const IM1 = 2147483563;
const IM2 = 2147483399;
const AM = 1 / IM1;
const IMM1 = IM1 - 1;
const IA1 = 40014;
const IA2 = 40692;
const IQ1 = 53668;
const IQ2 = 52774;
const IR1 = 12211;
const IR2 = 3791;
const NTAB = 32;
const NDIV = 1 + Math.floor(IMM1 / NTAB);
const EPS = 1.2e-7;
const RNMX = 1 - EPS;
export class Random {
    constructor(seed = Math.floor(Math.random() * 0x100000000)) {
        this.idum = 0;
        this.idum2 = 0;
        this.iy = 0;
        this.iv = [];
        this.z1 = null;
        this.seed(seed);
    }
    static newSeed() {
        return Math.floor(Math.random() * 0x100000000);
    }
    seed(seed) {
        this.idum = Math.max(1, Math.floor(seed));
        this.idum2 = this.idum;
        this.iy = 0;
        this.iv = new Array(NTAB).fill(0);
        for (let j = NTAB + 7; j >= 0; j--) {
            const k = Math.floor(this.idum / IQ1);
            this.idum = IA1 * (this.idum - k * IQ1) - k * IR1;
            if (this.idum < 0)
                this.idum += IM1;
            if (j < NTAB)
                this.iv[j] = this.idum;
        }
        this.iy = this.iv[0];
    }
    next() {
        let k = Math.floor(this.idum / IQ1);
        this.idum = IA1 * (this.idum - k * IQ1) - k * IR1;
        if (this.idum < 0)
            this.idum += IM1;
        k = Math.floor(this.idum2 / IQ2);
        this.idum2 = IA2 * (this.idum2 - k * IQ2) - k * IR2;
        if (this.idum2 < 0)
            this.idum2 += IM2;
        const j = Math.floor(this.iy / NDIV);
        this.iy = this.iv[j] - this.idum2;
        this.iv[j] = this.idum;
        if (this.iy < 1)
            this.iy += IMM1;
        return Math.min(AM * this.iy, RNMX);
    }
    nextInt(n) {
        return Math.floor(this.next() * n);
    }
    nextNormal(mean = 0, stdev = 1, min = -Infinity, max = Infinity) {
        while (true) {
            let z = this.z1;
            if (z == null) {
                const r = Math.sqrt(-2 * Math.log(this.next()));
                const theta = TWOPI * this.next();
                z = r * Math.cos(theta);
                this.z1 = r * Math.sin(theta);
            }
            else {
                this.z1 = null;
            }
            z = mean + z * stdev;
            if (z >= min && z <= max)
                return z;
        }
    }
    shuffle(array) {
        for (let i = array.length; i;) {
            const j = this.nextInt(i--);
            [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
    }
    *ishuffle(iterable) {
        const arr = [];
        if (!Array.isArray(iterable)) {
            if (hasSize(iterable)) {
                const iter = iterable[Symbol.iterator]();
                for (let i = 0; i < iterable.size; i++) {
                    const j = i + this.nextInt(iterable.size - i);
                    while (arr.length <= j) {
                        arr.push(iter.next().value);
                    }
                    yield arr[j];
                    arr[j] = arr[i];
                }
                return;
            }
            else {
                iterable = [...iterable];
            }
        }
        if (!Array.isArray(iterable))
            throw new Error('impossible');
        for (let i = 0; i < iterable.length; i++) {
            const j = i + this.nextInt(iterable.length - i);
            yield j in arr ? arr[j] : iterable[j];
            arr[j] = i in arr ? arr[i] : iterable[i];
        }
    }
    metropolisShuffle(arr, temp) {
        arr.sort((a, b) => b[0] - a[0]);
        if (temp <= 0)
            return arr;
        const l = arr.length;
        for (let i = l * l; i > 0; i--) {
            const j2 = this.nextInt(l - 1) + 1;
            const j1 = this.nextInt(j2);
            const delta = arr[j1][0] - arr[j2][0];
            const swap = delta < 0 || this.next() < Math.exp(-delta / temp);
            if (swap) {
                const tmp = arr[j1];
                arr[j1] = arr[j2];
                arr[j2] = tmp;
            }
        }
        return arr;
    }
    pick(arr) {
        if (!arr.length)
            throw new Error('empty array');
        return arr[this.nextInt(arr.length)];
    }
    pickWeighted(arr) {
        if (!arr.length)
            throw new Error('empty array');
        let total = 0;
        for (const [weight] of arr)
            total += weight;
        let choice = this.next() * total;
        for (const [weight, elem] of arr) {
            if (choice < weight)
                return elem;
            choice -= weight;
        }
        throw new Error('bad weights');
    }
    pickAndRemove(...arrs) {
        let count = 0;
        for (const arr of arrs) {
            count += arr.length;
        }
        if (!count)
            throw new Error('empty arrays');
        let i = this.nextInt(count);
        for (const arr of arrs) {
            if (i < arr.length)
                return arr.splice(i, 1)[0];
            i -= arr.length;
        }
        throw new Error('impossible');
    }
    bitGenerator() {
        let bits = 0;
        let next = 0;
        return () => {
            if (!bits) {
                bits = 32;
                next = this.nextInt(0x100000000);
            }
            bits--;
            const result = !(next & 1);
            next >>>= 1;
            return result;
        };
    }
}
function hasSize(iter) {
    return 'size' in iter;
}
const TWOPI = 2 * Math.PI;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmFuZG9tLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2pzL3JhbmRvbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLEdBQUcsR0FBRyxVQUFVLENBQUM7QUFDdkIsTUFBTSxHQUFHLEdBQUcsVUFBVSxDQUFDO0FBQ3ZCLE1BQU0sRUFBRSxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUM7QUFDbkIsTUFBTSxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsQ0FBQztBQUNyQixNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUM7QUFDbEIsTUFBTSxHQUFHLEdBQUcsS0FBSyxDQUFDO0FBQ2xCLE1BQU0sR0FBRyxHQUFHLEtBQUssQ0FBQztBQUNsQixNQUFNLEdBQUcsR0FBRyxLQUFLLENBQUM7QUFDbEIsTUFBTSxHQUFHLEdBQUcsS0FBSyxDQUFDO0FBQ2xCLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQztBQUNqQixNQUFNLElBQUksR0FBRyxFQUFFLENBQUM7QUFDaEIsTUFBTSxJQUFJLEdBQUcsQ0FBQyxHQUFHLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxDQUFDO0FBQ3pDLE1BQU0sR0FBRyxHQUFHLE1BQU0sQ0FBQztBQUNuQixNQUFNLElBQUksR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDO0FBRXJCLE1BQU0sT0FBTyxNQUFNO0lBYWpCLFlBQVksT0FBZSxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxXQUFXLENBQUM7UUFOMUQsU0FBSSxHQUFXLENBQUMsQ0FBQztRQUNqQixVQUFLLEdBQVcsQ0FBQyxDQUFDO1FBQ2xCLE9BQUUsR0FBVyxDQUFDLENBQUM7UUFDZixPQUFFLEdBQWEsRUFBRSxDQUFDO1FBQ2xCLE9BQUUsR0FBa0IsSUFBSSxDQUFDO1FBRy9CLElBQUksQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbEIsQ0FBQztJQVpELE1BQU0sQ0FBQyxPQUFPO1FBQ1osT0FBTyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsR0FBRyxXQUFXLENBQUMsQ0FBQztJQUNqRCxDQUFDO0lBWUQsSUFBSSxDQUFDLElBQVk7UUFDZixJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUMxQyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUM7UUFDdkIsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLENBQUM7UUFDWixJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNsQyxLQUFLLElBQUksQ0FBQyxHQUFHLElBQUksR0FBRyxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsRUFBRTtZQUNsQyxNQUFNLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxDQUFDLENBQUM7WUFDdEMsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDO1lBQ2xELElBQUksSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDO2dCQUFFLElBQUksQ0FBQyxJQUFJLElBQUksR0FBRyxDQUFDO1lBQ3BDLElBQUksQ0FBQyxHQUFHLElBQUk7Z0JBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDO1NBQ3RDO1FBQ0QsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3ZCLENBQUM7SUFFRCxJQUFJO1FBQ0YsSUFBSSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxHQUFHLEdBQUcsQ0FBQyxDQUFDO1FBQ3BDLElBQUksQ0FBQyxJQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDLEdBQUcsQ0FBQyxHQUFHLEdBQUcsQ0FBQztRQUNsRCxJQUFJLElBQUksQ0FBQyxJQUFJLEdBQUcsQ0FBQztZQUFFLElBQUksQ0FBQyxJQUFJLElBQUksR0FBRyxDQUFDO1FBQ3BDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxLQUFLLEdBQUcsR0FBRyxDQUFDLENBQUM7UUFDakMsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsR0FBRyxHQUFHLENBQUMsR0FBRyxDQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ3BELElBQUksSUFBSSxDQUFDLEtBQUssR0FBRyxDQUFDO1lBQUUsSUFBSSxDQUFDLEtBQUssSUFBSSxHQUFHLENBQUM7UUFDdEMsTUFBTSxDQUFDLEdBQUcsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsS0FBSyxDQUFDO1FBQ2xDLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztRQUN2QixJQUFJLElBQUksQ0FBQyxFQUFFLEdBQUcsQ0FBQztZQUFFLElBQUksQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDO1FBQ2pDLE9BQU8sSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLEVBQUUsRUFBRSxJQUFJLENBQUMsQ0FBQztJQUN0QyxDQUFDO0lBRUQsT0FBTyxDQUFDLENBQVM7UUFDZixPQUFPLElBQUksQ0FBQyxLQUFLLENB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SUFDbkMsT0FBTyxNQUFNLElBQUksSUFBSSxDQUFDO0FBQ3hCLENBQUM7QUFFRCxNQUFNLEtBQUssR0FBRyxDQUFDLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImNvbnN0IElNMSA9IDIxNDc0ODM1NjM7XG5jb25zdCBJTTIgPSAyMTQ3NDgzMzk5O1xuY29uc3QgQU0gPSAxIC8gSU0xO1xuY29uc3QgSU1NMSA9IElNMSAtIDE7XG5jb25zdCBJQTEgPSA0MDAxNDtcbmNvbnN0IElBMiA9IDQwNjkyO1xuY29uc3QgSVExID0gNTM2Njg7XG5jb25zdCBJUTIgPSA1Mjc3NDtcbmNvbnN0IElSMSA9IDEyMjExO1xuY29uc3QgSVIyID0gMzc5MTtcbmNvbnN0IE5UQUIgPSAzMjtcbmNvbnN0IE5ESVYgPSAxICsgTWF0aC5mbG9vcihJTU0xIC8gTlRBQik7XG5jb25zdCBFUFMgPSAxLjJlLTc7XG5jb25zdCBSTk1YID0gMSAtIEVQUztcblxuZXhwb3J0IGNsYXNzIFJhbmRvbSB7XG5cbiAgLy8gUmV0dXJucyBhIG5ldyBzZWVkIGF0IHJhbmRvbSwgdXNpbmcgdGhlIHN5c3RlbSBQUk5HLlxuICBzdGF0aWMgbmV3U2VlZCgpOiBudW1iZXIge1xuICAgIHJldHVybiBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAweDEwMDAwMDAwMCk7XG4gIH1cblxuICBwcml2YXRlIGlkdW06IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaWR1bTI6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXk6IG51bWJlciA9IDA7XG4gIHByaXZhdGUgaXY6IG51bWJlcltdID0gW107XG4gIHByaXZhdGUgejE6IG51bWJlciB8IG51bGwgPSBudWxsOyAvLyBleHRyYSBub3JtYWwgZGV2aWF0ZVxuXG4gIGNvbnN0cnVjdG9yKHNlZWQ6IG51bWJlciA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDB4MTAwMDAwMDAwKSkge1xuICAgIHRoaXMuc2VlZChzZWVkKTtcbiAgfVxuXG4gIHNlZWQoc2VlZDogbnVtYmVyKSB7XG4gICAgdGhpcy5pZHVtID0gTWF0aC5tYXgoMSwgTWF0aC5mbG9vcihzZWVkKSk7XG4gICAgdGhpcy5pZHVtMiA9IHRoaXMuaWR1bTtcbiAgICB0aGlzLml5ID0gMDtcbiAgICB0aGlzLml2ID0gbmV3IEFycmF5KE5UQUIpLmZpbGwoMCk7XG4gICAgZm9yIChsZXQgaiA9IE5UQUIgKyA3OyBqID49IDA7IGotLSkge1xuICAgICAgY29uc3QgayA9IE1hdGguZmxvb3IodGhpcy5pZHVtIC8gSVExKTtcbiAgICAgIHRoaXMuaWR1bSA9IElBMSAqICh0aGlzLmlkdW0gLSBrICogSVExKSAtIGsgKiBJUjE7XG4gICAgICBpZiAodGhpcy5pZHVtIDwgMCkgdGhpcy5pZHVtICs9IElNMTtcbiAgICAgIGlmIChqIDwgTlRBQikgdGhpcy5pdltqXSA9IHRoaXMuaWR1bTtcbiAgICB9XG4gICAgdGhpcy5peSA9IHRoaXMuaXZbMF07XG4gIH1cblxuICBuZXh0KCk6IG51bWJlciB7XG4gICAgbGV0IGsgPSBNYXRoLmZsb29yKHRoaXMuaWR1bSAvIElRMSk7XG4gICAgdGhpcy5pZHVtID0gSUExICogKHRoaXMuaWR1bSAtIGsgKiBJUTEpIC0gayAqIElSMTtcbiAgICBpZiAodGhpcy5pZHVtIDwgMCkgdGhpcy5pZHVtICs9IElNMTtcbiAgICBrID0gTWF0aC5mbG9vcih0aGlzLmlkdW0yIC8gSVEyKTtcbiAgICB0aGlzLmlkdW0yID0gSUEyICogKHRoaXMuaWR1bTIgLSBrICogSVEyKSAtIGsgKiBJUjI7XG4gICAgaWYgKHRoaXMuaWR1bTIgPCAwKSB0aGlzLmlkdW0yICs9IElNMjtcbiAgICBjb25zdCBqID0gTWF0aC5mbG9vcih0aGlzLml5IC8gTkRJVik7XG4gICAgdGhpcy5peSA9IHRoaXMuaXZbal0gLSB0aGlzLmlkdW0yO1xuICAgIHRoaXMuaXZbal0gPSB0aGlzLmlkdW07XG4gICAgaWYgKHRoaXMuaXkgPCAxKSB0aGlzLml5ICs9IElNTTE7XG4gICAgcmV0dXJuIE1hdGgubWluKEFNICogdGhpcy5peSwgUk5NWCk7XG4gIH1cblxuICBuZXh0SW50KG46IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGguZmxvb3IodGhpcy5uZXh0KCkgKiBuKTtcbiAgfVxuXG4gIG5leHROb3JtYWwobWVhbjogbnVtYmVyID0gMCxcbiAgICAgICAgICAgICBzdGRldjogbnVtYmVyID0gMSxcbiAgICAgICAgICAgICBtaW46IG51bWJlciA9IC1JbmZpbml0eSxcbiAgICAgICAgICAgICBtYXg6IG51bWJlciA9IEluZmluaXR5KSB7XG4gICAgd2hpbGUgKHRydWUpIHtcbiAgICAgIGxldCB6ID0gdGhpcy56MTtcbiAgICAgIGlmICh6ID09IG51bGwpIHtcbiAgICAgICAgY29uc3QgciA9IE1hdGguc3FydCgtMiAqIE1hdGgubG9nKHRoaXMubmV4dCgpKSk7XG4gICAgICAgIGNvbnN0IHRoZXRhID0gVFdPUEkgKiB0aGlzLm5leHQoKTtcbiAgICAgICAgeiA9IHIgKiBNYXRoLmNvcyh0aGV0YSk7XG4gICAgICAgIHRoaXMuejEgPSByICogTWF0aC5zaW4odGhldGEpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy56MSA9IG51bGw7XG4gICAgICB9XG4gICAgICB6ID0gbWVhbiArIHogKiBzdGRldjtcbiAgICAgIGlmICh6ID49IG1pbiAmJiB6IDw9IG1heCkgcmV0dXJuIHo7XG4gICAgfVxuICB9XG5cbiAgc2h1ZmZsZTxUIGV4dGVuZHMgTXV0YWJsZUFycmF5TGlrZTx1bmtub3duPj4oYXJyYXk6IFQpOiBUIHtcbiAgICBmb3IgKGxldCBpID0gYXJyYXkubGVuZ3RoOyBpOykge1xuICAgICAgY29uc3QgaiA9IHRoaXMubmV4dEludChpLS0pO1xuICAgICAgW2FycmF5W2ldLCBhcnJheVtqXV0gPSBbYXJyYXlbal0sIGFycmF5W2ldXTtcbiAgICB9XG4gICAgcmV0dXJuIGFycmF5O1xuICB9XG5cbiAgLyoqIERvZXMgbm90IGRlc3Ryb3kgdGhlIGlucHV0IGl0ZXJhYmxlLiAqL1xuICAqIGlzaHVmZmxlPFQ+KGl0ZXJhYmxlOiBJdGVyYWJsZTxUPik6IEl0ZXJhYmxlSXRlcmF0b3I8VD4ge1xuICAgIGNvbnN0IGFycjogVFtdID0gW107XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KGl0ZXJhYmxlKSkge1xuICAgICAgaWYgKGhhc1NpemUoaXRlcmFibGUpKSB7XG4gICAgICAgIGNvbnN0IGl0ZXIgPSBpdGVyYWJsZVtTeW1ib2wuaXRlcmF0b3JdKCk7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgaXRlcmFibGUuc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgaiA9IGkgKyB0aGlzLm5leHRJbnQoaXRlcmFibGUuc2l6ZSAtIGkpO1xuICAgICAgICAgIHdoaWxlIChhcnIubGVuZ3RoIDw9IGopIHtcbiAgICAgICAgICAgIGFyci5wdXNoKGl0ZXIubmV4dCgpLnZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgeWllbGQgYXJyW2pdO1xuICAgICAgICAgIGFycltqXSA9IGFycltpXTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm47IC8vIFRPRE8gLSB3aHkgd2FzIHRoaXMgbm90IHJlcXVpcmVkP1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgaXRlcmFibGUgPSBbLi4uaXRlcmFibGVdO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoIUFycmF5LmlzQXJyYXkoaXRlcmFibGUpKSB0aHJvdyBuZXcgRXJyb3IoJ2ltcG9zc2libGUnKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGl0ZXJhYmxlLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCBqID0gaSArIHRoaXMubmV4dEludChpdGVyYWJsZS5sZW5ndGggLSBpKTtcbiAgICAgIHlpZWxkIGogaW4gYXJyID8gYXJyW2pdIDogaXRlcmFibGVbal07XG4gICAgICBhcnJbal0gPSBpIGluIGFyciA/IGFycltpXSA6IGl0ZXJhYmxlW2ldO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBTaHVmZmxlcyBhIHdlaWdodGVkIGxpc3Qgc3VjaCB0aGF0IHRoZSBoaWdoZXIgd2VpZ2h0cyBfdGVuZF8gdG8gY29tZVxuICAgKiBlYXJsaWVyLCBidXQgdXNlcyBhIHRlbXBlcmF0dXJlLXBhcmFtZXRyaXplZCBtb250ZSBjYXJsbyBhbGdvcml0aG0gdG9cbiAgICogaW5qZWN0IHNvbWUgcmFuZG9tbmVzcy4gIFdoZW4gdGVtcGVyYXR1cmUgaXMgemVybyB0aGVuIHRoaXMgaXMganVzdCBhXG4gICAqIGRldGVybWluaXN0aWMgc29ydC4gIFdoZW4gdGVtcGVyYXR1cmUgaXMgaW5maW5pdGUsIHRoZW4gaXQncyBhXG4gICAqIGNvbXBsZXRlbHkgcmFuZG9tIHNodWZmbGUuICBBdCBpbi1iZXR3ZWVuIHRlbXBlcmF0dXJlcyAob24gdGhlIG9yZGVyXG4gICAqIG9mIG1hZ25pdHVkZSBvZiB0aGUgd2VpZ2h0cyksIHRoZXJlIGlzIGEgdHJhbnNpdGlvbi5cbiAgICovXG4gIG1ldHJvcG9saXNTaHVmZmxlPFQgZXh0ZW5kcyBBcnJheTxbbnVtYmVyLCBUXT4+KGFycjogVCwgdGVtcDogbnVtYmVyKTogVCB7XG4gICAgLy8gU3RhcnQgYXQgVD0wIGVxdWlsaWJyaXVtLCB0aGVuIGhlYXQgaXQgdXAuXG4gICAgYXJyLnNvcnQoKGEsIGIpID0+IGJbMF0gLSBhWzBdKTtcbiAgICBpZiAodGVtcCA8PSAwKSByZXR1cm4gYXJyO1xuXG4gICAgLy8gVE9ETyAtIHRoaXMgcHJvYmFibHkgZG9lc24ndCB3b3JrIGhvdyB3ZSdkIGxpa2UgLSByYW5kb21seSBzd2FwcGluZ1xuICAgIC8vIG5vbi1uZWlnaGJvcnMgc2VlbXMgcHJvYmxlbWF0aWMsIGFuZCBJJ20gc3RhcnRpbmcgdG8gcXVlc3Rpb24gdGhlXG4gICAgLy8gc2NhbGUgLSBpZiB3ZSBoYXZlIHdlaWdodHMgZnJvbSAwIHRvIDE1IHRoZW4gVD01IG1pZ2h0IG1lYW4gdGhhdFxuICAgIC8vIHdlJ2xsIHNlZSAxMC4uMTUgYXQgdGhlIGZyb250IGJ1dCB2ZXJ5IG5vdCBsaWtlbHkgb3RoZXJzLlxuICAgIC8vICAgLSBtYXliZSBpdCdzIHRoZSBzYW1lIHRoaW5nIHdpdGggYSB1bml0bGVzcyBzY2FsaW5nP1xuICAgIC8vIFdlIHNob3VsZCBhbHNvIHRyeSBOIHBhc3NlcyBvZiBub24tcmFuZG9tIG5laWdoYm9yIHNodWZmbGVzP1xuICAgIC8vICAgLSBpZiB0aGVyZSdzIGEgYmlnIGRlbHRhIHNvbWV3aGVyZSBpbiB0aGUgbWlkZGxlLCBpdCB3b3VsZCBiZSBoYXJkXG4gICAgLy8gICAgIHRvIGJyZWFrIHRocm91Z2ggdGhhdD9cbiAgICAvLyAgIC0tLT4gd2F5IHRvbyBzbG93XG5cbiAgICBjb25zdCBsID0gYXJyLmxlbmd0aDtcbiAgICBmb3IgKGxldCBpID0gbCAqIGw7IGkgPiAwOyBpLS0pIHtcbiAgICAgIGNvbnN0IGoyID0gdGhpcy5uZXh0SW50KGwgLSAxKSArIDE7XG4gICAgICBjb25zdCBqMSA9IHRoaXMubmV4dEludChqMik7XG4gICAgICBjb25zdCBkZWx0YSA9IGFycltqMV1bMF0gLSBhcnJbajJdWzBdO1xuICAgICAgLy8gR29hbDogd2VpZ2h0IDEgc2hvdWxkIGJlIGdyZWF0ZXIgdGhhbiB3ZWlnaHQgMjpcbiAgICAgIC8vICAgc28gZGVsdGEgPCAwIG1lYW5zIHdlIHNob3VsZCBkZWZpbml0ZWx5IHN3YXBcbiAgICAgIC8vICAgYnV0IGRlbHRhID4gMCBtZWFucyB3ZSBtaWdodCBzd2FwIGF0IGhpZ2hlciB0ZW1wZXJhdHVyZXNcbiAgICAgIC8vICAgICAgICAgICAgICAgICAocHJvYmFiaWxpdHkgUD1leHAoLWRlbHRhL3RlbXApKVxuICAgICAgY29uc3Qgc3dhcCA9IGRlbHRhIDwgMCB8fCB0aGlzLm5leHQoKSA8IE1hdGguZXhwKC1kZWx0YSAvIHRlbXApO1xuICAgICAgaWYgKHN3YXApIHtcbiAgICAgICAgY29uc3QgdG1wID0gYXJyW2oxXTtcbiAgICAgICAgYXJyW2oxXSA9IGFycltqMl07XG4gICAgICAgIGFycltqMl0gPSB0bXA7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBhcnI7XG4gIH1cblxuICBwaWNrPFQ+KGFycjogcmVhZG9ubHkgVFtdKTogVCB7XG4gICAgaWYgKCFhcnIubGVuZ3RoKSB0aHJvdyBuZXcgRXJyb3IoJ2VtcHR5IGFycmF5Jyk7XG4gICAgcmV0dXJuIGFyclt0aGlzLm5leHRJbnQoYXJyLmxlbmd0aCldO1xuICB9XG5cbiAgcGlja1dlaWdodGVkPFQ+KGFycjogUmVhZG9ubHlBcnJheTxyZWFkb25seSBbbnVtYmVyLCBUXT4pOiBUIHtcbiAgICBpZiAoIWFyci5sZW5ndGgpIHRocm93IG5ldyBFcnJvcignZW1wdHkgYXJyYXknKTtcbiAgICBsZXQgdG90YWwgPSAwO1xuICAgIGZvciAoY29uc3QgW3dlaWdodF0gb2YgYXJyKSB0b3RhbCArPSB3ZWlnaHQ7XG4gICAgbGV0IGNob2ljZSA9IHRoaXMubmV4dCgpICogdG90YWw7XG4gICAgZm9yIChjb25zdCBbd2VpZ2h0LCBlbGVtXSBvZiBhcnIpIHtcbiAgICAgIGlmIChjaG9pY2UgPCB3ZWlnaHQpIHJldHVybiBlbGVtO1xuICAgICAgY2hvaWNlIC09IHdlaWdodDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKCdiYWQgd2VpZ2h0cycpO1xuICB9XG5cbiAgcGlja0FuZFJlbW92ZTxUPiguLi5hcnJzOiBUW11bXSk6IFQge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgZm9yIChjb25zdCBhcnIgb2YgYXJycykge1xuICAgICAgY291bnQgKz0gYXJyLmxlbmd0aDtcbiAgICB9XG4gICAgaWYgKCFjb3VudCkgdGhyb3cgbmV3IEVycm9yKCdlbXB0eSBhcnJheXMnKTtcbiAgICBsZXQgaSA9IHRoaXMubmV4dEludChjb3VudCk7XG4gICAgZm9yIChjb25zdCBhcnIgb2YgYXJycykge1xuICAgICAgaWYgKGkgPCBhcnIubGVuZ3RoKSByZXR1cm4gYXJyLnNwbGljZShpLCAxKVswXTtcbiAgICAgIGkgLT0gYXJyLmxlbmd0aDtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEVycm9yKCdpbXBvc3NpYmxlJyk7XG4gIH1cblxuICBiaXRHZW5lcmF0b3IoKTogKCkgPT4gYm9vbGVhbiB7XG4gICAgbGV0IGJpdHMgPSAwO1xuICAgIGxldCBuZXh0ID0gMDtcbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgaWYgKCFiaXRzKSB7XG4gICAgICAgIGJpdHMgPSAzMjtcbiAgICAgICAgbmV4dCA9IHRoaXMubmV4dEludCgweDEwMDAwMDAwMCk7XG4gICAgICB9XG4gICAgICBiaXRzLS07XG4gICAgICBjb25zdCByZXN1bHQgPSAhKG5leHQgJiAxKTtcbiAgICAgIG5leHQgPj4+PSAxXG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH07XG4gIH1cbn1cblxuaW50ZXJmYWNlIEhhc1NpemU8VD4gZXh0ZW5kcyBJdGVyYWJsZTxUPiB7XG4gIHJlYWRvbmx5IHNpemU6IG51bWJlcjtcbn1cbmZ1bmN0aW9uIGhhc1NpemU8VD4oaXRlcjogSXRlcmFibGU8VD4pOiBpdGVyIGlzIEhhc1NpemU8VD4ge1xuICByZXR1cm4gJ3NpemUnIGluIGl0ZXI7XG59XG5cbmNvbnN0IFRXT1BJID0gMiAqIE1hdGguUEk7XG5cbmludGVyZmFjZSBNdXRhYmxlQXJyYXlMaWtlPFQ+IHtcbiAgbGVuZ3RoOiBudW1iZXI7XG4gIFtpbmRleDogbnVtYmVyXTogVDtcbn1cblxuLy8gLy8gUHJvdmlkZSBhIHN0YXRpYyBzaW5nbGV0b24gaW5zdGFuY2UuXG4vLyBsZXQgcmFuZG9tID0gKCgpID0+IHtcbi8vICAgbGV0IHNlZWQgPSAwO1xuLy8gICBpZiAod2luZG93ICYmIHdpbmRvdy5sb2NhdGlvbiAmJiB3aW5kb3cubG9jYXRpb24uaGFzaCkge1xuLy8gICAgIGZvciAoY29uc3QgY29tcG9uZW50IG9mIHdpbmRvdy5sb2NhdGlvbi5oYXNoLnN1YnN0cmluZygxKS5zcGxpdCgnJicpKSB7XG4vLyAgICAgICBjb25zdCBzcGxpdCA9IGNvbXBvbmVudC5zcGxpdCgnPScpO1xuLy8gICAgICAgaWYgKHNwbGl0WzBdID09PSAnc2VlZCcpIHtcbi8vICAgICAgICAgc2VlZCA9IE51bWJlcihzcGxpdFsxXSkgfHwgMDtcbi8vICAgICAgIH1cbi8vICAgICB9XG4vLyAgIH1cbi8vICAgaWYgKCFzZWVkKSB7XG4vLyAgICAgc2VlZCA9IE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIDB4MTAwMDAwMDAwKTtcbi8vICAgfVxuLy8gICByZXR1cm4gbmV3IFJhbmRvbShzZWVkKTtcbi8vIH0pKCk7XG4vLyBSYW5kb20ubmV4dEludCA9IChuKSA9PiByYW5kb20ubmV4dEludChuKTtcbi8vIFJhbmRvbS5uZXh0ID0gKCkgPT4gcmFuZG9tLm5leHQoKTtcbi8vIFJhbmRvbS5zZWVkID0gKHMpID0+IHJhbmRvbS5zZWVkKHMpO1xuIl19