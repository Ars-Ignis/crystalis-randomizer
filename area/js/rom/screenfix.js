import { iters } from '../util.js';
export var ScreenFix;
(function (ScreenFix) {
    ScreenFix[ScreenFix["Unknown"] = 0] = "Unknown";
    ScreenFix[ScreenFix["GrassLongGrass"] = 1] = "GrassLongGrass";
    ScreenFix[ScreenFix["GrassLongGrassRemapping"] = 2] = "GrassLongGrassRemapping";
    ScreenFix[ScreenFix["RiverShortGrass"] = 3] = "RiverShortGrass";
    ScreenFix[ScreenFix["SeaCaveEntrance"] = 4] = "SeaCaveEntrance";
    ScreenFix[ScreenFix["SeaRocks"] = 5] = "SeaRocks";
    ScreenFix[ScreenFix["SeaMarsh"] = 6] = "SeaMarsh";
    ScreenFix[ScreenFix["SeaTrees"] = 7] = "SeaTrees";
    ScreenFix[ScreenFix["DesertShortGrass"] = 8] = "DesertShortGrass";
    ScreenFix[ScreenFix["DesertLongGrass"] = 9] = "DesertLongGrass";
    ScreenFix[ScreenFix["DesertMarsh"] = 10] = "DesertMarsh";
    ScreenFix[ScreenFix["DesertRocks"] = 11] = "DesertRocks";
    ScreenFix[ScreenFix["DesertTrees"] = 12] = "DesertTrees";
    ScreenFix[ScreenFix["DesertTownEntrance"] = 13] = "DesertTownEntrance";
    ScreenFix[ScreenFix["LabyrinthParapets"] = 14] = "LabyrinthParapets";
    ScreenFix[ScreenFix["SwampDoors"] = 15] = "SwampDoors";
    ScreenFix[ScreenFix["ExtraSpikes"] = 16] = "ExtraSpikes";
    ScreenFix[ScreenFix["CloseCaves"] = 17] = "CloseCaves";
    ScreenFix[ScreenFix["WideArenaExits"] = 18] = "WideArenaExits";
})(ScreenFix || (ScreenFix = {}));
export function withRequire(requirement, props) {
    for (const key in props) {
        props[key].requires = [requirement];
    }
    return props;
}
export function fixTilesets(rom) {
    const { desert, grass, lime, mountain, mountainRiver, river, sea, town } = rom.metatilesets;
    const $ = rom.metascreens;
    $.registerFix(ScreenFix.DesertRocks);
    desert.getTile(0x5f).copyFrom(0x5b).replaceIn($.oasisCave, $.oasisLake);
    desert.getTile(0x5a).copyFrom(0x98).setTiles([, , 0x1a, 0x18]);
    desert.getTile(0x5b).copyFrom(0x80).setTiles([0x34, 0x32, ,]);
    desert.getTile(0x5c).copyFrom(0x80).setTiles([, , 0x37, 0x35]);
    desert.getTile(0x5d).copyFrom(0x80).setTiles([, 0x37, , 0x34]);
    desert.getTile(0x5e).copyFrom(0x80).setTiles([0x35, , 0x32,]);
    $.registerFix(ScreenFix.DesertTrees);
    desert.getTile(0x63).copyFrom(0x71);
    desert.getTile(0x68).copyFrom(0x70);
    desert.getTile(0x69).copyFrom(0x60);
    desert.getTile(0x6a).copyFrom(0x65);
    desert.getTile(0x6c).copyFrom(0x70);
    desert.getTile(0x6e).copyFrom(0x76);
    desert.getTile(0x6f).copyFrom(0x78);
    $.registerFix(ScreenFix.GrassLongGrass);
    grass.getTile(0x40).copyFrom(0x51);
    grass.getTile(0x41).copyFrom(0x52);
    grass.getTile(0x42).copyFrom(0x53);
    grass.getTile(0x43).copyFrom(0x54);
    grass.getTile(0x44).copyFrom(0x55);
    grass.getTile(0x45).copyFrom(0x56);
    grass.getTile(0x46).copyFrom(0x58);
    grass.getTile(0x47).copyFrom(0x59);
    $.registerFix(ScreenFix.SeaCaveEntrance);
    sea.getTile(0xad).copyFrom(0x0a)
        .replaceIn($.beachExitN, $.lighthouseEntrance, $.oceanShrine);
    sea.getTile(0x0a).copyFrom(0xa2);
    $.boundaryN_cave.screen.set2d(0x38, [[, 0x00, 0x00],
        [, 0x0a, 0x0a],
        [, 0xf7, 0xf7],
        [0xf8, 0xf8, 0xf8, 0xf8]]);
    $.cornerSE_cave.screen.set2d(0x49, [[, 0x00, 0x00],
        [, 0x0a, 0x0a],
        [, 0xf7, 0xf7],
        [0xf8, 0xf7, 0xf7],
        [, 0xfd, 0xf7]]);
    $.cornerSE_cave.screen.set2d(0x4a, [[0x00, 0x00],
        [0x0a, 0x0a],
        [0xf7, 0xf7],
        [0xf8, 0xf7],
        [0x80, 0xfd],
        [0x80, 0xff],
        [0xfa]]);
    $.registerFix(ScreenFix.CloseCaves);
    river.getTile(0x07).copyFrom(0x01).replaceIn(...river);
    river.getTile(0x0e).copyFrom(0x02).replaceIn(...river);
    river.getTile(0x20).copyFrom(0x03).replaceIn(...river);
    river.getTile(0x21).copyFrom(0x04).replaceIn(...river);
    for (const ts of [desert, sea, mountain, mountainRiver, lime]) {
        ts.getTile(0x68).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x83).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x88).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x89).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [town]) {
        ts.getTile(0x50).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x51).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x52).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x57).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [grass, river, desert]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xd7).setAlternative(0x0a);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x04).copyFrom(0xd7).setAlternative(0x0a);
    }
    for (const ts of [sea]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xcb).setAlternative(0x00);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0xc0);
        ts.getTile(0x04).copyFrom(0xcb).setAlternative(0xc0);
        for (let i = 1; i < 5; i++) {
            ts.getTile(i).setTiles(grass.getTile(i).tiles);
        }
    }
    for (const ts of [town]) {
        ts.getTile(0x01).copyFrom(0x63).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0x64).setAlternative(0xd2);
        ts.getTile(0x03).copyFrom(0x63).setAlternative(0x00);
        ts.getTile(0x04).copyFrom(0x64).setAlternative(0xd2);
    }
    const closedCaves = new Set([
        $.boundaryE_cave, $.boundaryW_cave, $.exitW_cave, $.caveAbovePortoa,
        $.beachCave, $.outsideWindmill,
        $.exitS_cave, $.townExitW_cave,
        $.zombieTownBottom_caveExit,
    ]);
    const waterCaves = new Set([]);
    if ($.isFixed(ScreenFix.SeaCaveEntrance)) {
        waterCaves.add($.boundaryN_cave);
        waterCaves.add($.cornerSE_cave);
    }
    const mountainCaves = new Set([
        $.mountainDeadEndW_caveEmpty,
        $.mountainPathW_cave,
        $.mountainCave_empty,
        $.mountainPathE_cave,
        $.mountainPathN_slopeS_cave,
        $.mountainPathWE_slopeN_cave,
        $.mountainPathE_gate,
    ]);
    for (const scr of [...closedCaves, ...waterCaves]) {
        const exit = scr.data.exits.find(e => e.type === 'cave');
        const pos = Math.min(...exit.exits) - 0x10;
        const tiles = waterCaves.has(scr) ? [[3, 3], [4, 4]] : [[1, 1], [2, 2]];
        scr.screen.set2d(pos, tiles);
        scr.addCustomFlag(true);
    }
    for (const scr of [...mountainCaves]) {
        const exit = scr.data.exits.find(e => e.type === 'cave' || e.type === 'gate');
        const pos = Math.min(...exit.exits) - 0x10;
        const tiles = [[0x1a, 0x1a], [0x08, 0x09]];
        scr.screen.set2d(pos, tiles);
        scr.addCustomFlag(true);
    }
    $.outsideWindmill.screen.set2d(0x43, [[0xca, 0x82]]);
    $.townExitW_cave.screen.set2d(0x2a, [[0xca, 0x82]]);
}
export function wideArenaExits(rom) {
    var _a;
    function widen(exits) {
        exits.splice(0, exits.length, ...new Set(iters.concat(...exits.map(e => [e, e + 1, e - 1]))));
    }
    const { fortressArena_through, fortressTrap, hallNS, hallNS_arena, hallNS_arenaWall, hallNS_entrance, } = rom.metascreens;
    hallNS_arena.screen.set2d(0x04, [
        [0x97, 0x76, 0x22, 0x23, 0x23, 0x23, 0x4b, 0x95],
        [0x42, 0x48, 0x22, 0x21, 0x23, 0x23, 0x45, 0x42],
        [0x43, 0x49, 0x2e, 0x23, 0x23, 0x21, 0x46, 0x43],
        [0x44, 0x4a, 0x2e, 0x23, 0x21, 0x21, 0x47, 0x44],
    ]);
    hallNS_arena.setGridTile(' c | a | c ');
    widen(hallNS_arena.findExitByType('edge:top').exits);
    hallNS_arenaWall.screen.set2d(0x04, [
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
        [0x97, 0x4f, 0x00, 0x01, 0x01, 0x02, 0x50, 0x95],
    ]);
    hallNS_arenaWall.setGridTile(' c | a | c ');
    widen(hallNS_arenaWall.findExitByType('edge:top').exits);
    const abductionTrigger = rom.locations.ZebuCave.spawns.find(s => s.isTrigger() && s.id === 0x8c);
    if (abductionTrigger)
        abductionTrigger.yt += 4;
    fortressArena_through.screen.set2d(0x05, [
        [0x5f, 0x22, 0x21, 0x21, 0x21, 0x5f],
        [0xb7, 0x22, 0x21, 0x21, 0x21, 0xb5],
        [0xbf, 0x22, 0x21, 0x21, 0x21, 0xa8],
    ]);
    fortressArena_through.setGridTile(' c | a | w ');
    widen(fortressArena_through.findExitByType('edge:top').exits);
    fortressTrap.screen.set2d(0xc4, [
        [0x3c, 0x3d, 0x21, 0x21, 0x21, 0x21, 0x3b, 0x3c],
        [0x92, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x90],
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
    ]);
    fortressTrap.setGridTile('   | x | c ');
    widen(fortressTrap.findExitByType('edge:bottom').exits);
    for (const location of rom.locations) {
        const meta = location.meta;
        for (const pos of meta.allPos()) {
            const scr = meta.get(pos);
            if (scr === hallNS_entrance && ((_a = meta.get(pos + 16)) === null || _a === void 0 ? void 0 : _a.hasFeature('arena'))) {
                meta.set(pos, hallNS);
                const row = location.screens[pos >>> 4];
                if (row)
                    row[pos & 0xf] = hallNS.sid;
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyZWVuZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL3JvbS9zY3JlZW5maXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFlBQVksQ0FBQztBQUduQyxNQUFNLENBQU4sSUFBWSxTQStEWDtBQS9ERCxXQUFZLFNBQVM7SUFDbkIsK0NBQU8sQ0FBQTtJQUdQLDZEQUFjLENBQUE7SUFLZCwrRUFBdUIsQ0FBQTtJQUl2QiwrREFBZSxDQUFBO0lBS2YsK0RBQWUsQ0FBQTtJQU1mLGlEQUFRLENBQUE7SUFHUixpREFBUSxDQUFBO0lBSVIsaURBQVEsQ0FBQTtJQUdSLGlFQUFnQixDQUFBO0lBR2hCLCtEQUFlLENBQUE7SUFJZix3REFBVyxDQUFBO0lBR1gsd0RBQVcsQ0FBQTtJQUdYLHdEQUFXLENBQUE7SUFHWCxzRUFBa0IsQ0FBQTtJQUdsQixvRUFBaUIsQ0FBQTtJQUVqQixzREFBVSxDQUFBO0lBRVYsd0RBQVcsQ0FBQTtJQUVYLHNEQUFVLENBQUE7SUFHViw4REFBYyxDQUFBO0FBQ2hCLENBQUMsRUEvRFcsU0FBUyxLQUFULFNBQVMsUUErRHBCO0FBR0QsTUFBTSxVQUFVLFdBQVcsQ0FBaUIsV0FBc0IsRUFBRSxLQUFRO0lBQzFFLEtBQUssTUFBTSxHQUFHLElBQUksS0FBSyxFQUFFO1FBQ3ZCLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNyQztJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQTRDRCxNQUFNLFVBQVUsV0FBVyxDQUFDLEdBQVE7SUFDbEMsTUFBTSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLFFBQVEsRUFBRSxhQUFhLEVBQzVDLEtBQUssRUFBRSxHQUFHLEVBQUUsSUFBSSxFQUFDLEdBQUcsR0FBRyxDQUFDLFlBQVksQ0FBQztJQUM1QyxNQUFNLENBQUMsR0FBRyxHQUFHLENBQUMsV0FBVyxDQUFDO0lBSTFCLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLENBQUMsU0FBUyxFQUFFLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQztJQUV4RSxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEFBQUQsRUFBSSxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxBQUFELEVBQUcsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsQUFBRCxFQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDL0QsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsSUFBSSxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUcsQ0FBQyxDQUFDO0lBRS9ELENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ3JDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3BDLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBSXBDLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGNBQWMsQ0FBQyxDQUFDO0lBQ3hDLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ25DLEtBQUssQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBV25DLENBQUMsQ0FBQyxXQUFXLENBQUMsU0FBUyxDQUFDLGVBQWUsQ0FBQyxDQUFDO0lBQ3pDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQztTQUMzQixTQUFTLENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxDQUFDLENBQUMsa0JBQWtCLEVBQUUsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxDQUFDO0lBQ2xFLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBRWpDLENBQUMsQ0FBQyxjQUFjLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFPO1FBQ3hCLENBQUssQUFBSixFQUFNLElBQUksRUFBRSxJQUFJLENBQU87UUFDeEIsQ0FBSyxBQUFKLEVBQU0sSUFBSSxFQUFFLElBQUksQ0FBTztRQUN4QixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNoRSxDQUFDLENBQUMsYUFBYSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBSyxBQUFKLEVBQU0sSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUssQUFBSixFQUFNLElBQUksRUFBRSxJQUFJLENBQUM7UUFDbEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ3pELENBQUMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksQ0FBTyxDQUFDLENBQUMsQ0FBQztJQWFuRCxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUVwQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFO1FBQzdELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBQ0QsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLElBQUksQ0FBQyxFQUFFO1FBQ3ZCLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBRUQsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUU7UUFDdkMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENB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Q0FBQztJQUNILFlBQVksQ0FBQyxXQUFXLENBQUMsYUFBYSxDQUFDLENBQUM7SUFDeEMsS0FBSyxDQUFDLFlBQVksQ0FBQyxjQUFjLENBQUMsYUFBYSxDQUFDLENBQUMsS0FBaUIsQ0FBQyxDQUFDO0lBSXBFLEtBQUssTUFBTSxRQUFRLElBQUksR0FBRyxDQUFDLFNBQVMsRUFBRTtRQUNwQyxNQUFNLElBQUksR0FBRyxRQUFRLENBQUMsSUFBSSxDQUFDO1FBQzNCLEtBQUssTUFBTSxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sRUFBRSxFQUFFO1lBQy9CLE1BQU0sR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxDQUFDLENBQUM7WUFDMUIsSUFBSSxHQUFHLEtBQUssZUFBZSxXQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxHQUFHLEVBQUUsQ0FBQywwQ0FBRSxVQUFVLENBQUMsT0FBTyxFQUFDLEVBQUU7Z0JBQ3RFLElBQUksQ0FBQyxHQUFHLENBQUMsR0FBRyxFQUFFLE1BQU0sQ0FBQyxDQUFDO2dCQUV0QixNQUFNLEdBQUcsR0FBRyxRQUFRLENBQUMsT0FBTyxDQUFDLEdBQUcsS0FBSyxDQUFDLENBQUMsQ0FBQztnQkFDeEMsSUFBSSxHQUFHO29CQUFFLEdBQUcsQ0FBQyxHQUFHLEdBQUcsR0FBRyxDQUFDLEdBQUcsTUFBTSxDQUFDLEdBQUcsQ0FBQzthQUN0QztTQUNGO0tBQ0Y7QUFDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUm9tIH0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7IE1ldGFzY3JlZW4gfSBmcm9tICcuL21ldGFzY3JlZW4uanMnO1xuaW1wb3J0IHsgaXRlcnMgfSBmcm9tICcuLi91dGlsLmpzJztcblxuLy8gU2ltcGxlIHRpbGVzZXQtb25seSBmaXhlcyB0aGF0IHVubG9jayBzb21lIHNjcmVlbi10aWxlc2V0IGNvbWJpbmF0aW9uc1xuZXhwb3J0IGVudW0gU2NyZWVuRml4IHtcbiAgVW5rbm93bixcbiAgLy8gU3VwcG9ydCBcImxvbmcgZ3Jhc3NcIiByaXZlciBzY3JlZW5zIG9uIHRoZSBncmFzcyB0aWxlc2V0IGJ5IGNvcHlpbmdcbiAgLy8gc29tZSB0aWxlcyBmcm9tIDUxLi41OSBpbnRvIDQwLi40Ny5cbiAgR3Jhc3NMb25nR3Jhc3MsXG4gIC8vIEluIGFkZGl0aW9uIHRvIGp1c3QgbWFraW5nIHRoZSBuZXcgbG9uZyBncmFzcyB0aWxlcywgd2UgbmVlZCB0b1xuICAvLyBhbHNvIHJlbWFwIHRoZSBleGlzdGluZyBvbmVzIGluIHNvbWUgc2l0dWF0aW9ucyB0byBwb2ludCB0byB0aGVcbiAgLy8gbmV3IG9uZXMsIGUuZy4gZm9yIHNjcmVlbnMgMWQsMjkgdG8gd29yayBvbiByaXZlciwgd2UgbmVlZCB0byB1c2VcbiAgLy8gdGhlIDR4IHRpbGVzIGluc3RlYWQgb2YgdGhlIDV4IG9uZXMgdG8gZml4IHRoZSBzdXJyb3VuZGluZy5cbiAgR3Jhc3NMb25nR3Jhc3NSZW1hcHBpbmcsIC8vIFRPRE9cbiAgLy8gUml2ZXIgdGlsZXNldHMgZG9uJ3QgZGVmaW5lIDEwLDEyLDE0LDE2LDE3LDFhLDFiLDFjLDIyLDIzLDI0LDI1LDI2LFxuICAvLyB3aGljaCBhcmUgdXNlZCBmb3IgdGhlIFwic2hvcnQgZ3Jhc3NcIiBpbiB0aGUgZ3Jhc3MgdGlsZXNldC4gIFRoZXNlXG4gIC8vIHdvdWxkIGJlIGVhc3kgdG8gY29weSBmcm9tIHNvbWV3aGVyZSBlbHNlIHRvIG9wZW4gdXAgYSBmZXcgc2NyZWVucy5cbiAgUml2ZXJTaG9ydEdyYXNzLCAvLyBUT0RPXG4gIC8vIEFuZ3J5IHNlYSB1c2VzIDBhIG9kZGx5IGZvciBhIHNpbXBsZSBkaWFnb25hbCBiZWFjaC9tb3VudGFpbiB0aWxlLFxuICAvLyBwcmV2ZW50aW5nIHBhcml0eSB3aXRoIGdyYXNzL3JpdmVyIGNhdmUgZW50cmFuY2UgYm90dG9tcy4gIE1vdmUgdGhpc1xuICAvLyB0aWxlIGVsc2V3aGVyZSAoYWQpIGFuZCBmaXggdGhlIGdyYXBoaWNzL2VmZmVjdHMuICBOb3RlIHRoYXQgdGhlXG4gIC8vIGFjdHVhbCBmaXggaXMgbm90IGVudGlyZWx5IHNhdGlzZnlpbmcuXG4gIFNlYUNhdmVFbnRyYW5jZSxcbiAgLy8gQW5ncnkgc2VhIGRvZXMgbm90IGhhbmRsZSByb2NrcyBjb3JyZWN0bHkuICBGaXggNWEuLjVlIGZvciBwYXJpdHlcbiAgLy8gd2l0aCBncmFzcy9yaXZlciB0aWxlc2V0cy4gIFRPRE8gLSBpbXBsZW1lbnQgdGhlIGZpeCAod2UgY291bGQgbW92ZVxuICAvLyB0aGUgZXhpc3RpbmcgdGlsZXMsIHVzZWQgYnkgbW91bnRhaW4gZ2F0ZXMsIGVsc2V3aGVyZSBwcmV0dHkgZWFzaWx5LFxuICAvLyBvciBhbHRlcm5hdGl2ZWx5IG1vdmUgYWxsIHRoZSA1YS4uNWUgaW4gYWxsIG90aGVyIHRpbGVzZXRzIGludG9cbiAgLy8gODksOGEsOTAsOTksOWQsZDEsZDIgd2hpY2ggYXJlIGZyZWUgaW4gODAsOTAsOTQsOWMpLlxuICBTZWFSb2NrcywgLy8gVE9ET1xuICAvLyBBbGxvdyB0aGUgc2VhIHRvIHN1cHBvcnQgMzQsMzgsM2MuLjNmLCB1c2VkIGFzIG1hcnNoIGluIHJpdmVyIHRpbGVzZXQuXG4gIC8vIFRoZXNlIHdvdWxkIG5lZWQgdG8gbWFwIHRvIHNpbXBsZSBvY2VhbiB0aWxlcy4gIFRPRE8gLSBpbXBsZW1lbnQuXG4gIFNlYU1hcnNoLCAvLyBUT0RPXG4gIC8vIFN1cHBvcnQgNngsN3ggdGlsZXMgKHRyZWVzKSBvbiBhbmdyeSBzZWEuICBQcm9iYWJseSBub3Qgd29ydGggaXQuXG4gIC8vIFdvdWxkIG5lZWQgdG8gbW92ZSAoZS5nLikgTGltZSBUcmVlIExha2UgdG8gYSB0b3RhbGx5IGRpZmZlcmVudCB0aWxlc2V0XG4gIC8vIHRvIGZyZWUgdXAgdGhlIG1ldGF0aWxlcy5cbiAgU2VhVHJlZXMsIC8vIFRPRE9cbiAgLy8gRml4aW5nIFJpdmVyU2hvcnRHcmFzcyBmb3IgZGVzZXJ0IGlzIGEgbG90IGhhcmRlciBiZWNhdXNlIGl0IHRvdWNoZXMgYVxuICAvLyBidW5jaCBvZiB0aWxlcyB1c2VkIGJ5IHRoZSBtb3VudGFpblJpdmVyIHRpbGVzZXQgKDEwLDE0LDJ4KS5cbiAgRGVzZXJ0U2hvcnRHcmFzcywgLy8gVE9ET1xuICAvLyBGaXhpbmcgR3Jhc3NMb25nR3Jhc3MgZm9yIGRlc2VydCBpcyBkaWZmaWN1bHQgYmVjYXVzZSB0aGUgNHggdGlsZXNcbiAgLy8gYXJlIHVzZWQgYnkgbW91bnRhaW5SaXZlci5cbiAgRGVzZXJ0TG9uZ0dyYXNzLCAvLyBUT0RPXG4gIC8vIERlc2VydCBkb2Vzbid0IHN1cHBvcnQgdGhlIDN4IG1hcnNoIHRpbGVzIChjbGFzaCB3aXRoIG1vdW50YWluUml2ZXIpLlxuICAvLyBJdCdzIHByb2JhYmx5IG5vdCBmZWFzaWJsZSB0byBhZGQgc3VwcG9ydCAtIGl0IHdvdWxkIGFsbG93IHNjcmVlbiAzMyxcbiAgLy8gYnV0IHRoZXJlJ3MgYSBzaW1pbGFyIHNvdXRoLWVkZ2UtZXhpdCBzY3JlZW4gd2l0aCBEZXNlcnRUb3duRW50cmFuY2UuXG4gIERlc2VydE1hcnNoLCAvLyBUT0RPXG4gIC8vIEZpeCA1YS4uNWUgdG8gYmUgY29tcGF0aWJsZSB3aXRoIGdyYXNzL3JpdmVyLiAgNWIgaXMgYWxyZWFkeSBpbiB1c2VcbiAgLy8gb24gdGhlIHR3byBvYXNpcyBzY3JlZW5zLCBzbyB0aGF0IHRpbGUgaXMgbW92ZWQgdG8gNWYgdG8gbWFrZSBzcGFjZS5cbiAgRGVzZXJ0Um9ja3MsXG4gIC8vIEFkZCBzb21lIG1pc3NpbmcgdHJlZSB0aWxlcyBpbiA2Myw2OCw2OSw2YSw2Yyw2ZSw2ZiwgcmVxdWlyZWQgZm9yXG4gIC8vIHBhcml0eSB3aXRoIHNvbWUgcml2ZXIgc2NyZWVucy5cbiAgRGVzZXJ0VHJlZXMsXG4gIC8vIFNvdXRoLWZhY2luZyB0b3duIGVudHJhbmNlcyB1c2UgMDcgZm9yIHRoZSB0b3Agb2YgdGhlIHRvd24gd2FsbC5cbiAgLy8gVGhpcyBjb3VsZCBiZSByZXBsYWNlZCB3aXRoIChlLmcuIDhjKSBvciBtYXliZSBzb21ldGhpbmcgYmV0dGVyLlxuICBEZXNlcnRUb3duRW50cmFuY2UsIC8vIFRPRE9cbiAgLy8gTGFieXJpbnRoIHBhcmFwZXRzIGNhbiBiZSBibG9ja2VkL3VuYmxvY2tlZCB3aXRoIGEgZmxhZy4gIFJlZ2lzdGVyZWRcbiAgLy8gaW4gbWF6ZS9nb2EuXG4gIExhYnlyaW50aFBhcmFwZXRzLFxuICAvLyBBZGRzIGZsYWdnYWJsZSBkb29ycyB0byB2YXJpb3VzIHNjcmVlbnMuXG4gIFN3YW1wRG9vcnMsIC8vIFRPRE8gKHNlZSBtYXplL3N3YW1wKVxuICAvLyBBZGRzIHNvbWUgZXh0cmEgc3Bpa2Ugc2NyZWVucy5cbiAgRXh0cmFTcGlrZXMsIC8vIFRPRE9cbiAgLy8gTWFrZSBjYXZlcyBjbG9zZWFibGUuXG4gIENsb3NlQ2F2ZXMsXG4gIC8vIE1ha2VzIHRoZSB0b3AgZXhpdHMgb2YgYXJlbmFzIGZ1bGwtc2l6ZSByYXRoZXIgdGhhbiBuYXJyb3csIGdpdmluZ1xuICAvLyBtb3JlIGZsZXhpYmlsaXR5IHdpdGggd2hhdCBjYW4gZ28gdGhlcmUuXG4gIFdpZGVBcmVuYUV4aXRzLFxufVxuXG50eXBlIFJlcXMgPSBSZWNvcmQ8YW55LCB7cmVxdWlyZXM/OiBTY3JlZW5GaXhbXX0+XG5leHBvcnQgZnVuY3Rpb24gd2l0aFJlcXVpcmU8VCBleHRlbmRzIFJlcXM+KHJlcXVpcmVtZW50OiBTY3JlZW5GaXgsIHByb3BzOiBUKSB7XG4gIGZvciAoY29uc3Qga2V5IGluIHByb3BzKSB7XG4gICAgcHJvcHNba2V5XS5yZXF1aXJlcyA9IFtyZXF1aXJlbWVudF07XG4gIH1cbiAgcmV0dXJuIHByb3BzO1xufVxuXG5cbiAgLy8gLy8gQWRkcyBhYmlsaXR5IHRvIGNsb3NlIGNhdmVzLlxuICAvLyBDbG9zZUNhdmVzLFxuXG5cbi8vIC8qKiBBZGRzIGEgJ0Nsb3NlQ2F2ZXMnIHJlcXVpcmVtZW50IG9uIGFsbCB0aGUgcHJvcGVydGllcy4gKi9cbi8vIGZ1bmN0aW9uIGNsb3NlQ2F2ZXM8VCBleHRlbmRzIFJlY29yZDxhbnksIHtyZXF1aXJlczogU2NyZWVuRml4W119Pj4ocHJvcHM6IFQpIHtcbi8vICAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcbi8vICAgICBwcm9wc1trZXldLnJlcXVpcmVzID0gW1NjcmVlbkZpeC5DbG9zZUNhdmVzXTtcbi8vICAgfVxuLy8gICByZXR1cm4gcHJvcHM7XG4vLyB9XG5cblxuLy8gTk9URTogTGlzdGluZyBleHBsaWNpdCBmbGFncyBkb2Vzbid0IHF1aXRlIHdvcmsuXG4vLyBlbnVtIEZsYWcge1xuLy8gICBBbHdheXMgPSAweDJmMCxcbi8vICAgV2luZG1pbGwgPSAweDJlZSxcbi8vICAgUHJpc29uID0gMHgyZDgsXG4vLyAgIENhbG0gPSAweDI4Myxcbi8vICAgU3R5eCA9IDB4MmIwLFxuLy8gICBEcmF5Z29uMSA9IDB4MjhmLFxuLy8gICBEcmF5Z29uMiA9IDB4MjhkLFxuLy8gfVxuXG4vLyBjb25zdCBHUkFTUyA9IDB4ODA7XG4vLyBjb25zdCBUT1dOID0gMHg4NDtcbi8vIGNvbnN0IENBVkUgPSAweDg4O1xuLy8gY29uc3QgUFlSQU1JRCA9IDB4OGM7XG4vLyBjb25zdCBSSVZFUiA9IDB4OTA7XG4vLyBjb25zdCBNT1VOVEFJTiA9IDB4OTQ7XG4vLyBjb25zdCBTRUEgPSAweDk0O1xuLy8gY29uc3QgU0hSSU5FID0gMHg5ODtcbi8vIGNvbnN0IERFU0VSVCA9IDB4OWM7XG4vLyBjb25zdCBNT1VOVEFJTl9SSVZFUiA9IDB4OWM7XG4vLyBjb25zdCBTV0FNUCA9IDB4YTA7XG4vLyBjb25zdCBIT1VTRSA9IDB4YTA7XG4vLyBjb25zdCBGT1JUUkVTUyA9IDB4YTQ7XG4vLyBjb25zdCBJQ0VfQ0FWRSA9IDB4YTg7XG4vLyBjb25zdCBUT1dFUiA9IDB4YWM7XG5cbi8qKiBBcHBseSBzdGFuZGFyZCB0aWxlc2V0IGZpeGVzLiAgT3RoZXJzIG1heSBiZSBhcHBsaWVkIGxhdGVyLiAqL1xuZXhwb3J0IGZ1bmN0aW9uIGZpeFRpbGVzZXRzKHJvbTogUm9tKSB7XG4gIGNvbnN0IHtkZXNlcnQsIGdyYXNzLCBsaW1lLCBtb3VudGFpbiwgbW91bnRhaW5SaXZlcixcbiAgICAgICAgIHJpdmVyLCBzZWEsIHRvd259ID0gcm9tLm1ldGF0aWxlc2V0cztcbiAgY29uc3QgJCA9IHJvbS5tZXRhc2NyZWVucztcblxuICAvLyBTZXZlcmFsIG9mIHRoZSBncmFzcy9yaXZlciBzY3JlZW5zIHdpdGggZm9yZXN0IHRpbGVzIGRvbid0IHdvcmsgb25cbiAgLy8gZGVzZXJ0LiAgRml4IHRoZW0gYnkgbWFraW5nIDVhLi42ZiB3b3JrIGNvcnJlY3RseS5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguRGVzZXJ0Um9ja3MpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVmKS5jb3B5RnJvbSgweDViKS5yZXBsYWNlSW4oJC5vYXNpc0NhdmUsICQub2FzaXNMYWtlKTtcblxuICBkZXNlcnQuZ2V0VGlsZSgweDVhKS5jb3B5RnJvbSgweDk4KS5zZXRUaWxlcyhbLCAsIDB4MWEsIDB4MThdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1YikuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWzB4MzQsIDB4MzIsICwgXSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWMpLmNvcHlGcm9tKDB4ODApLnNldFRpbGVzKFssICwgMHgzNywgMHgzNV0pO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVkKS5jb3B5RnJvbSgweDgwKS5zZXRUaWxlcyhbLCAweDM3LCAsIDB4MzRdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1ZSkuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWzB4MzUsICwgMHgzMiwgXSk7XG5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguRGVzZXJ0VHJlZXMpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDYzKS5jb3B5RnJvbSgweDcxKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2OCkuY29weUZyb20oMHg3MCk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NjkpLmNvcHlGcm9tKDB4NjApO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZhKS5jb3B5RnJvbSgweDY1KTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2YykuY29weUZyb20oMHg3MCk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NmUpLmNvcHlGcm9tKDB4NzYpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZmKS5jb3B5RnJvbSgweDc4KTtcblxuICAvLyBMb25nIGdyYXNzIHNjcmVlbnMgZG9uJ3Qgd29yayBvbiBncmFzcyB0aWxlc2V0cyBiZWNhdXNlIG9mIGEgZmV3XG4gIC8vIGRpZmZlcmVudCB0aWxlcyAtIGNvcHkgdGhlbSB3aGVyZSB0aGV5IG5lZWQgdG8gZ28uXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkdyYXNzTG9uZ0dyYXNzKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQwKS5jb3B5RnJvbSgweDUxKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQxKS5jb3B5RnJvbSgweDUyKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQyKS5jb3B5RnJvbSgweDUzKTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQzKS5jb3B5RnJvbSgweDU0KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ0KS5jb3B5RnJvbSgweDU1KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ1KS5jb3B5RnJvbSgweDU2KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ2KS5jb3B5RnJvbSgweDU4KTtcbiAgZ3Jhc3MuZ2V0VGlsZSgweDQ3KS5jb3B5RnJvbSgweDU5KTtcblxuICAvLyBBbmdyeSBzZWEgdGlsZXNldCBkb2Vzbid0IHN1cHBvcnQgdGlsZSAwYSAodXNlZCBlbHNld2hlcmUgZm9yIHRoZVxuICAvLyBib3R0b20gdGlsZSBpbiBjYXZlIGVudHJhbmNlcykgYmVjYXVzZSBpdCdzIGFscmVhZHkgaW4gdXNlIChidXRcbiAgLy8gbm90IGFzIGFuIGFsdGVybmF0aXZlKS4gIE1vdmUgaXQgdG8gYWQgYW5kIGdldCAwYSBiYWNrLiAgQWxzbyBhZGp1c3RcbiAgLy8gdGhlIHRpbGVzIGFyb3VuZCB0aGUgY2F2ZSBlbnRyYW5jZXMgdG8gbm90IGhhdmUgZGFtYWdlIHRpbGVzIGluIHRoZVxuICAvLyBkZXNlcnQgdGlsZXNldC4gIFRoaXMgY2hhbmdlcyB0aGUgZ3JhcGhpY3MgYSBiaXQgKGZyb20gZGFyayBibHVlXG4gIC8vIHdhdGVyIHRvIGxpZ2h0IGJsdWUpLCB3aGljaCBkb2Vzbid0IGxvb2sgcXVpdGUgYXMgbmljZS4gIFRoZSBvdGhlclxuICAvLyBhbHRlcm5hdGl2ZSBpcyB0byBhbGxvY2F0ZSAzIG5ldyB0aWxlcywgY29waWVkIGZyb20gMHg4MCBpbiBzZWEgYnV0XG4gIC8vIGZyb20gMHhmNywgMHhmOCwgYW5kIDB4ZmQgaW4gZGVzZXJ0L3JpdmVyL2dyYXNzLiAgVGhlbiBzZWEgY2FuIGtlZXBcbiAgLy8gaXRzIGRlZXAgd2F0ZXIgYnV0IGRlc2VydCBhdm9pZHMgdGhlIGRhbWFnZS5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguU2VhQ2F2ZUVudHJhbmNlKTtcbiAgc2VhLmdldFRpbGUoMHhhZCkuY29weUZyb20oMHgwYSlcbiAgICAgIC5yZXBsYWNlSW4oJC5iZWFjaEV4aXROLCAkLmxpZ2h0aG91c2VFbnRyYW5jZSwgJC5vY2VhblNocmluZSk7XG4gIHNlYS5nZXRUaWxlKDB4MGEpLmNvcHlGcm9tKDB4YTIpOyAvLyBkb24ndCBib3RoZXIgc2V0dGluZyBhbiBhbHRlcm5hdGl2ZS5cbiAgLy9zZWEuZ2V0VGlsZSgweDBhKS5zZXRUaWxlcyhbMHg5MSwgMHg5MSwgMHg3ZCwgMHg3ZF0pLnNldEF0dHJzKDIpO1xuICAkLmJvdW5kYXJ5Tl9jYXZlLnNjcmVlbi5zZXQyZCgweDM4LCBbWyAgICAsIDB4MDAsIDB4MDAgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4MGEsIDB4MGEgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4ZjcsIDB4ZjcgICAgICBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ZjgsIDB4ZjgsIDB4ZjgsIDB4ZjhdXSk7XG4gICQuY29ybmVyU0VfY2F2ZS5zY3JlZW4uc2V0MmQoMHg0OSwgW1sgICAgLCAweDAwLCAweDAwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4MGEsIDB4MGFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbICAgICwgMHhmNywgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY4LCAweGY3LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWyAgICAsIDB4ZmQsIDB4ZjddXSk7XG4gICQuY29ybmVyU0VfY2F2ZS5zY3JlZW4uc2V0MmQoMHg0YSwgW1sweDAwLCAweDAwXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4MGEsIDB4MGFdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmNywgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY4LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ODAsIDB4ZmRdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHg4MCwgMHhmZl0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGZhICAgICAgXV0pO1xuXG4gICAgIC8vICwgWzB4ZjgsIDB4ZjhdLCBbbnVsbCwgMHhmZF1dKTtcbiAgLy8gc2VhLnNjcmVlbnMuYWRkKCQuYm91bmRhcnlXX2NhdmUpO1xuICAvLyBzZWEuc2NyZWVucy5hZGQoJC5kZXNlcnRDYXZlRW50cmFuY2UpO1xuXG4gIC8vIFRvIGFsbG93IGNhdmVzIHRvIGJlIGNsb3NlZCwgd2UgY2xlYXIgb3V0IG1ldGF0aWxlcyAwMS4uMDQsIHRvIGJlIHVzZWQgYXNcbiAgLy8gdGhlIGZvdXIgY29ybmVycyBvZiB0aGUgY2F2ZTogW1swMSwgMDFdLCBbMDIsIDAyXV0uICAwMyBhbmQgMDQgYXJlIHVzZWQgZm9yXG4gIC8vIHdhdGVyIGVudHJhbmNlcyB0byBlbnN1cmUgdGhlIHBsYXllciBpc24ndCBraWNrZWQgb2ZmIHRoZSBkb2xwaGluLlxuICAvLyBUaGVzZSBhcmUgY29waWVkIGZyb20gYzEsZDcgZm9yIG1vc3QgdGlsZXNldHMgKHRob3VnaCBvY2VhbiBpcyBzcGVjaWFsKS5cbiAgLy8gU29tZSB0aWxlc2V0cyBhbHJlYWR5IGhhdmUgbWV0YXRpbGVzIGluIDAxLi4wNCBzbyB3ZSBuZWVkIHRvIG1vdmUgdGhlbSB0b1xuICAvLyB1bm9jY3VwaWVkIHNwb3RzIG9uIGEgcGVyLXRpbGVzZXQgYmFzaXMgKG5vdGUgdGhhdCBzZWEgKDk0KSBhbmQgZGVzZXJ0ICg5YylcbiAgLy8gYXJlIGVudGFuZ2xlZCBoZXJlKS4gIFtUT0RPIC0gY2xlYW4gdXAgMmMgYW5kIDJkIGFzIHdlbGxdXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkNsb3NlQ2F2ZXMpO1xuICAvLyBNb3ZlIHRoZSBleGlzdGluZyB0aWxlcyBpbiAwMS4uMDQgdG8gdmFyaW91cyBmcmVlIHNwb3RzXG4gIHJpdmVyLmdldFRpbGUoMHgwNykuY29weUZyb20oMHgwMSkucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgcml2ZXIuZ2V0VGlsZSgweDBlKS5jb3B5RnJvbSgweDAyKS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICByaXZlci5nZXRUaWxlKDB4MjApLmNvcHlGcm9tKDB4MDMpLnJlcGxhY2VJbiguLi5yaXZlcik7XG4gIHJpdmVyLmdldFRpbGUoMHgyMSkuY29weUZyb20oMHgwNCkucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgZm9yIChjb25zdCB0cyBvZiBbZGVzZXJ0LCBzZWEsIG1vdW50YWluLCBtb3VudGFpblJpdmVyLCBsaW1lXSkge1xuICAgIHRzLmdldFRpbGUoMHg2OCkuY29weUZyb20oMHgwMSkucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4ODMpLmNvcHlGcm9tKDB4MDIpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDg4KS5jb3B5RnJvbSgweDAzKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg4OSkuY29weUZyb20oMHgwNCkucmVwbGFjZUluKC4uLnRzKTtcbiAgfVxuICBmb3IgKGNvbnN0IHRzIG9mIFt0b3duXSkge1xuICAgIHRzLmdldFRpbGUoMHg1MCkuY29weUZyb20oMHgwMSkucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4NTEpLmNvcHlGcm9tKDB4MDIpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDUyKS5jb3B5RnJvbSgweDAzKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg1NykuY29weUZyb20oMHgwNCkucmVwbGFjZUluKC4uLnRzKTtcbiAgfVxuICAvLyBNYWtlIDAxLi4wNCBiZSBmbGFnZ2FibGUgd2FsbC9vcGVuaW5nXG4gIGZvciAoY29uc3QgdHMgb2YgW2dyYXNzLCByaXZlciwgZGVzZXJ0XSkge1xuICAgIHRzLmdldFRpbGUoMHgwMSkuY29weUZyb20oMHhjMSkuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDAyKS5jb3B5RnJvbSgweGQ3KS5zZXRBbHRlcm5hdGl2ZSgweDBhKTtcbiAgICB0cy5nZXRUaWxlKDB4MDMpLmNvcHlGcm9tKDB4YzEpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwNCkuY29weUZyb20oMHhkNykuc2V0QWx0ZXJuYXRpdmUoMHgwYSk7XG4gIH1cbiAgZm9yIChjb25zdCB0cyBvZiBbc2VhXSkge1xuICAgIHRzLmdldFRpbGUoMHgwMSkuY29weUZyb20oMHhjMSkuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDAyKS5jb3B5RnJvbSgweGNiKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDMpLmNvcHlGcm9tKDB4YzEpLnNldEFsdGVybmF0aXZlKDB4YzApO1xuICAgIHRzLmdldFRpbGUoMHgwNCkuY29weUZyb20oMHhjYikuc2V0QWx0ZXJuYXRpdmUoMHhjMCk7XG4gICAgLy8gY29weSByb2NrIGdyYXBoaWNzIGZyb20gb3RoZXIgdGlsZXNldCAoc2FtZSBwYWdlIGlzIGxvYWRlZClcbiAgICBmb3IgKGxldCBpID0gMTsgaSA8IDU7IGkrKykge1xuICAgICAgdHMuZ2V0VGlsZShpKS5zZXRUaWxlcyhncmFzcy5nZXRUaWxlKGkpLnRpbGVzKTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCB0cyBvZiBbdG93bl0pIHtcbiAgICB0cy5nZXRUaWxlKDB4MDEpLmNvcHlGcm9tKDB4NjMpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwMikuY29weUZyb20oMHg2NCkuc2V0QWx0ZXJuYXRpdmUoMHhkMik7XG4gICAgdHMuZ2V0VGlsZSgweDAzKS5jb3B5RnJvbSgweDYzKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDQpLmNvcHlGcm9tKDB4NjQpLnNldEFsdGVybmF0aXZlKDB4ZDIpO1xuICB9XG4gIC8vIFNldCB0aGUgY2F2ZSBlbnRyYW5jZXMgdG8gdXNlIDAxLi4wNCBhcyBhcHByb3ByaWF0ZVxuICBjb25zdCBjbG9zZWRDYXZlcyA9IG5ldyBTZXQoW1xuICAgICQuYm91bmRhcnlFX2NhdmUsICQuYm91bmRhcnlXX2NhdmUsICQuZXhpdFdfY2F2ZSwgJC5jYXZlQWJvdmVQb3J0b2EsXG4gICAgJC5iZWFjaENhdmUsICQub3V0c2lkZVdpbmRtaWxsLFxuICAgICQuZXhpdFNfY2F2ZSwgJC50b3duRXhpdFdfY2F2ZSxcbiAgICAkLnpvbWJpZVRvd25Cb3R0b21fY2F2ZUV4aXQsIC8vICh0b3duKVxuICAgIC8vIFRPRE8gLSBhbnkgd2F5IHRvIGRvICQuY2hhbm5lbEVuZFdfY2F2ZT8gKHN0YWlyIGluIGRvbHBoaW5DYXZlKVxuICAgIC8vIFRPRE8gLSBtb3VudGFpbiBjYXZlIGVudHJhbmNlcz8gKGJvdGggOTQgYW5kIFxuICAgIC8vICAgLSAwIG9uIHRvcCwgMTYgb24gYm90dG9tIGZvciAwNSAoZnJlZSBpbiA5NCkgYW5kIDA2IChmcm9tIDI3IG9yIDNjPylcbiAgICAvLyAgIC0gb3IganVzdCB1c2UgMWEvMWEvMDgvMDkgLSBvbmx5IDA4IGlmIGEga2V5IGlzIG5lZWRlZD9cbiAgXSk7XG4gIGNvbnN0IHdhdGVyQ2F2ZXMgPSBuZXcgU2V0PE1ldGFzY3JlZW4+KFtdKTtcbiAgaWYgKCQuaXNGaXhlZChTY3JlZW5GaXguU2VhQ2F2ZUVudHJhbmNlKSkge1xuICAgIHdhdGVyQ2F2ZXMuYWRkKCQuYm91bmRhcnlOX2NhdmUpO1xuICAgIHdhdGVyQ2F2ZXMuYWRkKCQuY29ybmVyU0VfY2F2ZSk7XG4gIH1cbiAgY29uc3QgbW91bnRhaW5DYXZlcyA9IG5ldyBTZXQoW1xuICAgICQubW91bnRhaW5EZWFkRW5kV19jYXZlRW1wdHksXG4gICAgJC5tb3VudGFpblBhdGhXX2NhdmUsXG4gICAgJC5tb3VudGFpbkNhdmVfZW1wdHksXG4gICAgJC5tb3VudGFpblBhdGhFX2NhdmUsXG4gICAgJC5tb3VudGFpblBhdGhOX3Nsb3BlU19jYXZlLFxuICAgICQubW91bnRhaW5QYXRoV0Vfc2xvcGVOX2NhdmUsXG4gICAgJC5tb3VudGFpblBhdGhFX2dhdGUsXG4gIF0pO1xuICBmb3IgKGNvbnN0IHNjciBvZiBbLi4uY2xvc2VkQ2F2ZXMsIC4uLndhdGVyQ2F2ZXNdKSB7XG4gICAgY29uc3QgZXhpdCA9IHNjci5kYXRhLmV4aXRzIS5maW5kKGUgPT4gZS50eXBlID09PSAnY2F2ZScpO1xuICAgIGNvbnN0IHBvcyA9IE1hdGgubWluKC4uLmV4aXQhLmV4aXRzKSAtIDB4MTA7XG4gICAgY29uc3QgdGlsZXMgPSB3YXRlckNhdmVzLmhhcyhzY3IpID8gW1szLCAzXSwgWzQsIDRdXSA6IFtbMSwgMV0sIFsyLCAyXV07XG4gICAgc2NyLnNjcmVlbi5zZXQyZChwb3MsIHRpbGVzKTtcbiAgICBzY3IuYWRkQ3VzdG9tRmxhZyh0cnVlKTtcbiAgfVxuICBmb3IgKGNvbnN0IHNjciBvZiBbLi4ubW91bnRhaW5DYXZlc10pIHtcbiAgICBjb25zdCBleGl0ID0gc2NyLmRhdGEuZXhpdHMhLmZpbmQoZSA9PiBlLnR5cGUgPT09ICdjYXZlJyB8fCBlLnR5cGUgPT09ICdnYXRlJyk7XG4gICAgY29uc3QgcG9zID0gTWF0aC5taW4oLi4uZXhpdCEuZXhpdHMpIC0gMHgxMDtcbiAgICBjb25zdCB0aWxlcyA9IFtbMHgxYSwgMHgxYV0sIFsweDA4LCAweDA5XV07XG4gICAgc2NyLnNjcmVlbi5zZXQyZChwb3MsIHRpbGVzKTtcbiAgICBzY3IuYWRkQ3VzdG9tRmxhZyh0cnVlKTtcbiAgfVxuICAvLyBGaXggdGhlIHR3byB2YW5pbGxhIHNlYWxlZC1jYXZlIGdyYXBoaWNzIHRvIGJlIGNvbnNpc3RlbnQgd2l0aFxuICAvLyBvdXIgbmljZXIgXCJyb2NrZmFsbFwiIGdyYXBoaWNzIChzcGVjaWZpY2FsbHksIGFkZCB0aGUgYXJjaGVkIHRvcCkuXG4gICQub3V0c2lkZVdpbmRtaWxsLnNjcmVlbi5zZXQyZCgweDQzLCBbWzB4Y2EsIDB4ODJdXSk7XG4gICQudG93bkV4aXRXX2NhdmUuc2NyZWVuLnNldDJkKDB4MmEsIFtbMHhjYSwgMHg4Ml1dKTtcblxuICAvLyBOT1RFOiB0aGUgY29ycmVjdCBjYXZlcyBhcmUgY2xvc2VkIGJ5IHBhc3MvZml4ZW50cmFuY2V0cmlnZ2Vycy5cblxuICAvLyBzZWEuZ2V0VGlsZSgweDBhKS5jb3B5RnJvbSgweGEyKS5zZXRUaWxlcyhbLCwweDkxLDB4OTFdKS5zZXRBdHRycygwKTtcbiAgLy8gVGhpcyBkb2VzIG9wZW4gdXAgc2NyZWVuICRjZSAoZGVzZXJ0IGNhdmUgZW50cmFuY2UpIGZvciB1c2UgaW4gdGhlIHNlYSxcbiAgLy8gd2hpY2ggaXMgaW50ZXJlc3RpbmcgYmVjYXVzZSB3aGlybHBvb2xzIGNhbid0IGJlIGZsb3duIHBhc3QgLSB3ZSdkIG5lZWRcbiAgLy8gdG8gYWRkIGZsYWdzIHRvIGNsZWFyIHRoZSB3aGlybHBvb2xzLCBidXQgaXQgd291bGQgYmUgYSBjYXZlIHRoYXQnc1xuICAvLyBibG9ja2VkIG9uIGNhbG1pbmcgdGhlIHNlYS4uLlxuXG4gIC8vIFdlIGNvdWxkIGFkZCBhIG51bWJlciBvZiBzY3JlZW5zIHRvIHRoZSBzZWEgaWYgd2UgY291bGQgbW92ZSA1YS4uNWVcbiAgLy8gKHdoaWNoIGNvbGxpZGVzIHdpdGggbW91bnRhaW4gZ2F0ZXMpLiAgODksOGEsOTAsOTksOWQsZDEsZDIgYXJlIGZyZWVcbiAgLy8gaW4gODAgKGdyYXNzKSwgOTAgKHJpdmVyKSwgYW5kIDljIChkZXNlcnQpLiAgVGhlIG1haW4gcHJvYmxlbSBpcyB0aGF0XG4gIC8vIGF0IGxlYXN0IHRoZSBjYXZlIGVudHJhbmNlcyBkb24ndCBxdWl0ZSB3b3JrIGZvciB0aGVzZSAtIHRoZXkgZW5kIHVwXG4gIC8vIGluIHNoYWxsb3cgd2F0ZXIsIGFyZSBhIGxpdHRsZSB0b28gc2hvcnQsIGFuZCBpdCBzZWVtcyB0byBiZSBpbXBvc3NpYmxlXG4gIC8vIHRvIHBpY2sgYSBwYWxldHRlIHRoYXQgaXMgbGlnaHQgYmx1ZSBvbiBib3R0b20gYW5kIGJsYWNrIG9uIHRvcC5cbiAgLy9cbiAgLy8gT3RoZXIgb3B0aW9ucyBmb3IgdGhlIHNlYSBhcmUgMzQsMzgsM2MuLjNmIHdoaWNoIGFyZSBtYXJzaCB0aWxlcyBpblxuICAvLyByaXZlciAtIHdvdWxkIG9wZW4gdXAgc29tZSBuYXJyb3cgcGFzc2FnZXMgKDMzLCBcblxuXG4gIC8vICByb20ubWV0YXNjcmVlbnM7XG5cbiAgLy8gZm9yIChjb25zdCB4IG9mIE9iamVjdC52YWx1ZXMoVElMRVNFVF9GSVhFUykpIHtcbiAgLy8gICBjb25zdCBpZCA9IHguaWQ7XG4gIC8vICAgY29uc3QgdHMgPSByb20udGlsZXNldHNbaWRdO1xuICAvLyAgIGNvbnN0IHRlID0gdHMuZWZmZWN0cygpO1xuICAvLyAgIGZvciAoY29uc3QgdHN0ciBpbiB4KSB7XG4gIC8vICAgICBjb25zdCB0ID0gTnVtYmVyKHRzdHIpO1xuICAvLyAgICAgaWYgKGlzTmFOKHQpKSBjb250aW51ZTtcbiAgLy8gICAgIGNvbnN0IHk6IG51bWJlcnx7YmFzZTogbnVtYmVyfSA9ICh4IGFzIGFueSlbdF07XG4gIC8vICAgICBjb25zdCBiYXNlID0gdHlwZW9mIHkgPT09ICdudW1iZXInID8geSA6ICh5IGFzIGFueSkuYmFzZTtcbiAgLy8gICAgIGNvbnN0IHJlc3Q6IGFueSA9IHR5cGVvZiB5ID09PSAnbnVtYmVyJyA/IHt9IDogeTtcbiAgLy8gICAgIHRzLmF0dHJzW3RdID0gdHMuYXR0cnNbYmFzZV07XG4gIC8vICAgICB0ZS5lZmZlY3RzW3RdID0gdGUuZWZmZWN0c1tiYXNlXTtcbiAgLy8gICAgIFtyZXN0LnRsLCByZXN0LnRyLCByZXN0LmJsLCByZXN0LmJyXS5mb3JFYWNoKChtLCBpKSA9PiB7XG4gIC8vICAgICAgIHRzLnRpbGVzW2ldW3RdID0gdHMudGlsZXNbaV1bbSAhPSBudWxsID8gbSA6IGJhc2VdO1xuICAvLyAgICAgfSk7XG4gIC8vICAgICBpZiAocmVzdC5tb3ZlKSB7fVxuICAvLyAgICAgLy8gaWYgKHJlc3QudGlsZXMpIHtcbiAgLy8gICAgIC8vICAgcmVzdC50aWxlcy5mb3JFYWNoKChzOiBudW1iZXIsIGk6IG51bWJlcikgPT4gdm9pZCAodHMudGlsZXNbaV1bdF0gPSBzKSk7XG4gIC8vICAgICAvLyB9XG4gIC8vICAgfVxuICAvLyB9XG59XG5cblxuLy8gY29uc3QgVElMRVNFVF9GSVhFUyA9IHtcbi8vICAgZ3Jhc3M6IHtcbi8vICAgICBpZDogMHg4MCxcbi8vICAgICAweDQwOiAweDUxLFxuLy8gICAgIDB4NDE6IDB4NTIsXG4vLyAgICAgMHg0MjogMHg1Myxcbi8vICAgICAweDQzOiAweDU0LFxuLy8gICAgIDB4NDQ6IDB4NTUsXG4vLyAgICAgMHg0NTogMHg1Nixcbi8vICAgICAweDQ2OiAweDU4LFxuLy8gICAgIDB4NDc6IDB4NTksXG4vLyAgIH0sXG4vLyAgIGRlc2VydDoge1xuLy8gICAgIGlkOiAweDljLFxuLy8gICAgIDB4NWE6IHtiYXNlOiAweDk4LCBibDogMHg5NCwgYnI6IDB4OTR9LFxuLy8gICAgIDB4NWI6IHtiYXNlOiAweDgwLCB0bDogMHhmZCwgdHI6IDB4ZmN9LFxuLy8gICAgIDB4NWM6IHtiYXNlOiAweDgwLCBibDogMHhmZiwgYnI6IDB4ZmV9LFxuLy8gICAgIDB4NWQ6IHtiYXNlOiAweDgwLCB0cjogMHhmZiwgYnI6IDB4ZmR9LFxuLy8gICAgIDB4NWU6IHtiYXNlOiAweDgwLCB0bDogMHhmZSwgYmw6IDB4ZmN9LFxuLy8gICAgIDB4NjM6IDB4NzEsXG4vLyAgICAgMHg2ODogMHg3MCxcbi8vICAgICAweDY5OiAweDYwLFxuLy8gICAgIDB4NmE6IDB4NjUsXG4vLyAgICAgMHg2YzogMHg3MCxcbi8vICAgICAweDZlOiAweDc2LFxuLy8gICAgIDB4NmY6IDB4NzgsXG4vLyAgIH0sXG4vLyB9IGFzIGNvbnN0O1xuXG4vLyBjb25zdCBTQ1JFRU5fUkVNQVBTID0gW1xuLy8gICB7dGlsZXNldHM6IFsweDljXSwgc3JjOiAweDViLCBkZXN0OiAweDVmLCBzY3JlZW5zOiBbMHhjZl19LFxuLy8gXTtcbi8vIGNvbnN0IFtdID0gU0NSRUVOX1JFTUFQUztcblxuLy8gVE9ETyAtIGNvcHkgNWYgPC0gNWIgaW4gOWMsIHRoZW4gcmVtYXAgaW4gc2NyZWVuIGNmXG4vLyAgICAgIC0gYmV0dGVyIG5vdGF0aW9uP1xuLy8gQ29uc2lkZXIgZG9pbmcgdGhpcyBwcm9ncmFtbWF0aWNhbGx5LCB0aG91Z2ggd2UnZCB3YW50IHRvIHVzZVxuLy8gdGhlIF9hY3R1YWxfIHNjcmVlbi10aWxlc2V0IHVzYWdlcyByYXRoZXIgdGhhbiBkZWNsYXJlZCBvcHRpb25zXG5cbi8vIGNsYXNzIFgge1xuLy8gICByZWFkb25seSBtOiBNZXRhc2NyZWVucztcbi8vICAgY29uc3RydWN0b3IocjogUm9tKSB7XG4vLyAgICAgdGhpcy5tID0gbmV3IE1ldGFzY3JlZW5zKHIpO1xuLy8gICB9XG4vLyB9XG5cbi8vIEFwcGxpZXMgdGhlIFdpZGVBcmVuYUV4aXRzIHNjcmVlbiBmaXguXG5leHBvcnQgZnVuY3Rpb24gd2lkZUFyZW5hRXhpdHMocm9tOiBSb20pIHtcbiAgZnVuY3Rpb24gd2lkZW4oZXhpdHM6IG51bWJlcltdKSB7XG4gICAgZXhpdHMuc3BsaWNlKDAsIGV4aXRzLmxlbmd0aCxcbiAgICAgICAgICAgICAgICAgLi4ubmV3IFNldChpdGVycy5jb25jYXQoXG4gICAgICAgICAgICAgICAgICAgICAuLi5leGl0cy5tYXAoZSA9PiBbZSwgZSArIDEsIGUgLSAxXSkpKSk7XG4gIH1cblxuICAvLyBXaWRlbiB0aGUgdG9wIGV4aXRzIG9mIHRoZSBzaW1wbGUgYXJlbmFzXG4gIGNvbnN0IHtcbiAgICBmb3J0cmVzc0FyZW5hX3Rocm91Z2gsIGZvcnRyZXNzVHJhcCxcbiAgICBoYWxsTlMsIGhhbGxOU19hcmVuYSwgaGFsbE5TX2FyZW5hV2FsbCwgaGFsbE5TX2VudHJhbmNlLFxuICB9ID0gcm9tLm1ldGFzY3JlZW5zO1xuICBoYWxsTlNfYXJlbmEuc2NyZWVuLnNldDJkKDB4MDQsIFtcbiAgICBbMHg5NywgMHg3NiwgMHgyMiwgMHgyMywgMHgyMywgMHgyMywgMHg0YiwgMHg5NV0sXG4gICAgWzB4NDIsIDB4NDgsIDB4MjIsIDB4MjEsIDB4MjMsIDB4MjMsIDB4NDUsIDB4NDJdLFxuICAgIFsweDQzLCAweDQ5LCAweDJlLCAweDIzLCAweDIzLCAweDIxLCAweDQ2LCAweDQzXSxcbiAgICBbMHg0NCwgMHg0YSwgMHgyZSwgMHgyMywgMHgyMSwgMHgyMSwgMHg0NywgMHg0NF0sXG4gIF0pO1xuICBoYWxsTlNfYXJlbmEuc2V0R3JpZFRpbGUoJyBjIHwgYSB8IGMgJyk7IC8vLCAnIGMgfCBhIHwgdyAnKTtcbiAgd2lkZW4oaGFsbE5TX2FyZW5hLmZpbmRFeGl0QnlUeXBlKCdlZGdlOnRvcCcpLmV4aXRzIGFzIG51bWJlcltdKTtcblxuICBoYWxsTlNfYXJlbmFXYWxsLnNjcmVlbi5zZXQyZCgweDA0LCBbXG4gICAgWzB4OTQsIDB4NGMsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4NGIsIDB4OTNdLFxuICAgIFsweDk3LCAweDRmLCAweDAwLCAweDAxLCAweDAxLCAweDAyLCAweDUwLCAweDk1XSxcbiAgXSk7XG4gIGhhbGxOU19hcmVuYVdhbGwuc2V0R3JpZFRpbGUoJyBjIHwgYSB8IGMgJyk7XG4gIHdpZGVuKGhhbGxOU19hcmVuYVdhbGwuZmluZEV4aXRCeVR5cGUoJ2VkZ2U6dG9wJykuZXhpdHMgYXMgbnVtYmVyW10pO1xuXG4gIC8vIE1vdmUgdGhlIGFiZHVjdGlvbiB0cmlnZ2VyIGRvd24gMyB0aWxlcyBzbyB5b3UgY2FuJ3Qgd2FsayBhcm91bmQgaXRcbiAgY29uc3QgYWJkdWN0aW9uVHJpZ2dlciA9XG4gICAgICByb20ubG9jYXRpb25zLlplYnVDYXZlLnNwYXducy5maW5kKHMgPT4gcy5pc1RyaWdnZXIoKSAmJiBzLmlkID09PSAweDhjKTtcbiAgaWYgKGFiZHVjdGlvblRyaWdnZXIpIGFiZHVjdGlvblRyaWdnZXIueXQgKz0gNDtcblxuICAvLyBXaWRlbiB0aGUgdG9wIGV4aXRzIG9mIHRoZSBmb3J0cmVzcy9weXJhbWlkIGFyZW5hc1xuICBmb3J0cmVzc0FyZW5hX3Rocm91Z2guc2NyZWVuLnNldDJkKDB4MDUsIFtcbiAgICBbMHg1ZiwgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHg1Zl0sXG4gICAgWzB4YjcsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4YjVdLFxuICAgIFsweGJmLCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweGE4XSxcbiAgXSk7XG4gIGZvcnRyZXNzQXJlbmFfdGhyb3VnaC5zZXRHcmlkVGlsZSgnIGMgfCBhIHwgdyAnKTtcbiAgd2lkZW4oZm9ydHJlc3NBcmVuYV90aHJvdWdoLmZpbmRFeGl0QnlUeXBlKCdlZGdlOnRvcCcpLmV4aXRzIGFzIG51bWJlcltdKTtcblxuICAvLyBXaWRlbiB0aGUgYm90dG9tIGVudHJhbmNlIG9mIHNhYmVyYSdzIHRyYXBcbiAgZm9ydHJlc3NUcmFwLnNjcmVlbi5zZXQyZCgweGM0LCBbXG4gICAgWzB4M2MsIDB4M2QsIDB4MjEsIDB4MjEsIDB4MjEsIDB4MjEsIDB4M2IsIDB4M2NdLFxuICAgIFsweDkyLCAweDRjLCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweDRiLCAweDkwXSxcbiAgICBbMHg5NCwgMHg0YywgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHg0YiwgMHg5M10sXG4gIF0pO1xuICBmb3J0cmVzc1RyYXAuc2V0R3JpZFRpbGUoJyAgIHwgeCB8IGMgJyk7XG4gIHdpZGVuKGZvcnRyZXNzVHJhcC5maW5kRXhpdEJ5VHlwZSgnZWRnZTpib3R0b20nKS5leGl0cyBhcyBudW1iZXJbXSk7XG5cbiAgLy8gRmluZCBjYXNlcyB3aGVyZSBhIG5hcnJvdyBoYWxsd2F5IHdhcyB1c2VkIG9uIHRvcFxuICAvLyBvZiBhbiBhcmVuYSBhbmQgcmVwbGFjZSB3aXRoIGEgbm9ybWFsIGhhbGx3YXlcbiAgZm9yIChjb25zdCBsb2NhdGlvbiBvZiByb20ubG9jYXRpb25zKSB7XG4gICAgY29uc3QgbWV0YSA9IGxvY2F0aW9uLm1ldGE7XG4gICAgZm9yIChjb25zdCBwb3Mgb2YgbWV0YS5hbGxQb3MoKSkge1xuICAgICAgY29uc3Qgc2NyID0gbWV0YS5nZXQocG9zKTtcbiAgICAgIGlmIChzY3IgPT09IGhhbGxOU19lbnRyYW5jZSAmJiBtZXRhLmdldChwb3MgKyAxNik/Lmhhc0ZlYXR1cmUoJ2FyZW5hJykpIHtcbiAgICAgICAgbWV0YS5zZXQocG9zLCBoYWxsTlMpO1xuICAgICAgICAvLyBhbHNvIHNldCB0aGUgbm9uLW1ldGEgdmVyc2lvbiwgbWFpbmx5IGZvciBtYXAgdmlld2VyXG4gICAgICAgIGNvbnN0IHJvdyA9IGxvY2F0aW9uLnNjcmVlbnNbcG9zID4+PiA0XTtcbiAgICAgICAgaWYgKHJvdykgcm93W3BvcyAmIDB4Zl0gPSBoYWxsTlMuc2lkO1xuICAgICAgfVxuICAgIH1cbiAgfVxufVxuIl19