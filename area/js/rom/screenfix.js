import { iters } from '../util.js';
export var ScreenFix;
(function (ScreenFix) {
    ScreenFix[ScreenFix["Unknown"] = 0] = "Unknown";
    ScreenFix[ScreenFix["GrassLongGrass"] = 1] = "GrassLongGrass";
    ScreenFix[ScreenFix["GrassLongGrassRemapping"] = 2] = "GrassLongGrassRemapping";
    ScreenFix[ScreenFix["RiverShortGrass"] = 3] = "RiverShortGrass";
    ScreenFix[ScreenFix["SeaCaveEntrance"] = 4] = "SeaCaveEntrance";
    ScreenFix[ScreenFix["SeaRocks"] = 5] = "SeaRocks";
    ScreenFix[ScreenFix["SeaMarsh"] = 6] = "SeaMarsh";
    ScreenFix[ScreenFix["SeaTrees"] = 7] = "SeaTrees";
    ScreenFix[ScreenFix["DesertShortGrass"] = 8] = "DesertShortGrass";
    ScreenFix[ScreenFix["DesertLongGrass"] = 9] = "DesertLongGrass";
    ScreenFix[ScreenFix["DesertMarsh"] = 10] = "DesertMarsh";
    ScreenFix[ScreenFix["DesertRocks"] = 11] = "DesertRocks";
    ScreenFix[ScreenFix["DesertTrees"] = 12] = "DesertTrees";
    ScreenFix[ScreenFix["DesertTownEntrance"] = 13] = "DesertTownEntrance";
    ScreenFix[ScreenFix["LabyrinthParapets"] = 14] = "LabyrinthParapets";
    ScreenFix[ScreenFix["SwampDoors"] = 15] = "SwampDoors";
    ScreenFix[ScreenFix["ExtraSpikes"] = 16] = "ExtraSpikes";
    ScreenFix[ScreenFix["CloseCaves"] = 17] = "CloseCaves";
    ScreenFix[ScreenFix["WideArenaExits"] = 18] = "WideArenaExits";
})(ScreenFix || (ScreenFix = {}));
export function withRequire(requirement, props) {
    for (const key in props) {
        props[key].requires = [requirement];
    }
    return props;
}
export function fixTilesets(rom) {
    const { desert, grass, lime, mountain, mountainRiver, river, sea } = rom.metatilesets;
    const $ = rom.metascreens;
    $.registerFix(ScreenFix.DesertRocks);
    desert.getTile(0x5f).copyFrom(0x5b).replaceIn($.oasisCave, $.oasisLake);
    desert.getTile(0x5a).copyFrom(0x98).setTiles([, , 0x1a, 0x18]);
    desert.getTile(0x5b).copyFrom(0x80).setTiles([0x34, 0x32, ,]);
    desert.getTile(0x5c).copyFrom(0x80).setTiles([, , 0x37, 0x35]);
    desert.getTile(0x5d).copyFrom(0x80).setTiles([, 0x37, , 0x34]);
    desert.getTile(0x5e).copyFrom(0x80).setTiles([0x35, , 0x32,]);
    $.registerFix(ScreenFix.DesertTrees);
    desert.getTile(0x63).copyFrom(0x71);
    desert.getTile(0x68).copyFrom(0x70);
    desert.getTile(0x69).copyFrom(0x60);
    desert.getTile(0x6a).copyFrom(0x65);
    desert.getTile(0x6c).copyFrom(0x70);
    desert.getTile(0x6e).copyFrom(0x76);
    desert.getTile(0x6f).copyFrom(0x78);
    $.registerFix(ScreenFix.GrassLongGrass);
    grass.getTile(0x40).copyFrom(0x51);
    grass.getTile(0x41).copyFrom(0x52);
    grass.getTile(0x42).copyFrom(0x53);
    grass.getTile(0x43).copyFrom(0x54);
    grass.getTile(0x44).copyFrom(0x55);
    grass.getTile(0x45).copyFrom(0x56);
    grass.getTile(0x46).copyFrom(0x58);
    grass.getTile(0x47).copyFrom(0x59);
    $.registerFix(ScreenFix.SeaCaveEntrance);
    sea.getTile(0xad).copyFrom(0x0a)
        .replaceIn($.beachExitN, $.lighthouseEntrance, $.oceanShrine);
    sea.getTile(0x0a).copyFrom(0xa2);
    $.boundaryN_cave.screen.set2d(0x38, [[null, 0x00, 0x00, null],
        [null, 0x0a, 0x0a, null],
        [null, 0xf7, 0xf7, null],
        [0xf8, 0xf8, 0xf8, 0xf8]]);
    $.cornerSE_cave.screen.set2d(0x49, [[null, 0x00, 0x00],
        [null, 0x0a, 0x0a],
        [null, 0xf7, 0xf7],
        [0xf8, 0xf7, 0xf7],
        [null, 0xfd, 0xf7]]);
    $.cornerSE_cave.screen.set2d(0x4a, [[0x00, 0x00],
        [0x0a, 0x0a],
        [0xf7, 0xf7],
        [0xf8, 0xf7],
        [0x80, 0xfd],
        [0x80, 0xff],
        [0xfa, null]]);
    $.registerFix(ScreenFix.CloseCaves);
    river.getTile(0x07).copyFrom(0x01).replaceIn(...river);
    river.getTile(0x0e).copyFrom(0x02).replaceIn(...river);
    river.getTile(0x20).copyFrom(0x03).replaceIn(...river);
    river.getTile(0x21).copyFrom(0x04).replaceIn(...river);
    for (const ts of [desert, sea, mountain, mountainRiver, lime]) {
        ts.getTile(0x68).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x83).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x88).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x89).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [grass, river, desert]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xd7).setAlternative(0x0a);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x04).copyFrom(0xd7).setAlternative(0x0a);
    }
    for (const ts of [sea]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xcb).setAlternative(0x00);
        ts.getTile(0x03).copyFrom(0xc1).setAlternative(0xc0);
        ts.getTile(0x04).copyFrom(0xcb).setAlternative(0xc0);
        for (let i = 1; i < 5; i++) {
            ts.getTile(i).setTiles(grass.getTile(i).tiles);
        }
    }
    const closedCaves = new Set([
        $.boundaryE_cave, $.boundaryW_cave, $.exitW_cave, $.caveAbovePortoa,
        $.beachCave, $.outsideWindmill,
        $.exitS_cave, $.townExitW_cave,
    ]);
    const waterCaves = new Set([]);
    waterCaves.add($.boundaryN_cave);
    waterCaves.add($.cornerSE_cave);
    for (const scr of [...closedCaves, ...waterCaves]) {
        const exit = scr.data.exits.find(e => e.type === 'cave');
        const pos = Math.min(...exit.exits) - 0x10;
        const tiles = waterCaves.has(scr) ? [[3, 3], [4, 4]] : [[1, 1], [2, 2]];
        scr.screen.set2d(pos, tiles);
        scr.addCustomFlag(true);
    }
    $.outsideWindmill.screen.set2d(0x43, [[0xca, 0x82]]);
    $.townExitW_cave.screen.set2d(0x2a, [[0xca, 0x82]]);
}
export function wideArenaExits(rom) {
    var _a;
    function widen(exits) {
        exits.splice(0, exits.length, ...new Set(iters.concat(...exits.map(e => [e, e + 1, e - 1]))));
    }
    const { fortressArena_through, fortressTrap, hallNS, hallNS_arena, hallNS_arenaWall, hallNS_entrance, } = rom.metascreens;
    hallNS_arena.screen.set2d(0x04, [
        [0x97, 0x76, 0x22, 0x23, 0x23, 0x23, 0x4b, 0x95],
        [0x42, 0x48, 0x22, 0x21, 0x23, 0x23, 0x45, 0x42],
        [0x43, 0x49, 0x2e, 0x23, 0x23, 0x21, 0x46, 0x43],
        [0x44, 0x4a, 0x2e, 0x23, 0x21, 0x21, 0x47, 0x44],
    ]);
    hallNS_arena.setGridTile(' c | a | c ');
    widen(hallNS_arena.findExitByType('edge:top').exits);
    hallNS_arenaWall.screen.set2d(0x04, [
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
        [0x97, 0x4f, 0x00, 0x01, 0x01, 0x02, 0x50, 0x95],
    ]);
    hallNS_arenaWall.setGridTile(' c | a | c ');
    widen(hallNS_arenaWall.findExitByType('edge:top').exits);
    const abductionTrigger = rom.locations.ZebuCave.spawns.find(s => s.isTrigger() && s.id === 0x8c);
    if (abductionTrigger)
        abductionTrigger.yt += 4;
    fortressArena_through.screen.set2d(0x05, [
        [0x5f, 0x22, 0x21, 0x21, 0x21, 0x5f],
        [0xb7, 0x22, 0x21, 0x21, 0x21, 0xb5],
        [0xbf, 0x22, 0x21, 0x21, 0x21, 0xa8],
    ]);
    fortressArena_through.setGridTile(' c | a | w ');
    widen(fortressArena_through.findExitByType('edge:top').exits);
    fortressTrap.screen.set2d(0xc4, [
        [0x3c, 0x3d, 0x21, 0x21, 0x21, 0x21, 0x3b, 0x3c],
        [0x92, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x90],
        [0x94, 0x4c, 0x22, 0x21, 0x21, 0x21, 0x4b, 0x93],
    ]);
    fortressTrap.setGridTile('   | x | c ');
    widen(fortressTrap.findExitByType('edge:bottom').exits);
    for (const location of rom.locations) {
        const meta = location.meta;
        for (const pos of meta.allPos()) {
            const scr = meta.get(pos);
            if (scr === hallNS_entrance && ((_a = meta.get(pos + 16)) === null || _a === void 0 ? void 0 : _a.hasFeature('arena'))) {
                meta.set(pos, hallNS);
                const row = location.screens[pos >>> 4];
                if (row)
                    row[pos & 0xf] = hallNS.sid;
            }
        }
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyZWVuZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL3JvbS9zY3JlZW5maXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBRUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLFlBQVksQ0FBQztBQUduQyxNQUFNLENBQU4sSUFBWSxTQThEWDtBQTlERCxXQUFZLFNBQVM7SUFDbkIsK0NBQU8sQ0FBQTtJQUdQLDZEQUFjLENBQUE7SUFLZCwrRUFBdUIsQ0FBQTtJQUl2QiwrREFBZSxDQUFBO0lBS2YsK0RBQWUsQ0FBQTtJQU1mLGlEQUFRLENBQUE7SUFHUixpREFBUSxDQUFBO0lBSVIsaURBQVEsQ0FBQTtJQUdSLGlFQUFnQixDQUFBO0lBR2hCLCtEQUFlLENBQUE7SUFJZix3REFBVyxDQUFBO0lBR1gsd0RBQVcsQ0FBQTtJQUdYLHdEQUFXLENBQUE7SUFHWCxzRUFBa0IsQ0FBQTtJQUVsQixvRUFBaUIsQ0FBQTtJQUVqQixzREFBVSxDQUFBO0lBRVYsd0RBQVcsQ0FBQTtJQUVYLHNEQUFVLENBQUE7SUFHViw4REFBYyxDQUFBO0FBQ2hCLENBQUMsRUE5RFcsU0FBUyxLQUFULFNBQVMsUUE4RHBCO0FBR0QsTUFBTSxVQUFVLFdBQVcsQ0FBaUIsV0FBc0IsRUFBRSxLQUFRO0lBQzFFLEtBQUssTUFBTSxHQUFHLElBQUksS0FBSyxFQUFFO1FBQ3ZCLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNyQztJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQTRDRCxNQUFNLFVBQVUsV0FBVyxDQUFDLEdBQVE7SUFDbEMsTUFBTSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUNuQixRQUFRLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUMsR0FBRyxHQUFHLENBQUMsWUFBWSxDQUFDO0lBQy9ELE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUM7SUFJMUIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDckMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRXhFLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQUFBRCxFQUFHLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQy9ELE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsQUFBRCxFQUFJLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxBQUFELEVBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsQUFBRCxFQUFHLElBQUksRUFBRyxDQUFDLENBQUM7SUFFL0QsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDckMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFJcEMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDeEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFXbkMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDekMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO1NBQzNCLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDbEUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFakMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLENBQUMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7UUFDbEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQWFuRCxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUVwQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFO1FBQzdELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBRUQsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxLQUFLLEVBQUUsTUFBTSxDQUFDLEVBQUU7UUFDdkMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3REO0lBQ0QsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFO1FBQ3RCLEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElB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eyBNZXRhc2NyZWVuIH0gZnJvbSAnLi9tZXRhc2NyZWVuLmpzJztcbmltcG9ydCB7IGl0ZXJzIH0gZnJvbSAnLi4vdXRpbC5qcyc7XG5cbi8vIFNpbXBsZSB0aWxlc2V0LW9ubHkgZml4ZXMgdGhhdCB1bmxvY2sgc29tZSBzY3JlZW4tdGlsZXNldCBjb21iaW5hdGlvbnNcbmV4cG9ydCBlbnVtIFNjcmVlbkZpeCB7XG4gIFVua25vd24sXG4gIC8vIFN1cHBvcnQgXCJsb25nIGdyYXNzXCIgcml2ZXIgc2NyZWVucyBvbiB0aGUgZ3Jhc3MgdGlsZXNldCBieSBjb3B5aW5nXG4gIC8vIHNvbWUgdGlsZXMgZnJvbSA1MS4uNTkgaW50byA0MC4uNDcuXG4gIEdyYXNzTG9uZ0dyYXNzLFxuICAvLyBJbiBhZGRpdGlvbiB0byBqdXN0IG1ha2luZyB0aGUgbmV3IGxvbmcgZ3Jhc3MgdGlsZXMsIHdlIG5lZWQgdG9cbiAgLy8gYWxzbyByZW1hcCB0aGUgZXhpc3Rpbmcgb25lcyBpbiBzb21lIHNpdHVhdGlvbnMgdG8gcG9pbnQgdG8gdGhlXG4gIC8vIG5ldyBvbmVzLCBlLmcuIGZvciBzY3JlZW5zIDFkLDI5IHRvIHdvcmsgb24gcml2ZXIsIHdlIG5lZWQgdG8gdXNlXG4gIC8vIHRoZSA0eCB0aWxlcyBpbnN0ZWFkIG9mIHRoZSA1eCBvbmVzIHRvIGZpeCB0aGUgc3Vycm91bmRpbmcuXG4gIEdyYXNzTG9uZ0dyYXNzUmVtYXBwaW5nLCAvLyBUT0RPXG4gIC8vIFJpdmVyIHRpbGVzZXRzIGRvbid0IGRlZmluZSAxMCwxMiwxNCwxNiwxNywxYSwxYiwxYywyMiwyMywyNCwyNSwyNixcbiAgLy8gd2hpY2ggYXJlIHVzZWQgZm9yIHRoZSBcInNob3J0IGdyYXNzXCIgaW4gdGhlIGdyYXNzIHRpbGVzZXQuICBUaGVzZVxuICAvLyB3b3VsZCBiZSBlYXN5IHRvIGNvcHkgZnJvbSBzb21ld2hlcmUgZWxzZSB0byBvcGVuIHVwIGEgZmV3IHNjcmVlbnMuXG4gIFJpdmVyU2hvcnRHcmFzcywgLy8gVE9ET1xuICAvLyBBbmdyeSBzZWEgdXNlcyAwYSBvZGRseSBmb3IgYSBzaW1wbGUgZGlhZ29uYWwgYmVhY2gvbW91bnRhaW4gdGlsZSxcbiAgLy8gcHJldmVudGluZyBwYXJpdHkgd2l0aCBncmFzcy9yaXZlciBjYXZlIGVudHJhbmNlIGJvdHRvbXMuICBNb3ZlIHRoaXNcbiAgLy8gdGlsZSBlbHNld2hlcmUgKGFkKSBhbmQgZml4IHRoZSBncmFwaGljcy9lZmZlY3RzLiAgTm90ZSB0aGF0IHRoZVxuICAvLyBhY3R1YWwgZml4IGlzIG5vdCBlbnRpcmVseSBzYXRpc2Z5aW5nLlxuICBTZWFDYXZlRW50cmFuY2UsXG4gIC8vIEFuZ3J5IHNlYSBkb2VzIG5vdCBoYW5kbGUgcm9ja3MgY29ycmVjdGx5LiAgRml4IDVhLi41ZSBmb3IgcGFyaXR5XG4gIC8vIHdpdGggZ3Jhc3Mvcml2ZXIgdGlsZXNldHMuICBUT0RPIC0gaW1wbGVtZW50IHRoZSBmaXggKHdlIGNvdWxkIG1vdmVcbiAgLy8gdGhlIGV4aXN0aW5nIHRpbGVzLCB1c2VkIGJ5IG1vdW50YWluIGdhdGVzLCBlbHNld2hlcmUgcHJldHR5IGVhc2lseSxcbiAgLy8gb3IgYWx0ZXJuYXRpdmVseSBtb3ZlIGFsbCB0aGUgNWEuLjVlIGluIGFsbCBvdGhlciB0aWxlc2V0cyBpbnRvXG4gIC8vIDg5LDhhLDkwLDk5LDlkLGQxLGQyIHdoaWNoIGFyZSBmcmVlIGluIDgwLDkwLDk0LDljKS5cbiAgU2VhUm9ja3MsIC8vIFRPRE9cbiAgLy8gQWxsb3cgdGhlIHNlYSB0byBzdXBwb3J0IDM0LDM4LDNjLi4zZiwgdXNlZCBhcyBtYXJzaCBpbiByaXZlciB0aWxlc2V0LlxuICAvLyBUaGVzZSB3b3VsZCBuZWVkIHRvIG1hcCB0byBzaW1wbGUgb2NlYW4gdGlsZXMuICBUT0RPIC0gaW1wbGVtZW50LlxuICBTZWFNYXJzaCwgLy8gVE9ET1xuICAvLyBTdXBwb3J0IDZ4LDd4IHRpbGVzICh0cmVlcykgb24gYW5ncnkgc2VhLiAgUHJvYmFibHkgbm90IHdvcnRoIGl0LlxuICAvLyBXb3VsZCBuZWVkIHRvIG1vdmUgKGUuZy4pIExpbWUgVHJlZSBMYWtlIHRvIGEgdG90YWxseSBkaWZmZXJlbnQgdGlsZXNldFxuICAvLyB0byBmcmVlIHVwIHRoZSBtZXRhdGlsZXMuXG4gIFNlYVRyZWVzLCAvLyBUT0RPXG4gIC8vIEZpeGluZyBSaXZlclNob3J0R3Jhc3MgZm9yIGRlc2VydCBpcyBhIGxvdCBoYXJkZXIgYmVjYXVzZSBpdCB0b3VjaGVzIGFcbiAgLy8gYnVuY2ggb2YgdGlsZXMgdXNlZCBieSB0aGUgbW91bnRhaW5SaXZlciB0aWxlc2V0ICgxMCwxNCwyeCkuXG4gIERlc2VydFNob3J0R3Jhc3MsIC8vIFRPRE9cbiAgLy8gRml4aW5nIEdyYXNzTG9uZ0dyYXNzIGZvciBkZXNlcnQgaXMgZGlmZmljdWx0IGJlY2F1c2UgdGhlIDR4IHRpbGVzXG4gIC8vIGFyZSB1c2VkIGJ5IG1vdW50YWluUml2ZXIuXG4gIERlc2VydExvbmdHcmFzcywgLy8gVE9ET1xuICAvLyBEZXNlcnQgZG9lc24ndCBzdXBwb3J0IHRoZSAzeCBtYXJzaCB0aWxlcyAoY2xhc2ggd2l0aCBtb3VudGFpblJpdmVyKS5cbiAgLy8gSXQncyBwcm9iYWJseSBub3QgZmVhc2libGUgdG8gYWRkIHN1cHBvcnQgLSBpdCB3b3VsZCBhbGxvdyBzY3JlZW4gMzMsXG4gIC8vIGJ1dCB0aGVyZSdzIGEgc2ltaWxhciBzb3V0aC1lZGdlLWV4aXQgc2NyZWVuIHdpdGggRGVzZXJ0VG93bkVudHJhbmNlLlxuICBEZXNlcnRNYXJzaCwgLy8gVE9ET1xuICAvLyBGaXggNWEuLjVlIHRvIGJlIGNvbXBhdGlibGUgd2l0aCBncmFzcy9yaXZlci4gIDViIGlzIGFscmVhZHkgaW4gdXNlXG4gIC8vIG9uIHRoZSB0d28gb2FzaXMgc2NyZWVucywgc28gdGhhdCB0aWxlIGlzIG1vdmVkIHRvIDVmIHRvIG1ha2Ugc3BhY2UuXG4gIERlc2VydFJvY2tzLFxuICAvLyBBZGQgc29tZSBtaXNzaW5nIHRyZWUgdGlsZXMgaW4gNjMsNjgsNjksNmEsNmMsNmUsNmYsIHJlcXVpcmVkIGZvclxuICAvLyBwYXJpdHkgd2l0aCBzb21lIHJpdmVyIHNjcmVlbnMuXG4gIERlc2VydFRyZWVzLFxuICAvLyBTb3V0aC1mYWNpbmcgdG93biBlbnRyYW5jZXMgdXNlIDA3IGZvciB0aGUgdG9wIG9mIHRoZSB0b3duIHdhbGwuXG4gIC8vIFRoaXMgY291bGQgYmUgcmVwbGFjZWQgd2l0aCAoZS5nLiA4Yykgb3IgbWF5YmUgc29tZXRoaW5nIGJldHRlci5cbiAgRGVzZXJ0VG93bkVudHJhbmNlLCAvLyBUT0RPXG4gIC8vIExhYnlyaW50aCBwYXJhcGV0cyBjYW4gYmUgYmxvY2tlZC91bmJsb2NrZWQgd2l0aCBhIGZsYWcuXG4gIExhYnlyaW50aFBhcmFwZXRzLCAvLyBUT0RPIChzZWUgbWF6ZS9nb2EpXG4gIC8vIEFkZHMgZmxhZ2dhYmxlIGRvb3JzIHRvIHZhcmlvdXMgc2NyZWVucy5cbiAgU3dhbXBEb29ycywgLy8gVE9ETyAoc2VlIG1hemUvc3dhbXApXG4gIC8vIEFkZHMgc29tZSBleHRyYSBzcGlrZSBzY3JlZW5zLlxuICBFeHRyYVNwaWtlcywgLy8gVE9ET1xuICAvLyBNYWtlIGNhdmVzIGNsb3NlYWJsZS5cbiAgQ2xvc2VDYXZlcyxcbiAgLy8gTWFrZXMgdGhlIHRvcCBleGl0cyBvZiBhcmVuYXMgZnVsbC1zaXplIHJhdGhlciB0aGFuIG5hcnJvdywgZ2l2aW5nXG4gIC8vIG1vcmUgZmxleGliaWxpdHkgd2l0aCB3aGF0IGNhbiBnbyB0aGVyZS5cbiAgV2lkZUFyZW5hRXhpdHMsXG59XG5cbnR5cGUgUmVxcyA9IFJlY29yZDxhbnksIHtyZXF1aXJlcz86IFNjcmVlbkZpeFtdfT5cbmV4cG9ydCBmdW5jdGlvbiB3aXRoUmVxdWlyZTxUIGV4dGVuZHMgUmVxcz4ocmVxdWlyZW1lbnQ6IFNjcmVlbkZpeCwgcHJvcHM6IFQpIHtcbiAgZm9yIChjb25zdCBrZXkgaW4gcHJvcHMpIHtcbiAgICBwcm9wc1trZXldLnJlcXVpcmVzID0gW3JlcXVpcmVtZW50XTtcbiAgfVxuICByZXR1cm4gcHJvcHM7XG59XG5cblxuICAvLyAvLyBBZGRzIGFiaWxpdHkgdG8gY2xvc2UgY2F2ZXMuXG4gIC8vIENsb3NlQ2F2ZXMsXG5cblxuLy8gLyoqIEFkZHMgYSAnQ2xvc2VDYXZlcycgcmVxdWlyZW1lbnQgb24gYWxsIHRoZSBwcm9wZXJ0aWVzLiAqL1xuLy8gZnVuY3Rpb24gY2xvc2VDYXZlczxUIGV4dGVuZHMgUmVjb3JkPGFueSwge3JlcXVpcmVzOiBTY3JlZW5GaXhbXX0+Pihwcm9wczogVCkge1xuLy8gICBmb3IgKGNvbnN0IGtleSBpbiBwcm9wcykge1xuLy8gICAgIHByb3BzW2tleV0ucmVxdWlyZXMgPSBbU2NyZWVuRml4LkNsb3NlQ2F2ZXNdO1xuLy8gICB9XG4vLyAgIHJldHVybiBwcm9wcztcbi8vIH1cblxuXG4vLyBOT1RFOiBMaXN0aW5nIGV4cGxpY2l0IGZsYWdzIGRvZXNuJ3QgcXVpdGUgd29yay5cbi8vIGVudW0gRmxhZyB7XG4vLyAgIEFsd2F5cyA9IDB4MmYwLFxuLy8gICBXaW5kbWlsbCA9IDB4MmVlLFxuLy8gICBQcmlzb24gPSAweDJkOCxcbi8vICAgQ2FsbSA9IDB4MjgzLFxuLy8gICBTdHl4ID0gMHgyYjAsXG4vLyAgIERyYXlnb24xID0gMHgyOGYsXG4vLyAgIERyYXlnb24yID0gMHgyOGQsXG4vLyB9XG5cbi8vIGNvbnN0IEdSQVNTID0gMHg4MDtcbi8vIGNvbnN0IFRPV04gPSAweDg0O1xuLy8gY29uc3QgQ0FWRSA9IDB4ODg7XG4vLyBjb25zdCBQWVJBTUlEID0gMHg4Yztcbi8vIGNvbnN0IFJJVkVSID0gMHg5MDtcbi8vIGNvbnN0IE1PVU5UQUlOID0gMHg5NDtcbi8vIGNvbnN0IFNFQSA9IDB4OTQ7XG4vLyBjb25zdCBTSFJJTkUgPSAweDk4O1xuLy8gY29uc3QgREVTRVJUID0gMHg5Yztcbi8vIGNvbnN0IE1PVU5UQUlOX1JJVkVSID0gMHg5Yztcbi8vIGNvbnN0IFNXQU1QID0gMHhhMDtcbi8vIGNvbnN0IEhPVVNFID0gMHhhMDtcbi8vIGNvbnN0IEZPUlRSRVNTID0gMHhhNDtcbi8vIGNvbnN0IElDRV9DQVZFID0gMHhhODtcbi8vIGNvbnN0IFRPV0VSID0gMHhhYztcblxuLyoqIEFwcGx5IHN0YW5kYXJkIHRpbGVzZXQgZml4ZXMuICBPdGhlcnMgbWF5IGJlIGFwcGxpZWQgbGF0ZXIuICovXG5leHBvcnQgZnVuY3Rpb24gZml4VGlsZXNldHMocm9tOiBSb20pIHtcbiAgY29uc3Qge2Rlc2VydCwgZ3Jhc3MsIGxpbWUsXG4gICAgICAgICBtb3VudGFpbiwgbW91bnRhaW5SaXZlciwgcml2ZXIsIHNlYX0gPSByb20ubWV0YXRpbGVzZXRzO1xuICBjb25zdCAkID0gcm9tLm1ldGFzY3JlZW5zO1xuXG4gIC8vIFNldmVyYWwgb2YgdGhlIGdyYXNzL3JpdmVyIHNjcmVlbnMgd2l0aCBmb3Jlc3QgdGlsZXMgZG9uJ3Qgd29yayBvblxuICAvLyBkZXNlcnQuICBGaXggdGhlbSBieSBtYWtpbmcgNWEuLjZmIHdvcmsgY29ycmVjdGx5LlxuICAkLnJlZ2lzdGVyRml4KFNjcmVlbkZpeC5EZXNlcnRSb2Nrcyk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWYpLmNvcHlGcm9tKDB4NWIpLnJlcGxhY2VJbigkLm9hc2lzQ2F2ZSwgJC5vYXNpc0xha2UpO1xuXG4gIGRlc2VydC5nZXRUaWxlKDB4NWEpLmNvcHlGcm9tKDB4OTgpLnNldFRpbGVzKFssICwgMHgxYSwgMHgxOF0pO1xuICBkZXNlcnQuZ2V0VGlsZSgweDViKS5jb3B5RnJvbSgweDgwKS5zZXRUaWxlcyhbMHgzNCwgMHgzMiwgLCBdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1YykuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWywgLCAweDM3LCAweDM1XSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWQpLmNvcHlGcm9tKDB4ODApLnNldFRpbGVzKFssIDB4MzcsICwgMHgzNF0pO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVlKS5jb3B5RnJvbSgweDgwKS5zZXRUaWxlcyhbMHgzNSwgLCAweDMyLCBdKTtcblxuICAkLnJlZ2lzdGVyRml4KFNjcmVlbkZpeC5EZXNlcnRUcmVlcyk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NjMpLmNvcHlGcm9tKDB4NzEpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDY4KS5jb3B5RnJvbSgweDcwKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2OSkuY29weUZyb20oMHg2MCk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NmEpLmNvcHlGcm9tKDB4NjUpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZjKS5jb3B5RnJvbSgweDcwKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2ZSkuY29weUZyb20oMHg3Nik7XG4gIGRlc2VydC5nZXRUaWxlKDB4NmYpLmNvcHlGcm9tKDB4NzgpO1xuXG4gIC8vIExvbmcgZ3Jhc3Mgc2NyZWVucyBkb24ndCB3b3JrIG9uIGdyYXNzIHRpbGVzZXRzIGJlY2F1c2Ugb2YgYSBmZXdcbiAgLy8gZGlmZmVyZW50IHRpbGVzIC0gY29weSB0aGVtIHdoZXJlIHRoZXkgbmVlZCB0byBnby5cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguR3Jhc3NMb25nR3Jhc3MpO1xuICBncmFzcy5nZXRUaWxlKDB4NDApLmNvcHlGcm9tKDB4NTEpO1xuICBncmFzcy5nZXRUaWxlKDB4NDEpLmNvcHlGcm9tKDB4NTIpO1xuICBncmFzcy5nZXRUaWxlKDB4NDIpLmNvcHlGcm9tKDB4NTMpO1xuICBncmFzcy5nZXRUaWxlKDB4NDMpLmNvcHlGcm9tKDB4NTQpO1xuICBncmFzcy5nZXRUaWxlKDB4NDQpLmNvcHlGcm9tKDB4NTUpO1xuICBncmFzcy5nZXRUaWxlKDB4NDUpLmNvcHlGcm9tKDB4NTYpO1xuICBncmFzcy5nZXRUaWxlKDB4NDYpLmNvcHlGcm9tKDB4NTgpO1xuICBncmFzcy5nZXRUaWxlKDB4NDcpLmNvcHlGcm9tKDB4NTkpO1xuXG4gIC8vIEFuZ3J5IHNlYSB0aWxlc2V0IGRvZXNuJ3Qgc3VwcG9ydCB0aWxlIDBhICh1c2VkIGVsc2V3aGVyZSBmb3IgdGhlXG4gIC8vIGJvdHRvbSB0aWxlIGluIGNhdmUgZW50cmFuY2VzKSBiZWNhdXNlIGl0J3MgYWxyZWFkeSBpbiB1c2UgKGJ1dFxuICAvLyBub3QgYXMgYW4gYWx0ZXJuYXRpdmUpLiAgTW92ZSBpdCB0byBhZCBhbmQgZ2V0IDBhIGJhY2suICBBbHNvIGFkanVzdFxuICAvLyB0aGUgdGlsZXMgYXJvdW5kIHRoZSBjYXZlIGVudHJhbmNlcyB0byBub3QgaGF2ZSBkYW1hZ2UgdGlsZXMgaW4gdGhlXG4gIC8vIGRlc2VydCB0aWxlc2V0LiAgVGhpcyBjaGFuZ2VzIHRoZSBncmFwaGljcyBhIGJpdCAoZnJvbSBkYXJrIGJsdWVcbiAgLy8gd2F0ZXIgdG8gbGlnaHQgYmx1ZSksIHdoaWNoIGRvZXNuJ3QgbG9vayBxdWl0ZSBhcyBuaWNlLiAgVGhlIG90aGVyXG4gIC8vIGFsdGVybmF0aXZlIGlzIHRvIGFsbG9jYXRlIDMgbmV3IHRpbGVzLCBjb3BpZWQgZnJvbSAweDgwIGluIHNlYSBidXRcbiAgLy8gZnJvbSAweGY3LCAweGY4LCBhbmQgMHhmZCBpbiBkZXNlcnQvcml2ZXIvZ3Jhc3MuICBUaGVuIHNlYSBjYW4ga2VlcFxuICAvLyBpdHMgZGVlcCB3YXRlciBidXQgZGVzZXJ0IGF2b2lkcyB0aGUgZGFtYWdlLlxuICAkLnJlZ2lzdGVyRml4KFNjcmVlbkZpeC5TZWFDYXZlRW50cmFuY2UpO1xuICBzZWEuZ2V0VGlsZSgweGFkKS5jb3B5RnJvbSgweDBhKVxuICAgICAgLnJlcGxhY2VJbigkLmJlYWNoRXhpdE4sICQubGlnaHRob3VzZUVudHJhbmNlLCAkLm9jZWFuU2hyaW5lKTtcbiAgc2VhLmdldFRpbGUoMHgwYSkuY29weUZyb20oMHhhMik7IC8vIGRvbid0IGJvdGhlciBzZXR0aW5nIGFuIGFsdGVybmF0aXZlLlxuICAvL3NlYS5nZXRUaWxlKDB4MGEpLnNldFRpbGVzKFsweDkxLCAweDkxLCAweDdkLCAweDdkXSkuc2V0QXR0cnMoMik7XG4gICQuYm91bmRhcnlOX2NhdmUuc2NyZWVuLnNldDJkKDB4MzgsIFtbbnVsbCwgMHgwMCwgMHgwMCwgbnVsbF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbnVsbCwgMHgwYSwgMHgwYSwgbnVsbF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbnVsbCwgMHhmNywgMHhmNywgbnVsbF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmOCwgMHhmOCwgMHhmOCwgMHhmOF1dKTtcbiAgJC5jb3JuZXJTRV9jYXZlLnNjcmVlbi5zZXQyZCgweDQ5LCBbW251bGwsIDB4MDAsIDB4MDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbnVsbCwgMHgwYSwgMHgwYV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtudWxsLCAweGY3LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ZjgsIDB4ZjcsIDB4ZjddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbbnVsbCwgMHhmZCwgMHhmN11dKTtcbiAgJC5jb3JuZXJTRV9jYXZlLnNjcmVlbi5zZXQyZCgweDRhLCBbWzB4MDAsIDB4MDBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHgwYSwgMHgwYV0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY3LCAweGY3XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ZjgsIDB4ZjddLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHg4MCwgMHhmZF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweDgwLCAweGZmXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ZmEsIG51bGxdXSk7XG5cbiAgICAgLy8gLCBbMHhmOCwgMHhmOF0sIFtudWxsLCAweGZkXV0pO1xuICAvLyBzZWEuc2NyZWVucy5hZGQoJC5ib3VuZGFyeVdfY2F2ZSk7XG4gIC8vIHNlYS5zY3JlZW5zLmFkZCgkLmRlc2VydENhdmVFbnRyYW5jZSk7XG5cbiAgLy8gVG8gYWxsb3cgY2F2ZXMgdG8gYmUgY2xvc2VkLCB3ZSBjbGVhciBvdXQgbWV0YXRpbGVzIDAxLi4wNCwgdG8gYmUgdXNlZCBhc1xuICAvLyB0aGUgZm91ciBjb3JuZXJzIG9mIHRoZSBjYXZlOiBbWzAxLCAwMV0sIFswMiwgMDJdXS4gIDAzIGFuZCAwNCBhcmUgdXNlZCBmb3JcbiAgLy8gd2F0ZXIgZW50cmFuY2VzIHRvIGVuc3VyZSB0aGUgcGxheWVyIGlzbid0IGtpY2tlZCBvZmYgdGhlIGRvbHBoaW4uXG4gIC8vIFRoZXNlIGFyZSBjb3BpZWQgZnJvbSBjMSxkNyBmb3IgbW9zdCB0aWxlc2V0cyAodGhvdWdoIG9jZWFuIGlzIHNwZWNpYWwpLlxuICAvLyBTb21lIHRpbGVzZXRzIGFscmVhZHkgaGF2ZSBtZXRhdGlsZXMgaW4gMDEuLjA0IHNvIHdlIG5lZWQgdG8gbW92ZSB0aGVtIHRvXG4gIC8vIHVub2NjdXBpZWQgc3BvdHMgb24gYSBwZXItdGlsZXNldCBiYXNpcyAobm90ZSB0aGF0IHNlYSAoOTQpIGFuZCBkZXNlcnQgKDljKVxuICAvLyBhcmUgZW50YW5nbGVkIGhlcmUpLiAgW1RPRE8gLSBjbGVhbiB1cCAyYyBhbmQgMmQgYXMgd2VsbF1cbiAgJC5yZWdpc3RlckZpeChTY3JlZW5GaXguQ2xvc2VDYXZlcyk7XG4gIC8vIE1vdmUgdGhlIGV4aXN0aW5nIHRpbGVzIGluIDAxLi4wNCB0byB2YXJpb3VzIGZyZWUgc3BvdHNcbiAgcml2ZXIuZ2V0VGlsZSgweDA3KS5jb3B5RnJvbSgweDAxKS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICByaXZlci5nZXRUaWxlKDB4MGUpLmNvcHlGcm9tKDB4MDIpLnJlcGxhY2VJbiguLi5yaXZlcik7XG4gIHJpdmVyLmdldFRpbGUoMHgyMCkuY29weUZyb20oMHgwMykucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgcml2ZXIuZ2V0VGlsZSgweDIxKS5jb3B5RnJvbSgweDA0KS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICBmb3IgKGNvbnN0IHRzIG9mIFtkZXNlcnQsIHNlYSwgbW91bnRhaW4sIG1vdW50YWluUml2ZXIsIGxpbWVdKSB7XG4gICAgdHMuZ2V0VGlsZSgweDY4KS5jb3B5RnJvbSgweDAxKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg4MykuY29weUZyb20oMHgwMikucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4ODgpLmNvcHlGcm9tKDB4MDMpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDg5KS5jb3B5RnJvbSgweDA0KS5yZXBsYWNlSW4oLi4udHMpO1xuICB9XG4gIC8vIE1ha2UgMDEuLjA0IGJlIGZsYWdnYWJsZSB3YWxsL29wZW5pbmdcbiAgZm9yIChjb25zdCB0cyBvZiBbZ3Jhc3MsIHJpdmVyLCBkZXNlcnRdKSB7XG4gICAgdHMuZ2V0VGlsZSgweDAxKS5jb3B5RnJvbSgweGMxKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDIpLmNvcHlGcm9tKDB4ZDcpLnNldEFsdGVybmF0aXZlKDB4MGEpO1xuICAgIHRzLmdldFRpbGUoMHgwMykuY29weUZyb20oMHhjMSkuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDA0KS5jb3B5RnJvbSgweGQ3KS5zZXRBbHRlcm5hdGl2ZSgweDBhKTtcbiAgfVxuICBmb3IgKGNvbnN0IHRzIG9mIFtzZWFdKSB7XG4gICAgdHMuZ2V0VGlsZSgweDAxKS5jb3B5RnJvbSgweGMxKS5zZXRBbHRlcm5hdGl2ZSgweDAwKTtcbiAgICB0cy5nZXRUaWxlKDB4MDIpLmNvcHlGcm9tKDB4Y2IpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwMykuY29weUZyb20oMHhjMSkuc2V0QWx0ZXJuYXRpdmUoMHhjMCk7XG4gICAgdHMuZ2V0VGlsZSgweDA0KS5jb3B5RnJvbSgweGNiKS5zZXRBbHRlcm5hdGl2ZSgweGMwKTtcbiAgICAvLyBjb3B5IHJvY2sgZ3JhcGhpY3MgZnJvbSBvdGhlciB0aWxlc2V0IChzYW1lIHBhZ2UgaXMgbG9hZGVkKVxuICAgIGZvciAobGV0IGkgPSAxOyBpIDwgNTsgaSsrKSB7XG4gICAgICB0cy5nZXRUaWxlKGkpLnNldFRpbGVzKGdyYXNzLmdldFRpbGUoaSkudGlsZXMpO1xuICAgIH1cbiAgfVxuICAvLyBTZXQgdGhlIGNhdmUgZW50cmFuY2VzIHRvIHVzZSAwMS4uMDQgYXMgYXBwcm9wcmlhdGVcbiAgY29uc3QgY2xvc2VkQ2F2ZXMgPSBuZXcgU2V0KFtcbiAgICAkLmJvdW5kYXJ5RV9jYXZlLCAkLmJvdW5kYXJ5V19jYXZlLCAkLmV4aXRXX2NhdmUsICQuY2F2ZUFib3ZlUG9ydG9hLFxuICAgICQuYmVhY2hDYXZlLCAkLm91dHNpZGVXaW5kbWlsbCxcbiAgICAvLyBUT0RPIC0gdGVzdCB0aGVzZTpcbiAgICAkLmV4aXRTX2NhdmUsICQudG93bkV4aXRXX2NhdmUsXG4gICAgLy8gVE9ETyAtICQuem9tYmllVG93bkJvdHRvbV9jYXZlRXhpdCwgKHRvd24pXG4gICAgLy8gVE9ETyAtICQuY2hhbm5lbEVuZFdfY2F2ZSwgKGRvbHBoaW5DYXZlKVxuICBdKTtcbiAgY29uc3Qgd2F0ZXJDYXZlcyA9IG5ldyBTZXQ8TWV0YXNjcmVlbj4oW10pO1xuICAvL2lmICgkLmlzRml4ZWQoU2NyZWVuRml4LlNlYUNhdmVFbnRyYW5jZXMpKSB7XG4gICAgd2F0ZXJDYXZlcy5hZGQoJC5ib3VuZGFyeU5fY2F2ZSk7XG4gICAgd2F0ZXJDYXZlcy5hZGQoJC5jb3JuZXJTRV9jYXZlKTtcbiAgLy99XG4gIGZvciAoY29uc3Qgc2NyIG9mIFsuLi5jbG9zZWRDYXZlcywgLi4ud2F0ZXJDYXZlc10pIHtcbiAgICBjb25zdCBleGl0ID0gc2NyLmRhdGEuZXhpdHMhLmZpbmQoZSA9PiBlLnR5cGUgPT09ICdjYXZlJyk7XG4gICAgY29uc3QgcG9zID0gTWF0aC5taW4oLi4uZXhpdCEuZXhpdHMpIC0gMHgxMDtcbiAgICBjb25zdCB0aWxlcyA9IHdhdGVyQ2F2ZXMuaGFzKHNjcikgPyBbWzMsIDNdLCBbNCwgNF1dIDogW1sxLCAxXSwgWzIsIDJdXTtcbiAgICBzY3Iuc2NyZWVuLnNldDJkKHBvcywgdGlsZXMpO1xuICAgIHNjci5hZGRDdXN0b21GbGFnKHRydWUpO1xuICB9XG4gIC8vIEZpeCB0aGUgdHdvIHZhbmlsbGEgc2VhbGVkLWNhdmUgZ3JhcGhpY3MgdG8gYmUgY29uc2lzdGVudCB3aXRoXG4gIC8vIG91ciBuaWNlciBcInJvY2tmYWxsXCIgZ3JhcGhpY3MgKHNwZWNpZmljYWxseSwgYWRkIHRoZSBhcmNoZWQgdG9wKS5cbiAgJC5vdXRzaWRlV2luZG1pbGwuc2NyZWVuLnNldDJkKDB4NDMsIFtbMHhjYSwgMHg4Ml1dKTtcbiAgJC50b3duRXhpdFdfY2F2ZS5zY3JlZW4uc2V0MmQoMHgyYSwgW1sweGNhLCAweDgyXV0pO1xuXG4gIC8vIE5PVEU6IHRoZSBjb3JyZWN0IGNhdmVzIGFyZSBjbG9zZWQgYnkgcGFzcy9maXhlbnRyYW5jZXRyaWdnZXJzLlxuXG4gIC8vIHNlYS5nZXRUaWxlKDB4MGEpLmNvcHlGcm9tKDB4YTIpLnNldFRpbGVzKFssLDB4OTEsMHg5MV0pLnNldEF0dHJzKDApO1xuICAvLyBUaGlzIGRvZXMgb3BlbiB1cCBzY3JlZW4gJGNlIChkZXNlcnQgY2F2ZSBlbnRyYW5jZSkgZm9yIHVzZSBpbiB0aGUgc2VhLFxuICAvLyB3aGljaCBpcyBpbnRlcmVzdGluZyBiZWNhdXNlIHdoaXJscG9vbHMgY2FuJ3QgYmUgZmxvd24gcGFzdCAtIHdlJ2QgbmVlZFxuICAvLyB0byBhZGQgZmxhZ3MgdG8gY2xlYXIgdGhlIHdoaXJscG9vbHMsIGJ1dCBpdCB3b3VsZCBiZSBhIGNhdmUgdGhhdCdzXG4gIC8vIGJsb2NrZWQgb24gY2FsbWluZyB0aGUgc2VhLi4uXG5cbiAgLy8gV2UgY291bGQgYWRkIGEgbnVtYmVyIG9mIHNjcmVlbnMgdG8gdGhlIHNlYSBpZiB3ZSBjb3VsZCBtb3ZlIDVhLi41ZVxuICAvLyAod2hpY2ggY29sbGlkZXMgd2l0aCBtb3VudGFpbiBnYXRlcykuICA4OSw4YSw5MCw5OSw5ZCxkMSxkMiBhcmUgZnJlZVxuICAvLyBpbiA4MCAoZ3Jhc3MpLCA5MCAocml2ZXIpLCBhbmQgOWMgKGRlc2VydCkuICBUaGUgbWFpbiBwcm9ibGVtIGlzIHRoYXRcbiAgLy8gYXQgbGVhc3QgdGhlIGNhdmUgZW50cmFuY2VzIGRvbid0IHF1aXRlIHdvcmsgZm9yIHRoZXNlIC0gdGhleSBlbmQgdXBcbiAgLy8gaW4gc2hhbGxvdyB3YXRlciwgYXJlIGEgbGl0dGxlIHRvbyBzaG9ydCwgYW5kIGl0IHNlZW1zIHRvIGJlIGltcG9zc2libGVcbiAgLy8gdG8gcGljayBhIHBhbGV0dGUgdGhhdCBpcyBsaWdodCBibHVlIG9uIGJvdHRvbSBhbmQgYmxhY2sgb24gdG9wLlxuICAvL1xuICAvLyBPdGhlciBvcHRpb25zIGZvciB0aGUgc2VhIGFyZSAzNCwzOCwzYy4uM2Ygd2hpY2ggYXJlIG1hcnNoIHRpbGVzIGluXG4gIC8vIHJpdmVyIC0gd291bGQgb3BlbiB1cCBzb21lIG5hcnJvdyBwYXNzYWdlcyAoMzMsIFxuXG5cbiAgLy8gIHJvbS5tZXRhc2NyZWVucztcblxuICAvLyBmb3IgKGNvbnN0IHggb2YgT2JqZWN0LnZhbHVlcyhUSUxFU0VUX0ZJWEVTKSkge1xuICAvLyAgIGNvbnN0IGlkID0geC5pZDtcbiAgLy8gICBjb25zdCB0cyA9IHJvbS50aWxlc2V0c1tpZF07XG4gIC8vICAgY29uc3QgdGUgPSB0cy5lZmZlY3RzKCk7XG4gIC8vICAgZm9yIChjb25zdCB0c3RyIGluIHgpIHtcbiAgLy8gICAgIGNvbnN0IHQgPSBOdW1iZXIodHN0cik7XG4gIC8vICAgICBpZiAoaXNOYU4odCkpIGNvbnRpbnVlO1xuICAvLyAgICAgY29uc3QgeTogbnVtYmVyfHtiYXNlOiBudW1iZXJ9ID0gKHggYXMgYW55KVt0XTtcbiAgLy8gICAgIGNvbnN0IGJhc2UgPSB0eXBlb2YgeSA9PT0gJ251bWJlcicgPyB5IDogKHkgYXMgYW55KS5iYXNlO1xuICAvLyAgICAgY29uc3QgcmVzdDogYW55ID0gdHlwZW9mIHkgPT09ICdudW1iZXInID8ge30gOiB5O1xuICAvLyAgICAgdHMuYXR0cnNbdF0gPSB0cy5hdHRyc1tiYXNlXTtcbiAgLy8gICAgIHRlLmVmZmVjdHNbdF0gPSB0ZS5lZmZlY3RzW2Jhc2VdO1xuICAvLyAgICAgW3Jlc3QudGwsIHJlc3QudHIsIHJlc3QuYmwsIHJlc3QuYnJdLmZvckVhY2goKG0sIGkpID0+IHtcbiAgLy8gICAgICAgdHMudGlsZXNbaV1bdF0gPSB0cy50aWxlc1tpXVttICE9IG51bGwgPyBtIDogYmFzZV07XG4gIC8vICAgICB9KTtcbiAgLy8gICAgIGlmIChyZXN0Lm1vdmUpIHt9XG4gIC8vICAgICAvLyBpZiAocmVzdC50aWxlcykge1xuICAvLyAgICAgLy8gICByZXN0LnRpbGVzLmZvckVhY2goKHM6IG51bWJlciwgaTogbnVtYmVyKSA9PiB2b2lkICh0cy50aWxlc1tpXVt0XSA9IHMpKTtcbiAgLy8gICAgIC8vIH1cbiAgLy8gICB9XG4gIC8vIH1cbn1cblxuXG4vLyBjb25zdCBUSUxFU0VUX0ZJWEVTID0ge1xuLy8gICBncmFzczoge1xuLy8gICAgIGlkOiAweDgwLFxuLy8gICAgIDB4NDA6IDB4NTEsXG4vLyAgICAgMHg0MTogMHg1Mixcbi8vICAgICAweDQyOiAweDUzLFxuLy8gICAgIDB4NDM6IDB4NTQsXG4vLyAgICAgMHg0NDogMHg1NSxcbi8vICAgICAweDQ1OiAweDU2LFxuLy8gICAgIDB4NDY6IDB4NTgsXG4vLyAgICAgMHg0NzogMHg1OSxcbi8vICAgfSxcbi8vICAgZGVzZXJ0OiB7XG4vLyAgICAgaWQ6IDB4OWMsXG4vLyAgICAgMHg1YToge2Jhc2U6IDB4OTgsIGJsOiAweDk0LCBicjogMHg5NH0sXG4vLyAgICAgMHg1Yjoge2Jhc2U6IDB4ODAsIHRsOiAweGZkLCB0cjogMHhmY30sXG4vLyAgICAgMHg1Yzoge2Jhc2U6IDB4ODAsIGJsOiAweGZmLCBicjogMHhmZX0sXG4vLyAgICAgMHg1ZDoge2Jhc2U6IDB4ODAsIHRyOiAweGZmLCBicjogMHhmZH0sXG4vLyAgICAgMHg1ZToge2Jhc2U6IDB4ODAsIHRsOiAweGZlLCBibDogMHhmY30sXG4vLyAgICAgMHg2MzogMHg3MSxcbi8vICAgICAweDY4OiAweDcwLFxuLy8gICAgIDB4Njk6IDB4NjAsXG4vLyAgICAgMHg2YTogMHg2NSxcbi8vICAgICAweDZjOiAweDcwLFxuLy8gICAgIDB4NmU6IDB4NzYsXG4vLyAgICAgMHg2ZjogMHg3OCxcbi8vICAgfSxcbi8vIH0gYXMgY29uc3Q7XG5cbi8vIGNvbnN0IFNDUkVFTl9SRU1BUFMgPSBbXG4vLyAgIHt0aWxlc2V0czogWzB4OWNdLCBzcmM6IDB4NWIsIGRlc3Q6IDB4NWYsIHNjcmVlbnM6IFsweGNmXX0sXG4vLyBdO1xuLy8gY29uc3QgW10gPSBTQ1JFRU5fUkVNQVBTO1xuXG4vLyBUT0RPIC0gY29weSA1ZiA8LSA1YiBpbiA5YywgdGhlbiByZW1hcCBpbiBzY3JlZW4gY2Zcbi8vICAgICAgLSBiZXR0ZXIgbm90YXRpb24/XG4vLyBDb25zaWRlciBkb2luZyB0aGlzIHByb2dyYW1tYXRpY2FsbHksIHRob3VnaCB3ZSdkIHdhbnQgdG8gdXNlXG4vLyB0aGUgX2FjdHVhbF8gc2NyZWVuLXRpbGVzZXQgdXNhZ2VzIHJhdGhlciB0aGFuIGRlY2xhcmVkIG9wdGlvbnNcblxuLy8gY2xhc3MgWCB7XG4vLyAgIHJlYWRvbmx5IG06IE1ldGFzY3JlZW5zO1xuLy8gICBjb25zdHJ1Y3RvcihyOiBSb20pIHtcbi8vICAgICB0aGlzLm0gPSBuZXcgTWV0YXNjcmVlbnMocik7XG4vLyAgIH1cbi8vIH1cblxuLy8gQXBwbGllcyB0aGUgV2lkZUFyZW5hRXhpdHMgc2NyZWVuIGZpeC5cbmV4cG9ydCBmdW5jdGlvbiB3aWRlQXJlbmFFeGl0cyhyb206IFJvbSkge1xuICBmdW5jdGlvbiB3aWRlbihleGl0czogbnVtYmVyW10pIHtcbiAgICBleGl0cy5zcGxpY2UoMCwgZXhpdHMubGVuZ3RoLFxuICAgICAgICAgICAgICAgICAuLi5uZXcgU2V0KGl0ZXJzLmNvbmNhdChcbiAgICAgICAgICAgICAgICAgICAgIC4uLmV4aXRzLm1hcChlID0+IFtlLCBlICsgMSwgZSAtIDFdKSkpKTtcbiAgfVxuXG4gIC8vIFdpZGVuIHRoZSB0b3AgZXhpdHMgb2YgdGhlIHNpbXBsZSBhcmVuYXNcbiAgY29uc3Qge1xuICAgIGZvcnRyZXNzQXJlbmFfdGhyb3VnaCwgZm9ydHJlc3NUcmFwLFxuICAgIGhhbGxOUywgaGFsbE5TX2FyZW5hLCBoYWxsTlNfYXJlbmFXYWxsLCBoYWxsTlNfZW50cmFuY2UsXG4gIH0gPSByb20ubWV0YXNjcmVlbnM7XG4gIGhhbGxOU19hcmVuYS5zY3JlZW4uc2V0MmQoMHgwNCwgW1xuICAgIFsweDk3LCAweDc2LCAweDIyLCAweDIzLCAweDIzLCAweDIzLCAweDRiLCAweDk1XSxcbiAgICBbMHg0MiwgMHg0OCwgMHgyMiwgMHgyMSwgMHgyMywgMHgyMywgMHg0NSwgMHg0Ml0sXG4gICAgWzB4NDMsIDB4NDksIDB4MmUsIDB4MjMsIDB4MjMsIDB4MjEsIDB4NDYsIDB4NDNdLFxuICAgIFsweDQ0LCAweDRhLCAweDJlLCAweDIzLCAweDIxLCAweDIxLCAweDQ3LCAweDQ0XSxcbiAgXSk7XG4gIGhhbGxOU19hcmVuYS5zZXRHcmlkVGlsZSgnIGMgfCBhIHwgYyAnKTsgLy8sICcgYyB8IGEgfCB3ICcpO1xuICB3aWRlbihoYWxsTlNfYXJlbmEuZmluZEV4aXRCeVR5cGUoJ2VkZ2U6dG9wJykuZXhpdHMgYXMgbnVtYmVyW10pO1xuXG4gIGhhbGxOU19hcmVuYVdhbGwuc2NyZWVuLnNldDJkKDB4MDQsIFtcbiAgICBbMHg5NCwgMHg0YywgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHg0YiwgMHg5M10sXG4gICAgWzB4OTcsIDB4NGYsIDB4MDAsIDB4MDEsIDB4MDEsIDB4MDIsIDB4NTAsIDB4OTVdLFxuICBdKTtcbiAgaGFsbE5TX2FyZW5hV2FsbC5zZXRHcmlkVGlsZSgnIGMgfCBhIHwgYyAnKTtcbiAgd2lkZW4oaGFsbE5TX2FyZW5hV2FsbC5maW5kRXhpdEJ5VHlwZSgnZWRnZTp0b3AnKS5leGl0cyBhcyBudW1iZXJbXSk7XG5cbiAgLy8gTW92ZSB0aGUgYWJkdWN0aW9uIHRyaWdnZXIgZG93biAzIHRpbGVzIHNvIHlvdSBjYW4ndCB3YWxrIGFyb3VuZCBpdFxuICBjb25zdCBhYmR1Y3Rpb25UcmlnZ2VyID1cbiAgICAgIHJvbS5sb2NhdGlvbnMuWmVidUNhdmUuc3Bhd25zLmZpbmQocyA9PiBzLmlzVHJpZ2dlcigpICYmIHMuaWQgPT09IDB4OGMpO1xuICBpZiAoYWJkdWN0aW9uVHJpZ2dlcikgYWJkdWN0aW9uVHJpZ2dlci55dCArPSA0O1xuXG4gIC8vIFdpZGVuIHRoZSB0b3AgZXhpdHMgb2YgdGhlIGZvcnRyZXNzL3B5cmFtaWQgYXJlbmFzXG4gIGZvcnRyZXNzQXJlbmFfdGhyb3VnaC5zY3JlZW4uc2V0MmQoMHgwNSwgW1xuICAgIFsweDVmLCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweDVmXSxcbiAgICBbMHhiNywgMHgyMiwgMHgyMSwgMHgyMSwgMHgyMSwgMHhiNV0sXG4gICAgWzB4YmYsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4YThdLFxuICBdKTtcbiAgZm9ydHJlc3NBcmVuYV90aHJvdWdoLnNldEdyaWRUaWxlKCcgYyB8IGEgfCB3ICcpO1xuICB3aWRlbihmb3J0cmVzc0FyZW5hX3Rocm91Z2guZmluZEV4aXRCeVR5cGUoJ2VkZ2U6dG9wJykuZXhpdHMgYXMgbnVtYmVyW10pO1xuXG4gIC8vIFdpZGVuIHRoZSBib3R0b20gZW50cmFuY2Ugb2Ygc2FiZXJhJ3MgdHJhcFxuICBmb3J0cmVzc1RyYXAuc2NyZWVuLnNldDJkKDB4YzQsIFtcbiAgICBbMHgzYywgMHgzZCwgMHgyMSwgMHgyMSwgMHgyMSwgMHgyMSwgMHgzYiwgMHgzY10sXG4gICAgWzB4OTIsIDB4NGMsIDB4MjIsIDB4MjEsIDB4MjEsIDB4MjEsIDB4NGIsIDB4OTBdLFxuICAgIFsweDk0LCAweDRjLCAweDIyLCAweDIxLCAweDIxLCAweDIxLCAweDRiLCAweDkzXSxcbiAgXSk7XG4gIGZvcnRyZXNzVHJhcC5zZXRHcmlkVGlsZSgnICAgfCB4IHwgYyAnKTtcbiAgd2lkZW4oZm9ydHJlc3NUcmFwLmZpbmRFeGl0QnlUeXBlKCdlZGdlOmJvdHRvbScpLmV4aXRzIGFzIG51bWJlcltdKTtcblxuICAvLyBGaW5kIGNhc2VzIHdoZXJlIGEgbmFycm93IGhhbGx3YXkgd2FzIHVzZWQgb24gdG9wXG4gIC8vIG9mIGFuIGFyZW5hIGFuZCByZXBsYWNlIHdpdGggYSBub3JtYWwgaGFsbHdheVxuICBmb3IgKGNvbnN0IGxvY2F0aW9uIG9mIHJvbS5sb2NhdGlvbnMpIHtcbiAgICBjb25zdCBtZXRhID0gbG9jYXRpb24ubWV0YTtcbiAgICBmb3IgKGNvbnN0IHBvcyBvZiBtZXRhLmFsbFBvcygpKSB7XG4gICAgICBjb25zdCBzY3IgPSBtZXRhLmdldChwb3MpO1xuICAgICAgaWYgKHNjciA9PT0gaGFsbE5TX2VudHJhbmNlICYmIG1ldGEuZ2V0KHBvcyArIDE2KT8uaGFzRmVhdHVyZSgnYXJlbmEnKSkge1xuICAgICAgICBtZXRhLnNldChwb3MsIGhhbGxOUyk7XG4gICAgICAgIC8vIGFsc28gc2V0IHRoZSBub24tbWV0YSB2ZXJzaW9uLCBtYWlubHkgZm9yIG1hcCB2aWV3ZXJcbiAgICAgICAgY29uc3Qgcm93ID0gbG9jYXRpb24uc2NyZWVuc1twb3MgPj4+IDRdO1xuICAgICAgICBpZiAocm93KSByb3dbcG9zICYgMHhmXSA9IGhhbGxOUy5zaWQ7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG4iXX0=