export class Deque {
    constructor() {
        this.buffer = new Array(16);
        this.mask = 0xf;
        this.start = 0;
        this.end = 0;
        this.size = 0;
    }
    get length() {
        return this.size;
    }
    upsize(target) {
        while (this.mask < target) {
            if (this.end <= this.start)
                this.start += this.mask + 1;
            this.mask = this.mask << 1 | 1;
            this.buffer = this.buffer.concat(this.buffer);
        }
        this.size = target;
    }
    push(...elems) {
        this.upsize(this.size + elems.length);
        for (const elem of elems) {
            this.buffer[this.end] = elem;
            this.end = (this.end + 1) & this.mask;
        }
    }
    pop() {
        if (!this.size)
            return undefined;
        this.end = (this.end - 1) & this.mask;
        this.size--;
        return this.buffer[this.end];
    }
    peek() {
        if (!this.size)
            return undefined;
        return this.buffer[(this.end - 1) & this.mask];
    }
    unshift(...elems) {
        this.upsize(this.size + elems.length);
        for (const elem of elems) {
            this.start = (this.start - 1) & this.mask;
            this.buffer[this.start] = elem;
        }
    }
    shift() {
        if (!this.size)
            return undefined;
        const result = this.buffer[this.start];
        this.start = (this.start + 1) & this.mask;
        this.size--;
        return result;
    }
    front() {
        if (!this.size)
            return undefined;
        return this.buffer[this.start];
    }
    toString() {
        const parts = new Array(this.size);
        for (let i = 0; i < this.size; i++) {
            parts[i] = this.buffer[(this.start + i) & this.mask];
        }
        return `[${parts.join(', ')}]`;
    }
}
export const breakLines = (str, len) => {
    str = str.trim();
    const out = [];
    while (str.length > len) {
        let b = str.substring(0, len).lastIndexOf(' ');
        if (b < 0)
            b = len;
        out.push(str.substring(0, b).trim());
        str = str.substring(b).trim();
    }
    out.push(str.trim());
    return out;
};
export class UsageError extends Error {
}
export class SuffixTrie {
    constructor(key = '') {
        this.key = key;
        this.next = new Map();
    }
    get(key) {
        let t = this;
        for (let i = key.length - 1; i >= 0 && t; i++) {
            t = t.next.get(key[i]);
        }
        return t && t.data;
    }
    with(c) {
        let t = this.next.get(c);
        if (!t)
            this.next.set(c, (t = new SuffixTrie(c + this.key)));
        return t;
    }
    set(key, value) {
        let t = this;
        for (let i = key.length - 1; i >= 0 && t; i++) {
            t = t.with(key[i]);
        }
        t.data = value;
    }
    *values() {
        const stack = [this];
        while (stack.length) {
            const top = stack.pop();
            if (top.data)
                yield top.data;
            stack.push(...top.next.values());
        }
    }
}
export class DefaultMap extends Map {
    constructor(supplier, init) {
        super(init);
        this.supplier = supplier;
    }
    get(key) {
        let value = super.get(key);
        if (value == null)
            super.set(key, value = this.supplier(key));
        return value;
    }
}
export class IndexedSet {
    constructor() {
        this.forward = [];
        this.reverse = new Map();
    }
    add(elem) {
        let result = this.reverse.get(elem);
        if (result == null)
            this.reverse.set(elem, result = this.forward.push(elem) - 1);
        return result;
    }
    get(index) {
        return this.forward[index];
    }
}
export var iters;
(function (iters_1) {
    function* concat(...iters) {
        for (const iter of iters) {
            yield* iter;
        }
    }
    iters_1.concat = concat;
    function isEmpty(iter) {
        return Boolean(iter[Symbol.iterator]().next().done);
    }
    iters_1.isEmpty = isEmpty;
    function* map(iter, f) {
        for (const elem of iter) {
            yield f(elem);
        }
    }
    iters_1.map = map;
    function* filter(iter, f) {
        for (const elem of iter) {
            if (f(elem))
                yield elem;
        }
    }
    iters_1.filter = filter;
    function* flatMap(iter, f) {
        for (const elem of iter) {
            yield* f(elem);
        }
    }
    iters_1.flatMap = flatMap;
    function count(iter) {
        let count = 0;
        for (const _ of iter) {
            count++;
        }
        return count;
    }
    iters_1.count = count;
    function first(iter, fallback) {
        for (const elem of iter)
            return elem;
        if (arguments.length < 2)
            throw new Error(`Empty iterable: ${iter}`);
        return fallback;
    }
    iters_1.first = first;
    function zip(left, right, zipper = (a, b) => [a, b]) {
        return {
            *[Symbol.iterator]() {
                const leftIter = left[Symbol.iterator]();
                const rightIter = right[Symbol.iterator]();
                let a, b;
                while ((a = leftIter.next(), b = rightIter.next(), !a.done && !b.done)) {
                    yield zipper(a.value, b.value);
                }
            }
        };
    }
    iters_1.zip = zip;
})(iters || (iters = {}));
export function spread(iter) {
    return [...iter];
}
export class LabeledSet {
    constructor() {
        this.map = new Map();
    }
    add(elem) {
        this.map.set(elem.label, elem);
    }
    has(elem) {
        return this.map.has(elem.label);
    }
    delete(elem) {
        this.map.delete(elem.label);
    }
    [Symbol.iterator]() {
        return this.map.values();
    }
}
const INVALIDATED = Symbol('Invalidated');
const SIZE = Symbol('Size');
class SetMultimapSetView {
    constructor(ownerMap, ownerKey, currentSet) {
        this.ownerMap = ownerMap;
        this.ownerKey = ownerKey;
        this.currentSet = currentSet;
    }
    getCurrentSet() {
        if (!this.currentSet || this.currentSet[INVALIDATED]) {
            this.currentSet = this.ownerMap.get(this.ownerKey) || new Set();
        }
        return this.currentSet;
    }
    mutateSet(f) {
        const set = this.getCurrentSet();
        const size = set.size;
        try {
            return f(set);
        }
        finally {
            this.ownerMap[SIZE] += set.size - size;
            if (!set.size) {
                this.ownerMap.delete(this.ownerKey);
                set[INVALIDATED] = true;
            }
        }
    }
    add(elem) {
        this.mutateSet(s => s.add(elem));
        return this;
    }
    has(elem) {
        return this.getCurrentSet().has(elem);
    }
    clear() {
        this.mutateSet(s => s.clear());
    }
    delete(elem) {
        return this.mutateSet(s => s.delete(elem));
    }
    [Symbol.iterator]() {
        return this.getCurrentSet()[Symbol.iterator]();
    }
    values() {
        return this.getCurrentSet().values();
    }
    keys() {
        return this.getCurrentSet().keys();
    }
    entries() {
        return this.getCurrentSet().entries();
    }
    forEach(callback, thisArg) {
        this.getCurrentSet().forEach(callback, thisArg);
    }
    get size() {
        return this.getCurrentSet().size;
    }
    get [Symbol.toStringTag]() {
        return 'Set';
    }
}
Reflect.setPrototypeOf(SetMultimapSetView.prototype, Set.prototype);
export class SetMultimap {
    constructor(entries = []) {
        this.map = new Map();
        this.map[SIZE] = 0;
        for (const [k, v] of entries) {
            this.add(k, v);
        }
    }
    get size() {
        return this.map[SIZE];
    }
    get(k) {
        return new SetMultimapSetView(this.map, k, this.map.get(k));
    }
    add(k, v) {
        let set = this.map.get(k);
        if (!set)
            this.map.set(k, set = new Set());
        const size = set.size;
        set.add(v);
        this.map[SIZE] += set.size - size;
    }
}
export class Multiset {
    constructor(entries = []) {
        this.entries = new DefaultMap(() => 0, entries);
    }
    add(elem) {
        this.entries.set(elem, this.entries.get(elem) + 1);
    }
    delete(elem) {
        const count = this.entries.get(elem) - 1;
        if (count > 0) {
            this.entries.set(elem, count);
        }
        else {
            this.entries.delete(elem);
        }
    }
    unique() {
        return this.entries.size;
    }
    count(elem) {
        return this.entries.has(elem) ? this.entries.get(elem) : 0;
    }
    [Symbol.iterator]() {
        return this.entries.entries();
    }
}
export function assertNever(x) {
    throw new Error(`non-exhaustive check: ${x}`);
}
export function assert(x) {
    if (!x)
        throw new Error(`asserted but falsy: ${x}`);
    return x;
}
export function isNonNull(x) {
    return x != null;
}
export function memoize(f) {
    const cache = {};
    return function (...args) {
        let c = cache;
        for (const arg of args) {
            if (!c.next)
                c.next = new WeakMap();
            let next = (c.next || (c.next = new WeakMap())).get(arg);
            if (!next)
                c.next.set(arg, next = {});
        }
        if (!c.cached) {
            c.value = f.apply(this, args);
            c.cached = true;
        }
        return c.value;
    };
}
export function strcmp(left, right) {
    if (left < right)
        return -1;
    if (right < left)
        return 1;
    return 0;
}
export class Keyed {
    constructor(data) {
        this.data = data;
    }
    get(index) {
        return this.data[index];
    }
    [Symbol.iterator]() {
        return this.data.entries();
    }
    values() {
        return this.data[Symbol.iterator]();
    }
}
export class ArrayMap {
    constructor(data) {
        this.data = data;
        const rev = new Map();
        for (let i = 0; i < data.length; i++) {
            rev.set(data[i], i);
        }
        this.rev = rev;
        this.length = data.length;
    }
    get(index) {
        return this.data[index];
    }
    hasValue(value) {
        return this.rev.has(value);
    }
    index(value) {
        const index = this.rev.get(value);
        if (index == null)
            throw new Error(`Missing index for ${value}`);
        return index;
    }
    [Symbol.iterator]() {
        return this.data.entries();
    }
    values() {
        return this.data[Symbol.iterator]();
    }
}
export class MutableArrayBiMap {
    constructor() {
        this._fwd = [];
        this._rev = [];
    }
    *[Symbol.iterator]() {
        for (let i = 0; i < this._fwd.length; i++) {
            const val = this._fwd[i];
            if (val != null)
                yield [i, val];
        }
    }
    *keys() {
        for (let i = 0; i < this._fwd.length; i++) {
            if (this._fwd[i] != null)
                yield i;
        }
    }
    *values() {
        for (let i = 0; i < this._rev.length; i++) {
            if (this._rev[i] != null)
                yield i;
        }
    }
    get(index) {
        return this._fwd[index];
    }
    has(key) {
        return this._fwd[key] != null;
    }
    hasValue(value) {
        return this._rev[value] != null;
    }
    index(value) {
        const index = this._rev[value];
        if (index == null)
            throw new Error(`Missing index for ${value}`);
        return index;
    }
    set(key, value) {
        if (this._fwd[key])
            throw new Error(`already has key ${key}`);
        if (this._rev[value])
            throw new Error(`already has value ${value}`);
        this._fwd[key] = value;
        this._rev[value] = key;
    }
    replace(key, value) {
        const oldKey = this._rev[value];
        if (oldKey != null)
            delete this._fwd[oldKey];
        const oldValue = this._fwd[key];
        if (oldValue != null)
            delete this._rev[oldValue];
        this._fwd[key] = value;
        this._rev[value] = key;
        return oldValue;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidXRpbC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qcy91dGlsLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE1BQU0sT0FBTyxLQUFLO0lBQWxCO1FBRVUsV0FBTSxHQUFzQixJQUFJLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMxQyxTQUFJLEdBQVcsR0FBRyxDQUFDO1FBQ25CLFVBQUssR0FBVyxDQUFDLENBQUM7UUFDbEIsUUFBRyxHQUFXLENBQUMsQ0FBQztRQUNoQixTQUFJLEdBQVcsQ0FBQyxDQUFDO0lBK0QzQixDQUFDO0lBN0RDLElBQUksTUFBTTtRQUNSLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQztJQUNuQixDQUFDO0lBRUQsTUFBTSxDQUFDLE1BQWM7UUFDbkIsT0FBTyxJQUFJLENBQUMsSUFBSSxHQUFHLE1BQU0sRUFBRTtZQUN6QixJQUFJLElBQUksQ0FBQyxHQUFHLElBQUksSUFBSSxDQUFDLEtBQUs7Z0JBQUUsSUFBSSxDQUFDLEtBQUssSUFBSSxJQUFJLENBQUMsSUFBSSxHQUFHLENBQUMsQ0FBQztZQUN4RCxJQUFJLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQyxJQUFJLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztZQUMvQixJQUFJLENBQUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQztTQUMvQztRQUNELElBQUksQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDO0lBQ3JCLENBQUM7SUFFRCxJQUFJLENBQUMsR0FBRyxLQUFVO1FBQ2hCLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLElBQUksR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDdEMsS0FBSyxNQUFNLElBQUksSUFBSSxLQUFLLEVBQUU7WUFDeEIsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEdBQUcsSUFBSSxD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QUN2QixPQUFPLFFBQVEsQ0FBQztJQUNsQixDQUFDO0NBRUYiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgRGVxdWU8VD4ge1xuXG4gIHByaXZhdGUgYnVmZmVyOiAoVCB8IHVuZGVmaW5lZClbXSA9IG5ldyBBcnJheSgxNik7XG4gIHByaXZhdGUgbWFzazogbnVtYmVyID0gMHhmO1xuICBwcml2YXRlIHN0YXJ0OiBudW1iZXIgPSAwO1xuICBwcml2YXRlIGVuZDogbnVtYmVyID0gMDtcbiAgcHJpdmF0ZSBzaXplOiBudW1iZXIgPSAwO1xuXG4gIGdldCBsZW5ndGgoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5zaXplO1xuICB9XG5cbiAgdXBzaXplKHRhcmdldDogbnVtYmVyKSB7XG4gICAgd2hpbGUgKHRoaXMubWFzayA8IHRhcmdldCkge1xuICAgICAgaWYgKHRoaXMuZW5kIDw9IHRoaXMuc3RhcnQpIHRoaXMuc3RhcnQgKz0gdGhpcy5tYXNrICsgMTtcbiAgICAgIHRoaXMubWFzayA9IHRoaXMubWFzayA8PCAxIHwgMTtcbiAgICAgIHRoaXMuYnVmZmVyID0gdGhpcy5idWZmZXIuY29uY2F0KHRoaXMuYnVmZmVyKTtcbiAgICB9XG4gICAgdGhpcy5zaXplID0gdGFyZ2V0O1xuICB9XG5cbiAgcHVzaCguLi5lbGVtczogVFtdKSB7XG4gICAgdGhpcy51cHNpemUodGhpcy5zaXplICsgZWxlbXMubGVuZ3RoKTtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2YgZWxlbXMpIHtcbiAgICAgIHRoaXMuYnVmZmVyW3RoaXMuZW5kXSA9IGVsZW07XG4gICAgICB0aGlzLmVuZCA9ICh0aGlzLmVuZCArIDEpICYgdGhpcy5tYXNrO1xuICAgIH1cbiAgfVxuXG4gIHBvcCgpOiBUIHwgdW5kZWZpbmVkIHtcbiAgICBpZiAoIXRoaXMuc2l6ZSkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICB0aGlzLmVuZCA9ICh0aGlzLmVuZCAtIDEpICYgdGhpcy5tYXNrO1xuICAgIHRoaXMuc2l6ZS0tO1xuICAgIHJldHVybiB0aGlzLmJ1ZmZlclt0aGlzLmVuZF07XG4gIH1cblxuICBwZWVrKCk6IFQgfCB1bmRlZmluZWQge1xuICAgIGlmICghdGhpcy5zaXplKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIHJldHVybiB0aGlzLmJ1ZmZlclsodGhpcy5lbmQgLSAxKSAmIHRoaXMubWFza107XG4gIH1cblxuICB1bnNoaWZ0KC4uLmVsZW1zOiBUW10pIHtcbiAgICB0aGlzLnVwc2l6ZSh0aGlzLnNpemUgKyBlbGVtcy5sZW5ndGgpO1xuICAgIGZvciAoY29uc3QgZWxlbSBvZiBlbGVtcykge1xuICAgICAgdGhpcy5zdGFydCA9ICh0aGlzLnN0YXJ0IC0gMSkgJiB0aGlzLm1hc2s7XG4gICAgICB0aGlzLmJ1ZmZlclt0aGlzLnN0YXJ0XSA9IGVsZW07XG4gICAgfVxuICB9XG5cbiAgc2hpZnQoKTogVCB8IHVuZGVmaW5lZCB7XG4gICAgaWYgKCF0aGlzLnNpemUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgY29uc3QgcmVzdWx0ID0gdGhpcy5idWZmZXJbdGhpcy5zdGFydF07XG4gICAgdGhpcy5zdGFydCA9ICh0aGlzLnN0YXJ0ICsgMSkgJiB0aGlzLm1hc2s7XG4gICAgdGhpcy5zaXplLS07XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGZyb250KCk6IFQgfCB1bmRlZmluZWQge1xuICAgIGlmICghdGhpcy5zaXplKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIHJldHVybiB0aGlzLmJ1ZmZlclt0aGlzLnN0YXJ0XTtcbiAgfVxuXG4gIHRvU3RyaW5nKCkge1xuICAgIGNvbnN0IHBhcnRzID0gbmV3IEFycmF5KHRoaXMuc2l6ZSk7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLnNpemU7IGkrKykge1xuICAgICAgcGFydHNbaV0gPSB0aGlzLmJ1ZmZlclsodGhpcy5zdGFydCArIGkpICYgdGhpcy5tYXNrXTtcbiAgICB9XG4gICAgcmV0dXJuIGBbJHtwYXJ0cy5qb2luKCcsICcpfV1gO1xuICB9XG59XG5cbi8vIC8qKiBAdGVtcGxhdGUgVCAqL1xuLy8gZXhwb3J0IGNsYXNzIERlcXVlU2V0IHtcbi8vICAgY29uc3RydWN0b3IoKSB7XG4vLyAgICAgLyoqIEB0eXBlIHshQXJyYXk8VHx1bmRlZmluZWQ+fSAqL1xuLy8gICAgIHRoaXMuYnVmZmVyID0gbmV3IEFycmF5KDE2KTtcbi8vICAgICAvKiogQHR5cGUge251bWJlcn0gKi9cbi8vICAgICB0aGlzLm1hc2sgPSAweGY7XG4vLyAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4vLyAgICAgdGhpcy5zdGFydCA9IDA7XG4vLyAgICAgLyoqIEB0eXBlIHtudW1iZXJ9ICovXG4vLyAgICAgdGhpcy5lbmQgPSAwO1xuLy8gICAgIC8qKiBAdHlwZSB7bnVtYmVyfSAqL1xuLy8gICAgIHRoaXMuc2l6ZSA9IDA7IC8vIHJlYWRvbmx5IGV4dGVybmFsbHlcbi8vICAgICAvKiogQHR5cGUgeyFTZXQ8VD59ICovXG4vLyAgICAgdGhpcy5zZXQgPSBuZXcgU2V0KCk7XG4vLyAgIH1cblxuLy8gICB1cHNpemUodGFyZ2V0KSB7XG4vLyAgICAgd2hpbGUgKHRoaXMubWFzayA8IHRhcmdldCkge1xuLy8gICAgICAgdGhpcy5zdGFydCArPSB0aGlzLm1hc2sgKyAxO1xuLy8gICAgICAgdGhpcy5tYXNrID0gdGhpcy5tYXNrIDw8IDEgfCAxO1xuLy8gICAgICAgdGhpcy5idWZmZXIgPSB0aGlzLmJ1ZmZlci5jb25jYXQodGhpcy5idWZmZXIpO1xuLy8gICAgIH1cbi8vICAgICB0aGlzLnNpemUgPSB0YXJnZXQ7XG4vLyAgIH1cblxuLy8gICAvKiogQHBhcmFtIHsuLi5UfSBlbGVtICovXG4vLyAgIHB1c2goLi4uZWxlbXMpIHtcbi8vICAgICB0aGlzLnVwc2l6ZSh0aGlzLnNpemUgKyBlbGVtcy5sZW5ndGgpO1xuLy8gICAgIGZvciAoY29uc3QgZWxlbSBvZiBlbGVtcykge1xuLy8gICAgICAgaWYgKHRoaXMuc2V0LmhhcyhlbGVtKSkge1xuLy8gICAgICAgICB0aGlzLnNpemUtLTtcbi8vICAgICAgICAgY29udGludWU7XG4vLyAgICAgICB9XG4vLyAgICAgICB0aGlzLmJ1ZmZlclt0aGlzLmVuZF0gPSBlbGVtO1xuLy8gICAgICAgdGhpcy5lbmQgPSAodGhpcy5lbmQgKyAxKSAmIHRoaXMubWFzaztcbi8vICAgICB9XG4vLyAgIH1cblxuLy8gICAvKiogQHJldHVybiB7VHx1bmRlZmluZWR9ICovXG4vLyAgIHBvcCgpIHtcbi8vICAgICBpZiAoIXRoaXMuc2l6ZSkgcmV0dXJuIHVuZGVmaW5lZDtcbi8vICAgICB0aGlzLmVuZCA9ICh0aGlzLmVuZCAtIDEpICYgdGhpcy5tYXNrO1xuLy8gICAgIHRoaXMuc2l6ZS0tO1xuLy8gICAgIGNvbnN0IG91dCA9IHRoaXMuYnVmZmVyW3RoaXMuZW5kXTtcbi8vICAgICB0aGlzLnNldC5kZWxldGUob3V0KTtcbi8vICAgICByZXR1cm4gb3V0O1xuLy8gICB9XG5cbi8vICAgLyoqIEByZXR1cm4ge1R8dW5kZWZpbmVkfSAqL1xuLy8gICBwZWVrKCkge1xuLy8gICAgIGlmICghdGhpcy5zaXplKSByZXR1cm4gdW5kZWZpbmVkO1xuLy8gICAgIHJldHVybiB0aGlzLmJ1ZmZlclsodGhpcy5lbmQgLSAxKSAmIHRoaXMubWFza107XG4vLyAgIH1cblxuLy8gICAvKiogQHBhcmFtIHsuLi5UfSBlbGVtICovXG4vLyAgIHVuc2hpZnQoLi4uZWxlbXMpIHtcbi8vICAgICB0aGlzLnVwc2l6ZSh0aGlzLnNpemUgKyBlbGVtcy5sZW5ndGgpO1xuLy8gICAgIGZvciAoY29uc3QgZWxlbSBvZiBlbGVtcykge1xuLy8gICAgICAgaWYgKHRoaXMuc2V0LmhhcyhlbGVtKSkge1xuLy8gICAgICAgICB0aGlzLnNpemUtLTtcbi8vICAgICAgICAgY29udGludWU7XG4vLyAgICAgICB9XG4vLyAgICAgICB0aGlzLnN0YXJ0ID0gKHRoaXMuc3RhcnQgLSAxKSAmIHRoaXMubWFzaztcbi8vICAgICAgIHRoaXMuYnVmZmVyW3RoaXMuc3RhcnRdID0gZWxlbTtcbi8vICAgICB9XG4vLyAgIH1cblxuLy8gICAvKiogQHJldHVybiB7VHx1bmRlZmluZWR9ICovXG4vLyAgIHNoaWZ0KCkge1xuLy8gICAgIGlmICghdGhpcy5zaXplKSByZXR1cm4gdW5kZWZpbmVkO1xuLy8gICAgIGNvbnN0IHJlc3VsdCA9IHRoaXMuYnVmZmVyW3RoaXMuc3RhcnRdO1xuLy8gICAgIHRoaXMuc3RhcnQgPSAodGhpcy5zdGFydCArIDEpICYgdGhpcy5tYXNrO1xuLy8gICAgIHRoaXMuc2l6ZS0tO1xuLy8gICAgIHRoaXMuc2V0LnJlbW92ZShyZXN1bHQpO1xuLy8gICAgIHJldHVybiByZXN1bHQ7XG4vLyAgIH1cblxuLy8gICAvKiogQHJldHVybiB7VHx1bmRlZmluZWR9ICovXG4vLyAgIGZyb250KCkge1xuLy8gICAgIGlmICghdGhpcy5zaXplKSByZXR1cm4gdW5kZWZpbmVkO1xuLy8gICAgIHJldHVybiB0aGlzLmJ1ZmZlclt0aGlzLnN0YXJ0XTtcbi8vICAgfVxuLy8gfVxuXG4vLyBleHBvcnQgY2xhc3MgSW5kZXhlZExpc3Qge1xuLy8gICBjb25zdHJ1Y3RvcigpIHtcbi8vICAgICB0aGlzLmxpc3QgPSBbXTtcbi8vICAgICB0aGlzLm1hcCA9IG5ldyBNYXAoKTtcbi8vICAgfVxuXG4vLyAgIGFkZChlbGVtKSB7XG4vLyAgICAgaWYgKHRoaXMubWFwLmhhcyhlbGVtKSkgcmV0dXJuO1xuLy8gICAgIHRoaXMubWFwLnNldChlbGVtLCB0aGlzLmxpc3QubGVuZ3RoKTtcbi8vICAgICB0aGlzLmxpc3QucHVzaChlbGVtKTtcbi8vICAgfVxuXG4vLyAgIGluZGV4T2YoZWxlbSkge1xuLy8gICAgIHJldHVybiB0aGlzLm1hcC5nZXQoZWxlbSk7XG4vLyAgIH1cblxuLy8gICByZW1vdmUoZWxlbSkge1xuLy8gICAgIC8vIFRPRE8gLSB0aGlzIGlzbid0IHN1cGVyIGVmZmljaWVudC4uLlxuLy8gICAgIC8vIFdlIGNvdWxkIG1haW50YWluIGEgc21hbGwgaGFuZGZ1bCBvZiBzcGxpdCBwb2ludHMuXG4vLyAgICAgLy8gT3IgYSBSZW1vdmFsVHJlZSB3aGVyZSBpdCBzdGFydHMgd2l0aCBhIGZ1bGx5LWJhbGFuY2VkXG4vLyAgICAgLy8gYmluYXJ5IHRyZWUgKGhlaWdodCB+IGxvZyhuKSkgYW5kIHRoZW4gd2UganVzdCByZW1vdmVcbi8vICAgICAvLyBlbGVtZW50cyBmcm9tIHRoZXJlIHNvIHRoYXQgd2Ugb25seSBuZWVkIHRvIHVwZGF0ZVxuLy8gICAgIC8vIE8obG9nKG4pKSBcInNpemVcIiB2YWx1ZXMgb24gdGhlIHdheSB1cC4gIFRob3VnaCB0aGlzXG4vLyAgICAgLy8gZG9lc24ndCBoZWxwIHRvIGFjdHVhbGx5ICpmaW5kKiB0aGUgZWxlbWVudC4uLlxuLy8gICAgIC8vIEFub3RoZXIgb3B0aW9uIHdvdWxkIGJlIHRvIHVzZSB0aGUgYml0cyBvZiB0aGUgaW5kZXhcbi8vICAgICAvLyB0byBrZWVwIHRyYWNrIG9mIHRoZSBudW1iZXIgb2YgcmVtb3ZlZCBlbGVtZW50cyBiZWZvcmUuXG4vLyAgICAgLy8gU28gd2UgaGF2ZSBhIHNhbWUtc2l6ZSBhcnJheSBvZiBudW1iZXJzXG4vLyAgICAgLy8gd2hlcmUgZWFjaCBlbnRyeSB0ZWxscyB0aGUgc2l6ZSB0byBhZGQgZm9yIHRoZSBOdGggb25lLWJpdFxuLy8gICAgIC8vIGFuZCBhbGwgdGhlIGhpZ2hlciBiaXRzLlxuLy8gICAgIC8vICAgMDAgLT4gMFxuLy8gICAgIC8vICAgMDEgLT4gMVxuLy8gICAgIC8vICAgMTAgLT4gMlxuLy8gICAgIC8vICAgMTEgLT4gMyA9IDIgKyAxXG4vLyAgICAgLy8gU3RvcmluZ1xuLy8gICAgIC8vICAgWCMgIC0+IDJcbi8vICAgICAvLyAgIDFYICAtPiAxXG4vLyAgICAgLy8gICAwWCAgLT4gMVxuLy8gICAgIC8vIEZvciBiaWdnZXIgbGlzdCxcbi8vICAgICAvLyAgIDExWCAtPiAxICAgIHN0b3JlZCBhdCAgICAxMTEgPSA3XG4vLyAgICAgLy8gICAxMFggLT4gMSAgICAgICAgICAgICAgICAgMTEwID0gNlxuLy8gICAgIC8vICAgMDFYIC0+IDEgICAgICAgICAgICAgICAgIDEwMSA9IDVcbi8vICAgICAvLyAgIDAwWCAtPiAxICAgICAgICAgICAgICAgICAxMDAgPSA0XG4vLyAgICAgLy8gICAxWCMgLT4gMiAgICAgICAgICAgICAgICAgMDExID0gM1xuLy8gICAgIC8vICAgMFgjIC0+IDIgICAgICAgICAgICAgICAgIDAxMCA9IDJcbi8vICAgICAvLyAgIFgjIyAtPiA0ICAgICAgICAgICAgICAgICAwMDEgPSAxXG4vLyAgICAgLy8gVGhlIHVwc2hvdCBpcyB0aGF0IHdoZW4gcmVtb3ZpbmcgYW4gZWxlbWVudCB3ZSBvbmx5IG5lZWQgdG9cbi8vICAgICAvLyB1cGRhdGUgTyhsb2cobikpIGVsZW1lbnRzLi4uXG4vLyAgICAgLy8gQW5kIHdlIGNhbiBhdm9pZCBzcGxpY2luZyB0aGUgbGlzdCBhbmQgZXZlbiBmaW5kIHRoZSBmaXJzdFxuLy8gICAgIC8vIGVsZW1lbnQgd2l0aCBiaW5hcnkgc2VhcmNoIC0gTyhsb2cobikpXG4vLyAgICAgY29uc3QgaW5kZXggPSB0aGlzLm1hcC5nZXQoZWxlbSk7XG4vLyAgICAgaWYgKGluZGV4ID09IG51bGwpIHJldHVybjtcbi8vICAgICB0aGlzLmxpc3Quc3BsaWNlKGluZGV4LCAxKTtcbi8vICAgICB0aGlzLm1hcC5kZWxldGUoZWxlbSk7XG4vLyAgICAgZm9yIChsZXQgaSA9IGluZGV4OyBpIDwgdGhpcy5saXN0Lmxlbmd0aDsgaSsrKSB7XG4vLyAgICAgICB0aGlzLm1hcC5zZXQodGhpcy5saXN0W2ldLCBpKTtcbi8vICAgICB9XG4vLyAgIH1cblxuLy8gICBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcbi8vICAgICByZXR1cm4gdGhpcy5saXN0W1N5bWJvbC5pdGVyYXRvcl0oKTtcbi8vICAgfVxuLy8gfVxuXG5leHBvcnQgY29uc3QgYnJlYWtMaW5lcyA9IChzdHI6IHN0cmluZywgbGVuOiBudW1iZXIpOiBzdHJpbmdbXSA9PiB7XG4gIHN0ciA9IHN0ci50cmltKCk7XG4gIGNvbnN0IG91dDogc3RyaW5nW10gPSBbXTtcbiAgd2hpbGUgKHN0ci5sZW5ndGggPiBsZW4pIHtcbiAgICBsZXQgYiA9IHN0ci5zdWJzdHJpbmcoMCwgbGVuKS5sYXN0SW5kZXhPZignICcpO1xuICAgIGlmIChiIDwgMCkgYiA9IGxlbjtcbiAgICBvdXQucHVzaChzdHIuc3Vic3RyaW5nKDAsIGIpLnRyaW0oKSk7XG4gICAgc3RyID0gc3RyLnN1YnN0cmluZyhiKS50cmltKCk7XG4gIH1cbiAgb3V0LnB1c2goc3RyLnRyaW0oKSk7XG4gIHJldHVybiBvdXQ7XG59O1xuXG5leHBvcnQgY2xhc3MgVXNhZ2VFcnJvciBleHRlbmRzIEVycm9yIHt9XG5cbmV4cG9ydCBjbGFzcyBTdWZmaXhUcmllPFQ+IHtcbiAgcmVhZG9ubHkgbmV4dCA9IG5ldyBNYXA8c3RyaW5nLCBTdWZmaXhUcmllPFQ+PigpO1xuICBkYXRhOiBUIHwgdW5kZWZpbmVkO1xuXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IGtleTogc3RyaW5nID0gJycpIHt9XG5cbiAgZ2V0KGtleTogc3RyaW5nKTogVCB8IHVuZGVmaW5lZCB7XG4gICAgbGV0IHQ6IFN1ZmZpeFRyaWU8VD4gfCB1bmRlZmluZWQgPSB0aGlzO1xuICAgIGZvciAobGV0IGkgPSBrZXkubGVuZ3RoIC0gMTsgaSA+PSAwICYmIHQ7IGkrKykge1xuICAgICAgdCA9IHQubmV4dC5nZXQoa2V5W2ldKTtcbiAgICB9XG4gICAgcmV0dXJuIHQgJiYgdC5kYXRhO1xuICB9XG5cbiAgd2l0aChjOiBzdHJpbmcpOiBTdWZmaXhUcmllPFQ+IHtcbiAgICBsZXQgdCA9IHRoaXMubmV4dC5nZXQoYyk7XG4gICAgaWYgKCF0KSB0aGlzLm5leHQuc2V0KGMsICh0ID0gbmV3IFN1ZmZpeFRyaWU8VD4oYyArIHRoaXMua2V5KSkpO1xuICAgIHJldHVybiB0O1xuICB9XG5cbiAgc2V0KGtleTogc3RyaW5nLCB2YWx1ZTogVCB8IHVuZGVmaW5lZCkge1xuICAgIGxldCB0OiBTdWZmaXhUcmllPFQ+ID0gdGhpcztcbiAgICBmb3IgKGxldCBpID0ga2V5Lmxlbmd0aCAtIDE7IGkgPj0gMCAmJiB0OyBpKyspIHtcbiAgICAgIHQgPSB0LndpdGgoa2V5W2ldKTtcbiAgICB9XG4gICAgdC5kYXRhID0gdmFsdWU7XG4gIH1cblxuICAqIHZhbHVlcygpOiBJdGVyYWJsZTxUPiB7XG4gICAgY29uc3Qgc3RhY2s6IFN1ZmZpeFRyaWU8VD5bXSA9IFt0aGlzXTtcbiAgICB3aGlsZSAoc3RhY2subGVuZ3RoKSB7XG4gICAgICBjb25zdCB0b3AgPSBzdGFjay5wb3AoKSE7XG4gICAgICBpZiAodG9wLmRhdGEpIHlpZWxkIHRvcC5kYXRhO1xuICAgICAgc3RhY2sucHVzaCguLi50b3AubmV4dC52YWx1ZXMoKSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBEZWZhdWx0TWFwPEssIFYgZXh0ZW5kcyB7fT4gZXh0ZW5kcyBNYXA8SywgVj4ge1xuICBjb25zdHJ1Y3Rvcihwcml2YXRlIHJlYWRvbmx5IHN1cHBsaWVyOiAoa2V5OiBLKSA9PiBWLFxuICAgICAgICAgICAgICBpbml0PzogSXRlcmFibGU8cmVhZG9ubHkgW0ssIFZdPikge1xuICAgIHN1cGVyKGluaXQgYXMgYW55KTsgLy8gTk9URTogTWFwJ3MgZGVjbGFyYXRpb25zIGFyZSBvZmYsIEl0ZXJhYmxlIGlzIGZpbmUuXG4gIH1cbiAgZ2V0KGtleTogSyk6IFYge1xuICAgIGxldCB2YWx1ZSA9IHN1cGVyLmdldChrZXkpO1xuICAgIGlmICh2YWx1ZSA9PSBudWxsKSBzdXBlci5zZXQoa2V5LCB2YWx1ZSA9IHRoaXMuc3VwcGxpZXIoa2V5KSk7XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJbmRleGVkU2V0PFQgZXh0ZW5kcyB7fT4ge1xuICBwcml2YXRlIGZvcndhcmQ6IFRbXSA9IFtdO1xuICBwcml2YXRlIHJldmVyc2UgPSBuZXcgTWFwPFQsIG51bWJlcj4oKTtcblxuICBhZGQoZWxlbTogVCk6IG51bWJlciB7XG4gICAgbGV0IHJlc3VsdCA9IHRoaXMucmV2ZXJzZS5nZXQoZWxlbSk7XG4gICAgaWYgKHJlc3VsdCA9PSBudWxsKSB0aGlzLnJldmVyc2Uuc2V0KGVsZW0sIHJlc3VsdCA9IHRoaXMuZm9yd2FyZC5wdXNoKGVsZW0pIC0gMSk7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIGdldChpbmRleDogbnVtYmVyKTogVCB7XG4gICAgcmV0dXJuIHRoaXMuZm9yd2FyZFtpbmRleF07XG4gIH1cbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBpdGVycyB7XG4gIC8vIENvbmNhdGVuYXRlcyBpdGVyYWJsZXMuXG4gIGV4cG9ydCBmdW5jdGlvbiAqIGNvbmNhdDxUPiguLi5pdGVyczogQXJyYXk8SXRlcmFibGU8VD4+KTogSXRlcmFibGVJdGVyYXRvcjxUPiB7XG4gICAgZm9yIChjb25zdCBpdGVyIG9mIGl0ZXJzKSB7XG4gICAgICB5aWVsZCAqIGl0ZXI7XG4gICAgfVxuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGlzRW1wdHkoaXRlcjogSXRlcmFibGU8dW5rbm93bj4pOiBib29sZWFuIHtcbiAgICByZXR1cm4gQm9vbGVhbihpdGVyW1N5bWJvbC5pdGVyYXRvcl0oKS5uZXh0KCkuZG9uZSk7XG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gKiBtYXA8VCwgVT4oaXRlcjogSXRlcmFibGU8VD4sIGY6IChlbGVtOiBUKSA9PiBVKTogSXRlcmFibGVJdGVyYXRvcjxVPiB7XG4gICAgZm9yIChjb25zdCBlbGVtIG9mIGl0ZXIpIHtcbiAgICAgIHlpZWxkIGYoZWxlbSk7XG4gICAgfVxuICB9XG4gIGV4cG9ydCBmdW5jdGlvbiAqIGZpbHRlcjxUPihpdGVyOiBJdGVyYWJsZTxUPiwgZjogKGVsZW06IFQpID0+IGJvb2xlYW4pOiBJdGVyYWJsZTxUPiB7XG4gICAgZm9yIChjb25zdCBlbGVtIG9mIGl0ZXIpIHtcbiAgICAgIGlmIChmKGVsZW0pKSB5aWVsZCBlbGVtO1xuICAgIH1cbiAgfVxuICBleHBvcnQgZnVuY3Rpb24gKiBmbGF0TWFwPFQsIFU+KGl0ZXI6IEl0ZXJhYmxlPFQ+LCBmOiAoZWxlbTogVCkgPT4gSXRlcmFibGU8VT4pOiBJdGVyYWJsZUl0ZXJhdG9yPFU+IHtcbiAgICBmb3IgKGNvbnN0IGVsZW0gb2YgaXRlcikge1xuICAgICAgeWllbGQgKiBmKGVsZW0pO1xuICAgIH1cbiAgfVxuICBleHBvcnQgZnVuY3Rpb24gY291bnQoaXRlcjogSXRlcmFibGU8dW5rbm93bj4pOiBudW1iZXIge1xuICAgIGxldCBjb3VudCA9IDA7XG4gICAgZm9yIChjb25zdCBfIG9mIGl0ZXIpIHtcbiAgICAgIGNvdW50Kys7XG4gICAgfVxuICAgIHJldHVybiBjb3VudDtcbiAgfVxuXG4gIGV4cG9ydCBmdW5jdGlvbiBmaXJzdDxUPihpdGVyOiBJdGVyYWJsZTxUPik6IFQ7XG4gIGV4cG9ydCBmdW5jdGlvbiBmaXJzdDxUPihpdGVyOiBJdGVyYWJsZTxUPiwgZmFsbGJhY2s6IFQpOiBUO1xuICBleHBvcnQgZnVuY3Rpb24gZmlyc3Q8VD4oaXRlcjogSXRlcmFibGU8VD4sIGZhbGxiYWNrPzogVCk6IFQge1xuICAgIGZvciAoY29uc3QgZWxlbSBvZiBpdGVyKSByZXR1cm4gZWxlbTtcbiAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCA8IDIpIHRocm93IG5ldyBFcnJvcihgRW1wdHkgaXRlcmFibGU6ICR7aXRlcn1gKTtcbiAgICByZXR1cm4gZmFsbGJhY2sgYXMgVDsgICAgXG4gIH1cblxuICBleHBvcnQgZnVuY3Rpb24gemlwPEEsIEI+KGxlZnQ6IEl0ZXJhYmxlPEE+LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJpZ2h0OiBJdGVyYWJsZTxCPik6IEl0ZXJhYmxlPFtBLCBCXT47XG4gIGV4cG9ydCBmdW5jdGlvbiB6aXA8QSwgQiwgQz4obGVmdDogSXRlcmFibGU8QT4sIHJpZ2h0OiBJdGVyYWJsZTxCPixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6aXBwZXI6IChhOiBBLCBiOiBCKSA9PiBDKTogSXRlcmFibGU8Qz47XG4gIGV4cG9ydCBmdW5jdGlvbiB6aXA8QSwgQiwgQz4obGVmdDogSXRlcmFibGU8QT4sIHJpZ2h0OiBJdGVyYWJsZTxCPixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB6aXBwZXI6IChhOiBBLCBiOiBCKSA9PiBDID0gKGEsIGIpID0+IFthLCBiXSBhcyBhbnkpOlxuICBJdGVyYWJsZTxDPiB7XG4gICAgcmV0dXJuIHtcbiAgICAgICogW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgICAgIGNvbnN0IGxlZnRJdGVyID0gbGVmdFtTeW1ib2wuaXRlcmF0b3JdKCk7XG4gICAgICAgIGNvbnN0IHJpZ2h0SXRlciA9IHJpZ2h0W1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgICAgICAgbGV0IGEsIGI7XG4gICAgICAgIHdoaWxlICgoYSA9IGxlZnRJdGVyLm5leHQoKSwgYiA9IHJpZ2h0SXRlci5uZXh0KCksICFhLmRvbmUgJiYgIWIuZG9uZSkpIHtcbiAgICAgICAgICB5aWVsZCB6aXBwZXIoYS52YWx1ZSwgYi52YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzcHJlYWQ8VD4oaXRlcjogSXRlcmFibGU8VD4pOiBUW10ge1xuICByZXR1cm4gWy4uLml0ZXJdO1xufVxuXG4vKiogQSBzZXQgb2Ygb2JqZWN0cyB3aXRoIHVuaXF1ZSBsYWJlbHMgKGJhc2ljYWxseSB0b1N0cmluZy1lcXVpdmFsZW5jZSkuICovXG5leHBvcnQgY2xhc3MgTGFiZWxlZFNldDxUIGV4dGVuZHMgTGFiZWxlZD4gaW1wbGVtZW50cyBJdGVyYWJsZTxUPiB7XG4gIHByaXZhdGUgbWFwID0gbmV3IE1hcDxTdHJpbmcsIFQ+KCk7XG4gIGFkZChlbGVtOiBUKSB7XG4gICAgdGhpcy5tYXAuc2V0KGVsZW0ubGFiZWwsIGVsZW0pO1xuICB9XG4gIGhhcyhlbGVtOiBUKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubWFwLmhhcyhlbGVtLmxhYmVsKTtcbiAgfVxuICBkZWxldGUoZWxlbTogVCkge1xuICAgIHRoaXMubWFwLmRlbGV0ZShlbGVtLmxhYmVsKTtcbiAgfVxuICBbU3ltYm9sLml0ZXJhdG9yXSgpIHtcbiAgICByZXR1cm4gdGhpcy5tYXAudmFsdWVzKCk7XG4gIH1cbn1cbi8qKiBTdXBlcmludGVyZmFjZSBmb3Igb2JqZWN0cyB0aGF0IGNhbiBiZSBzdG9yZWQgaW4gYSBMYWJlbGVkU2V0LiAqL1xuZXhwb3J0IGludGVyZmFjZSBMYWJlbGVkIHtcbiAgcmVhZG9ubHkgbGFiZWw6IHN0cmluZztcbn1cblxuY29uc3QgSU5WQUxJREFURUQgPSBTeW1ib2woJ0ludmFsaWRhdGVkJyk7XG5jb25zdCBTSVpFID0gU3ltYm9sKCdTaXplJyk7XG5cbmNsYXNzIFNldE11bHRpbWFwU2V0VmlldzxLLCBWPiBpbXBsZW1lbnRzIFNldDxWPiB7XG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgb3duZXJNYXA6IE1hcDxLLCBTZXQ8Vj4+LFxuICAgICAgICAgICAgICBwcml2YXRlIHJlYWRvbmx5IG93bmVyS2V5OiBLLCBwcml2YXRlIGN1cnJlbnRTZXQ/OiBTZXQ8Vj4pIHt9XG4gIHByaXZhdGUgZ2V0Q3VycmVudFNldCgpIHtcbiAgICBpZiAoIXRoaXMuY3VycmVudFNldCB8fCAodGhpcy5jdXJyZW50U2V0IGFzIGFueSlbSU5WQUxJREFURURdKSB7XG4gICAgICB0aGlzLmN1cnJlbnRTZXQgPSB0aGlzLm93bmVyTWFwLmdldCh0aGlzLm93bmVyS2V5KSB8fCBuZXcgU2V0PFY+KCk7XG4gICAgfVxuICAgIHJldHVybiB0aGlzLmN1cnJlbnRTZXQ7XG4gIH1cbiAgcHJpdmF0ZSBtdXRhdGVTZXQ8Uj4oZjogKHM6IFNldDxWPikgPT4gUik6IFIge1xuICAgIGNvbnN0IHNldCA9IHRoaXMuZ2V0Q3VycmVudFNldCgpO1xuICAgIGNvbnN0IHNpemUgPSBzZXQuc2l6ZTtcbiAgICB0cnkge1xuICAgICAgcmV0dXJuIGYoc2V0KTtcbiAgICB9IGZpbmFsbHkge1xuICAgICAgKHRoaXMub3duZXJNYXAgYXMgYW55KVtTSVpFXSArPSBzZXQuc2l6ZSAtIHNpemU7XG4gICAgICBpZiAoIXNldC5zaXplKSB7XG4gICAgICAgIHRoaXMub3duZXJNYXAuZGVsZXRlKHRoaXMub3duZXJLZXkpO1xuICAgICAgICAoc2V0IGFzIGFueSlbSU5WQUxJREFURURdID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgYWRkKGVsZW06IFYpOiB0aGlzIHtcbiAgICB0aGlzLm11dGF0ZVNldChzID0+IHMuYWRkKGVsZW0pKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuICBoYXMoZWxlbTogVik6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmdldEN1cnJlbnRTZXQoKS5oYXMoZWxlbSk7XG4gIH1cbiAgY2xlYXIoKTogdm9pZCB7XG4gICAgdGhpcy5tdXRhdGVTZXQocyA9PiBzLmNsZWFyKCkpO1xuICB9XG4gIGRlbGV0ZShlbGVtOiBWKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMubXV0YXRlU2V0KHMgPT4gcy5kZWxldGUoZWxlbSkpO1xuICB9XG4gIFtTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhYmxlSXRlcmF0b3I8Vj4ge1xuICAgIHJldHVybiB0aGlzLmdldEN1cnJlbnRTZXQoKVtTeW1ib2wuaXRlcmF0b3JdKCk7XG4gIH1cbiAgdmFsdWVzKCk6IEl0ZXJhYmxlSXRlcmF0b3I8Vj4ge1xuICAgIHJldHVybiB0aGlzLmdldEN1cnJlbnRTZXQoKS52YWx1ZXMoKTtcbiAgfVxuICBrZXlzKCk6IEl0ZXJhYmxlSXRlcmF0b3I8Vj4ge1xuICAgIHJldHVybiB0aGlzLmdldEN1cnJlbnRTZXQoKS5rZXlzKCk7XG4gIH1cbiAgZW50cmllcygpOiBJdGVyYWJsZUl0ZXJhdG9yPFtWLCBWXT4ge1xuICAgIHJldHVybiB0aGlzLmdldEN1cnJlbnRTZXQoKS5lbnRyaWVzKCk7XG4gIH1cbiAgZm9yRWFjaDxUPihjYWxsYmFjazogKHZhbHVlOiBWLCBrZXk6IFYsIHNldDogU2V0PFY+KSA9PiB2b2lkLCB0aGlzQXJnPzogVCk6IHZvaWQge1xuICAgIHRoaXMuZ2V0Q3VycmVudFNldCgpLmZvckVhY2goY2FsbGJhY2ssIHRoaXNBcmcpO1xuICB9XG4gIGdldCBzaXplKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZ2V0Q3VycmVudFNldCgpLnNpemU7XG4gIH1cbiAgZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuICdTZXQnO1xuICB9XG59XG4vLyBGaXggJ2luc3RhbmNlb2YnIHRvIHdvcmsgcHJvcGVybHkgd2l0aG91dCByZXF1aXJpbmcgYWN0dWFsIHN1cGVyY2xhc3MuLi5cblJlZmxlY3Quc2V0UHJvdG90eXBlT2YoU2V0TXVsdGltYXBTZXRWaWV3LnByb3RvdHlwZSwgU2V0LnByb3RvdHlwZSk7XG5cbmV4cG9ydCBjbGFzcyBTZXRNdWx0aW1hcDxLLCBWPiB7XG5cbiAgcHJpdmF0ZSByZWFkb25seSBtYXAgPSBuZXcgTWFwPEssIFNldDxWPj4oKTtcblxuICBjb25zdHJ1Y3RvcihlbnRyaWVzOiBJdGVyYWJsZTxyZWFkb25seSBbSywgVl0+ID0gW10pIHtcbiAgICAodGhpcy5tYXAgYXMgYW55KVtTSVpFXSA9IDA7XG4gICAgZm9yIChjb25zdCBbaywgdl0gb2YgZW50cmllcykge1xuICAgICAgdGhpcy5hZGQoaywgdik7XG4gICAgfVxuICB9XG5cbiAgZ2V0IHNpemUoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gKHRoaXMubWFwIGFzIGFueSlbU0laRV07XG4gIH1cblxuICBnZXQoazogSyk6IFNldDxWPiB7XG4gICAgcmV0dXJuIG5ldyBTZXRNdWx0aW1hcFNldFZpZXcodGhpcy5tYXAsIGssIHRoaXMubWFwLmdldChrKSk7XG4gIH1cblxuICBhZGQoazogSywgdjogVik6IHZvaWQge1xuICAgIGxldCBzZXQgPSB0aGlzLm1hcC5nZXQoayk7XG4gICAgaWYgKCFzZXQpIHRoaXMubWFwLnNldChrLCBzZXQgPSBuZXcgU2V0KCkpO1xuICAgIGNvbnN0IHNpemUgPSBzZXQuc2l6ZTtcbiAgICBzZXQuYWRkKHYpO1xuICAgICh0aGlzLm1hcCBhcyBhbnkpW1NJWkVdICs9IHNldC5zaXplIC0gc2l6ZTtcbiAgfVxuXG4gIC8vIFRPRE8gLSBpdGVyYXRpb24/XG59XG5cblxuZXhwb3J0IGNsYXNzIE11bHRpc2V0PFQ+IGltcGxlbWVudHMgSXRlcmFibGU8W1QsIG51bWJlcl0+IHtcbiAgcHJpdmF0ZSBlbnRyaWVzOiBEZWZhdWx0TWFwPFQsIG51bWJlcj47XG4gIGNvbnN0cnVjdG9yKGVudHJpZXM6IEl0ZXJhYmxlPFtULCBudW1iZXJdPiA9IFtdKSB7XG4gICAgdGhpcy5lbnRyaWVzID0gbmV3IERlZmF1bHRNYXAoKCkgPT4gMCwgZW50cmllcyk7XG4gIH1cbiAgYWRkKGVsZW06IFQpIHtcbiAgICB0aGlzLmVudHJpZXMuc2V0KGVsZW0sIHRoaXMuZW50cmllcy5nZXQoZWxlbSkgKyAxKTtcbiAgfVxuICBkZWxldGUoZWxlbTogVCkge1xuICAgIGNvbnN0IGNvdW50ID0gdGhpcy5lbnRyaWVzLmdldChlbGVtKSAtIDE7XG4gICAgaWYgKGNvdW50ID4gMCkge1xuICAgICAgdGhpcy5lbnRyaWVzLnNldChlbGVtLCBjb3VudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuZW50cmllcy5kZWxldGUoZWxlbSk7XG4gICAgfVxuICB9XG4gIHVuaXF1ZSgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLmVudHJpZXMuc2l6ZTtcbiAgfVxuICBjb3VudChlbGVtOiBUKTogbnVtYmVyIHtcbiAgICByZXR1cm4gdGhpcy5lbnRyaWVzLmhhcyhlbGVtKSA/IHRoaXMuZW50cmllcy5nZXQoZWxlbSkgOiAwO1xuICB9XG4gIFtTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhYmxlSXRlcmF0b3I8W1QsIG51bWJlcl0+IHtcbiAgICByZXR1cm4gdGhpcy5lbnRyaWVzLmVudHJpZXMoKTtcbiAgfVxufVxuXG5cbmV4cG9ydCBmdW5jdGlvbiBhc3NlcnROZXZlcih4OiBuZXZlcik6IG5ldmVyIHtcbiAgdGhyb3cgbmV3IEVycm9yKGBub24tZXhoYXVzdGl2ZSBjaGVjazogJHt4fWApO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gYXNzZXJ0PFQ+KHg6IFR8dW5kZWZpbmVkfG51bGwpOiBUIHtcbiAgaWYgKCF4KSB0aHJvdyBuZXcgRXJyb3IoYGFzc2VydGVkIGJ1dCBmYWxzeTogJHt4fWApO1xuICByZXR1cm4geDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIGlzTm9uTnVsbDxUIGV4dGVuZHMge30+KHg6IFR8dW5kZWZpbmVkfG51bGwpOiB4IGlzIFQge1xuICByZXR1cm4geCAhPSBudWxsO1xufVxuLy8gZXhwb3J0IGZ1bmN0aW9uIG5vbk51bGw8VCBleHRlbmRzIHt9Pih4OiBUfHVuZGVmaW5lZHxudWxsKTogVCB7XG4vLyAgIGlmICh4ICE9IG51bGwpIHJldHVybiB4O1xuLy8gICB0aHJvdyBuZXcgRXJyb3IoYEV4cGVjdGVkIG5vbi1udWxsYCk7XG4vLyB9XG5cblxuLy8gR2VuZXJhbGl6ZWQgbWVtb2l6YXRpb24gd3JhcHBlci4gIEFsbCBhcmd1bWVudHMgbXVzdCBiZSBvYmplY3RzLFxuLy8gYnV0IGFueSBudW1iZXIgb2YgYXJndW1lbnRzIGlzIGFsbG93ZWQuXG50eXBlIEY8QSBleHRlbmRzIGFueVtdLCBSPiA9ICguLi5hcmdzOiBBKSA9PiBSO1xuZXhwb3J0IGZ1bmN0aW9uIG1lbW9pemU8VCBleHRlbmRzIG9iamVjdFtdLCBSPihmOiBGPFQsIFI+KTogRjxULCBSPiB7XG4gIGludGVyZmFjZSBWIHtcbiAgICBuZXh0PzogV2Vha01hcDxhbnksIFY+O1xuICAgIHZhbHVlPzogUjtcbiAgICBjYWNoZWQ/OiBib29sZWFuO1xuICB9XG4gIGNvbnN0IGNhY2hlOiBWID0ge307XG4gIHJldHVybiBmdW5jdGlvbih0aGlzOiBhbnksIC4uLmFyZ3M6IGFueVtdKSB7XG4gICAgbGV0IGMgPSBjYWNoZTtcbiAgICBmb3IgKGNvbnN0IGFyZyBvZiBhcmdzKSB7XG4gICAgICBpZiAoIWMubmV4dCkgYy5uZXh0ID0gbmV3IFdlYWtNYXA8YW55LCBWPigpO1xuICAgICAgbGV0IG5leHQgPSAoYy5uZXh0IHx8IChjLm5leHQgPSBuZXcgV2Vha01hcCgpKSkuZ2V0KGFyZyk7XG4gICAgICBpZiAoIW5leHQpIGMubmV4dC5zZXQoYXJnLCBuZXh0ID0ge30pO1xuICAgIH1cbiAgICBpZiAoIWMuY2FjaGVkKSB7XG4gICAgICBjLnZhbHVlID0gZi5hcHBseSh0aGlzLCBhcmdzKTtcbiAgICAgIGMuY2FjaGVkID0gdHJ1ZTtcbiAgICB9XG4gICAgcmV0dXJuIGMudmFsdWUgYXMgUjtcbiAgfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHN0cmNtcChsZWZ0OiBzdHJpbmcsIHJpZ2h0OiBzdHJpbmcpOiBudW1iZXIge1xuICBpZiAobGVmdCA8IHJpZ2h0KSByZXR1cm4gLTE7XG4gIGlmIChyaWdodCA8IGxlZnQpIHJldHVybiAxO1xuICByZXR1cm4gMDtcbn1cblxuLy8gZXhwb3J0IGNsYXNzIFByaW1lSWRHZW5lcmF0b3Ige1xuLy8gICBwcml2YXRlIF9pbmRleCA9IDA7XG4vLyAgIG5leHQoKTogbnVtYmVyIHtcbi8vICAgICBpZiAodGhpcy5faW5kZXggPj0gUFJJTUVTLmxlbmd0aCkgdGhyb3cgbmV3IEVycm9yKCdvdmVyZmxvdycpO1xuLy8gICAgIHJldHVybiBQUklNRVNbdGhpcy5faW5kZXgrK107XG4vLyAgIH1cbi8vIH1cbi8vIGNvbnN0IFBSSU1FUyA9ICgoKSA9PiB7XG4vLyAgIGNvbnN0IG4gPSAxMDAwMDtcbi8vICAgY29uc3Qgb3V0ID0gbmV3IFNldCgpO1xuLy8gICBmb3IgKGxldCBpID0gMjsgaSA8IG47IGkrKykgeyBvdXQuYWRkKGkpOyB9XG4vLyAgIGZvciAobGV0IGkgPSAyOyBpICogaSA8IG47IGkrKykge1xuLy8gICAgIGlmICghb3V0LmhhcyhpKSkgY29udGludWU7XG4vLyAgICAgZm9yIChsZXQgaiA9IDIgKiBpOyBqIDwgbjsgaiArPSBpKSB7XG4vLyAgICAgICBvdXQuZGVsZXRlKGopO1xuLy8gICAgIH1cbi8vICAgfVxuLy8gICByZXR1cm4gWy4uLm91dF07XG4vLyB9KSgpO1xuXG5leHBvcnQgY2xhc3MgS2V5ZWQ8SyBleHRlbmRzIG51bWJlciwgVj4gaW1wbGVtZW50cyBJdGVyYWJsZTxbSywgVl0+IHtcbiAgY29uc3RydWN0b3IocHJpdmF0ZSByZWFkb25seSBkYXRhOiByZWFkb25seSBWW10pIHt9XG5cbiAgZ2V0KGluZGV4OiBLKTogVnx1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmRhdGFbaW5kZXhdO1xuICB9XG5cbiAgW1N5bWJvbC5pdGVyYXRvcl0oKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YS5lbnRyaWVzKCkgYXMgSXRlcmFibGVJdGVyYXRvcjxbSywgVl0+O1xuICB9XG5cbiAgdmFsdWVzKCk6IEl0ZXJhdG9yPFY+IHtcbiAgICByZXR1cm4gdGhpcy5kYXRhW1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgQXJyYXlNYXA8SyBleHRlbmRzIG51bWJlciwgVj4gaW1wbGVtZW50cyBJdGVyYWJsZTxbSywgVl0+IHtcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHJldjogUmVhZG9ubHlNYXA8ViwgSz47XG4gIHJlYWRvbmx5IGxlbmd0aDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKHByaXZhdGUgcmVhZG9ubHkgZGF0YTogcmVhZG9ubHkgVltdKSB7XG4gICAgY29uc3QgcmV2ID0gbmV3IE1hcDxWLCBLPigpO1xuICAgIGZvciAobGV0IGkgPSAwIGFzIEs7IGkgPCBkYXRhLmxlbmd0aDsgaSsrKSB7XG4gICAgICByZXYuc2V0KGRhdGFbaV0sIGkpO1xuICAgIH1cbiAgICB0aGlzLnJldiA9IHJldjtcbiAgICB0aGlzLmxlbmd0aCA9IGRhdGEubGVuZ3RoO1xuICB9XG5cbiAgZ2V0KGluZGV4OiBLKTogVnx1bmRlZmluZWQge1xuICAgIHJldHVybiB0aGlzLmRhdGFbaW5kZXhdO1xuICB9XG5cbiAgaGFzVmFsdWUodmFsdWU6IFYpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5yZXYuaGFzKHZhbHVlKTtcbiAgfVxuXG4gIGluZGV4KHZhbHVlOiBWKTogS3x1bmRlZmluZWQge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5yZXYuZ2V0KHZhbHVlKTtcbiAgICBpZiAoaW5kZXggPT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGluZGV4IGZvciAke3ZhbHVlfWApO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIFtTeW1ib2wuaXRlcmF0b3JdKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGEuZW50cmllcygpIGFzIEl0ZXJhYmxlSXRlcmF0b3I8W0ssIFZdPjtcbiAgfVxuXG4gIHZhbHVlcygpOiBJdGVyYWJsZUl0ZXJhdG9yPFY+IHtcbiAgICByZXR1cm4gdGhpcy5kYXRhW1N5bWJvbC5pdGVyYXRvcl0oKTtcbiAgfVxufVxuXG5leHBvcnQgY2xhc3MgTXV0YWJsZUFycmF5QmlNYXA8SyBleHRlbmRzIG51bWJlciwgViBleHRlbmRzIG51bWJlcj4ge1xuICBwcml2YXRlIHJlYWRvbmx5IF9md2Q6IFZbXSA9IFtdO1xuICBwcml2YXRlIHJlYWRvbmx5IF9yZXY6IEtbXSA9IFtdO1xuXG4gICogW1N5bWJvbC5pdGVyYXRvcl0oKTogSXRlcmFibGVJdGVyYXRvcjxbSywgVl0+IHtcbiAgICBmb3IgKGxldCBpID0gMCBhcyBLOyBpIDwgdGhpcy5fZndkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBjb25zdCB2YWwgPSB0aGlzLl9md2RbaV07XG4gICAgICBpZiAodmFsICE9IG51bGwpIHlpZWxkIFtpLCB2YWxdO1xuICAgIH1cbiAgfVxuXG4gICoga2V5cygpOiBJdGVyYWJsZUl0ZXJhdG9yPEs+IHtcbiAgICBmb3IgKGxldCBpID0gMCBhcyBLOyBpIDwgdGhpcy5fZndkLmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAodGhpcy5fZndkW2ldICE9IG51bGwpIHlpZWxkIGk7XG4gICAgfVxuICB9XG5cbiAgKiB2YWx1ZXMoKTogSXRlcmFibGVJdGVyYXRvcjxWPiB7XG4gICAgZm9yIChsZXQgaSA9IDAgYXMgVjsgaSA8IHRoaXMuX3Jldi5sZW5ndGg7IGkrKykge1xuICAgICAgaWYgKHRoaXMuX3JldltpXSAhPSBudWxsKSB5aWVsZCBpO1xuICAgIH1cbiAgfVxuXG4gIGdldChpbmRleDogSyk6IFZ8dW5kZWZpbmVkIHtcbiAgICByZXR1cm4gdGhpcy5fZndkW2luZGV4XTtcbiAgfVxuXG4gIGhhcyhrZXk6IEspOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fZndkW2tleV0gIT0gbnVsbDtcbiAgfVxuXG4gIGhhc1ZhbHVlKHZhbHVlOiBWKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Jldlt2YWx1ZV0gIT0gbnVsbDtcbiAgfVxuXG4gIGluZGV4KHZhbHVlOiBWKTogS3x1bmRlZmluZWQge1xuICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fcmV2W3ZhbHVlXTtcbiAgICBpZiAoaW5kZXggPT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKGBNaXNzaW5nIGluZGV4IGZvciAke3ZhbHVlfWApO1xuICAgIHJldHVybiBpbmRleDtcbiAgfVxuXG4gIHNldChrZXk6IEssIHZhbHVlOiBWKSB7XG4gICAgaWYgKHRoaXMuX2Z3ZFtrZXldKSB0aHJvdyBuZXcgRXJyb3IoYGFscmVhZHkgaGFzIGtleSAke2tleX1gKTtcbiAgICBpZiAodGhpcy5fcmV2W3ZhbHVlXSkgdGhyb3cgbmV3IEVycm9yKGBhbHJlYWR5IGhhcyB2YWx1ZSAke3ZhbHVlfWApO1xuICAgIHRoaXMuX2Z3ZFtrZXldID0gdmFsdWU7XG4gICAgdGhpcy5fcmV2W3ZhbHVlXSA9IGtleTtcbiAgfVxuXG4gIHJlcGxhY2Uoa2V5OiBLLCB2YWx1ZTogVik6IFZ8dW5kZWZpbmVkIHtcbiAgICBjb25zdCBvbGRLZXkgPSB0aGlzLl9yZXZbdmFsdWVdO1xuICAgIGlmIChvbGRLZXkgIT0gbnVsbCkgZGVsZXRlIHRoaXMuX2Z3ZFtvbGRLZXldO1xuICAgIGNvbnN0IG9sZFZhbHVlID0gdGhpcy5fZndkW2tleV07XG4gICAgaWYgKG9sZFZhbHVlICE9IG51bGwpIGRlbGV0ZSB0aGlzLl9yZXZbb2xkVmFsdWVdO1xuICAgIHRoaXMuX2Z3ZFtrZXldID0gdmFsdWU7XG4gICAgdGhpcy5fcmV2W3ZhbHVlXSA9IGtleTtcbiAgICByZXR1cm4gb2xkVmFsdWU7XG4gIH1cblxufVxuIl19