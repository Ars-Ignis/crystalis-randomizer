export class Spoiler {
    constructor(rom) {
        this.rom = rom;
        this.slots = [];
        this.route = [];
        this.mazes = [];
        this.trades = [];
        this.walls = [];
        this.unidentifiedItems = [];
        this.wildWarps = [];
    }
    addCheck(condition, deps) {
        this.route.push(new Check(this, condition, deps));
    }
    addSlot(slot, slotName, item) {
        this.slots[slot & 0xff] =
            new Slot(this.rom, slot & 0xff, slotName, item & 0xff);
    }
    addMaze(id, name, maze) {
        this.mazes.push({ id, name, maze });
    }
    addTrade(itemId, item, npc) {
        this.trades.push({ itemId, item, npc });
    }
    addUnidentifiedItem(itemId, oldName, newName) {
        this.unidentifiedItems.push({ itemId, oldName, newName });
    }
    addWall(location, oldElement, newElement) {
        this.walls.push({ location, oldElement, newElement });
    }
    addWildWarp(id, name) {
        this.wildWarps.push({ id, name });
    }
    formatCondition(id) {
        var _a;
        return (_a = this.rom.flags[id]) === null || _a === void 0 ? void 0 : _a.name;
    }
    formatConditionList(conditions) {
        var _a;
        const terms = [];
        for (const c of conditions) {
            const f = this.rom.flags[c];
            if ((_a = f) === null || _a === void 0 ? void 0 : _a.logic.track)
                terms.push(f.name);
        }
        return terms.join(', ');
    }
}
class Check {
    constructor(spoiler, condition, deps) {
        this.spoiler = spoiler;
        this.condition = condition;
        this.deps = deps;
    }
    toString() {
        let item = 0;
        if ((this.condition & ~0x7f) === 0x100) {
            item = 0x200 | this.spoiler.rom.slots[this.condition & 0xff];
        }
        return `${this.spoiler.formatCondition(this.condition)}${item ? ` (${this.spoiler.formatCondition(item)})` : ''}: [${this.spoiler.formatConditionList(this.deps)}]`;
    }
}
class Slot {
    constructor(rom, slot, slotName, item) {
        this.slot = slot;
        this.slotName = slotName;
        this.item = item;
        this.itemName = slotToItem(rom, item);
        this.originalItem = slotToItem(rom, slot);
    }
    toString() {
        return `${this.itemName}: ${this.slotName} (${this.originalItem})`;
    }
}
function slotToItem(rom, slot) {
    if (slot >= 0x70)
        return 'Mimic';
    return rom.items[rom.itemGets[slot].itemId].messageName;
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3BvaWxlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9yb20vc3BvaWxlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFXQSxNQUFNLE9BQU8sT0FBTztJQVdsQixZQUFxQixHQUFRO1FBQVIsUUFBRyxHQUFILEdBQUcsQ0FBSztRQVZwQixVQUFLLEdBQVcsRUFBRSxDQUFDO1FBQ25CLFVBQUssR0FBWSxFQUFFLENBQUM7UUFDcEIsVUFBSyxHQUFXLEVBQUUsQ0FBQztRQUNuQixXQUFNLEdBQVksRUFBRSxDQUFDO1FBQ3JCLFVBQUssR0FBVyxFQUFFLENBQUM7UUFDbkIsc0JBQWlCLEdBQXVCLEVBQUUsQ0FBQztRQUMzQyxjQUFTLEdBQWUsRUFBRSxDQUFDO0lBSUosQ0FBQztJQUVqQyxRQUFRLENBQUMsU0FBaUIsRUFBRSxJQUF1QjtRQUNqRCxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7SUFDcEQsQ0FBQztJQUVELE9BQU8sQ0FBQyxJQUFZLEVBQUUsUUFBZ0IsRUFBRSxJQUFZO1FBQ2xELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxHQUFHLElBQUksQ0FBQztZQUNuQixJQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsR0FBRyxFQUFFLElBQUksR0FBRyxJQUFJLEVBQUUsUUFBUSxFQUFFLElBQUksR0FBRyxJQUFJLENBQUMsQ0FBQztJQUM3RCxDQUFDO0lBRUQsT0FBTyxDQUFDLEVBQVUsRUFBRSxJQUFZLEVBQUUsSUFBWTtRQUM1QyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxFQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztJQUNwQyxDQUFDO0lBRUQsUUFBUSxDQUFDLE1BQWMsRUFBRSxJQUFZLEVBQUUsR0FBVztRQUNoRCxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsR0FBRyxFQUFDLENBQUMsQ0FBQztJQUN4QyxDQUFDO0lBRUQsbUJBQW1CLENBQUMsTUFBYyxFQUFFLE9BQWUsRUFBRSxPQUFlO1FBQ2xFLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLENBQUMsRUFBQyxNQUFNLEVBQUUsT0FBTyxFQUFFLE9BQU8sRUFBQyxDQUFDLENBQUM7SUFDMUQsQ0FBQztJQUVELE9BQU8sQ0FBQyxRQUFnQixFQUFFLFVBQWtCLEVBQUUsVUFBa0I7UUFDOUQsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBQyxRQUFRLEVBQUUsVUFBVSxFQUFFLFVBQVUsRUFBQyxDQUFDLENBQUM7SUFDdEQsQ0FBQztJQUVELFdBQVcsQ0FBQyxFQUFVLEVBQUUsSUFBWTtRQUNsQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxFQUFDLEVBQUUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO0lBQ2xDLENBQUM7SUFFRCxlQUFlLENBQUMsRUFBVTs7UUFDeEIsYUFBTyxJQUFJLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsMENBQUUsSUFBSSxDQUFBO0lBQ2pDLENBQUM7SUFFRCxtQkFBbUIsQ0FBQyxVQUE2Qjs7UUFDL0MsTUFBTSxLQUFLLEdBQWEsRUFBRSxDQUFDO1FBQzNCLEtBQUssTUFBTSxDQUFDLElBQUksVUFBVSxFQUFFO1lBQzFCLE1BQU0sQ0FBQyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1lBQzVCLFVBQUksQ0FBQywwQ0FBRSxLQUFLLENBQUMsS0FBSztnQkFBRSxLQUFLLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQztTQUN4QztRQUNELE9BQU8sS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMxQixDQUFDO0NBQ0Y7QUErQkQsTUFBTSxLQUFLO0lBQ1QsWUFBcUIsT0FBZ0IsRUFDaEIsU0FBaUIsRUFDakIsSUFBdUI7UUFGdkIsWUFBTyxHQUFQLE9BQU8sQ0FBUztRQUNoQixjQUFTLEdBQVQsU0FBUyxDQUFRO1FBQ2pCLFNBQUksR0FBSixJQUFJLENBQW1CO0lBQUcsQ0FBQztJQUVoRCxRQUFRO1FBQ04sSUFBSSxJQUFJLEdBQUcsQ0FBQyxDQUFDO1FBQ2IsSUFBSSxDQUFDLElBQUksQ0FBQyxTQUFTLEdBQUcsQ0FBQyxJQUFJLENBQUMsS0FBSyxLQUFLLEVBQUU7WUFDdEMsSUFBSSxHQUFHLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFNBQVMsR0FBRyxJQUFJLENBQUMsQ0FBQztTQUM5RDtRQUNELE9BQU8sR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLEdBQzlDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUMsT0FBTyxDQUFDLGVBQWUsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUNwRCxNQUFNLElBQUksQ0FBQyxPQUFPLENBQUMsbUJBQW1CLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDL0QsQ0FBQztDQUNGO0FBRUQsTUFBTSxJQUFJO0lBSVIsWUFBWSxHQUFRLEVBQ0MsSUFBWSxFQUNaLFFBQWdCLEVBQ2hCLElBQVk7UUFGWixTQUFJLEdBQUosSUFBSSxDQUFRO1FBQ1osYUFBUSxHQUFSLFFBQVEsQ0FBUTtRQUNoQixTQUFJLEdBQUosSUFBSSxDQUFRO1FBQy9CLElBQUksQ0FBQyxRQUFRLEdBQUcsVUFBVSxDQUFDLEdBQUcsRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN0QyxJQUFJLENBQUMsWUFBWSxHQUFHLFVBQVUsQ0FBQyxHQUFHLEVBQUUsSUFBSSxDQUFDLENBQUM7SUFDNUMsQ0FBQztJQUVELFFBQVE7UUFFTixPQUFPLEdBQUcsSUFBSSxDQUFDLFFBQVEsS0FBSyxJQUFJLENBQUMsUUFBUSxLQUFLLElBQUksQ0FBQyxZQUFZLEdBQUcsQ0FBQztJQUNyRSxDQUFDO0NBQ0Y7QUFFRCxTQUFTLFVBQVUsQ0FBQyxHQUFRLEVBQUUsSUFBWTtJQUN4QyxJQUFJLElBQUksSUFBSSxJQUFJO1FBQUUsT0FBTyxPQUFPLENBQUM7SUFDakMsT0FBTyxHQUFHLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsV0FBVyxDQUFDO0FBQzFELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcblxuLyoqXG4gKiBTdG9yZXMgb3JnYW5pemVkIGluZm9ybWF0aW9uIGFib3V0IHRoZSBzaHVmZmxlLCBpbmNsdWRpbmdcbiAqICAgLSB3aGljaCBpdGVtcyBhcmUgaW4gd2hpY2ggc2xvdHNcbiAqICAgLSBhIGtub3duLXdvcmtpbmcgcm91dGUgdGhyb3VnaCB0aGUgZ2FtZVxuICogICAtIHdoaWNoIGVuZW1pZXMgYXJlIHNodWZmbGUgd2hlcmVcbiAqICAgLSBlbmVteSB2dWxuZXJhYmlsaXRpZXNcbiAqICAgLSBsb2NhdGlvbiBjb25uZWN0aW9uc1xuICogICAtIHJvdXRlcyB0byBlYWNoIGFyZWFcbiAqL1xuZXhwb3J0IGNsYXNzIFNwb2lsZXIge1xuICByZWFkb25seSBzbG90czogU2xvdFtdID0gW107XG4gIHJlYWRvbmx5IHJvdXRlOiBDaGVja1tdID0gW107XG4gIHJlYWRvbmx5IG1hemVzOiBNYXplW10gPSBbXTtcbiAgcmVhZG9ubHkgdHJhZGVzOiBUcmFkZVtdID0gW107XG4gIHJlYWRvbmx5IHdhbGxzOiBXYWxsW10gPSBbXTtcbiAgcmVhZG9ubHkgdW5pZGVudGlmaWVkSXRlbXM6IFVuaWRlbnRpZmllZEl0ZW1bXSA9IFtdO1xuICByZWFkb25seSB3aWxkV2FycHM6IFdpbGRXYXJwW10gPSBbXTtcblxuICAvLyBUT0RPIC0gc2hvcHMsIGJvc3Mgd2Vha25lc3Nlc1xuXG4gIGNvbnN0cnVjdG9yKHJlYWRvbmx5IHJvbTogUm9tKSB7fVxuXG4gIGFkZENoZWNrKGNvbmRpdGlvbjogbnVtYmVyLCBkZXBzOiByZWFkb25seSBudW1iZXJbXSk6IHZvaWQge1xuICAgIHRoaXMucm91dGUucHVzaChuZXcgQ2hlY2sodGhpcywgY29uZGl0aW9uLCBkZXBzKSk7XG4gIH1cblxuICBhZGRTbG90KHNsb3Q6IG51bWJlciwgc2xvdE5hbWU6IHN0cmluZywgaXRlbTogbnVtYmVyKTogdm9pZCB7XG4gICAgdGhpcy5zbG90c1tzbG90ICYgMHhmZl0gPVxuICAgICAgICBuZXcgU2xvdCh0aGlzLnJvbSwgc2xvdCAmIDB4ZmYsIHNsb3ROYW1lLCBpdGVtICYgMHhmZik7XG4gIH1cblxuICBhZGRNYXplKGlkOiBudW1iZXIsIG5hbWU6IHN0cmluZywgbWF6ZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5tYXplcy5wdXNoKHtpZCwgbmFtZSwgbWF6ZX0pO1xuICB9XG5cbiAgYWRkVHJhZGUoaXRlbUlkOiBudW1iZXIsIGl0ZW06IHN0cmluZywgbnBjOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnRyYWRlcy5wdXNoKHtpdGVtSWQsIGl0ZW0sIG5wY30pO1xuICB9XG5cbiAgYWRkVW5pZGVudGlmaWVkSXRlbShpdGVtSWQ6IG51bWJlciwgb2xkTmFtZTogc3RyaW5nLCBuZXdOYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnVuaWRlbnRpZmllZEl0ZW1zLnB1c2goe2l0ZW1JZCwgb2xkTmFtZSwgbmV3TmFtZX0pO1xuICB9XG5cbiAgYWRkV2FsbChsb2NhdGlvbjogc3RyaW5nLCBvbGRFbGVtZW50OiBudW1iZXIsIG5ld0VsZW1lbnQ6IG51bWJlcik6IHZvaWQge1xuICAgIHRoaXMud2FsbHMucHVzaCh7bG9jYXRpb24sIG9sZEVsZW1lbnQsIG5ld0VsZW1lbnR9KTtcbiAgfVxuXG4gIGFkZFdpbGRXYXJwKGlkOiBudW1iZXIsIG5hbWU6IHN0cmluZyk6IHZvaWQge1xuICAgIHRoaXMud2lsZFdhcnBzLnB1c2goe2lkLCBuYW1lfSk7XG4gIH1cblxuICBmb3JtYXRDb25kaXRpb24oaWQ6IG51bWJlcik6IHN0cmluZyB7XG4gICAgcmV0dXJuIHRoaXMucm9tLmZsYWdzW2lkXT8ubmFtZVxuICB9XG5cbiAgZm9ybWF0Q29uZGl0aW9uTGlzdChjb25kaXRpb25zOiByZWFkb25seSBudW1iZXJbXSk6IHN0cmluZyB7XG4gICAgY29uc3QgdGVybXM6IHN0cmluZ1tdID0gW107XG4gICAgZm9yIChjb25zdCBjIG9mIGNvbmRpdGlvbnMpIHtcbiAgICAgIGNvbnN0IGYgPSB0aGlzLnJvbS5mbGFnc1tjXTtcbiAgICAgIGlmIChmPy5sb2dpYy50cmFjaykgdGVybXMucHVzaChmLm5hbWUpO1xuICAgIH1cbiAgICByZXR1cm4gdGVybXMuam9pbignLCAnKTtcbiAgfVxufVxuXG5pbnRlcmZhY2UgTWF6ZSB7XG4gIGlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbiAgbWF6ZTogc3RyaW5nO1xufVxuXG5pbnRlcmZhY2UgVHJhZGUge1xuICBpdGVtSWQ6IG51bWJlcjtcbiAgaXRlbTogc3RyaW5nO1xuICBucGM6IHN0cmluZztcbn1cblxuaW50ZXJmYWNlIFVuaWRlbnRpZmllZEl0ZW0ge1xuICBpdGVtSWQ6IG51bWJlcjtcbiAgb2xkTmFtZTogc3RyaW5nO1xuICBuZXdOYW1lOiBzdHJpbmc7XG59XG5cbmludGVyZmFjZSBXYWxsIHtcbiAgbG9jYXRpb246IHN0cmluZztcbiAgb2xkRWxlbWVudDogbnVtYmVyO1xuICBuZXdFbGVtZW50OiBudW1iZXI7XG59XG5cbmludGVyZmFjZSBXaWxkV2FycCB7XG4gIGlkOiBudW1iZXI7XG4gIG5hbWU6IHN0cmluZztcbn1cblxuY2xhc3MgQ2hlY2sge1xuICBjb25zdHJ1Y3RvcihyZWFkb25seSBzcG9pbGVyOiBTcG9pbGVyLFxuICAgICAgICAgICAgICByZWFkb25seSBjb25kaXRpb246IG51bWJlcixcbiAgICAgICAgICAgICAgcmVhZG9ubHkgZGVwczogcmVhZG9ubHkgbnVtYmVyW10pIHt9XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICBsZXQgaXRlbSA9IDA7XG4gICAgaWYgKCh0aGlzLmNvbmRpdGlvbiAmIH4weDdmKSA9PT0gMHgxMDApIHtcbiAgICAgIGl0ZW0gPSAweDIwMCB8IHRoaXMuc3BvaWxlci5yb20uc2xvdHNbdGhpcy5jb25kaXRpb24gJiAweGZmXTtcbiAgICB9XG4gICAgcmV0dXJuIGAke3RoaXMuc3BvaWxlci5mb3JtYXRDb25kaXRpb24odGhpcy5jb25kaXRpb24pfSR7XG4gICAgICAgICAgICBpdGVtID8gYCAoJHt0aGlzLnNwb2lsZXIuZm9ybWF0Q29uZGl0aW9uKGl0ZW0pfSlgIDogJydcbiAgICAgICAgICAgIH06IFske3RoaXMuc3BvaWxlci5mb3JtYXRDb25kaXRpb25MaXN0KHRoaXMuZGVwcyl9XWA7XG4gIH1cbn1cblxuY2xhc3MgU2xvdCB7XG4gIHJlYWRvbmx5IGl0ZW1OYW1lOiBzdHJpbmc7XG4gIHJlYWRvbmx5IG9yaWdpbmFsSXRlbTogc3RyaW5nO1xuXG4gIGNvbnN0cnVjdG9yKHJvbTogUm9tLFxuICAgICAgICAgICAgICByZWFkb25seSBzbG90OiBudW1iZXIsXG4gICAgICAgICAgICAgIHJlYWRvbmx5IHNsb3ROYW1lOiBzdHJpbmcsXG4gICAgICAgICAgICAgIHJlYWRvbmx5IGl0ZW06IG51bWJlcikge1xuICAgIHRoaXMuaXRlbU5hbWUgPSBzbG90VG9JdGVtKHJvbSwgaXRlbSk7XG4gICAgdGhpcy5vcmlnaW5hbEl0ZW0gPSBzbG90VG9JdGVtKHJvbSwgc2xvdCk7XG4gIH1cblxuICB0b1N0cmluZygpOiBzdHJpbmcge1xuICAgIC8vIEZpZ3VyZSBvdXQgdGhlIG5hbWUgb2YgdGhlIHNsb3QsIHRoZSBvcmlnaW5hbCBpdGVtLCBldGNcbiAgICByZXR1cm4gYCR7dGhpcy5pdGVtTmFtZX06ICR7dGhpcy5zbG90TmFtZX0gKCR7dGhpcy5vcmlnaW5hbEl0ZW19KWA7XG4gIH1cbn1cblxuZnVuY3Rpb24gc2xvdFRvSXRlbShyb206IFJvbSwgc2xvdDogbnVtYmVyKTogc3RyaW5nIHtcbiAgaWYgKHNsb3QgPj0gMHg3MCkgcmV0dXJuICdNaW1pYyc7XG4gIHJldHVybiByb20uaXRlbXNbcm9tLml0ZW1HZXRzW3Nsb3RdLml0ZW1JZF0ubWVzc2FnZU5hbWU7XG59XG4iXX0=