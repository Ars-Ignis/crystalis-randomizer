import { Entity, EntityArray } from './entity.js';
import { MessageId } from './messageid.js';
import { hex, readLittleEndian, readString, seq, writeLittleEndian, ITEM_USE_FLAGS, ITEM_CONDITION_FLAGS } from './util.js';
import { assertNever } from '../util.js';
const ITEM_USE_JUMP_TABLE = 0x1c399;
const ITEM_USE_DATA_TABLE = 0x1dbe2;
const ITEM_DATA_TABLE = 0x20ff0;
const SELECTED_ITEM_TABLE = 0x2103b;
const VANILLA_PAWN_PRICE_TABLE = 0x21ec2;
const MENU_NAME_TABLE = 0x21086;
const MESSAGE_NAME_TABLE = 0x28a5c;
const MENU_NAME_ENCODE = [
    ['Sword', '\x0a\x0b\x0c'],
    [' of ', '\x5c\x5d'],
    ['Bracelet', '\x3c\x3d\x3e\x5b'],
    ['Shield', '\x0d\x0e\x0f'],
    ['Armor', '\x7b\x11\x12'],
    ['Magic', '\x23\x25\x28'],
    ['Power', '\x13\x14\x15'],
    ['Item', '\x16\x17\x5e'],
];
export class Item extends Entity {
    constructor(items, id, opts = {}) {
        super(items.rom, id);
        this.itemUseJump = 0;
        const rom = this.rom;
        items[id] = this;
        this.itemUseData = [];
        this.trades = opts.trades || [];
        this.use = opts.use || false;
        this.weight = opts.weight || 1;
        if (this.use) {
            this.itemUseJump = readLittleEndian(rom.prg, this.itemUseJumpPointer) + 0x14000;
            const entries = items.itemUseJumps[this.itemUseJump];
            if (!entries)
                throw new Error(`Bad ItemUseJump: ${this.itemUseJump}`);
            let itemUseOffset = readLittleEndian(rom.prg, this.itemUseDataPointer) + 0x14000;
            for (const entry of entries) {
                const data = ItemUse.from(entry, rom.prg, itemUseOffset);
                this.itemUseData.push(data);
                itemUseOffset += data.length;
            }
        }
        this.itemDataValue = rom.prg[this.itemDataPointer];
        this.selectedItemValue = rom.prg[this.selectedItemPointer];
        if (rom.shopDataTablesAddress != null) {
            const address = rom.shopDataTablesAddress +
                21 * rom.shopCount +
                2 * rom.scalingLevels +
                2 * (id - 0xd);
            this.basePrice = id >= 0xd && id < 0x27 ? readLittleEndian(rom.prg, address) : 0;
        }
        else {
            const address = VANILLA_PAWN_PRICE_TABLE + 2 * id;
            this.basePrice = readLittleEndian(rom.prg, address) * 2;
        }
        const messageNameBase = readLittleEndian(rom.prg, this.messageNamePointer) + 0x20000;
        this.messageName = readString(rom.prg, messageNameBase);
        const menuNameBase = readLittleEndian(rom.prg, this.menuNamePointer) + 0x18000;
        this.menuName = MENU_NAME_ENCODE.reduce((s, [d, e]) => s.replace(e, d), readString(rom.prg, menuNameBase, 0xff));
    }
    get itemUseJumpPointer() {
        return ITEM_USE_JUMP_TABLE + 2 * this.id;
    }
    get itemUseDataPointer() {
        return ITEM_USE_DATA_TABLE + 2 * this.id;
    }
    get itemDataPointer() {
        return ITEM_DATA_TABLE + this.id;
    }
    get selectedItemPointer() {
        return SELECTED_ITEM_TABLE + this.id;
    }
    get messageNamePointer() {
        return MESSAGE_NAME_TABLE + 2 * this.id;
    }
    get menuNamePointer() {
        return MENU_NAME_TABLE + 2 * this.id;
    }
    itemUseMessages() {
        const messages = new Map();
        for (const { message } of this.itemUseData) {
            messages.set(message.mid(), message);
        }
        return [...messages.values()];
    }
    setName(name) {
        this.messageName = this.menuName = name;
    }
    get palette() { return this.itemDataValue & 3; }
    set palette(p) { this.itemDataValue = this.itemDataValue & ~3 | (p & 3); }
    get unique() { return !!(this.itemDataValue & 0x40); }
    set unique(u) { this.itemDataValue = this.itemDataValue & ~0x40 | (u ? 0x40 : 0); }
    get worn() { return !!(this.itemDataValue & 0x20); }
    set worn(w) { this.itemDataValue = this.itemDataValue & ~0x20 | (w ? 0x20 : 0); }
    get solid() { return !!(this.itemDataValue & 0x80); }
    set solid(s) { this.itemDataValue = this.itemDataValue & ~0x80 | (s ? 0x80 : 0); }
    async write(writer) {
        writer.rom[this.itemDataPointer] = this.itemDataValue;
        writer.rom[this.selectedItemPointer] = this.selectedItemValue;
        if (this.rom.shopDataTablesAddress != null) {
            if (this.id >= 0xd && this.id < 0x27) {
                const address = this.rom.shopDataTablesAddress +
                    21 * this.rom.shopCount +
                    2 * this.rom.scalingLevels +
                    2 * (this.id - 0xd);
                writeLittleEndian(writer.rom, address, this.basePrice);
            }
        }
        else {
            const address = VANILLA_PAWN_PRICE_TABLE + 2 * this.id;
            writeLittleEndian(writer.rom, address, this.basePrice >>> 1);
        }
        const menuNameEncoded = MENU_NAME_ENCODE.reduce((s, [d, e]) => s.replace(d, e), this.menuName);
        const menuAddress = await writer.write([...stringToBytes(menuNameEncoded), 0xff], 0x20000, 0x21fff, `ItemMenuName ${hex(this.id)}`);
        writeLittleEndian(writer.rom, this.menuNamePointer, menuAddress - 0x18000);
        if (this.use) {
            writeLittleEndian(writer.rom, this.itemUseJumpPointer, this.itemUseJump - 0x14000);
            const itemUseData = [];
            for (const use of this.itemUseData) {
                itemUseData.push(...use.bytes());
            }
            const itemUseAddress = await writer.write(itemUseData, 0x1c000, 0x1ffff, `ItemUseData ${hex(this.id)}`);
            writeLittleEndian(writer.rom, this.itemUseDataPointer, itemUseAddress - 0x14000);
        }
    }
    isMagic() {
        return this.id >= 0x41 && this.id <= 0x48;
    }
}
const stringToBytes = (s) => {
    return seq(s.length, i => s.charCodeAt(i));
};
export class ItemUse {
    constructor(kind, want, message, flags) {
        this.kind = kind;
        this.want = want;
        this.message = message;
        this.flags = flags;
    }
    static from(kind, data, offset) {
        let want = 0;
        if (kind === 'expect' || kind === 'screen') {
            want = data[offset + 1] << 8 | data[offset];
            offset += 2;
        }
        else if (kind === 'flag') {
            const flags = ITEM_CONDITION_FLAGS.read(data, offset);
            if (!flags.length)
                flags.push(~0);
            if (flags.length > 1)
                throw new Error(`Flag list too long: ${flags}`);
            want = flags[0];
            offset += 2;
        }
        else if (kind === 'location') {
            want = data[offset++];
        }
        else if (kind !== 'empty') {
            assertNever(kind);
        }
        const message = MessageId.from(data, offset);
        const flags = ITEM_USE_FLAGS.read(data, offset + 2);
        return new ItemUse(kind, want, message, flags);
    }
    bytes() {
        const bytes = [];
        if (this.kind === 'expect' || this.kind === 'screen') {
            bytes.push(this.want & 0xff, (this.want >>> 8) & 0xff);
        }
        else if (this.kind === 'flag') {
            const flagBytes = ITEM_CONDITION_FLAGS.bytes([this.want]);
            if (flagBytes.length !== 2)
                throw new Error(`bad data: ${flagBytes}`);
            bytes.push(...flagBytes);
        }
        else if (this.kind === 'location') {
            bytes.push(this.want);
        }
        else if (this.kind !== 'empty') {
            assertNever(this.kind);
        }
        bytes.push(...this.message.data);
        bytes.push(...ITEM_USE_FLAGS.bytes(this.flags));
        return bytes;
    }
    tradeNpc() {
        if (this.kind !== 'expect')
            return null;
        if ((this.want >>> 8) !== 1)
            return null;
        return this.want & 0xff;
    }
    get length() {
        const header = this.kind === 'empty' ? 0 : this.kind === 'location' ? 1 : 2;
        return 2 * (1 + Math.max(1, this.flags.length)) + header;
    }
}
export class Items extends EntityArray {
    constructor(rom) {
        super(0x49);
        this.rom = rom;
        this.itemUseJumps = DEFAULT_ITEM_USE_JUMPS;
        this.SwordOfWind = new Item(this, 0x00);
        this.SwordOfFire = new Item(this, 0x01);
        this.SwordOfWater = new Item(this, 0x02);
        this.SwordOfThunder = new Item(this, 0x03);
        this.Crystalis = new Item(this, 0x04);
        this.BallOfWind = new Item(this, 0x05);
        this.TornadoBracelet = new Item(this, 0x06);
        this.BallOfFire = new Item(this, 0x07);
        this.FlameBracelet = new Item(this, 0x08);
        this.BallOfWater = new Item(this, 0x09);
        this.BlizzardBracelet = new Item(this, 0x0a);
        this.BallOfThunder = new Item(this, 0x0b);
        this.StormBracelet = new Item(this, 0x0c);
        this.CarapaceShield = new Item(this, 0x0d);
        this.BronzeShield = new Item(this, 0x0e);
        this.PlatinumShield = new Item(this, 0x0f);
        this.MirroredShield = new Item(this, 0x10);
        this.CeramicShield = new Item(this, 0x11);
        this.SacredShield = new Item(this, 0x12);
        this.BattleShield = new Item(this, 0x13);
        this.PsychoShield = new Item(this, 0x14);
        this.TannedHide = new Item(this, 0x15);
        this.LeatherArmor = new Item(this, 0x16);
        this.BronzeArmor = new Item(this, 0x17);
        this.PlatinumArmor = new Item(this, 0x18);
        this.SoldierSuit = new Item(this, 0x19);
        this.CeramicSuit = new Item(this, 0x1a);
        this.BattleArmor = new Item(this, 0x1b);
        this.PsychoArmor = new Item(this, 0x1c);
        this.MedicalHerb = new Item(this, 0x1d, { use: true, trades: [0] });
        this.Antidote = new Item(this, 0x1e, { use: true });
        this.LysisPlant = new Item(this, 0x1f, { use: true });
        this.FruitOfLime = new Item(this, 0x20, { use: true });
        this.FruitOfPower = new Item(this, 0x21, { use: true });
        this.MagicRing = new Item(this, 0x22, { use: true });
        this.FruitOfRepun = new Item(this, 0x23, { use: true });
        this.WarpBoots = new Item(this, 0x24, { use: true });
        this.StatueOfOnyx = new Item(this, 0x25, { use: true, trades: [0] });
        this.OpelStatue = new Item(this, 0x26, { use: true });
        this.InsectFlute = new Item(this, 0x27, { use: true });
        this.FluteOfLime = new Item(this, 0x28, { use: true,
            trades: [0, 1, 2, 3] });
        this.GasMask = new Item(this, 0x29);
        this.PowerRing = new Item(this, 0x2a);
        this.WarriorRing = new Item(this, 0x2b);
        this.IronNecklace = new Item(this, 0x2c);
        this.DeosPendant = new Item(this, 0x2d);
        this.RabbitBoots = new Item(this, 0x2e);
        this.LeatherBoots = new Item(this, 0x2f);
        this.ShieldRing = new Item(this, 0x30);
        this.AlarmFlute = new Item(this, 0x31, { use: true, trades: [0, 1] });
        this.WindmillKey = new Item(this, 0x32, { use: true });
        this.KeyToPrison = new Item(this, 0x33, { use: true });
        this.KeyToStyx = new Item(this, 0x34, { use: true });
        this.FogLamp = new Item(this, 0x35, { use: true, trades: [0] });
        this.ShellFlute = new Item(this, 0x36, { use: true });
        this.EyeGlasses = new Item(this, 0x37, { use: true });
        this.BrokenStatue = new Item(this, 0x38, { use: true });
        this.GlowingLamp = new Item(this, 0x39, { use: true });
        this.StatueOfGold = new Item(this, 0x3a, { use: true });
        this.LovePendant = new Item(this, 0x3b, { use: true, trades: [0] });
        this.KirisaPlant = new Item(this, 0x3c, { use: true, trades: [0] });
        this.IvoryStatue = new Item(this, 0x3d, { use: true, trades: [0] });
        this.BowOfMoon = new Item(this, 0x3e, { use: true });
        this.BowOfSun = new Item(this, 0x3f, { use: true });
        this.BowOfTruth = new Item(this, 0x40, { use: true });
        this.Refresh = new Item(this, 0x41);
        this.Paralysis = new Item(this, 0x42);
        this.Telepathy = new Item(this, 0x43);
        this.Teleport = new Item(this, 0x44);
        this.Recover = new Item(this, 0x45);
        this.Barrier = new Item(this, 0x46);
        this.Change = new Item(this, 0x47);
        this.Flight = new Item(this, 0x48);
    }
    async write(writer) {
        const promises = [];
        for (const item of this) {
            promises.push(item.write(writer));
        }
        await Promise.all(promises);
    }
}
const DEFAULT_ITEM_USE_JUMPS = {
    0x1c439: ['expect'],
    0x1c442: ['screen'],
    0x1c450: ['empty'],
    0x1c451: ['screen'],
    0x1c45f: ['location'],
    0x1c491: ['expect'],
    0x1c4a9: ['expect', 'expect'],
    0x1c4b3: ['location'],
    0x1c4d0: ['expect'],
    0x1c4db: [],
    0x1c4e0: ['expect', 'empty'],
    0x1c507: ['empty'],
    0x1c51d: ['empty'],
    0x1c524: ['empty'],
    0x1c52f: ['empty'],
    0x1c53a: ['empty'],
    0x1c54a: ['empty'],
    0x1c564: ['empty'],
    0x1c565: ['expect'],
    0x1c56b: ['flag'],
    0x1c585: ['empty'],
    0x1c59e: ['expect', 'expect', 'expect', 'expect'],
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9yb20vaXRlbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFFLFdBQVcsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUNoRCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDekMsT0FBTyxFQUFDLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLGlCQUFpQixFQUN6RCxjQUFjLEVBQUUsb0JBQW9CLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFJL0QsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV2QyxNQUFNLG1CQUFtQixHQUFHLE9BQU8sQ0FBQztBQUNwQyxNQUFNLG1CQUFtQixHQUFHLE9BQU8sQ0FBQztBQUNwQyxNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUM7QUFDaEMsTUFBTSxtQkFBbUIsR0FBRyxPQUFPLENBQUM7QUFDcEMsTUFBTSx3QkFBd0IsR0FBRyxPQUFPLENBQUM7QUFDekMsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDO0FBQ2hDLE1BQU0sa0JBQWtCLEdBQUcsT0FBTyxDQUFDO0FBR25DLE1BQU0sZ0JBQWdCLEdBQUc7SUFDdkIsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDO0lBQ3pCLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQztJQUNwQixDQUFDLFVBQVUsRUFBRSxrQkFBa0IsQ0FBQztJQUNoQyxDQUFDLFFBQVEsRUFBRSxjQUFjLENBQUM7SUFDMUIsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDO0lBQ3pCLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQztJQUN6QixDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUM7SUFDekIsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDO0NBQ3pCLENBQUM7QUFTRixNQUFNLE9BQU8sSUFBSyxTQUFRLE1BQU07SUFxQjlC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QWEsR0FBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFeEMsbUJBQWMsR0FBSyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsbUJBQWMsR0FBSyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsbUJBQWMsR0FBSyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsa0JBQWEsR0FBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFeEMsZUFBVSxHQUFTLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxrQkFBYSxHQUFNLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FB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ckUsZ0JBQVcsR0FBUSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7UUFDckQsZ0JBQVcsR0FBUSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7UUFDckQsY0FBUyxHQUFVLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxZQUFPLEdBQVksSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO1FBQ2xFLGVBQVUsR0FBUyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7UUFDckQsZUFBVSxHQUFTLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENB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T0FBTyxFQUFFLENBQUMsUUFBUSxDQUFDO0lBRW5CLE9BQU8sRUFBRSxDQUFDLE1BQU0sQ0FBQztJQUVqQixPQUFPLEVBQUUsQ0FBQyxPQUFPLENBQUM7SUFFbEIsT0FBTyxFQUFFLENBQUMsUUFBUSxFQUFFLFFBQVEsRUFBRSxRQUFRLEVBQUUsUUFBUSxDQUFDO0NBQ2xELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0VudGl0eSwgRW50aXR5QXJyYXl9IGZyb20gJy4vZW50aXR5LmpzJztcbmltcG9ydCB7TWVzc2FnZUlkfSBmcm9tICcuL21lc3NhZ2VpZC5qcyc7XG5pbXBvcnQge2hleCwgcmVhZExpdHRsZUVuZGlhbiwgcmVhZFN0cmluZywgc2VxLCB3cml0ZUxpdHRsZUVuZGlhbixcbiAgICAgICAgSVRFTV9VU0VfRkxBR1MsIElURU1fQ09ORElUSU9OX0ZMQUdTfSBmcm9tICcuL3V0aWwuanMnO1xuaW1wb3J0IHtXcml0ZXJ9IGZyb20gJy4vd3JpdGVyLmpzJztcbmltcG9ydCB7RGF0YX0gZnJvbSAnLi91dGlsLmpzJztcbmltcG9ydCB7Um9tfSBmcm9tICcuLi9yb20uanMnO1xuaW1wb3J0IHthc3NlcnROZXZlcn0gZnJvbSAnLi4vdXRpbC5qcyc7XG5cbmNvbnN0IElURU1fVVNFX0pVTVBfVEFCTEUgPSAweDFjMzk5O1xuY29uc3QgSVRFTV9VU0VfREFUQV9UQUJMRSA9IDB4MWRiZTI7XG5jb25zdCBJVEVNX0RBVEFfVEFCTEUgPSAweDIwZmYwO1xuY29uc3QgU0VMRUNURURfSVRFTV9UQUJMRSA9IDB4MjEwM2I7XG5jb25zdCBWQU5JTExBX1BBV05fUFJJQ0VfVEFCTEUgPSAweDIxZWMyO1xuY29uc3QgTUVOVV9OQU1FX1RBQkxFID0gMHgyMTA4NjtcbmNvbnN0IE1FU1NBR0VfTkFNRV9UQUJMRSA9IDB4MjhhNWM7IC8vIE5PVEU6IGludGVncmF0ZSB3aXRoIG1lc3NhZ2VzIGVudGl0eT9cblxuLy8gTWFwIHRvIHBhdHRlcm4gZW50cmllcyBmb3IgY29tYmluYXRpb25zIG9mIGxldHRlcnMuXG5jb25zdCBNRU5VX05BTUVfRU5DT0RFID0gW1xuICBbJ1N3b3JkJywgJ1xceDBhXFx4MGJcXHgwYyddLFxuICBbJyBvZiAnLCAnXFx4NWNcXHg1ZCddLFxuICBbJ0JyYWNlbGV0JywgJ1xceDNjXFx4M2RcXHgzZVxceDViJ10sXG4gIFsnU2hpZWxkJywgJ1xceDBkXFx4MGVcXHgwZiddLFxuICBbJ0FybW9yJywgJ1xceDdiXFx4MTFcXHgxMiddLFxuICBbJ01hZ2ljJywgJ1xceDIzXFx4MjVcXHgyOCddLFxuICBbJ1Bvd2VyJywgJ1xceDEzXFx4MTRcXHgxNSddLFxuICBbJ0l0ZW0nLCAnXFx4MTZcXHgxN1xceDVlJ10sXG5dO1xuXG5pbnRlcmZhY2UgSXRlbU9wdGlvbnMge1xuICB0cmFkZXM/OiBudW1iZXJbXTtcbiAgdXNlPzogYm9vbGVhbjtcbiAgd2VpZ2h0PzogbnVtYmVyO1xufVxuXG4vLyBBbiBpdGVtOyBub3RlIHRoYXQgc29tZSB0YWJsZXMgZ28gdXAgdG8gJDQ5IG9yIGV2ZW4gJDRhIC0gdGhlc2UgY2FuIGJiZSBpZ25vcmVkXG5leHBvcnQgY2xhc3MgSXRlbSBleHRlbmRzIEVudGl0eSB7XG5cbiAgaXRlbVVzZUp1bXAgPSAwO1xuICBpdGVtVXNlRGF0YTogSXRlbVVzZVtdO1xuXG4gIGl0ZW1EYXRhVmFsdWU6IG51bWJlcjsgLy8gOjAzIGlzIHBhbGV0dGUsIDo4MCBpcyBzd29yZCBhbmQgbWFnaWMgKHNvbGlkIGJnKVxuICAgICAgICAgICAgICAgICAgICAgICAgIC8vIDo0MCBpcyB1bmlxdWUsIDoyMCBpcyB3b3JuIChzd29yZC9hbW9yL29yYi9yaW5nL21hZ2ljKVxuICBzZWxlY3RlZEl0ZW1WYWx1ZTogbnVtYmVyO1xuXG4gIGJhc2VQcmljZTogbnVtYmVyO1xuXG4gIC8vIFBST0JMRU0gLSByZWFkIGluIG9uZSBmb3JtYXQsIHdyaXRlIGluIGFub3RoZXIuLi4/XG4gIG1lc3NhZ2VOYW1lOiBzdHJpbmc7IC8vIFRPRE8gLSB0aGlzIHNob3VsZCBsaXZlIGxpbmsgaW50byBNZXNzYWdlcyB0YWJsZVxuICBtZW51TmFtZTogc3RyaW5nO1xuXG4gIHRyYWRlczogbnVtYmVyW107XG4gIHVzZTogYm9vbGVhbjtcblxuICAvLyBXZWlnaHQgZm9yIHNodWZmbGluZyAtIGhpZ2hlciBudW1iZXJzIHdpbGwgYmUgcGxhY2VkIGVhcmxpZXIuXG4gIHdlaWdodDogbnVtYmVyO1xuXG4gIGNvbnN0cnVjdG9yKGl0ZW1zOiBJdGVtcywgaWQ6IG51bWJlciwgb3B0czogSXRlbU9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKGl0ZW1zLnJvbSwgaWQpO1xuICAgIGNvbnN0IHJvbSA9IHRoaXMucm9tO1xuICAgIGl0ZW1zW2lkXSA9IHRoaXM7XG4gICAgdGhpcy5pdGVtVXNlRGF0YSA9IFtdO1xuICAgIHRoaXMudHJhZGVzID0gb3B0cy50cmFkZXMgfHwgW107XG4gICAgdGhpcy51c2UgPSBvcHRzLnVzZSB8fCBmYWxzZTtcbiAgICB0aGlzLndlaWdodCA9IG9wdHMud2VpZ2h0IHx8IDE7XG5cbiAgICBpZiAodGhpcy51c2UpIHtcbiAgICAgIHRoaXMuaXRlbVVzZUp1bXAgPSByZWFkTGl0dGxlRW5kaWFuKHJvbS5wcmcsIHRoaXMuaXRlbVVzZUp1bXBQb2ludGVyKSArIDB4MTQwMDA7XG4gICAgICBjb25zdCBlbnRyaWVzID0gaXRlbXMuaXRlbVVzZUp1bXBzW3RoaXMuaXRlbVVzZUp1bXBdO1xuICAgICAgaWYgKCFlbnRyaWVzKSB0aHJvdyBuZXcgRXJyb3IoYEJhZCBJdGVtVXNlSnVtcDogJHt0aGlzLml0ZW1Vc2VKdW1wfWApO1xuICAgICAgbGV0IGl0ZW1Vc2VPZmZzZXQgPSByZWFkTGl0dGxlRW5kaWFuKHJvbS5wcmcsIHRoaXMuaXRlbVVzZURhdGFQb2ludGVyKSArIDB4MTQwMDA7XG4gICAgICBmb3IgKGNvbnN0IGVudHJ5IG9mIGVudHJpZXMpIHtcbiAgICAgICAgY29uc3QgZGF0YSA9IEl0ZW1Vc2UuZnJvbShlbnRyeSwgcm9tLnByZywgaXRlbVVzZU9mZnNldCk7XG4gICAgICAgIHRoaXMuaXRlbVVzZURhdGEucHVzaChkYXRhKTtcbiAgICAgICAgaXRlbVVzZU9mZnNldCArPSBkYXRhLmxlbmd0aDtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLml0ZW1EYXRhVmFsdWUgPSByb20ucHJnW3RoaXMuaXRlbURhdGFQb2ludGVyXTtcbiAgICB0aGlzLnNlbGVjdGVkSXRlbVZhbHVlID0gcm9tLnByZ1t0aGlzLnNlbGVjdGVkSXRlbVBvaW50ZXJdO1xuXG4gICAgaWYgKHJvbS5zaG9wRGF0YVRhYmxlc0FkZHJlc3MgIT0gbnVsbCkge1xuICAgICAgY29uc3QgYWRkcmVzcyA9XG4gICAgICAgICAgcm9tLnNob3BEYXRhVGFibGVzQWRkcmVzcyArXG4gICAgICAgICAgMjEgKiByb20uc2hvcENvdW50ICtcbiAgICAgICAgICAyICogcm9tLnNjYWxpbmdMZXZlbHMgK1xuICAgICAgICAgIDIgKiAoaWQgLSAweGQpO1xuICAgICAgdGhpcy5iYXNlUHJpY2UgPSBpZCA+PSAweGQgJiYgaWQgPCAweDI3ID8gcmVhZExpdHRsZUVuZGlhbihyb20ucHJnLCBhZGRyZXNzKSA6IDA7XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGFkZHJlc3MgPSBWQU5JTExBX1BBV05fUFJJQ0VfVEFCTEUgKyAyICogaWQ7XG4gICAgICB0aGlzLmJhc2VQcmljZSA9IHJlYWRMaXR0bGVFbmRpYW4ocm9tLnByZywgYWRkcmVzcykgKiAyO1xuICAgIH1cblxuICAgIGNvbnN0IG1lc3NhZ2VOYW1lQmFzZSA9IHJlYWRMaXR0bGVFbmRpYW4ocm9tLnByZywgdGhpcy5tZXNzYWdlTmFtZVBvaW50ZXIpICsgMHgyMDAwMDtcbiAgICB0aGlzLm1lc3NhZ2VOYW1lID0gcmVhZFN0cmluZyhyb20ucHJnLCBtZXNzYWdlTmFtZUJhc2UpO1xuXG4gICAgY29uc3QgbWVudU5hbWVCYXNlID0gcmVhZExpdHRsZUVuZGlhbihyb20ucHJnLCB0aGlzLm1lbnVOYW1lUG9pbnRlcikgKyAweDE4MDAwO1xuICAgIHRoaXMubWVudU5hbWUgPSBNRU5VX05BTUVfRU5DT0RFLnJlZHVjZSgocywgW2QsIGVdKSA9PiBzLnJlcGxhY2UoZSwgZCksXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlYWRTdHJpbmcocm9tLnByZywgbWVudU5hbWVCYXNlLCAweGZmKSk7XG5cbiAgICAvLyBjb25zdCB0cmFkZUluQ291bnQgPSBUUkFERV9JTlMuZ2V0KGlkKTtcbiAgICAvLyB0aGlzLnRyYWRlSW4gPVxuICAgIC8vICAgICB0cmFkZUluQ291bnQgPyB0dXBsZShyb20ucHJnLCB0aGlzLml0ZW1Vc2VEYXRhQmFzZSwgNiAqIHRyYWRlSW5Db3VudCkgOiB1bmRlZmluZWQ7XG5cbiAgICAvLyBjb25zb2xlLmxvZyhgSXRlbSAke3RoaXMubWVudU5hbWV9IGJhc2UgcHJpY2UgJHt0aGlzLmJhc2VQcmljZX1gKTtcbiAgICAvLyBUT0RPIC0gcm9tLnVuaXF1ZUl0ZW1UYWJsZUFkZHJlc3NcbiAgICAvLyAgLT4gY3VycmVudCBoYXJkLWNvZGVkIGluIHBhdGNoLmlkZW50aWZ5S2V5SXRlbXNGb3JEaWZmaWN1bHR5QnVmZnNcbiAgfVxuXG4gIGdldCBpdGVtVXNlSnVtcFBvaW50ZXIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gSVRFTV9VU0VfSlVNUF9UQUJMRSArIDIgKiB0aGlzLmlkO1xuICB9XG5cbiAgZ2V0IGl0ZW1Vc2VEYXRhUG9pbnRlcigpOiBudW1iZXIge1xuICAgIHJldHVybiBJVEVNX1VTRV9EQVRBX1RBQkxFICsgMiAqIHRoaXMuaWQ7XG4gIH1cblxuICBnZXQgaXRlbURhdGFQb2ludGVyKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIElURU1fREFUQV9UQUJMRSArIHRoaXMuaWQ7XG4gIH1cblxuICBnZXQgc2VsZWN0ZWRJdGVtUG9pbnRlcigpOiBudW1iZXIge1xuICAgIHJldHVybiBTRUxFQ1RFRF9JVEVNX1RBQkxFICsgdGhpcy5pZDtcbiAgfVxuXG4gIGdldCBtZXNzYWdlTmFtZVBvaW50ZXIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTUVTU0FHRV9OQU1FX1RBQkxFICsgMiAqIHRoaXMuaWQ7XG4gIH1cblxuICBnZXQgbWVudU5hbWVQb2ludGVyKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIE1FTlVfTkFNRV9UQUJMRSArIDIgKiB0aGlzLmlkO1xuICB9XG5cbiAgaXRlbVVzZU1lc3NhZ2VzKCk6IE1lc3NhZ2VJZFtdIHtcbiAgICBjb25zdCBtZXNzYWdlcyA9IG5ldyBNYXA8c3RyaW5nLCBNZXNzYWdlSWQ+KCk7XG4gICAgZm9yIChjb25zdCB7bWVzc2FnZX0gb2YgdGhpcy5pdGVtVXNlRGF0YSkge1xuICAgICAgbWVzc2FnZXMuc2V0KG1lc3NhZ2UubWlkKCksIG1lc3NhZ2UpO1xuICAgIH1cbiAgICByZXR1cm4gWy4uLm1lc3NhZ2VzLnZhbHVlcygpXTtcbiAgfVxuXG4gIHNldE5hbWUobmFtZTogc3RyaW5nKTogdm9pZCB7XG4gICAgdGhpcy5tZXNzYWdlTmFtZSA9IHRoaXMubWVudU5hbWUgPSBuYW1lO1xuICB9XG5cbiAgLy8gUGFsZXR0ZSBmb3IgbWVudSBpY29uXG4gIGdldCBwYWxldHRlKCk6IG51bWJlciB7IHJldHVybiB0aGlzLml0ZW1EYXRhVmFsdWUgJiAzOyB9XG4gIHNldCBwYWxldHRlKHA6IG51bWJlcikgeyB0aGlzLml0ZW1EYXRhVmFsdWUgPSB0aGlzLml0ZW1EYXRhVmFsdWUgJiB+MyB8IChwICYgMyk7IH1cblxuICAvLyBVbmlxdWUgaXRlbTogY2Fubm90IGJlIGRyb3BwZWQgb3Igc29sZFxuICBnZXQgdW5pcXVlKCk6IGJvb2xlYW4geyByZXR1cm4gISEodGhpcy5pdGVtRGF0YVZhbHVlICYgMHg0MCk7IH1cbiAgc2V0IHVuaXF1ZSh1OiBib29sZWFuKSB7IHRoaXMuaXRlbURhdGFWYWx1ZSA9IHRoaXMuaXRlbURhdGFWYWx1ZSAmIH4weDQwIHwgKHUgPyAweDQwIDogMCk7IH1cblxuICAvLyBXb3JuIGl0ZW0gKHN3b3JkL2FybW9yL29yYi9yaW5nL21hZ2ljKSAtIG5vdCBjbGVhciB3aGVyZSB0aGlzIGlzIHVzZWRcbiAgZ2V0IHdvcm4oKTogYm9vbGVhbiB7IHJldHVybiAhISh0aGlzLml0ZW1EYXRhVmFsdWUgJiAweDIwKTsgfVxuICBzZXQgd29ybih3OiBib29sZWFuKSB7IHRoaXMuaXRlbURhdGFWYWx1ZSA9IHRoaXMuaXRlbURhdGFWYWx1ZSAmIH4weDIwIHwgKHcgPyAweDIwIDogMCk7IH1cblxuICAvLyBTb2xpZCBiYWNrZ3JvdW5kIChzd29yZC9tYWdpYylcbiAgZ2V0IHNvbGlkKCk6IGJvb2xlYW4geyByZXR1cm4gISEodGhpcy5pdGVtRGF0YVZhbHVlICYgMHg4MCk7IH1cbiAgc2V0IHNvbGlkKHM6IGJvb2xlYW4pIHsgdGhpcy5pdGVtRGF0YVZhbHVlID0gdGhpcy5pdGVtRGF0YVZhbHVlICYgfjB4ODAgfCAocyA/IDB4ODAgOiAwKTsgfVxuXG4gIC8vIGdldCBpdGVtVXNlRGF0YSgpOiBVaW50OEFycmF5IHtcbiAgLy8gICAvLyBOT1RFOiB0aGlzIGlzIGhhY2t5LCBpdCBzaG91bGQgcmVhbGx5IGJlIGxlc3MgdGhhbiAyNCwgYW5kIHZhcmlhYmxlIVxuICAvLyAgIC8vIE1vcmVvdmVyLCBzb21lIGl0ZW1zIGhhdmUgb3ZlcmxhcHBpbmcgZGF0YSwgd2hpY2ggaXMgYXdrd2FyZC5cbiAgLy8gICAvLyBTbyByZWFsbHkgd2UgbmVlZCBzZXBhcmF0ZSBJdGVtVXNlIGFuZCBJdGVtSnVtcCBlbnRpdGllcyBhbmQgdGhlbiBqdXN0XG4gIC8vICAgLy8gcG9pbnQgdG8gd2hpY2ggb25lIHdlIHdhbnQgaGVyZS5cbiAgLy8gICByZXR1cm4gdGhpcy5yb20ucHJnLnN1YmFycmF5KHRoaXMuaXRlbVVzZURhdGFCYXNlLCAyNCk7XG4gIC8vIH1cblxuICBhc3luYyB3cml0ZSh3cml0ZXI6IFdyaXRlcik6IFByb21pc2U8dm9pZD4ge1xuICAgIHdyaXRlci5yb21bdGhpcy5pdGVtRGF0YVBvaW50ZXJdID0gdGhpcy5pdGVtRGF0YVZhbHVlO1xuICAgIHdyaXRlci5yb21bdGhpcy5zZWxlY3RlZEl0ZW1Qb2ludGVyXSA9IHRoaXMuc2VsZWN0ZWRJdGVtVmFsdWU7XG4gICAgaWYgKHRoaXMucm9tLnNob3BEYXRhVGFibGVzQWRkcmVzcyAhPSBudWxsKSB7XG4gICAgICBpZiAodGhpcy5pZCA+PSAweGQgJiYgdGhpcy5pZCA8IDB4MjcpIHtcbiAgICAgICAgY29uc3QgYWRkcmVzcyA9XG4gICAgICAgICAgICB0aGlzLnJvbS5zaG9wRGF0YVRhYmxlc0FkZHJlc3MgK1xuICAgICAgICAgICAgMjEgKiB0aGlzLnJvbS5zaG9wQ291bnQgK1xuICAgICAgICAgICAgMiAqIHRoaXMucm9tLnNjYWxpbmdMZXZlbHMgK1xuICAgICAgICAgICAgMiAqICh0aGlzLmlkIC0gMHhkKTtcbiAgICAgICAgd3JpdGVMaXR0bGVFbmRpYW4od3JpdGVyLnJvbSwgYWRkcmVzcywgdGhpcy5iYXNlUHJpY2UpO1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBhZGRyZXNzID0gVkFOSUxMQV9QQVdOX1BSSUNFX1RBQkxFICsgMiAqIHRoaXMuaWQ7XG4gICAgICB3cml0ZUxpdHRsZUVuZGlhbih3cml0ZXIucm9tLCBhZGRyZXNzLCB0aGlzLmJhc2VQcmljZSA+Pj4gMSk7XG4gICAgfVxuXG4gICAgY29uc3QgbWVudU5hbWVFbmNvZGVkID1cbiAgICAgICAgTUVOVV9OQU1FX0VOQ09ERS5yZWR1Y2UoKHMsIFtkLCBlXSkgPT4gcy5yZXBsYWNlKGQsIGUpLCB0aGlzLm1lbnVOYW1lKTtcblxuICAgIGNvbnN0IG1lbnVBZGRyZXNzID0gYXdhaXQgd3JpdGVyLndyaXRlKFxuICAgICAgICBbLi4uc3RyaW5nVG9CeXRlcyhtZW51TmFtZUVuY29kZWQpLCAweGZmXSxcbiAgICAgICAgMHgyMDAwMCwgMHgyMWZmZiwgYEl0ZW1NZW51TmFtZSAke2hleCh0aGlzLmlkKX1gKTtcbiAgICB3cml0ZUxpdHRsZUVuZGlhbih3cml0ZXIucm9tLCB0aGlzLm1lbnVOYW1lUG9pbnRlciwgbWVudUFkZHJlc3MgLSAweDE4MDAwKTtcblxuICAgIGlmICh0aGlzLnVzZSkge1xuICAgICAgd3JpdGVMaXR0bGVFbmRpYW4od3JpdGVyLnJvbSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuaXRlbVVzZUp1bXBQb2ludGVyLCB0aGlzLml0ZW1Vc2VKdW1wIC0gMHgxNDAwMCk7XG5cbiAgICAgIGNvbnN0IGl0ZW1Vc2VEYXRhOiBudW1iZXJbXSA9IFtdO1xuICAgICAgZm9yIChjb25zdCB1c2Ugb2YgdGhpcy5pdGVtVXNlRGF0YSkge1xuICAgICAgICBpdGVtVXNlRGF0YS5wdXNoKC4uLnVzZS5ieXRlcygpKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGl0ZW1Vc2VBZGRyZXNzID0gYXdhaXQgd3JpdGVyLndyaXRlKFxuICAgICAgICAgIGl0ZW1Vc2VEYXRhLCAweDFjMDAwLCAweDFmZmZmLCBgSXRlbVVzZURhdGEgJHtoZXgodGhpcy5pZCl9YCk7XG4gICAgICB3cml0ZUxpdHRsZUVuZGlhbih3cml0ZXIucm9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtVXNlRGF0YVBvaW50ZXIsIGl0ZW1Vc2VBZGRyZXNzIC0gMHgxNDAwMCk7XG4gICAgfVxuXG4gICAgLy8gd3JpdGVyLndyaXRlKFsuLi5zdHJpbmdUb0J5dGVzKHRoaXMubWVzc2FnZU5hbWUpLCAwXSxcbiAgICAvLyAweDI4MDAwLCAweDI5ZmZmLCBgSXRlbU1lc3NhZ2VOYW1lICR7aGV4KHRoaXMuaWQpfWApLFxuICAgIC8vIHdyaXRlTGl0dGxlRW5kaWFuKHdyaXRlci5yb20sIHRoaXMubWVzc2FnZU5hbWVQb2ludGVyLCBtZXNzYWdlQWRkcmVzcyAtIDB4MjAwMDApO1xuICB9XG5cbiAgaXNNYWdpYygpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pZCA+PSAweDQxICYmIHRoaXMuaWQgPD0gMHg0ODtcbiAgfVxufVxuXG5jb25zdCBzdHJpbmdUb0J5dGVzID0gKHM6IHN0cmluZyk6IG51bWJlcltdID0+IHtcbiAgcmV0dXJuIHNlcShzLmxlbmd0aCwgaSA9PiBzLmNoYXJDb2RlQXQoaSkpO1xufTtcblxuLy8gVHJhZGUtaW4gc2xvdHMgY291bGQgYmUgY3VzdG9taXplZCBxdWl0ZSBhIGJpdDpcbi8vICAtIE5QQ1xuLy8gIC0gaXRlbSByZXF1aXJlZFxuLy8gIC0gaXRlbSBnaXZlblxuLy8gIC0gZmxhZ3MgZ2l2ZW5cbi8vICAtIGxvY2F0aW9uXG4vLyBldGMuLi5cbi8vIGNvbnN0IFRSQURFX0lOUyA9IG5ldyBNYXAoW1xuLy8gICBbMHgxZCwgMV0sIC8vIG1lZGljYWwgaGVyYlxuLy8gICBbMHgyNSwgMV0sIC8vIHN0YXR1ZSBvZiBvbnl4XG4vLyAgIFsweDI4LCA0XSwgLy8gZmx1dGUgb2YgbGltZSAoZmlyc3QgdHdvIHVudXNlZClcbi8vICAgWzB4MzEsIDJdLCAvLyBhbGFybSBmbHV0ZVxuLy8gICBbMHgzNSwgMV0sIC8vIGZvZyBsYW1wXG4vLyAgIFsweDNiLCAxXSwgLy8gbG92ZSBwZW5kYW50XG4vLyAgIFsweDNjLCAxXSwgLy8ga2lyaXNhIHBsYW50XG4vLyAgIFsweDNkLCAxXSwgLy8gaXZvcnkgc3RhdHVlXG4gIC8vIFRPRE8gLSBjb25zaWRlciBtb3Zpbmcgc2xlZXBpbmcgcGVvcGxlP1xuICAvLyAgICAgIC0tPiB3b3VsZCB3YW50IHRvIHB1dCBzb21ldGhpbmcgaW4gdGhlaXIgcGxhY2U/XG4gIC8vICAgICAgICAgIC0gbWF5YmUgZXZlbiBhIGJvc3MgaW4gY2xvc2UgcXVhcnRlcnMgYXJlYT9cbiAgLy8gVE9ETyAtIG1heWJlIE5QQyBzaG91bGQgaGF2ZSBhbiBcIml0ZW0gd2FudGVkXCIgcHJvcGVydHk/XG4vLyBdKTtcblxuLy8gSXRlbVVzZSBkYXRhIGFyZSBpbiBzdGFuemFzIHdpdGggMC0yIGJ5dGUgaGVhZGVycy5cbi8vIFRoZSBzdHJ1Y3R1cmUgaXMgZGV0ZXJtaW5lZCBieSB0aGUgSXRlbVVzZUp1bXAsXG4vLyB3aGljaCBleHBlY3RzIHRoZSB2YXJpb3VzIGhlYWRlcnMuXG5cbnR5cGUgSXRlbVVzZUtpbmQgPSAnZXhwZWN0JyB8ICdzY3JlZW4nIHwgJ2ZsYWcnIHwgJ2xvY2F0aW9uJyB8ICdlbXB0eSc7XG5cbmV4cG9ydCBjbGFzcyBJdGVtVXNlIHtcbiAgY29uc3RydWN0b3IocHVibGljIGtpbmQ6IEl0ZW1Vc2VLaW5kLFxuICAgICAgICAgICAgICBwdWJsaWMgd2FudDogbnVtYmVyLCAvLyBub3RlOiBpbnRlcnByZXRhdGlvbiBkZXBlbmRzIG9uIGtpbmQuXG4gICAgICAgICAgICAgIHB1YmxpYyBtZXNzYWdlOiBNZXNzYWdlSWQsXG4gICAgICAgICAgICAgIHB1YmxpYyBmbGFnczogbnVtYmVyW10pIHt9XG5cbiAgc3RhdGljIGZyb20oa2luZDogSXRlbVVzZUtpbmQsIGRhdGE6IERhdGE8bnVtYmVyPiwgb2Zmc2V0OiBudW1iZXIpIHtcbiAgICBsZXQgd2FudCA9IDA7XG4gICAgaWYgKGtpbmQgPT09ICdleHBlY3QnIHx8IGtpbmQgPT09ICdzY3JlZW4nKSB7XG4gICAgICB3YW50ID0gZGF0YVtvZmZzZXQgKyAxXSA8PCA4IHwgZGF0YVtvZmZzZXRdO1xuICAgICAgb2Zmc2V0ICs9IDI7XG4gICAgfSBlbHNlIGlmIChraW5kID09PSAnZmxhZycpIHtcbiAgICAgIGNvbnN0IGZsYWdzID0gSVRFTV9DT05ESVRJT05fRkxBR1MucmVhZChkYXRhLCBvZmZzZXQpO1xuICAgICAgaWYgKCFmbGFncy5sZW5ndGgpIGZsYWdzLnB1c2gofjApO1xuICAgICAgaWYgKGZsYWdzLmxlbmd0aCA+IDEpIHRocm93IG5ldyBFcnJvcihgRmxhZyBsaXN0IHRvbyBsb25nOiAke2ZsYWdzfWApO1xuICAgICAgd2FudCA9IGZsYWdzWzBdO1xuICAgICAgb2Zmc2V0ICs9IDI7XG4gICAgfSBlbHNlIGlmIChraW5kID09PSAnbG9jYXRpb24nKSB7XG4gICAgICB3YW50ID0gZGF0YVtvZmZzZXQrK107XG4gICAgfSBlbHNlIGlmIChraW5kICE9PSAnZW1wdHknKSB7XG4gICAgICBhc3NlcnROZXZlcihraW5kKTtcbiAgICB9XG4gICAgY29uc3QgbWVzc2FnZSA9IE1lc3NhZ2VJZC5mcm9tKGRhdGEsIG9mZnNldCk7XG4gICAgY29uc3QgZmxhZ3MgPSBJVEVNX1VTRV9GTEFHUy5yZWFkKGRhdGEsIG9mZnNldCArIDIpO1xuICAgIHJldHVybiBuZXcgSXRlbVVzZShraW5kLCB3YW50LCBtZXNzYWdlLCBmbGFncyk7XG4gIH1cblxuICBieXRlcygpOiBudW1iZXJbXSB7XG4gICAgY29uc3QgYnl0ZXMgPSBbXTtcbiAgICBpZiAodGhpcy5raW5kID09PSAnZXhwZWN0JyB8fCB0aGlzLmtpbmQgPT09ICdzY3JlZW4nKSB7XG4gICAgICBieXRlcy5wdXNoKHRoaXMud2FudCAmIDB4ZmYsICh0aGlzLndhbnQgPj4+IDgpICYgMHhmZik7XG4gICAgfSBlbHNlIGlmICh0aGlzLmtpbmQgPT09ICdmbGFnJykge1xuICAgICAgY29uc3QgZmxhZ0J5dGVzID0gSVRFTV9DT05ESVRJT05fRkxBR1MuYnl0ZXMoW3RoaXMud2FudF0pO1xuICAgICAgaWYgKGZsYWdCeXRlcy5sZW5ndGggIT09IDIpIHRocm93IG5ldyBFcnJvcihgYmFkIGRhdGE6ICR7ZmxhZ0J5dGVzfWApO1xuICAgICAgYnl0ZXMucHVzaCguLi5mbGFnQnl0ZXMpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5raW5kID09PSAnbG9jYXRpb24nKSB7XG4gICAgICBieXRlcy5wdXNoKHRoaXMud2FudCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmtpbmQgIT09ICdlbXB0eScpIHtcbiAgICAgIGFzc2VydE5ldmVyKHRoaXMua2luZCk7XG4gICAgfSBcbiAgICBieXRlcy5wdXNoKC4uLnRoaXMubWVzc2FnZS5kYXRhKTtcbiAgICBieXRlcy5wdXNoKC4uLklURU1fVVNFX0ZMQUdTLmJ5dGVzKHRoaXMuZmxhZ3MpKTtcbiAgICByZXR1cm4gYnl0ZXM7XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIE5QQyBpZCBmb3IgYW4gZXhwZWN0IE5QQyB1c2UsIG90aGVyd2lzZSBudWxsLlxuICB0cmFkZU5wYygpOiBudW1iZXJ8bnVsbCB7XG4gICAgaWYgKHRoaXMua2luZCAhPT0gJ2V4cGVjdCcpIHJldHVybiBudWxsO1xuICAgIGlmICgodGhpcy53YW50ID4+PiA4KSAhPT0gMSkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMud2FudCAmIDB4ZmY7XG4gIH1cblxuICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgY29uc3QgaGVhZGVyID0gdGhpcy5raW5kID09PSAnZW1wdHknID8gMCA6IHRoaXMua2luZCA9PT0gJ2xvY2F0aW9uJyA/IDEgOiAyO1xuICAgIHJldHVybiAyICogKDEgKyBNYXRoLm1heCgxLCB0aGlzLmZsYWdzLmxlbmd0aCkpICsgaGVhZGVyO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJdGVtcyBleHRlbmRzIEVudGl0eUFycmF5PEl0ZW0+IHtcbiAgLy8gTk9URTogdGhpcyBtdXN0IGJlIGluaXRpYWxpemVkIGZpcnN0LlxuICByZWFkb25seSBpdGVtVXNlSnVtcHMgPSBERUZBVUxUX0lURU1fVVNFX0pVTVBTO1xuXG4gIC8vIFN3b3Jkc1xuICByZWFkb25seSBTd29yZE9mV2luZCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgwMCk7XG4gIHJlYWRvbmx5IFN3b3JkT2ZGaXJlICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDAxKTtcbiAgcmVhZG9ubHkgU3dvcmRPZldhdGVyICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MDIpO1xuICByZWFkb25seSBTd29yZE9mVGh1bmRlciAgID0gbmV3IEl0ZW0odGhpcywgMHgwMyk7XG4gIHJlYWRvbmx5IENyeXN0YWxpcyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA0KTtcbiAgLy8gUG93ZXJzXG4gIHJlYWRvbmx5IEJhbGxPZldpbmQgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA1KTtcbiAgcmVhZG9ubHkgVG9ybmFkb0JyYWNlbGV0ICA9IG5ldyBJdGVtKHRoaXMsIDB4MDYpO1xuICByZWFkb25seSBCYWxsT2ZGaXJlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgwNyk7XG4gIHJlYWRvbmx5IEZsYW1lQnJhY2VsZXQgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA4KTtcbiAgcmVhZG9ubHkgQmFsbE9mV2F0ZXIgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MDkpO1xuICByZWFkb25seSBCbGl6emFyZEJyYWNlbGV0ID0gbmV3IEl0ZW0odGhpcywgMHgwYSk7XG4gIHJlYWRvbmx5IEJhbGxPZlRodW5kZXIgICAgPSBuZXcgSXRlbSh0aGlzLCAweDBiKTtcbiAgcmVhZG9ubHkgU3Rvcm1CcmFjZWxldCAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MGMpO1xuICAvLyBTaGllbGRzXG4gIHJlYWRvbmx5IENhcmFwYWNlU2hpZWxkICAgPSBuZXcgSXRlbSh0aGlzLCAweDBkKTtcbiAgcmVhZG9ubHkgQnJvbnplU2hpZWxkICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MGUpO1xuICByZWFkb25seSBQbGF0aW51bVNoaWVsZCAgID0gbmV3IEl0ZW0odGhpcywgMHgwZik7XG4gIHJlYWRvbmx5IE1pcnJvcmVkU2hpZWxkICAgPSBuZXcgSXRlbSh0aGlzLCAweDEwKTtcbiAgcmVhZG9ubHkgQ2VyYW1pY1NoaWVsZCAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTEpO1xuICByZWFkb25seSBTYWNyZWRTaGllbGQgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxMik7XG4gIHJlYWRvbmx5IEJhdHRsZVNoaWVsZCAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDEzKTtcbiAgcmVhZG9ubHkgUHN5Y2hvU2hpZWxkICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTQpO1xuICAvLyBBcm1vclxuICByZWFkb25seSBUYW5uZWRIaWRlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxNSk7XG4gIHJlYWRvbmx5IExlYXRoZXJBcm1vciAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDE2KTtcbiAgcmVhZG9ubHkgQnJvbnplQXJtb3IgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTcpO1xuICByZWFkb25seSBQbGF0aW51bUFybW9yICAgID0gbmV3IEl0ZW0odGhpcywgMHgxOCk7XG4gIHJlYWRvbmx5IFNvbGRpZXJTdWl0ICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDE5KTtcbiAgcmVhZG9ubHkgQ2VyYW1pY1N1aXQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MWEpO1xuICByZWFkb25seSBCYXR0bGVBcm1vciAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxYik7XG4gIHJlYWRvbmx5IFBzeWNob0FybW9yICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFjKTtcbiAgLy8gQ29uc3VtYWJsZXNcbiAgcmVhZG9ubHkgTWVkaWNhbEhlcmIgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MWQsIHt1c2U6IHRydWUsIHRyYWRlczogWzBdfSk7XG4gIHJlYWRvbmx5IEFudGlkb3RlICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFlLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEx5c2lzUGxhbnQgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFmLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZMaW1lICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIwLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZQb3dlciAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIxLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IE1hZ2ljUmluZyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIyLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZSZXB1biAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIzLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IFdhcnBCb290cyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDI0LCB7dXNlOiB0cnVlfSk7XG4gIC8vIFF1ZXN0IGl0ZW1zICgxKVxuICByZWFkb25seSBTdGF0dWVPZk9ueXggICAgID0gbmV3IEl0ZW0odGhpcywgMHgyNSwge3VzZTogdHJ1ZSwgdHJhZGVzOiBbMF19KTtcbiAgcmVhZG9ubHkgT3BlbFN0YXR1ZSAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MjYsIHt1c2U6IHRydWV9KTtcbiAgcmVhZG9ubHkgSW5zZWN0Rmx1dGUgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MjcsIHt1c2U6IHRydWV9KTtcbiAgLy8gVE9ETyAtIGNvbnNpZGVyIG9ubHkgdXNpbmcgMiwgMz8gIDAgYW5kIDEgYXJlIHVudXNlZC4uLlxuICByZWFkb25seSBGbHV0ZU9mTGltZSAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyOCwge3VzZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFkZXM6IFswLCAxLCAyLCAzXX0pO1xuICAvLyBXb3JuIGl0ZW1zXG4gIHJlYWRvbmx5IEdhc01hc2sgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDI5KTtcbiAgcmVhZG9ubHkgUG93ZXJSaW5nICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MmEpO1xuICByZWFkb25seSBXYXJyaW9yUmluZyAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyYik7XG4gIHJlYWRvbmx5IElyb25OZWNrbGFjZSAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDJjKTtcbiAgcmVhZG9ubHkgRGVvc1BlbmRhbnQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MmQpO1xuICByZWFkb25seSBSYWJiaXRCb290cyAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyZSk7XG4gIHJlYWRvbmx5IExlYXRoZXJCb290cyAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDJmKTtcbiAgcmVhZG9ubHkgU2hpZWxkUmluZyAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MzApO1xuICAvLyBRdWVzdCBpdGVtcyAoMilcbiAgcmVhZG9ubHkgQWxhcm1GbHV0ZSAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MzEsIHt1c2U6IHRydWUsIHRyYWRlczogWzAsIDFdfSk7XG4gIHJlYWRvbmx5IFdpbmRtaWxsS2V5ICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDMyLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEtleVRvUHJpc29uICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDMzLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEtleVRvU3R5eCAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDM0LCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZvZ0xhbXAgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDM1LCB7dXNlOiB0cnVlLCB0cmFkZXM6IFswXX0pO1xuICByZWFkb25seSBTaGVsbEZsdXRlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzNiwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBFeWVHbGFzc2VzICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzNywge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCcm9rZW5TdGF0dWUgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzOCwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBHbG93aW5nTGFtcCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzOSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBTdGF0dWVPZkdvbGQgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzYSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBMb3ZlUGVuZGFudCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzYiwge3VzZTogdHJ1ZSwgdHJhZGVzOiBbMF19KTtcbiAgcmVhZG9ubHkgS2lyaXNhUGxhbnQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4M2MsIHt1c2U6IHRydWUsIHRyYWRlczogWzBdfSk7XG4gIHJlYWRvbmx5IEl2b3J5U3RhdHVlICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDNkLCB7dXNlOiB0cnVlLCB0cmFkZXM6IFswXX0pO1xuICByZWFkb25seSBCb3dPZk1vb24gICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzZSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCb3dPZlN1biAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzZiwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCb3dPZlRydXRoICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0MCwge3VzZTogdHJ1ZX0pO1xuICAvLyBNYWdpY1xuICByZWFkb25seSBSZWZyZXNoICAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0MSk7XG4gIHJlYWRvbmx5IFBhcmFseXNpcyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQyKTtcbiAgcmVhZG9ubHkgVGVsZXBhdGh5ICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4NDMpO1xuICByZWFkb25seSBUZWxlcG9ydCAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0NCk7XG4gIHJlYWRvbmx5IFJlY292ZXIgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQ1KTtcbiAgcmVhZG9ubHkgQmFycmllciAgICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4NDYpO1xuICByZWFkb25seSBDaGFuZ2UgICAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0Nyk7XG4gIHJlYWRvbmx5IEZsaWdodCAgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQ4KTtcblxuICBjb25zdHJ1Y3RvcihyZWFkb25seSByb206IFJvbSkge1xuICAgIHN1cGVyKDB4NDkpO1xuICB9XG5cbiAgYXN5bmMgd3JpdGUod3JpdGVyOiBXcml0ZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzKSB7XG4gICAgICBwcm9taXNlcy5wdXNoKGl0ZW0ud3JpdGUod3JpdGVyKSk7XG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgfVxufVxuXG5jb25zdCBERUZBVUxUX0lURU1fVVNFX0pVTVBTOiB7W2FkZHI6IG51bWJlcl06IEl0ZW1Vc2VLaW5kW119ID0ge1xuICAvLyAzYiBsb3ZlIHBlbmRhbnRcbiAgMHgxYzQzOTogWydleHBlY3QnXSxcbiAgLy8gNDAgYm93IG9mIHRydXRoXG4gIDB4MWM0NDI6IFsnc2NyZWVuJ10sXG4gIC8vIDI2IG9wZWwgc3RhdHVlXG4gIDB4MWM0NTA6IFsnZW1wdHknXSxcbiAgLy8gM2UgYm93IG9mIG1vb24sIDNmIGJvdyBvZiBzdW5cbiAgMHgxYzQ1MTogWydzY3JlZW4nXSxcbiAgLy8gMzIgd2luZG1pbGwga2V5LCAzNyBleWUgZ2xhc3Nlc1xuICAweDFjNDVmOiBbJ2xvY2F0aW9uJ10sXG4gIC8vIDMzIHByaXNvbiBrZXksIDM0IHN0eHksIDM1IGZvZyBsYW1wLCAzYyBraXJpc2EgcGxhbnQsIDNkIGl2b3J5IHN0YXR1ZVxuICAweDFjNDkxOiBbJ2V4cGVjdCddLFxuICAvLyAzMSBhbGFybSBmbHV0ZVxuICAweDFjNGE5OiBbJ2V4cGVjdCcsICdleHBlY3QnXSxcbiAgLy8gMjcgaW5zZWN0IGZsdXRlXG4gIDB4MWM0YjM6IFsnbG9jYXRpb24nXSxcbiAgLy8gM2Egc3RhdHVlIG9mIGdvbGRcbiAgMHgxYzRkMDogWydleHBlY3QnXSxcbiAgLy8gaW52YWxpZFxuICAweDFjNGRiOiBbXSxcbiAgLy8gMWQgbWVkaWNhbCBoZXJiXG4gIDB4MWM0ZTA6IFsnZXhwZWN0JywgJ2VtcHR5J10sXG4gIC8vIDIxIGZydWl0IG9mIHBvd2VyXG4gIDB4MWM1MDc6IFsnZW1wdHknXSxcbiAgLy8gMjIgbWFnaWMgcmluZ1xuICAweDFjNTFkOiBbJ2VtcHR5J10sXG4gIC8vIDFlIGFudGlkb3RlXG4gIDB4MWM1MjQ6IFsnZW1wdHknXSxcbiAgLy8gMWYgbHlzaXMgcGxhbnRcbiAgMHgxYzUyZjogWydlbXB0eSddLFxuICAvLyAyMCBmcnVpdCBvZiBsaW1lXG4gIDB4MWM1M2E6IFsnZW1wdHknXSxcbiAgLy8gMjMgZnJ1aXQgb2YgcmVwdW5cbiAgMHgxYzU0YTogWydlbXB0eSddLFxuICAvLyAyNCB3YXJwIGJvb3RzIC0+IHJ0c1xuICAweDFjNTY0OiBbJ2VtcHR5J10sXG4gIC8vIDI1IHN0YXR1ZSBvZiBvbnl4XG4gIDB4MWM1NjU6IFsnZXhwZWN0J10sXG4gIC8vIDM2IHNoZWxsIGZsdXRlXG4gIDB4MWM1NmI6IFsnZmxhZyddLFxuICAvLyAzOSBnbG93aW5nIGxhbXBcbiAgMHgxYzU4NTogWydlbXB0eSddLFxuICAvLyAyOCBmbHV0ZSBvZiBsaW1lXG4gIDB4MWM1OWU6IFsnZXhwZWN0JywgJ2V4cGVjdCcsICdleHBlY3QnLCAnZXhwZWN0J10sXG59O1xuIl19