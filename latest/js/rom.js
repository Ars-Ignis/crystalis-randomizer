import { AdHocSpawn } from './rom/adhocspawn.js';
import { BossKill } from './rom/bosskill.js';
import { Bosses } from './rom/bosses.js';
import { Hitbox } from './rom/hitbox.js';
import { Item } from './rom/item.js';
import { ItemGet } from './rom/itemget.js';
import { Locations } from './rom/locations.js';
import { Messages } from './rom/messages.js';
import { Metasprite } from './rom/metasprite.js';
import { Monster } from './rom/monster.js';
import { Npc } from './rom/npc.js';
import { Objects } from './rom/objects.js';
import { RomOption } from './rom/option.js';
import { Palette } from './rom/palette.js';
import { Pattern } from './rom/pattern.js';
import { Screen } from './rom/screen.js';
import { Shop } from './rom/shop.js';
import { Telepathy } from './rom/telepathy.js';
import { TileAnimation } from './rom/tileanimation.js';
import { TileEffects } from './rom/tileeffects.js';
import { Tileset } from './rom/tileset.js';
import { Trigger } from './rom/trigger.js';
import { hex, seq } from './rom/util.js';
import { WildWarp } from './rom/wildwarp.js';
import { Writer } from './rom/writer.js';
import { UnionFind } from './unionfind.js';
export class Rom {
    constructor(rom) {
        const prgSize = rom[4] * 0x4000;
        const prgStart = 0x10 + (rom[6] & 4 ? 512 : 0);
        const prgEnd = prgStart + prgSize;
        this.prg = rom.subarray(prgStart, prgEnd);
        this.chr = rom.subarray(prgEnd);
        this.shopCount = Rom.SHOP_COUNT.get(rom);
        this.scalingLevels = Rom.SCALING_LEVELS.get(rom);
        this.uniqueItemTableAddress = Rom.UNIQUE_ITEM_TABLE.get(rom);
        this.shopDataTablesAddress = Rom.SHOP_DATA_TABLES.get(rom);
        this.telepathyTablesAddress = Rom.TELEPATHY_TABLES.get(rom);
        this.omitItemGetDataSuffix = Rom.OMIT_ITEM_GET_DATA_SUFFIX.get(rom);
        this.omitLocalDialogSuffix = Rom.OMIT_LOCAL_DIALOG_SUFFIX.get(rom);
        this.compressedMapData = Rom.COMPRESSED_MAPDATA.get(rom);
        for (const [address, old, value] of ADJUSTMENTS) {
            if (this.prg[address] === old)
                this.prg[address] = value;
        }
        this.screens = seq(0x103, i => new Screen(this, i));
        this.tilesets = seq(12, i => new Tileset(this, i << 2 | 0x80));
        this.tileEffects = seq(11, i => new TileEffects(this, i + 0xb3));
        this.triggers = seq(0x43, i => new Trigger(this, 0x80 | i));
        this.patterns = seq(this.chr.length >> 4, i => new Pattern(this, i));
        this.palettes = seq(0x100, i => new Palette(this, i));
        this.locations = new Locations(this);
        this.tileAnimations = seq(4, i => new TileAnimation(this, i));
        this.hitboxes = seq(24, i => new Hitbox(this, i));
        this.objects = new Objects(this);
        this.adHocSpawns = seq(0x60, i => new AdHocSpawn(this, i));
        this.metasprites = seq(0x100, i => new Metasprite(this, i));
        this.messages = new Messages(this);
        this.telepathy = new Telepathy(this);
        this.itemGets = seq(0x71, i => new ItemGet(this, i));
        this.items = seq(0x49, i => new Item(this, i));
        this.shops = seq(44, i => new Shop(this, i));
        this.npcs = seq(0xcd, i => new Npc(this, i));
        this.bossKills = seq(0xe, i => new BossKill(this, i));
        this.bosses = new Bosses(this);
        this.wildWarp = new WildWarp(this);
    }
    trigger(id) {
        if (id < 0x80 || id > 0xff)
            throw new Error(`Bad trigger id $${hex(id)}`);
        return this.triggers[id & 0x7f];
    }
    tileset(id) {
        if (id < 0x80 || id > 0xac || id & 3)
            throw new Error(`Bad tileset id $${hex(id)}`);
        return this.tilesets[(id & 0x7f) >>> 2];
    }
    get projectiles() {
        const projectiles = new Set();
        for (const m of this.objects.filter(o => o instanceof Monster)) {
            if (m.child) {
                projectiles.add(this.objects[this.adHocSpawns[m.child].objectId]);
            }
        }
        return [...projectiles].sort((x, y) => (x.id - y.id));
    }
    get monsterGraphics() {
        const gfx = {};
        for (const l of this.locations) {
            if (!l.used || !l.hasSpawns)
                continue;
            for (const o of l.spawns) {
                if (!(o.data[2] & 7)) {
                    const slot = o.data[2] & 0x80 ? 1 : 0;
                    const id = hex(o.data[3] + 0x50);
                    const data = gfx[id] = gfx[id] || {};
                    data[`${slot}:${l.spritePatterns[slot].toString(16)}:${l.spritePalettes[slot].toString(16)}`]
                        = { pal: l.spritePalettes[slot],
                            pat: l.spritePatterns[slot],
                            slot,
                        };
                }
            }
        }
        return gfx;
    }
    get locationMonsters() {
        const m = {};
        for (const l of this.locations) {
            if (!l.used || !l.hasSpawns)
                continue;
            const s = m['$' + hex(l.id)] = {};
            for (const o of l.spawns) {
                if (!(o.data[2] & 7)) {
                    const slot = o.data[2] & 0x80 ? 1 : 0;
                    const id = o.data[3] + 0x50;
                    s[`${slot}:${id.toString(16)}`] =
                        (s[`${slot}:${id.toString(16)}`] || 0) + 1;
                }
            }
        }
        return m;
    }
    async writeData() {
        Rom.SHOP_COUNT.set(this.prg, this.shopCount);
        Rom.SCALING_LEVELS.set(this.prg, this.scalingLevels);
        Rom.UNIQUE_ITEM_TABLE.set(this.prg, this.uniqueItemTableAddress);
        Rom.SHOP_DATA_TABLES.set(this.prg, this.shopDataTablesAddress);
        Rom.OMIT_ITEM_GET_DATA_SUFFIX.set(this.prg, this.omitItemGetDataSuffix);
        Rom.OMIT_LOCAL_DIALOG_SUFFIX.set(this.prg, this.omitLocalDialogSuffix);
        Rom.COMPRESSED_MAPDATA.set(this.prg, this.compressedMapData);
        const writer = new Writer(this.prg, this.chr);
        writer.alloc(0x144f8, 0x17e00);
        writer.alloc(0x193f9, 0x1ac00);
        writer.alloc(0x1ae00, 0x1bd00);
        writer.alloc(0x1c77a, 0x1c95d);
        writer.alloc(0x1cae5, 0x1d8f4);
        writer.alloc(0x1dde6, 0x1e065);
        writer.alloc(0x1e200, 0x1e3c0);
        writer.alloc(0x2111a, 0x21468);
        writer.alloc(0x2a000, 0x2fc00);
        if (this.telepathyTablesAddress) {
            writer.alloc(0x1d8f4, 0x1db00);
        }
        else {
            writer.alloc(0x1da4c, 0x1db00);
        }
        const promises = [];
        const writeAll = (writables) => {
            for (const w of writables) {
                promises.push(w.write(writer));
            }
        };
        writeAll(this.locations);
        writeAll(this.objects);
        writeAll(this.hitboxes);
        writeAll(this.triggers);
        writeAll(this.npcs);
        writeAll(this.tilesets);
        writeAll(this.tileEffects);
        writeAll(this.screens);
        writeAll(this.adHocSpawns);
        writeAll(this.itemGets);
        writeAll(this.items);
        writeAll(this.shops);
        writeAll(this.bossKills);
        writeAll(this.patterns);
        this.wildWarp.write(writer);
        promises.push(this.telepathy.write(writer));
        promises.push(this.messages.write(writer));
        promises.push(writer.commit());
        await Promise.all(promises).then(() => undefined);
    }
    analyzeTiles() {
    }
    disjointTilesets() {
        const tilesetByScreen = [];
        for (const loc of this.locations) {
            if (!loc.used)
                continue;
            const tileset = loc.tileset;
            const ext = loc.extended ? 0x100 : 0;
            for (const row of loc.screens) {
                for (const s of row) {
                    (tilesetByScreen[s + ext] || (tilesetByScreen[s + ext] = new Set())).add(tileset);
                }
            }
        }
        const tiles = seq(256, () => new UnionFind());
        for (let s = 0; s < tilesetByScreen.length; s++) {
            if (!tilesetByScreen[s])
                continue;
            for (const t of this.screens[s].allTilesSet()) {
                tiles[t].union([...tilesetByScreen[s]]);
            }
        }
        for (let t = 0; t < tiles.length; t++) {
            const p = tiles[t].sets()
                .map((s) => [...s].map(hex).join(' '))
                .join(' | ');
            console.log(`Tile ${hex(t)}: ${p}`);
        }
    }
    swapMetatiles(tilesets, ...cycles) {
        const rev = new Map();
        const revArr = seq(0x100);
        const alt = new Map();
        const cpl = (x) => Array.isArray(x) ? x[0] : x < 0 ? ~x : x;
        for (const cycle of cycles) {
            for (let i = 0; i < cycle.length - 1; i++) {
                if (Array.isArray(cycle[i])) {
                    const arr = cycle[i];
                    alt.set(arr[0], arr[1]);
                    cycle[i] = arr[0];
                }
            }
            for (let i = 0; i < cycle.length - 1; i++) {
                const j = cycle[i];
                const k = cycle[i + 1];
                if (j < 0 || k < 0)
                    continue;
                rev.set(k, j);
                revArr[k] = j;
            }
        }
        const screens = new Set();
        const tileEffects = new Set();
        const tilesetsSet = new Set(tilesets);
        for (const l of this.locations) {
            if (!l.used)
                continue;
            if (!tilesetsSet.has(l.tileset))
                continue;
            tileEffects.add(l.tileEffects);
            for (const screen of l.allScreens()) {
                screens.add(screen);
            }
        }
        for (const screen of screens) {
            for (let i = 0, len = screen.tiles.length; i < len; i++) {
                screen.tiles[i] = revArr[screen.tiles[i]];
            }
        }
        for (const tsid of tilesetsSet) {
            const tileset = this.tilesets[(tsid & 0x7f) >>> 2];
            for (const cycle of cycles) {
                for (let i = 0; i < cycle.length - 1; i++) {
                    const a = cpl(cycle[i]);
                    const b = cpl(cycle[i + 1]);
                    for (let j = 0; j < 4; j++) {
                        tileset.tiles[j][a] = tileset.tiles[j][b];
                    }
                    tileset.attrs[a] = tileset.attrs[b];
                    if (b < 0x20 && tileset.alternates[b] !== b) {
                        if (a >= 0x20)
                            throw new Error(`Cannot unflag: ${tsid} ${a} ${b} ${tileset.alternates[b]}`);
                        tileset.alternates[a] = tileset.alternates[b];
                    }
                }
            }
            for (const [a, b] of alt) {
                tileset.alternates[a] = b;
            }
        }
        for (const teid of tileEffects) {
            const tileEffect = this.tileEffects[teid - 0xb3];
            for (const cycle of cycles) {
                for (let i = 0; i < cycle.length - 1; i++) {
                    const a = cpl(cycle[i]);
                    const b = cpl(cycle[i + 1]);
                    tileEffect.effects[a] = tileEffect.effects[b];
                }
            }
            for (const a of alt.keys()) {
                tileEffect.effects[a] |= 0x08;
            }
        }
    }
    moveFlag(oldFlag, newFlag) {
        function replace(arr) {
            for (let i = 0; i < arr.length; i++) {
                if (arr[i] === oldFlag)
                    arr[i] = newFlag;
                if (arr[i] === ~oldFlag)
                    arr[i] = ~newFlag;
            }
        }
        for (const trigger of this.triggers) {
            replace(trigger.conditions);
            replace(trigger.flags);
        }
        for (const npc of this.npcs) {
            for (const conds of npc.spawnConditions.values())
                replace(conds);
            for (const dialogs of [npc.globalDialogs, ...npc.localDialogs.values()]) {
                for (const dialog of dialogs) {
                    if (dialog.condition === oldFlag)
                        dialog.condition = newFlag;
                    if (dialog.condition === ~oldFlag)
                        dialog.condition = ~newFlag;
                }
            }
        }
        if ((oldFlag & ~0xff) === 0x200 && (newFlag & ~0xff) === 0x200) {
            for (const loc of this.locations) {
                for (const flag of loc.flags) {
                    if (flag.flag === oldFlag)
                        flag.flag = newFlag;
                }
            }
        }
    }
    nextFreeTrigger() {
        for (const t of this.triggers) {
            if (!t.used)
                return t;
        }
        throw new Error('Could not find an unused trigger.');
    }
    static async load(patch, receiver) {
        const file = await pickFile(receiver);
        if (patch)
            await patch(file);
        return new Rom(file);
    }
}
Rom.OMIT_ITEM_GET_DATA_SUFFIX = RomOption.bit(0x142c0, 0);
Rom.OMIT_LOCAL_DIALOG_SUFFIX = RomOption.bit(0x142c0, 1);
Rom.COMPRESSED_MAPDATA = RomOption.bit(0x142c0, 2);
Rom.SHOP_COUNT = RomOption.byte(0x142c1);
Rom.SCALING_LEVELS = RomOption.byte(0x142c2);
Rom.UNIQUE_ITEM_TABLE = RomOption.address(0x142d0);
Rom.SHOP_DATA_TABLES = RomOption.address(0x142d3);
Rom.TELEPATHY_TABLES = RomOption.address(0x142d6);
function pickFile(receiver) {
    if (!receiver)
        receiver = picker => document.body.appendChild(picker);
    return new Promise((resolve) => {
        if (window.location.hash !== '#reset') {
            const data = localStorage.getItem('rom');
            if (data) {
                return resolve(Uint8Array.from(new Array(data.length / 2).fill(0).map((_, i) => Number.parseInt(data[2 * i] + data[2 * i + 1], 16))));
            }
        }
        const upload = document.createElement('input');
        document.body.appendChild(upload);
        upload.type = 'file';
        upload.addEventListener('change', () => {
            const file = upload.files[0];
            const reader = new FileReader();
            reader.addEventListener('loadend', () => {
                const arr = new Uint8Array(reader.result);
                const str = Array.from(arr, hex).join('');
                localStorage.setItem('rom', str);
                upload.remove();
                resolve(arr);
            });
            reader.readAsArrayBuffer(file);
        });
    });
}
export const EXPECTED_CRC32 = 0x1bd39032;
const ADJUSTMENTS = [
    [0x13646, 0x02, 0x06],
    [0x1456a, 0x00, 0xff],
    [0x14aeb, 0x09, 0xff],
    [0x14db9, 0x08, 0x80],
    [0x1545d, 0xff, 0x00],
    [0x15baf, 0xf0, 0x80],
    [0x15bb6, 0xdf, 0x80],
    [0x15bb7, 0x96, 0x80],
    [0x164ff, 0x0b, 0x0a],
    [0x1782a, 0x10, 0x01],
    [0x17857, 0x10, 0x01],
    [0x19f02, 0x40, 0x80],
    [0x19f03, 0x33, 0x32],
    [0x1cf05, 0x47, 0x48],
    [0x1d311, 0x20, 0xa0],
    [0x1d312, 0x30, 0x00],
    [0x1cff9, 0x60, 0xe0],
    [0x2ca90, 0x02, 0x00],
    [0x2f573, 0x02, 0x00],
    [0x2fae4, 0x5f, 0x00],
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9tLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2pzL3JvbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDL0MsT0FBTyxFQUFDLFFBQVEsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBQzNDLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDdkMsT0FBTyxFQUFDLElBQUksRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNuQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDekMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLG9CQUFvQixDQUFDO0FBQzdDLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUMzQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDL0MsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxHQUFHLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFFakMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUMxQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDekMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRW5DLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxvQkFBb0IsQ0FBQztBQUM3QyxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0s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QUUsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDakUsSUFBSSxDQUFDLFFBQVEsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFLElBQUksR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzVELElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsTUFBTSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3JFLElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLEtBQUssRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ3RELElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLGNBQWMsR0FBRyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxhQUFhLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDOUQsSUFBSSxDQUFDLFFBQVEsR0FBRyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxNQUFNLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsSUFBSSxDQUFDLE9BQU8sR0FBRyxJQUFJLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNqQyxJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUMzRCxJQUFJLENBQUMsV0FBVyxHQUFHLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLFVBQVUsQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1RCxJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ25DLElBQUksQ0FBQyxTQUFTLEdBQUcsSUFBSSxTQUFTLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLFFBQVEsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxPQUFPLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDckQsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDL0MsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLElBQUksR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDN0MsSUFBSSxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLE1BQU0sR0FBRyxJQUFJLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUMvQixJQUFJLENBQUMsUUFBUSxHQUFHLElBQUksUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JDLENBQUM7SUFFRCxPQUFPLENBQUMsRUFBVTtRQUNoQixJQUFJLEVBQUUsR0FBRyxJQUFJLElB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LE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3JCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3JCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFHckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztDQUNiLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FkSG9jU3Bhd259IGZyb20gJy4vcm9tL2FkaG9jc3Bhd24uanMnO1xuaW1wb3J0IHtCb3NzS2lsbH0gZnJvbSAnLi9yb20vYm9zc2tpbGwuanMnO1xuaW1wb3J0IHtCb3NzZXN9IGZyb20gJy4vcm9tL2Jvc3Nlcy5qcyc7XG5pbXBvcnQge0hpdGJveH0gZnJvbSAnLi9yb20vaGl0Ym94LmpzJztcbmltcG9ydCB7SXRlbX0gZnJvbSAnLi9yb20vaXRlbS5qcyc7XG5pbXBvcnQge0l0ZW1HZXR9IGZyb20gJy4vcm9tL2l0ZW1nZXQuanMnO1xuaW1wb3J0IHtMb2NhdGlvbnN9IGZyb20gJy4vcm9tL2xvY2F0aW9ucy5qcyc7XG5pbXBvcnQge01lc3NhZ2VzfSBmcm9tICcuL3JvbS9tZXNzYWdlcy5qcyc7XG5pbXBvcnQge01ldGFzcHJpdGV9IGZyb20gJy4vcm9tL21ldGFzcHJpdGUuanMnO1xuaW1wb3J0IHtNb25zdGVyfSBmcm9tICcuL3JvbS9tb25zdGVyLmpzJztcbmltcG9ydCB7TnBjfSBmcm9tICcuL3JvbS9ucGMuanMnO1xuaW1wb3J0IHtPYmplY3REYXRhfSBmcm9tICcuL3JvbS9vYmplY3RkYXRhLmpzJztcbmltcG9ydCB7T2JqZWN0c30gZnJvbSAnLi9yb20vb2JqZWN0cy5qcyc7XG5pbXBvcnQge1JvbU9wdGlvbn0gZnJvbSAnLi9yb20vb3B0aW9uLmpzJztcbmltcG9ydCB7UGFsZXR0ZX0gZnJvbSAnLi9yb20vcGFsZXR0ZS5qcyc7XG5pbXBvcnQge1BhdHRlcm59IGZyb20gJy4vcm9tL3BhdHRlcm4uanMnO1xuaW1wb3J0IHtTY3JlZW59IGZyb20gJy4vcm9tL3NjcmVlbi5qcyc7XG5pbXBvcnQge1Nob3B9IGZyb20gJy4vcm9tL3Nob3AuanMnO1xuaW1wb3J0IHtTcG9pbGVyfSBmcm9tICcuL3JvbS9zcG9pbGVyLmpzJztcbmltcG9ydCB7VGVsZXBhdGh5fSBmcm9tICcuL3JvbS90ZWxlcGF0aHkuanMnO1xuaW1wb3J0IHtUaWxlQW5pbWF0aW9ufSBmcm9tICcuL3JvbS90aWxlYW5pbWF0aW9uLmpzJztcbmltcG9ydCB7VGlsZUVmZmVjdHN9IGZyb20gJy4vcm9tL3RpbGVlZmZlY3RzLmpzJztcbmltcG9ydCB7VGlsZXNldH0gZnJvbSAnLi9yb20vdGlsZXNldC5qcyc7XG5pbXBvcnQge1RyaWdnZXJ9IGZyb20gJy4vcm9tL3RyaWdnZXIuanMnO1xuaW1wb3J0IHtoZXgsIHNlcX0gZnJvbSAnLi9yb20vdXRpbC5qcyc7XG5pbXBvcnQge1dpbGRXYXJwfSBmcm9tICcuL3JvbS93aWxkd2FycC5qcyc7XG5pbXBvcnQge1dyaXRlcn0gZnJvbSAnLi9yb20vd3JpdGVyLmpzJztcbmltcG9ydCB7VW5pb25GaW5kfSBmcm9tICcuL3VuaW9uZmluZC5qcyc7XG5cbi8vIEEga25vd24gbG9jYXRpb24gZm9yIGRhdGEgYWJvdXQgc3RydWN0dXJhbCBjaGFuZ2VzIHdlJ3ZlIG1hZGUgdG8gdGhlIHJvbS5cbi8vIFRoZSB0cmljayBpcyB0byBmaW5kIGEgc3VpdGFibGUgcmVnaW9uIG9mIFJPTSB0aGF0J3MgYm90aCB1bnVzZWQgKmFuZCpcbi8vIGlzIG5vdCBwYXJ0aWN1bGFybHkgKnVzYWJsZSogZm9yIG91ciBwdXJwb3Nlcy4gIFRoZSBib3R0b20gMyByb3dzIG9mIHRoZVxuLy8gdmFyaW91cyBzaW5nbGUtc2NyZWVuIG1hcHMgYXJlIGFsbCBlZmZlY3RpdmVseSB1bnVzZWQsIHNvIHRoYXQgZ2l2ZXMgNDhcbi8vIGJ5dGVzIHBlciBtYXAuICBTaG9wcyAoMTQwMDAuLjE0MmZmKSBhbHNvIGhhdmUgYSBnaWFudCBhcmVhIHVwIHRvcCB0aGF0XG4vLyBjb3VsZCBwb3NzaWJseSBiZSB1c2FibGUsIHRob3VnaCB3ZSdkIG5lZWQgdG8gdGVhY2ggdGhlIHRpbGUtcmVhZGluZyBjb2RlXG4vLyB0byBpZ25vcmUgd2hhdGV2ZXIncyB3cml0dGVuIHRoZXJlLCBzaW5jZSBpdCAqaXMqIHZpc2libGUgYmVmb3JlIHRoZSBtZW51XG4vLyBwb3BzIHVwLiAgVGhlc2UgYXJlIGJpZyBlbm91Z2ggcmVnaW9ucyB0aGF0IHdlIGNvdWxkIGV2ZW4gY29uc2lkZXIgdXNpbmdcbi8vIHRoZW0gdmlhIHBhZ2Utc3dhcHBpbmcgdG8gZ2V0IGV4dHJhIGRhdGEgaW4gYXJiaXRyYXJ5IGNvbnRleHRzLlxuXG4vLyBTaG9wcyBhcmUgcGFydGljdWxhcmx5IG5pY2UgYmVjYXVzZSB0aGV5J3JlIGFsbCAwMCBpbiB2YW5pbGxhLlxuLy8gT3RoZXIgcG9zc2libGUgcmVnaW9uczpcbi8vICAgLSA0OCBieXRlcyBhdCAkZmZjMCAobWV6YW1lIHNocmluZSkgPT4gJGZmZTAgaXMgYWxsICRmZiBpbiB2YW5pbGxhLlxuXG5leHBvcnQgY2xhc3MgUm9tIHtcblxuICAvLyBUaGVzZSB2YWx1ZXMgY2FuIGJlIHF1ZXJpZWQgdG8gZGV0ZXJtaW5lIGhvdyB0byBwYXJzZSBhbnkgZ2l2ZW4gcm9tLlxuICAvLyBUaGV5J3JlIGFsbCBhbHdheXMgemVybyBmb3IgdmFuaWxsYVxuICBzdGF0aWMgcmVhZG9ubHkgT01JVF9JVEVNX0dFVF9EQVRBX1NVRkZJWCAgICA9IFJvbU9wdGlvbi5iaXQoMHgxNDJjMCwgMCk7XG4gIHN0YXRpYyByZWFkb25seSBPTUlUX0xPQ0FMX0RJQUxPR19TVUZGSVggICAgID0gUm9tT3B0aW9uLmJpdCgweDE0MmMwLCAxKTtcbiAgc3RhdGljIHJlYWRvbmx5IENPTVBSRVNTRURfTUFQREFUQSAgICAgICAgICAgPSBSb21PcHRpb24uYml0KDB4MTQyYzAsIDIpO1xuICBzdGF0aWMgcmVhZG9ubHkgU0hPUF9DT1VOVCAgICAgICAgICAgICAgICAgICA9IFJvbU9wdGlvbi5ieXRlKDB4MTQyYzEpO1xuICBzdGF0aWMgcmVhZG9ubHkgU0NBTElOR19MRVZFTFMgICAgICAgICAgICAgICA9IFJvbU9wdGlvbi5ieXRlKDB4MTQyYzIpO1xuICBzdGF0aWMgcmVhZG9ubHkgVU5JUVVFX0lURU1fVEFCTEUgICAgICAgICAgICA9IFJvbU9wdGlvbi5hZGRyZXNzKDB4MTQyZDApO1xuICBzdGF0aWMgcmVhZG9ubHkgU0hPUF9EQVRBX1RBQkxFUyAgICAgICAgICAgICA9IFJvbU9wdGlvbi5hZGRyZXNzKDB4MTQyZDMpO1xuICBzdGF0aWMgcmVhZG9ubHkgVEVMRVBBVEhZX1RBQkxFUyAgICAgICAgICAgICA9IFJvbU9wdGlvbi5hZGRyZXNzKDB4MTQyZDYpO1xuXG4gIHJlYWRvbmx5IHByZzogVWludDhBcnJheTtcbiAgcmVhZG9ubHkgY2hyOiBVaW50OEFycmF5O1xuXG4gIHJlYWRvbmx5IHNjcmVlbnM6IFNjcmVlbltdO1xuICByZWFkb25seSB0aWxlc2V0czogVGlsZXNldFtdO1xuICByZWFkb25seSB0aWxlRWZmZWN0czogVGlsZUVmZmVjdHNbXTtcbiAgcmVhZG9ubHkgdHJpZ2dlcnM6IFRyaWdnZXJbXTtcbiAgcmVhZG9ubHkgcGF0dGVybnM6IFBhdHRlcm5bXTtcbiAgcmVhZG9ubHkgcGFsZXR0ZXM6IFBhbGV0dGVbXTtcbiAgcmVhZG9ubHkgbG9jYXRpb25zOiBMb2NhdGlvbnM7XG4gIHJlYWRvbmx5IHRpbGVBbmltYXRpb25zOiBUaWxlQW5pbWF0aW9uW107XG4gIHJlYWRvbmx5IGhpdGJveGVzOiBIaXRib3hbXTtcbiAgcmVhZG9ubHkgb2JqZWN0czogT2JqZWN0cztcbiAgcmVhZG9ubHkgYWRIb2NTcGF3bnM6IEFkSG9jU3Bhd25bXTtcbiAgcmVhZG9ubHkgbWV0YXNwcml0ZXM6IE1ldGFzcHJpdGVbXTtcbiAgcmVhZG9ubHkgaXRlbUdldHM6IEl0ZW1HZXRbXTtcbiAgcmVhZG9ubHkgaXRlbXM6IEl0ZW1bXTtcbiAgcmVhZG9ubHkgc2hvcHM6IFNob3BbXTtcbiAgcmVhZG9ubHkgbnBjczogTnBjW107XG4gIHJlYWRvbmx5IGJvc3NLaWxsczogQm9zc0tpbGxbXTtcbiAgcmVhZG9ubHkgYm9zc2VzOiBCb3NzZXM7XG4gIHJlYWRvbmx5IHdpbGRXYXJwOiBXaWxkV2FycDtcblxuICByZWFkb25seSB0ZWxlcGF0aHk6IFRlbGVwYXRoeTtcbiAgcmVhZG9ubHkgbWVzc2FnZXM6IE1lc3NhZ2VzO1xuXG4gIHNwb2lsZXI/OiBTcG9pbGVyO1xuXG4gIC8vIE5PVEU6IFRoZSBmb2xsb3dpbmcgcHJvcGVydGllcyBtYXkgYmUgY2hhbmdlZCBiZXR3ZWVuIHJlYWRpbmcgYW5kIHdyaXRpbmdcbiAgLy8gdGhlIHJvbS4gIElmIHRoaXMgaGFwcGVucywgdGhlIHdyaXR0ZW4gcm9tIHdpbGwgaGF2ZSBkaWZmZXJlbnQgb3B0aW9ucy5cbiAgLy8gVGhpcyBpcyBhbiBlZmZlY3RpdmUgd2F5IHRvIGNvbnZlcnQgYmV0d2VlbiB0d28gc3R5bGVzLlxuXG4gIC8vIE1heCBudW1iZXIgb2Ygc2hvcHMuICBWYXJpb3VzIGJsb2NrcyBvZiBtZW1vcnkgcmVxdWlyZSBrbm93aW5nIHRoaXMgbnVtYmVyXG4gIC8vIHRvIGFsbG9jYXRlLlxuICBzaG9wQ291bnQ6IG51bWJlcjtcbiAgLy8gTnVtYmVyIG9mIHNjYWxpbmcgbGV2ZWxzLiAgRGV0ZXJtaW5lcyB0aGUgc2l6ZSBvZiB0aGUgc2NhbGluZyB0YWJsZXMuXG4gIHNjYWxpbmdMZXZlbHM6IG51bWJlcjtcblxuICAvLyBBZGRyZXNzIHRvIHJlYWQvd3JpdGUgdGhlIGJpdGZpZWxkIGluZGljYXRpbmcgdW5pcXVlIGl0ZW1zLlxuICB1bmlxdWVJdGVtVGFibGVBZGRyZXNzOiBudW1iZXI7XG4gIC8vIEFkZHJlc3Mgb2Ygbm9ybWFsaXplZCBwcmljZXMgdGFibGUsIGlmIHByZXNlbnQuICBJZiB0aGlzIGlzIGFic2VudCB0aGVuIHdlXG4gIC8vIGFzc3VtZSBwcmljZXMgYXJlIG5vdCBub3JtYWxpemVkIGFuZCBhcmUgYXQgdGhlIG5vcm1hbCBwYXduIHNob3AgYWRkcmVzcy5cbiAgc2hvcERhdGFUYWJsZXNBZGRyZXNzOiBudW1iZXI7XG4gIC8vIEFkZHJlc3Mgb2YgcmVhcnJhbmdlZCB0ZWxlcGF0aHkgdGFibGVzLlxuICB0ZWxlcGF0aHlUYWJsZXNBZGRyZXNzOiBudW1iZXI7XG4gIC8vIFdoZXRoZXIgdGhlIHRyYWlsaW5nICRmZiBzaG91bGQgYmUgb21pdHRlZCBmcm9tIHRoZSBJdGVtR2V0RGF0YSB0YWJsZS5cbiAgb21pdEl0ZW1HZXREYXRhU3VmZml4OiBib29sZWFuO1xuICAvLyBXaGV0aGVyIHRoZSB0cmFpbGluZyBieXRlIG9mIGVhY2ggTG9jYWxEaWFsb2cgaXMgb21pdHRlZC4gIFRoaXMgYWZmZWN0c1xuICAvLyBib3RoIHJlYWRpbmcgYW5kIHdyaXRpbmcgdGhlIHRhYmxlLiAgTWF5IGJlIGluZmVycmVkIHdoaWxlIHJlYWRpbmcuXG4gIG9taXRMb2NhbERpYWxvZ1N1ZmZpeDogYm9vbGVhbjtcbiAgLy8gV2hldGhlciBtYXBkYXRhIGhhcyBiZWVuIGNvbXByZXNzZWQuXG4gIGNvbXByZXNzZWRNYXBEYXRhOiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKHJvbTogVWludDhBcnJheSkge1xuICAgIGNvbnN0IHByZ1NpemUgPSByb21bNF0gKiAweDQwMDA7XG4gICAgLy8gTk9URTogY2hyU2l6ZSA9IHJvbVs1XSAqIDB4MjAwMDtcbiAgICBjb25zdCBwcmdTdGFydCA9IDB4MTAgKyAocm9tWzZdICYgNCA/IDUxMiA6IDApO1xuICAgIGNvbnN0IHByZ0VuZCA9IHByZ1N0YXJ0ICsgcHJnU2l6ZTtcbiAgICB0aGlzLnByZyA9IHJvbS5zdWJhcnJheShwcmdTdGFydCwgcHJnRW5kKTtcbiAgICB0aGlzLmNociA9IHJvbS5zdWJhcnJheShwcmdFbmQpO1xuXG4gICAgdGhpcy5zaG9wQ291bnQgPSBSb20uU0hPUF9DT1VOVC5nZXQocm9tKTtcbiAgICB0aGlzLnNjYWxpbmdMZXZlbHMgPSBSb20uU0NBTElOR19MRVZFTFMuZ2V0KHJvbSk7XG4gICAgdGhpcy51bmlxdWVJdGVtVGFibGVBZGRyZXNzID0gUm9tLlVOSVFVRV9JVEVNX1RBQkxFLmdldChyb20pO1xuICAgIHRoaXMuc2hvcERhdGFUYWJsZXNBZGRyZXNzID0gUm9tLlNIT1BfREFUQV9UQUJMRVMuZ2V0KHJvbSk7XG4gICAgdGhpcy50ZWxlcGF0aHlUYWJsZXNBZGRyZXNzID0gUm9tLlRFTEVQQVRIWV9UQUJMRVMuZ2V0KHJvbSk7XG4gICAgdGhpcy5vbWl0SXRlbUdldERhdGFTdWZmaXggPSBSb20uT01JVF9JVEVNX0dFVF9EQVRBX1NVRkZJWC5nZXQocm9tKTtcbiAgICB0aGlzLm9taXRMb2NhbERpYWxvZ1N1ZmZpeCA9IFJvbS5PTUlUX0xPQ0FMX0RJQUxPR19TVUZGSVguZ2V0KHJvbSk7XG4gICAgdGhpcy5jb21wcmVzc2VkTWFwRGF0YSA9IFJvbS5DT01QUkVTU0VEX01BUERBVEEuZ2V0KHJvbSk7XG5cbiAgICAvLyBpZiAoY3JjMzIocm9tKSA9PT0gRVhQRUNURURfQ1JDMzIpIHtcbiAgICBmb3IgKGNvbnN0IFthZGRyZXNzLCBvbGQsIHZhbHVlXSBvZiBBREpVU1RNRU5UUykge1xuICAgICAgaWYgKHRoaXMucHJnW2FkZHJlc3NdID09PSBvbGQpIHRoaXMucHJnW2FkZHJlc3NdID0gdmFsdWU7XG4gICAgfVxuXG4gICAgLy8gTG9hZCB1cCBhIGJ1bmNoIG9mIGRhdGEgdGFibGVzLiAgVGhpcyB3aWxsIGluY2x1ZGUgYSBsYXJnZSBudW1iZXIgb2YgdGhlXG4gICAgLy8gZGF0YSB0YWJsZXMgaW4gdGhlIFJPTS4gIFRoZSBpZGVhIGlzIHRoYXQgd2UgY2FuIGVkaXQgdGhlIGFycmF5cyBsb2NhbGx5XG4gICAgLy8gYW5kIHRoZW4gaGF2ZSBhIFwiY29tbWl0XCIgZnVuY3Rpb24gdGhhdCByZWJ1aWxkcyB0aGUgUk9NIHdpdGggdGhlIG5ld1xuICAgIC8vIGFycmF5cy4gIFdlIG1heSBuZWVkIHRvIHdyaXRlIGEgXCJwYWdlZCBhbGxvY2F0b3JcIiB0aGF0IGNhbiBhbGxvY2F0ZVxuICAgIC8vIGNodW5rcyBvZiBST00gaW4gYSBnaXZlbiBwYWdlLiAgUHJvYmFibHkgd2FudCB0byB1c2UgYSBncmVlZHkgYWxnb3JpdGhtXG4gICAgLy8gd2hlcmUgd2Ugc3RhcnQgd2l0aCB0aGUgYmlnZ2VzdCBjaHVuayBhbmQgcHV0IGl0IGluIHRoZSBzbWFsbGVzdCBzcG90XG4gICAgLy8gdGhhdCBmaXRzIGl0LiAgUHJlc3VtYWJseSB3ZSBrbm93IHRoZSBzaXplcyB1cCBmcm9udCBldmVuIGJlZm9yZSB3ZSBoYXZlXG4gICAgLy8gYWxsIHRoZSBhZGRyZXNzZXMsIHNvIHdlIGNvdWxkIGRvIGFsbCB0aGUgYWxsb2NhdGlvbiBhdCBvbmNlIC0gcHJvYmFibHlcbiAgICAvLyByZXR1cm5pbmcgYSB0b2tlbiBmb3IgZWFjaCBhbGxvY2F0aW9uIGFuZCB0aGVuIGFsbCB0b2tlbnMgZ2V0IGZpbGxlZCBpblxuICAgIC8vIGF0IG9uY2UgKGFjdHVhbCBwcm9taXNlcyB3b3VsZCBiZSBtb3JlIHVud2VpbGR5KS5cbiAgICAvLyBUcmlja3kgLSB3aGF0IGFib3V0IHNoYXJlZCBlbGVtZW50cyBvZiBkYXRhIHRhYmxlcyAtIHdlIHB1bGwgdGhlbVxuICAgIC8vIHNlcGFyYXRlbHksIGJ1dCB3ZSdsbCBuZWVkIHRvIHJlLWNvYWxlc2NlIHRoZW0uICBCdXQgdGhpcyByZXF1aXJlc1xuICAgIC8vIGtub3dpbmcgdGhlaXIgY29udGVudHMgQkVGT1JFIGFsbG9jYXRpbmcgdGhlaXIgc3BhY2UuICBTbyB3ZSBuZWVkIHR3b1xuICAgIC8vIGFsbG9jYXRlIG1ldGhvZHMgLSBvbmUgd2hlcmUgdGhlIGNvbnRlbnQgaXMga25vd24gYW5kIG9uZSB3aGVyZSBvbmx5IHRoZVxuICAgIC8vIGxlbmd0aCBpcyBrbm93bi5cbiAgICB0aGlzLnNjcmVlbnMgPSBzZXEoMHgxMDMsIGkgPT4gbmV3IFNjcmVlbih0aGlzLCBpKSk7XG4gICAgdGhpcy50aWxlc2V0cyA9IHNlcSgxMiwgaSA9PiBuZXcgVGlsZXNldCh0aGlzLCBpIDw8IDIgfCAweDgwKSk7XG4gICAgdGhpcy50aWxlRWZmZWN0cyA9IHNlcSgxMSwgaSA9PiBuZXcgVGlsZUVmZmVjdHModGhpcywgaSArIDB4YjMpKTtcbiAgICB0aGlzLnRyaWdnZXJzID0gc2VxKDB4NDMsIGkgPT4gbmV3IFRyaWdnZXIodGhpcywgMHg4MCB8IGkpKTtcbiAgICB0aGlzLnBhdHRlcm5zID0gc2VxKHRoaXMuY2hyLmxlbmd0aCA+PiA0LCBpID0+IG5ldyBQYXR0ZXJuKHRoaXMsIGkpKTtcbiAgICB0aGlzLnBhbGV0dGVzID0gc2VxKDB4MTAwLCBpID0+IG5ldyBQYWxldHRlKHRoaXMsIGkpKTtcbiAgICB0aGlzLmxvY2F0aW9ucyA9IG5ldyBMb2NhdGlvbnModGhpcyk7XG4gICAgdGhpcy50aWxlQW5pbWF0aW9ucyA9IHNlcSg0LCBpID0+IG5ldyBUaWxlQW5pbWF0aW9uKHRoaXMsIGkpKTtcbiAgICB0aGlzLmhpdGJveGVzID0gc2VxKDI0LCBpID0+IG5ldyBIaXRib3godGhpcywgaSkpO1xuICAgIHRoaXMub2JqZWN0cyA9IG5ldyBPYmplY3RzKHRoaXMpO1xuICAgIHRoaXMuYWRIb2NTcGF3bnMgPSBzZXEoMHg2MCwgaSA9PiBuZXcgQWRIb2NTcGF3bih0aGlzLCBpKSk7XG4gICAgdGhpcy5tZXRhc3ByaXRlcyA9IHNlcSgweDEwMCwgaSA9PiBuZXcgTWV0YXNwcml0ZSh0aGlzLCBpKSk7XG4gICAgdGhpcy5tZXNzYWdlcyA9IG5ldyBNZXNzYWdlcyh0aGlzKTtcbiAgICB0aGlzLnRlbGVwYXRoeSA9IG5ldyBUZWxlcGF0aHkodGhpcyk7XG4gICAgdGhpcy5pdGVtR2V0cyA9IHNlcSgweDcxLCBpID0+IG5ldyBJdGVtR2V0KHRoaXMsIGkpKTtcbiAgICB0aGlzLml0ZW1zID0gc2VxKDB4NDksIGkgPT4gbmV3IEl0ZW0odGhpcywgaSkpO1xuICAgIHRoaXMuc2hvcHMgPSBzZXEoNDQsIGkgPT4gbmV3IFNob3AodGhpcywgaSkpOyAvLyBOT1RFOiBkZXBlbmRzIG9uIGxvY2F0aW9ucyBhbmQgb2JqZWN0c1xuICAgIHRoaXMubnBjcyA9IHNlcSgweGNkLCBpID0+IG5ldyBOcGModGhpcywgaSkpO1xuICAgIHRoaXMuYm9zc0tpbGxzID0gc2VxKDB4ZSwgaSA9PiBuZXcgQm9zc0tpbGwodGhpcywgaSkpO1xuICAgIHRoaXMuYm9zc2VzID0gbmV3IEJvc3Nlcyh0aGlzKTtcbiAgICB0aGlzLndpbGRXYXJwID0gbmV3IFdpbGRXYXJwKHRoaXMpO1xuICB9XG5cbiAgdHJpZ2dlcihpZDogbnVtYmVyKTogVHJpZ2dlciB7XG4gICAgaWYgKGlkIDwgMHg4MCB8fCBpZCA+IDB4ZmYpIHRocm93IG5ldyBFcnJvcihgQmFkIHRyaWdnZXIgaWQgJCR7aGV4KGlkKX1gKTtcbiAgICByZXR1cm4gdGhpcy50cmlnZ2Vyc1tpZCAmIDB4N2ZdO1xuICB9XG5cbiAgdGlsZXNldChpZDogbnVtYmVyKTogVGlsZXNldCB7XG4gICAgaWYgKGlkIDwgMHg4MCB8fCBpZCA+IDB4YWMgfHwgaWQgJiAzKSB0aHJvdyBuZXcgRXJyb3IoYEJhZCB0aWxlc2V0IGlkICQke2hleChpZCl9YCk7XG4gICAgcmV0dXJuIHRoaXMudGlsZXNldHNbKGlkICYgMHg3ZikgPj4+IDJdO1xuICB9XG5cbiAgLy8gVE9ETyAtIGNyb3NzLXJlZmVyZW5jZSBtb25zdGVycy9tZXRhc3ByaXRlcy9tZXRhdGlsZXMvc2NyZWVucyB3aXRoIHBhdHRlcm5zL3BhbGV0dGVzXG4gIC8vIGdldCBtb25zdGVycygpOiBPYmplY3REYXRhW10ge1xuICAvLyAgIGNvbnN0IG1vbnN0ZXJzID0gbmV3IFNldDxPYmplY3REYXRhPigpO1xuICAvLyAgIGZvciAoY29uc3QgbCBvZiB0aGlzLmxvY2F0aW9ucykge1xuICAvLyAgICAgaWYgKCFsLnVzZWQgfHwgIWwuaGFzU3Bhd25zKSBjb250aW51ZTtcbiAgLy8gICAgIGZvciAoY29uc3QgbyBvZiBsLnNwYXducykge1xuICAvLyAgICAgICBpZiAoby5pc01vbnN0ZXIoKSkgbW9uc3RlcnMuYWRkKHRoaXMub2JqZWN0c1tvLm1vbnN0ZXJJZF0pO1xuICAvLyAgICAgfVxuICAvLyAgIH1cbiAgLy8gICByZXR1cm4gWy4uLm1vbnN0ZXJzXS5zb3J0KCh4LCB5KSA9PiAoeC5pZCAtIHkuaWQpKTtcbiAgLy8gfVxuXG4gIGdldCBwcm9qZWN0aWxlcygpOiBPYmplY3REYXRhW10ge1xuICAgIGNvbnN0IHByb2plY3RpbGVzID0gbmV3IFNldDxPYmplY3REYXRhPigpO1xuICAgIGZvciAoY29uc3QgbSBvZiB0aGlzLm9iamVjdHMuZmlsdGVyKG8gPT4gbyBpbnN0YW5jZW9mIE1vbnN0ZXIpKSB7XG4gICAgICBpZiAobS5jaGlsZCkge1xuICAgICAgICBwcm9qZWN0aWxlcy5hZGQodGhpcy5vYmplY3RzW3RoaXMuYWRIb2NTcGF3bnNbbS5jaGlsZF0ub2JqZWN0SWRdKTtcbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIFsuLi5wcm9qZWN0aWxlc10uc29ydCgoeCwgeSkgPT4gKHguaWQgLSB5LmlkKSk7XG4gIH1cblxuICBnZXQgbW9uc3RlckdyYXBoaWNzKCkge1xuICAgIGNvbnN0IGdmeDoge1tpZDogc3RyaW5nXTpcbiAgICAgICAgICAgICAgICB7W2luZm86IHN0cmluZ106XG4gICAgICAgICAgICAgICAgIHtzbG90OiBudW1iZXIsIHBhdDogbnVtYmVyLCBwYWw6IG51bWJlcn19fSA9IHt9O1xuICAgIGZvciAoY29uc3QgbCBvZiB0aGlzLmxvY2F0aW9ucykge1xuICAgICAgaWYgKCFsLnVzZWQgfHwgIWwuaGFzU3Bhd25zKSBjb250aW51ZTtcbiAgICAgIGZvciAoY29uc3QgbyBvZiBsLnNwYXducykge1xuICAgICAgICBpZiAoIShvLmRhdGFbMl0gJiA3KSkge1xuICAgICAgICAgIGNvbnN0IHNsb3QgPSBvLmRhdGFbMl0gJiAweDgwID8gMSA6IDA7XG4gICAgICAgICAgY29uc3QgaWQgPSBoZXgoby5kYXRhWzNdICsgMHg1MCk7XG4gICAgICAgICAgY29uc3QgZGF0YSA9IGdmeFtpZF0gPSBnZnhbaWRdIHx8IHt9O1xuICAgICAgICAgIGRhdGFbYCR7c2xvdH06JHtsLnNwcml0ZVBhdHRlcm5zW3Nsb3RdLnRvU3RyaW5nKDE2KX06JHtcbiAgICAgICAgICAgICAgIGwuc3ByaXRlUGFsZXR0ZXNbc2xvdF0udG9TdHJpbmcoMTYpfWBdXG4gICAgICAgICAgICA9IHtwYWw6IGwuc3ByaXRlUGFsZXR0ZXNbc2xvdF0sXG4gICAgICAgICAgICAgICBwYXQ6IGwuc3ByaXRlUGF0dGVybnNbc2xvdF0sXG4gICAgICAgICAgICAgICBzbG90LFxuICAgICAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBnZng7XG4gIH1cblxuICBnZXQgbG9jYXRpb25Nb25zdGVycygpIHtcbiAgICBjb25zdCBtOiB7W2lkOiBzdHJpbmddOiB7W2luZm86IHN0cmluZ106IG51bWJlcn19ID0ge307XG4gICAgZm9yIChjb25zdCBsIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICBpZiAoIWwudXNlZCB8fCAhbC5oYXNTcGF3bnMpIGNvbnRpbnVlO1xuICAgICAgLy8gd2hpY2ggbW9uc3RlcnMgYXJlIGluIHdoaWNoIHNsb3RzP1xuICAgICAgY29uc3Qgczoge1tpbmZvOiBzdHJpbmddOiBudW1iZXJ9ID0gbVsnJCcgKyBoZXgobC5pZCldID0ge307XG4gICAgICBmb3IgKGNvbnN0IG8gb2YgbC5zcGF3bnMpIHtcbiAgICAgICAgaWYgKCEoby5kYXRhWzJdICYgNykpIHtcbiAgICAgICAgICBjb25zdCBzbG90ID0gby5kYXRhWzJdICYgMHg4MCA/IDEgOiAwO1xuICAgICAgICAgIGNvbnN0IGlkID0gby5kYXRhWzNdICsgMHg1MDtcbiAgICAgICAgICBzW2Ake3Nsb3R9OiR7aWQudG9TdHJpbmcoMTYpfWBdID1cbiAgICAgICAgICAgICAgKHNbYCR7c2xvdH06JHtpZC50b1N0cmluZygxNil9YF0gfHwgMCkgKyAxO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtO1xuICB9XG5cbiAgLy8gVE9ETyAtIGZvciBlYWNoIHNwcml0ZSBwYXR0ZXJuIHRhYmxlLCBmaW5kIGFsbCB0aGUgcGFsZXR0ZXMgdGhhdCBpdCB1c2VzLlxuICAvLyBGaW5kIGFsbCB0aGUgbW9uc3RlcnMgb24gaXQuICBXZSBjYW4gcHJvYmFibHkgYWxsb3cgYW55IHBhbGV0dGUgc28gbG9uZ1xuICAvLyBhcyBvbmUgb2YgdGhlIHBhbGV0dGVzIGlzIHVzZWQgd2l0aCB0aGF0IHBhdHRlcm4uXG4gIC8vIFRPRE8gLSBtYXggbnVtYmVyIG9mIGluc3RhbmNlcyBvZiBhIG1vbnN0ZXIgb24gYW55IG1hcCAtIGkuZS4gYXZvaWQgaGF2aW5nXG4gIC8vIGZpdmUgZmx5ZXJzIG9uIHRoZSBzYW1lIG1hcCFcblxuICAvLyA0NjAgLSAwIG1lYW5zIGVpdGhlciBmbHllciBvciBzdGF0aW9uYXJ5XG4gIC8vICAgICAgICAgICAtIHN0YXRpb25hcnkgaGFzIDRhMCB+IDIwNCwyMDUsMjA2XG4gIC8vICAgICAgICAgICAgIChrcmFrZW4sIHN3YW1wIHBsYW50LCBzb3JjZXJvcilcbiAgLy8gICAgICAgNiAtIG1pbWljXG4gIC8vICAgICAgIDFmIC0gc3dpbW1lclxuICAvLyAgICAgICA1NCAtIHRvbWF0byBhbmQgYmlyZFxuICAvLyAgICAgICA1NSAtIHN3aW1tZXJcbiAgLy8gICAgICAgNTcgLSBub3JtYWxcbiAgLy8gICAgICAgNWYgLSBhbHNvIG5vcm1hbCwgYnV0IG1lZHVzYSBoZWFkIGlzIGZseWVyP1xuICAvLyAgICAgICA3NyAtIHNvbGRpZXJzLCBpY2Ugem9tYmllXG5cbi8vICAgLy8gRG9uJ3Qgd29ycnkgYWJvdXQgb3RoZXIgZGF0YXMgeWV0XG4vLyAgIHdyaXRlT2JqZWN0RGF0YSgpIHtcbi8vICAgICAvLyBidWlsZCB1cCBhIG1hcCBmcm9tIGFjdHVhbCBkYXRhIHRvIGluZGV4ZXMgdGhhdCBwb2ludCB0byBpdFxuLy8gICAgIGxldCBhZGRyID0gMHgxYWUwMDtcbi8vICAgICBjb25zdCBkYXRhcyA9IHt9O1xuLy8gICAgIGZvciAoY29uc3Qgb2JqZWN0IG9mIHRoaXMub2JqZWN0cykge1xuLy8gICAgICAgY29uc3Qgc2VyID0gb2JqZWN0LnNlcmlhbGl6ZSgpO1xuLy8gICAgICAgY29uc3QgZGF0YSA9IHNlci5qb2luKCcgJyk7XG4vLyAgICAgICBpZiAoZGF0YSBpbiBkYXRhcykge1xuLy8gLy9jb25zb2xlLmxvZyhgJCR7b2JqZWN0LmlkLnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLDApfTogUmV1c2luZyBleGlzdGluZyBkYXRhICQke2RhdGFzW2RhdGFdLnRvU3RyaW5nKDE2KX1gKTtcbi8vICAgICAgICAgb2JqZWN0Lm9iamVjdERhdGFCYXNlID0gZGF0YXNbZGF0YV07XG4vLyAgICAgICB9IGVsc2Uge1xuLy8gICAgICAgICBvYmplY3Qub2JqZWN0RGF0YUJhc2UgPSBhZGRyO1xuLy8gICAgICAgICBkYXRhc1tkYXRhXSA9IGFkZHI7XG4vLyAvL2NvbnNvbGUubG9nKGAkJHtvYmplY3QuaWQudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsMCl9OiBEYXRhIGlzIGF0ICQke1xuLy8gLy8gICAgICAgICAgICAgYWRkci50b1N0cmluZygxNil9OiAke0FycmF5LmZyb20oc2VyLCB4PT4nJCcreC50b1N0cmluZygxNikucGFkU3RhcnQoMiwwKSkuam9pbignLCcpfWApO1xuLy8gICAgICAgICBhZGRyICs9IHNlci5sZW5ndGg7XG4vLyAvLyBzZWVkIDM1MTc4MTEwMzZcbi8vICAgICAgIH1cbi8vICAgICAgIG9iamVjdC53cml0ZSgpO1xuLy8gICAgIH1cbi8vIC8vY29uc29sZS5sb2coYFdyb3RlIG9iamVjdCBkYXRhIGZyb20gJDFhYzAwIHRvICQke2FkZHIudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDUsIDApXG4vLyAvLyAgICAgICAgICAgICB9LCBzYXZpbmcgJHsweDFiZTkxIC0gYWRkcn0gYnl0ZXMuYCk7XG4vLyAgICAgcmV0dXJuIGFkZHI7XG4vLyAgIH1cblxuICBhc3luYyB3cml0ZURhdGEoKSB7XG4gICAgLy8gV3JpdGUgdGhlIG9wdGlvbnMgZmlyc3RcbiAgICBSb20uU0hPUF9DT1VOVC5zZXQodGhpcy5wcmcsIHRoaXMuc2hvcENvdW50KTtcbiAgICBSb20uU0NBTElOR19MRVZFTFMuc2V0KHRoaXMucHJnLCB0aGlzLnNjYWxpbmdMZXZlbHMpO1xuICAgIFJvbS5VTklRVUVfSVRFTV9UQUJMRS5zZXQodGhpcy5wcmcsIHRoaXMudW5pcXVlSXRlbVRhYmxlQWRkcmVzcyk7XG4gICAgUm9tLlNIT1BfREFUQV9UQUJMRVMuc2V0KHRoaXMucHJnLCB0aGlzLnNob3BEYXRhVGFibGVzQWRkcmVzcyk7XG4gICAgUm9tLk9NSVRfSVRFTV9HRVRfREFUQV9TVUZGSVguc2V0KHRoaXMucHJnLCB0aGlzLm9taXRJdGVtR2V0RGF0YVN1ZmZpeCk7XG4gICAgUm9tLk9NSVRfTE9DQUxfRElBTE9HX1NVRkZJWC5zZXQodGhpcy5wcmcsIHRoaXMub21pdExvY2FsRGlhbG9nU3VmZml4KTtcbiAgICBSb20uQ09NUFJFU1NFRF9NQVBEQVRBLnNldCh0aGlzLnByZywgdGhpcy5jb21wcmVzc2VkTWFwRGF0YSk7XG5cbiAgICBjb25zdCB3cml0ZXIgPSBuZXcgV3JpdGVyKHRoaXMucHJnLCB0aGlzLmNocik7XG4gICAgLy8gTWFwRGF0YVxuICAgIHdyaXRlci5hbGxvYygweDE0NGY4LCAweDE3ZTAwKTtcbiAgICAvLyBOcGNEYXRhXG4gICAgLy8gTk9URTogMTkzZjkgaXMgYXNzdW1pbmcgJGZiIGlzIHRoZSBsYXN0IGxvY2F0aW9uIElELiAgSWYgd2UgYWRkIG1vcmUgbG9jYXRpb25zIGF0XG4gICAgLy8gdGhlIGVuZCB0aGVuIHdlJ2xsIG5lZWQgdG8gcHVzaCB0aGlzIGJhY2sgYSBmZXcgbW9yZSBieXRlcy4gIFdlIGNvdWxkIHBvc3NpYmx5XG4gICAgLy8gZGV0ZWN0IHRoZSBiYWQgd3JpdGUgYW5kIHRocm93IGFuIGVycm9yLCBhbmQvb3IgY29tcHV0ZSB0aGUgbWF4IGxvY2F0aW9uIElELlxuICAgIHdyaXRlci5hbGxvYygweDE5M2Y5LCAweDFhYzAwKTtcbiAgICAvLyBPYmplY3REYXRhIChpbmRleCBhdCAxYWMwMC4uMWFlMDApXG4gICAgd3JpdGVyLmFsbG9jKDB4MWFlMDAsIDB4MWJkMDApOyAvLyBzYXZlIDUxMiBieXRlcyBhdCBlbmQgZm9yIHNvbWUgZXh0cmEgY29kZVxuICAgIC8vIE5wY1NwYXduQ29uZGl0aW9uc1xuICAgIHdyaXRlci5hbGxvYygweDFjNzdhLCAweDFjOTVkKTtcbiAgICAvLyBOcGNEaWFsb2dcbiAgICB3cml0ZXIuYWxsb2MoMHgxY2FlNSwgMHgxZDhmNCk7XG4gICAgLy8gSXRlbUdldERhdGFcbiAgICB3cml0ZXIuYWxsb2MoMHgxZGRlNiwgMHgxZTA2NSk7XG4gICAgLy8gVHJpZ2dlckRhdGFcbiAgICAvLyBOT1RFOiBUaGVyZSdzIHNvbWUgZnJlZSBzcGFjZSBhdCAxZTNjMC4uMWUzZjAsIGJ1dCB3ZSB1c2UgdGhpcyBmb3IgdGhlXG4gICAgLy8gQ2hlY2tCZWxvd0Jvc3MgdHJpZ2dlcnMuXG4gICAgd3JpdGVyLmFsbG9jKDB4MWUyMDAsIDB4MWUzYzApO1xuICAgIC8vIEl0ZW1NZW51TmFtZVxuICAgIHdyaXRlci5hbGxvYygweDIxMTFhLCAweDIxNDY4KTtcbiAgICAvLyBrZWVwIGl0ZW0gJDQ5IFwiICAgICAgICBcIiB3aGljaCBpcyBhY3R1YWxseSB1c2VkIHNvbWV3aGVyZT9cbiAgICAvLyB3cml0ZXIuYWxsb2MoMHgyMTQ3MSwgMHgyMTRmMSk7IC8vIFRPRE8gLSBkbyB3ZSBuZWVkIGFueSBvZiB0aGlzP1xuICAgIC8vIEl0ZW1NZXNzYWdlTmFtZVxuICAgIC8vIHdyaXRlci5hbGxvYygweDI4ZTgxLCAweDI5MjJiKTsgLy8gTk9URTogdW5jb3ZlcmVkIHRocnUgMjk0MDBcbiAgICAvLyB3cml0ZXIuYWxsb2MoMHgyOTIyYiwgMHgyOTQwMCk7IC8vIFRPRE8gLSBuZWVkZWQ/XG4gICAgLy8gTk9URTogb25jZSB3ZSByZWxlYXNlIHRoZSBvdGhlciBtZXNzYWdlIHRhYmxlcywgdGhpcyB3aWxsIGp1c3QgYmUgb25lIGdpYW50IGJsb2NrLlxuXG4gICAgLy8gTWVzc2FnZSB0YWJsZSBwYXJ0c1xuICAgIC8vIHdyaXRlci5hbGxvYygweDI4MDAwLCAweDI4M2ZlKTtcbiAgICAvLyBNZXNzYWdlIHRhYmxlc1xuICAgIC8vIFRPRE8gLSB3ZSBkb24ndCB1c2UgdGhlIHdyaXRlciB0byBhbGxvY2F0ZSB0aGUgYWJicmV2aWF0aW9uIHRhYmxlcywgYnV0IHdlIGNvdWxkXG4gICAgd3JpdGVyLmFsbG9jKDB4MmEwMDAsIDB4MmZjMDApO1xuXG4gICAgaWYgKHRoaXMudGVsZXBhdGh5VGFibGVzQWRkcmVzcykge1xuICAgICAgd3JpdGVyLmFsbG9jKDB4MWQ4ZjQsIDB4MWRiMDApOyAvLyBsb2NhdGlvbiB0YWJsZSBhbGwgdGhlIHdheSB0aHJ1IG1haW5cbiAgICB9IGVsc2Uge1xuICAgICAgd3JpdGVyLmFsbG9jKDB4MWRhNGMsIDB4MWRiMDApOyAvLyBleGlzdGluZyBtYWluIHRhYmxlIGlzIGhlcmUuXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICBjb25zdCB3cml0ZUFsbCA9ICh3cml0YWJsZXM6IHt3cml0ZSh3cml0ZXI6IFdyaXRlcik6IHVua25vd259W10pID0+IHtcbiAgICAgIGZvciAoY29uc3QgdyBvZiB3cml0YWJsZXMpIHtcbiAgICAgICAgcHJvbWlzZXMucHVzaCh3LndyaXRlKHdyaXRlcikpO1xuICAgICAgfVxuICAgIH07XG4gICAgd3JpdGVBbGwodGhpcy5sb2NhdGlvbnMpO1xuICAgIHdyaXRlQWxsKHRoaXMub2JqZWN0cyk7XG4gICAgd3JpdGVBbGwodGhpcy5oaXRib3hlcyk7XG4gICAgd3JpdGVBbGwodGhpcy50cmlnZ2Vycyk7XG4gICAgd3JpdGVBbGwodGhpcy5ucGNzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnRpbGVzZXRzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnRpbGVFZmZlY3RzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnNjcmVlbnMpO1xuICAgIHdyaXRlQWxsKHRoaXMuYWRIb2NTcGF3bnMpO1xuICAgIHdyaXRlQWxsKHRoaXMuaXRlbUdldHMpO1xuICAgIHdyaXRlQWxsKHRoaXMuaXRlbXMpO1xuICAgIHdyaXRlQWxsKHRoaXMuc2hvcHMpO1xuICAgIHdyaXRlQWxsKHRoaXMuYm9zc0tpbGxzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnBhdHRlcm5zKTtcbiAgICB0aGlzLndpbGRXYXJwLndyaXRlKHdyaXRlcik7XG4gICAgcHJvbWlzZXMucHVzaCh0aGlzLnRlbGVwYXRoeS53cml0ZSh3cml0ZXIpKTtcbiAgICBwcm9taXNlcy5wdXNoKHRoaXMubWVzc2FnZXMud3JpdGUod3JpdGVyKSk7XG4gICAgcHJvbWlzZXMucHVzaCh3cml0ZXIuY29tbWl0KCkpO1xuICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKS50aGVuKCgpID0+IHVuZGVmaW5lZCk7XG4gIH1cblxuICBhbmFseXplVGlsZXMoKSB7XG4gICAgLy8gRm9yIGFueSBnaXZlbiB0aWxlIGluZGV4LCB3aGF0IHNjcmVlbnMgZG9lcyBpdCBhcHBlYXIgb24uXG4gICAgLy8gRm9yIHRob3NlIHNjcmVlbnMsIHdoaWNoIHRpbGVzZXRzIGRvZXMgKml0KiBhcHBlYXIgb24uXG4gICAgLy8gVGhhdCB0aWxlIElEIGlzIGxpbmtlZCBhY3Jvc3MgYWxsIHRob3NlIHRpbGVzZXRzLlxuICAgIC8vIEZvcm1zIGEgcGFydGl0aW9uaW5nIGZvciBlYWNoIHRpbGUgSUQgPT4gdW5pb24tZmluZC5cbiAgICAvLyBHaXZlbiB0aGlzIHBhcnRpdGlvbmluZywgaWYgSSB3YW50IHRvIG1vdmUgYSB0aWxlIG9uIGEgZ2l2ZW5cbiAgICAvLyB0aWxlc2V0LCBhbGwgSSBuZWVkIHRvIGRvIGlzIGZpbmQgYW5vdGhlciB0aWxlIElEIHdpdGggdGhlXG4gICAgLy8gc2FtZSBwYXJ0aXRpb24gYW5kIHN3YXAgdGhlbT9cblxuICAgIC8vIE1vcmUgZ2VuZXJhbGx5LCB3ZSBjYW4ganVzdCBwYXJ0aXRpb24gdGhlIHRpbGVzZXRzLlxuXG4gICAgLy8gRm9yIGVhY2ggc2NyZWVuLCBmaW5kIGFsbCB0aWxlc2V0cyBUIGZvciB0aGF0IHNjcmVlblxuICAgIC8vIFRoZW4gZm9yIGVhY2ggdGlsZSBvbiB0aGUgc2NyZWVuLCB1bmlvbiBUIGZvciB0aGF0IHRpbGUuXG5cbiAgICAvLyBHaXZlbiBhIHRpbGVzZXQgYW5kIGEgbWV0YXRpbGUgSUQsIGZpbmQgYWxsIHRoZSBzY3JlZW5zIHRoYXQgKDEpIGFyZSByZW5kZXJlZFxuICAgIC8vIHdpdGggdGhhdCB0aWxlc2V0LCBhbmQgKGIpIHRoYXQgY29udGFpbiB0aGF0IG1ldGF0aWxlOyB0aGVuIGZpbmQgYWxsICpvdGhlcipcbiAgICAvLyB0aWxlc2V0cyB0aGF0IHRob3NlIHNjcmVlbnMgYXJlIGV2ZXIgcmVuZGVyZWQgd2l0aC5cblxuICAgIC8vIEdpdmVuIGEgc2NyZWVuLCBmaW5kIGFsbCBhdmFpbGFibGUgbWV0YXRpbGUgSURzIHRoYXQgY291bGQgYmUgYWRkZWQgdG8gaXRcbiAgICAvLyB3aXRob3V0IGNhdXNpbmcgcHJvYmxlbXMgd2l0aCBvdGhlciBzY3JlZW5zIHRoYXQgc2hhcmUgYW55IHRpbGVzZXRzLlxuICAgIC8vICAtPiB1bnVzZWQgKG9yIHVzZWQgYnV0IHNoYXJlZCBleGNsdXNpdmVseSkgYWNyb3NzIGFsbCB0aWxlc2V0cyB0aGUgc2NyZWVuIG1heSB1c2VcblxuICAgIC8vIFdoYXQgSSB3YW50IGZvciBzd2FwcGluZyBpcyB0aGUgZm9sbG93aW5nOlxuICAgIC8vICAxLiBmaW5kIGFsbCBzY3JlZW5zIEkgd2FudCB0byB3b3JrIG9uID0+IHRpbGVzZXRzXG4gICAgLy8gIDIuIGZpbmQgdW51c2VkIGZsYWdnYWJibGUgdGlsZXMgaW4gdGhlIGhhcmRlc3Qgb25lLFxuICAgIC8vICAgICB3aGljaCBhcmUgYWxzbyBJU09MQVRFRCBpbiB0aGUgb3RoZXJzLlxuICAgIC8vICAzLiB3YW50IHRoZXNlIHRpbGVzIHRvIGJlIHVudXNlZCBpbiBBTEwgcmVsZXZhbnQgdGlsZXNldHNcbiAgICAvLyAgNC4gdG8gbWFrZSB0aGlzIHNvLCBmaW5kICpvdGhlciogdW51c2VkIGZsYWdnYWJsZSB0aWxlcyBpbiBvdGhlciB0aWxlc2V0c1xuICAgIC8vICA1LiBzd2FwIHRoZSB1bnVzZWQgd2l0aCB0aGUgaXNvbGF0ZWQgdGlsZXMgaW4gdGhlIG90aGVyIHRpbGVzZXRzXG5cbiAgICAvLyBDYXZlczpcbiAgICAvLyAgMGE6ICAgICAgOTAgLyA5Y1xuICAgIC8vICAxNTogODAgLyA5MCAvIDljXG4gICAgLy8gIDE5OiAgICAgIDkwICAgICAgKHdpbGwgYWRkIHRvIDgwPylcbiAgICAvLyAgM2U6ICAgICAgOTBcbiAgICAvL1xuICAgIC8vIElkZWFsbHkgd2UgY291bGQgcmV1c2UgODAncyAxLzIvMy80IGZvciB0aGlzXG4gICAgLy8gIDAxOiA5MCB8IDk0IDljXG4gICAgLy8gIDAyOiA5MCB8IDk0IDljXG4gICAgLy8gIDAzOiAgICAgIDk0IDljXG4gICAgLy8gIDA0OiA5MCB8IDk0IDljXG4gICAgLy9cbiAgICAvLyBOZWVkIDQgb3RoZXIgZmxhZ2dhYmxlIHRpbGUgaW5kaWNlcyB3ZSBjYW4gc3dhcCB0bz9cbiAgICAvLyAgIDkwOiA9PiAoMSwyIG5lZWQgZmxhZ2dhYmxlOyAzIHVudXNlZDsgNCBhbnkpID0+IDA3LCAwZSwgMTAsIDEyLCAxMywgLi4uLCAyMCwgMjEsIDIyLCAuLi5cbiAgICAvLyAgIDk0IDljOiA9PiBkb24ndCBuZWVkIGFueSBmbGFnZ2FibGUgPT4gMDUsIDNjLCA2OCwgODMsIDg4LCA4OSwgOGEsIDkwLCAuLi5cbiAgfVxuXG4gIGRpc2pvaW50VGlsZXNldHMoKSB7XG4gICAgY29uc3QgdGlsZXNldEJ5U2NyZWVuOiBBcnJheTxTZXQ8bnVtYmVyPj4gPSBbXTtcbiAgICBmb3IgKGNvbnN0IGxvYyBvZiB0aGlzLmxvY2F0aW9ucykge1xuICAgICAgaWYgKCFsb2MudXNlZCkgY29udGludWU7XG4gICAgICBjb25zdCB0aWxlc2V0ID0gbG9jLnRpbGVzZXQ7XG4gICAgICBjb25zdCBleHQgPSBsb2MuZXh0ZW5kZWQgPyAweDEwMCA6IDA7XG4gICAgICBmb3IgKGNvbnN0IHJvdyBvZiBsb2Muc2NyZWVucykge1xuICAgICAgICBmb3IgKGNvbnN0IHMgb2Ygcm93KSB7XG4gICAgICAgICAgKHRpbGVzZXRCeVNjcmVlbltzICsgZXh0XSB8fCAodGlsZXNldEJ5U2NyZWVuW3MgKyBleHRdID0gbmV3IFNldCgpKSkuYWRkKHRpbGVzZXQpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHRpbGVzID0gc2VxKDI1NiwgKCkgPT4gbmV3IFVuaW9uRmluZDxudW1iZXI+KCkpO1xuICAgIGZvciAobGV0IHMgPSAwOyBzIDwgdGlsZXNldEJ5U2NyZWVuLmxlbmd0aDsgcysrKSB7XG4gICAgICBpZiAoIXRpbGVzZXRCeVNjcmVlbltzXSkgY29udGludWU7XG4gICAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy5zY3JlZW5zW3NdLmFsbFRpbGVzU2V0KCkpIHtcbiAgICAgICAgdGlsZXNbdF0udW5pb24oWy4uLnRpbGVzZXRCeVNjcmVlbltzXV0pO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBvdXRwdXRcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8IHRpbGVzLmxlbmd0aDsgdCsrKSB7XG4gICAgICBjb25zdCBwID0gdGlsZXNbdF0uc2V0cygpXG4gICAgICAgICAgLm1hcCgoczogU2V0PG51bWJlcj4pID0+IFsuLi5zXS5tYXAoaGV4KS5qb2luKCcgJykpXG4gICAgICAgICAgLmpvaW4oJyB8ICcpO1xuICAgICAgY29uc29sZS5sb2coYFRpbGUgJHtoZXgodCl9OiAke3B9YCk7XG4gICAgfVxuICAgIC8vICAgaWYgKCF0aWxlc2V0QnlTY3JlZW5baV0pIHtcbiAgICAvLyAgICAgY29uc29sZS5sb2coYE5vIHRpbGVzZXQgZm9yIHNjcmVlbiAke2kudG9TdHJpbmcoMTYpfWApO1xuICAgIC8vICAgICBjb250aW51ZTtcbiAgICAvLyAgIH1cbiAgICAvLyAgIHVuaW9uLnVuaW9uKFsuLi50aWxlc2V0QnlTY3JlZW5baV1dKTtcbiAgICAvLyB9XG4gICAgLy8gcmV0dXJuIHVuaW9uLnNldHMoKTtcbiAgfVxuXG4gIC8vIEN5Y2xlcyBhcmUgbm90IGFjdHVhbGx5IGN5Y2xpYyAtIGFuIGV4cGxpY2l0IGxvb3AgYXQgdGhlIGVuZCBpcyByZXF1aXJlZCB0byBzd2FwLlxuICAvLyBWYXJpYW5jZTogWzEsIDIsIG51bGxdIHdpbGwgY2F1c2UgaW5zdGFuY2VzIG9mIDEgdG8gYmVjb21lIDIgYW5kIHdpbGxcbiAgLy8gICAgICAgICAgIGNhdXNlIHByb3BlcnRpZXMgb2YgMSB0byBiZSBjb3BpZWQgaW50byBzbG90IDJcbiAgLy8gQ29tbW9uIHVzYWdlIGlzIHRvIHN3YXAgdGhpbmdzIG91dCBvZiB0aGUgd2F5IGFuZCB0aGVuIGNvcHkgaW50byB0aGVcbiAgLy8gbmV3bHktZnJlZWQgc2xvdC4gIFNheSB3ZSB3YW50ZWQgdG8gZnJlZSB1cCBzbG90cyBbMSwgMiwgMywgNF0gYW5kXG4gIC8vIGhhZCBhdmFpbGFibGUvZnJlZSBzbG90cyBbNSwgNiwgNywgOF0gYW5kIHdhbnQgdG8gY29weSBmcm9tIFs5LCBhLCBiLCBjXS5cbiAgLy8gVGhlbiBjeWNsZXMgd2lsbCBiZSBbMSwgNSwgOV0gPz8/IG5vXG4gIC8vICAtIHByb2JhYmx5IHdhbnQgdG8gZG8gc2NyZWVucyBzZXBhcmF0ZWx5IGZyb20gdGlsZXNldHMuLi4/XG4gIC8vIE5PVEUgLSB3ZSBkb24ndCBhY3R1YWxseSB3YW50IHRvIGNoYW5nZSB0aWxlcyBmb3IgdGhlIGxhc3QgY29weS4uLiFcbiAgLy8gICBpbiB0aGlzIGNhc2UsIHRzWzVdIDwtIHRzWzFdLCB0c1sxXSA8LSB0c1s5XSwgc2NyZWVuLm1hcCgxIC0+IDUpXG4gIC8vICAgcmVwbGFjZShbMHg5MF0sIFs1LCAxLCB+OV0pXG4gIC8vICAgICA9PiAxcyByZXBsYWNlZCB3aXRoIDVzIGluIHNjcmVlbnMgYnV0IDlzIE5PVCByZXBsYWNlZCB3aXRoIDFzLlxuICAvLyBKdXN0IGJ1aWxkIHRoZSBwYXJ0aXRpb24gb25jZSBsYXppbHk/IHRoZW4gY2FuIHJldXNlLi4uXG4gIC8vICAgLSBlbnN1cmUgYm90aCBzaWRlcyBvZiByZXBsYWNlbWVudCBoYXZlIGNvcnJlY3QgcGFydGl0aW9uaW5nP0VcbiAgLy8gICAgIG9yIGp1c3QgZG8gaXQgb2ZmbGluZSAtIGl0J3Mgc2ltcGxlclxuICAvLyBUT0RPIC0gU2FuaXR5IGNoZWNrPyAgV2FudCB0byBtYWtlIHN1cmUgbm9ib2R5IGlzIHVzaW5nIGNsb2JiZXJlZCB0aWxlcz9cbiAgc3dhcE1ldGF0aWxlcyh0aWxlc2V0czogbnVtYmVyW10sIC4uLmN5Y2xlczogKG51bWJlciB8IG51bWJlcltdKVtdW10pIHtcbiAgICAvLyBQcm9jZXNzIHRoZSBjeWNsZXNcbiAgICBjb25zdCByZXYgPSBuZXcgTWFwPG51bWJlciwgbnVtYmVyPigpO1xuICAgIGNvbnN0IHJldkFycjogbnVtYmVyW10gPSBzZXEoMHgxMDApO1xuICAgIGNvbnN0IGFsdCA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+KCk7XG4gICAgY29uc3QgY3BsID0gKHg6IG51bWJlciB8IG51bWJlcltdKTogbnVtYmVyID0+IEFycmF5LmlzQXJyYXkoeCkgPyB4WzBdIDogeCA8IDAgPyB+eCA6IHg7XG4gICAgZm9yIChjb25zdCBjeWNsZSBvZiBjeWNsZXMpIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3ljbGUubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KGN5Y2xlW2ldKSkge1xuICAgICAgICAgIGNvbnN0IGFyciA9IGN5Y2xlW2ldIGFzIG51bWJlcltdO1xuICAgICAgICAgIGFsdC5zZXQoYXJyWzBdLCBhcnJbMV0pO1xuICAgICAgICAgIGN5Y2xlW2ldID0gYXJyWzBdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGN5Y2xlLmxlbmd0aCAtIDE7IGkrKykge1xuICAgICAgICBjb25zdCBqID0gY3ljbGVbaV0gYXMgbnVtYmVyO1xuICAgICAgICBjb25zdCBrID0gY3ljbGVbaSArIDFdIGFzIG51bWJlcjtcbiAgICAgICAgaWYgKGogPCAwIHx8IGsgPCAwKSBjb250aW51ZTtcbiAgICAgICAgcmV2LnNldChrLCBqKTtcbiAgICAgICAgcmV2QXJyW2tdID0gajtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gY29uc3QgcmVwbGFjZW1lbnRTZXQgPSBuZXcgU2V0KHJlcGxhY2VtZW50cy5rZXlzKCkpO1xuICAgIC8vIEZpbmQgaW5zdGFuY2VzIGluICgxKSBzY3JlZW5zLCAoMikgdGlsZXNldHMgYW5kIGFsdGVybmF0ZXMsICgzKSB0aWxlRWZmZWN0c1xuICAgIGNvbnN0IHNjcmVlbnMgPSBuZXcgU2V0PFNjcmVlbj4oKTtcbiAgICBjb25zdCB0aWxlRWZmZWN0cyA9IG5ldyBTZXQ8bnVtYmVyPigpO1xuICAgIGNvbnN0IHRpbGVzZXRzU2V0ID0gbmV3IFNldCh0aWxlc2V0cyk7XG4gICAgZm9yIChjb25zdCBsIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICBpZiAoIWwudXNlZCkgY29udGludWU7XG4gICAgICBpZiAoIXRpbGVzZXRzU2V0LmhhcyhsLnRpbGVzZXQpKSBjb250aW51ZTtcbiAgICAgIHRpbGVFZmZlY3RzLmFkZChsLnRpbGVFZmZlY3RzKTtcbiAgICAgIGZvciAoY29uc3Qgc2NyZWVuIG9mIGwuYWxsU2NyZWVucygpKSB7XG4gICAgICAgIHNjcmVlbnMuYWRkKHNjcmVlbik7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIERvIHJlcGxhY2VtZW50cy5cbiAgICAvLyAxLiBzY3JlZW5zOiBbNSwgMSwgfjldID0+IGNoYW5nZSAxcyBpbnRvIDVzXG4gICAgZm9yIChjb25zdCBzY3JlZW4gb2Ygc2NyZWVucykge1xuICAgICAgZm9yIChsZXQgaSA9IDAsIGxlbiA9IHNjcmVlbi50aWxlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykge1xuICAgICAgICBzY3JlZW4udGlsZXNbaV0gPSByZXZBcnJbc2NyZWVuLnRpbGVzW2ldXTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gMi4gdGlsZXNldHM6IFs1LCAxIH45XSA9PiBjb3B5IDUgPD0gMSBhbmQgMSA8PSA5XG4gICAgZm9yIChjb25zdCB0c2lkIG9mIHRpbGVzZXRzU2V0KSB7XG4gICAgICBjb25zdCB0aWxlc2V0ID0gdGhpcy50aWxlc2V0c1sodHNpZCAmIDB4N2YpID4+PiAyXTtcbiAgICAgIGZvciAoY29uc3QgY3ljbGUgb2YgY3ljbGVzKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3ljbGUubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgYSA9IGNwbChjeWNsZVtpXSk7XG4gICAgICAgICAgY29uc3QgYiA9IGNwbChjeWNsZVtpICsgMV0pO1xuICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgNDsgaisrKSB7XG4gICAgICAgICAgICB0aWxlc2V0LnRpbGVzW2pdW2FdID0gdGlsZXNldC50aWxlc1tqXVtiXTtcbiAgICAgICAgICB9XG4gICAgICAgICAgdGlsZXNldC5hdHRyc1thXSA9IHRpbGVzZXQuYXR0cnNbYl07XG4gICAgICAgICAgaWYgKGIgPCAweDIwICYmIHRpbGVzZXQuYWx0ZXJuYXRlc1tiXSAhPT0gYikge1xuICAgICAgICAgICAgaWYgKGEgPj0gMHgyMCkgdGhyb3cgbmV3IEVycm9yKGBDYW5ub3QgdW5mbGFnOiAke3RzaWR9ICR7YX0gJHtifSAke3RpbGVzZXQuYWx0ZXJuYXRlc1tiXX1gKTtcbiAgICAgICAgICAgIHRpbGVzZXQuYWx0ZXJuYXRlc1thXSA9IHRpbGVzZXQuYWx0ZXJuYXRlc1tiXTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvciAoY29uc3QgW2EsIGJdIG9mIGFsdCkge1xuICAgICAgICB0aWxlc2V0LmFsdGVybmF0ZXNbYV0gPSBiO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyAzLiB0aWxlRWZmZWN0c1xuICAgIGZvciAoY29uc3QgdGVpZCBvZiB0aWxlRWZmZWN0cykge1xuICAgICAgY29uc3QgdGlsZUVmZmVjdCA9IHRoaXMudGlsZUVmZmVjdHNbdGVpZCAtIDB4YjNdO1xuICAgICAgZm9yIChjb25zdCBjeWNsZSBvZiBjeWNsZXMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjeWNsZS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBhID0gY3BsKGN5Y2xlW2ldKTtcbiAgICAgICAgICBjb25zdCBiID0gY3BsKGN5Y2xlW2kgKyAxXSk7XG4gICAgICAgICAgdGlsZUVmZmVjdC5lZmZlY3RzW2FdID0gdGlsZUVmZmVjdC5lZmZlY3RzW2JdO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IGEgb2YgYWx0LmtleXMoKSkge1xuICAgICAgICAvLyBUaGlzIGJpdCBpcyByZXF1aXJlZCB0byBpbmRpY2F0ZSB0aGF0IHRoZSBhbHRlcm5hdGl2ZSB0aWxlJ3NcbiAgICAgICAgLy8gZWZmZWN0IHNob3VsZCBiZSBjb25zdWx0ZWQuICBTaW1wbHkgaGF2aW5nIHRoZSBmbGFnIGFuZCB0aGVcbiAgICAgICAgLy8gdGlsZSBpbmRleCA8ICQyMCBpcyBub3Qgc3VmZmljaWVudC5cbiAgICAgICAgdGlsZUVmZmVjdC5lZmZlY3RzW2FdIHw9IDB4MDg7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIERvbmU/IT9cbiAgfVxuXG4gIG1vdmVGbGFnKG9sZEZsYWc6IG51bWJlciwgbmV3RmxhZzogbnVtYmVyKSB7XG4gICAgLy8gbmVlZCB0byB1cGRhdGUgdHJpZ2dlcnMsIHNwYXducywgZGlhbG9nc1xuICAgIGZ1bmN0aW9uIHJlcGxhY2UoYXJyOiBudW1iZXJbXSkge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhcnIubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgaWYgKGFycltpXSA9PT0gb2xkRmxhZykgYXJyW2ldID0gbmV3RmxhZztcbiAgICAgICAgaWYgKGFycltpXSA9PT0gfm9sZEZsYWcpIGFycltpXSA9IH5uZXdGbGFnO1xuICAgICAgfVxuICAgIH1cbiAgICBmb3IgKGNvbnN0IHRyaWdnZXIgb2YgdGhpcy50cmlnZ2Vycykge1xuICAgICAgcmVwbGFjZSh0cmlnZ2VyLmNvbmRpdGlvbnMpO1xuICAgICAgcmVwbGFjZSh0cmlnZ2VyLmZsYWdzKTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBucGMgb2YgdGhpcy5ucGNzKSB7XG4gICAgICBmb3IgKGNvbnN0IGNvbmRzIG9mIG5wYy5zcGF3bkNvbmRpdGlvbnMudmFsdWVzKCkpIHJlcGxhY2UoY29uZHMpO1xuICAgICAgZm9yIChjb25zdCBkaWFsb2dzIG9mIFtucGMuZ2xvYmFsRGlhbG9ncywgLi4ubnBjLmxvY2FsRGlhbG9ncy52YWx1ZXMoKV0pIHtcbiAgICAgICAgZm9yIChjb25zdCBkaWFsb2cgb2YgZGlhbG9ncykge1xuICAgICAgICAgIGlmIChkaWFsb2cuY29uZGl0aW9uID09PSBvbGRGbGFnKSBkaWFsb2cuY29uZGl0aW9uID0gbmV3RmxhZztcbiAgICAgICAgICBpZiAoZGlhbG9nLmNvbmRpdGlvbiA9PT0gfm9sZEZsYWcpIGRpYWxvZy5jb25kaXRpb24gPSB+bmV3RmxhZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICAvLyBhbHNvIG5lZWQgdG8gdXBkYXRlIG1hcCBmbGFncyBpZiA+PSAkMjAwXG4gICAgaWYgKChvbGRGbGFnICYgfjB4ZmYpID09PSAweDIwMCAmJiAobmV3RmxhZyAmIH4weGZmKSA9PT0gMHgyMDApIHtcbiAgICAgIGZvciAoY29uc3QgbG9jIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICAgIGZvciAoY29uc3QgZmxhZyBvZiBsb2MuZmxhZ3MpIHtcbiAgICAgICAgICBpZiAoZmxhZy5mbGFnID09PSBvbGRGbGFnKSBmbGFnLmZsYWcgPSBuZXdGbGFnO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgbmV4dEZyZWVUcmlnZ2VyKCk6IFRyaWdnZXIge1xuICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnRyaWdnZXJzKSB7XG4gICAgICBpZiAoIXQudXNlZCkgcmV0dXJuIHQ7XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcignQ291bGQgbm90IGZpbmQgYW4gdW51c2VkIHRyaWdnZXIuJyk7XG4gIH1cblxuICAvLyBVc2UgdGhlIGJyb3dzZXIgQVBJIHRvIGxvYWQgdGhlIFJPTS4gIFVzZSAjcmVzZXQgdG8gZm9yZ2V0IGFuZCByZWxvYWQuXG4gIHN0YXRpYyBhc3luYyBsb2FkKHBhdGNoPzogKGRhdGE6IFVpbnQ4QXJyYXkpID0+IFByb21pc2U8dm9pZD4sXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyPzogKHBpY2tlcjogRWxlbWVudCkgPT4gdm9pZCkge1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCBwaWNrRmlsZShyZWNlaXZlcik7XG4gICAgaWYgKHBhdGNoKSBhd2FpdCBwYXRjaChmaWxlKTtcbiAgICByZXR1cm4gbmV3IFJvbShmaWxlKTtcbiAgfSAgXG59XG5cbi8vIGNvbnN0IGludGVyc2VjdHMgPSAobGVmdCwgcmlnaHQpID0+IHtcbi8vICAgaWYgKGxlZnQuc2l6ZSA+IHJpZ2h0LnNpemUpIHJldHVybiBpbnRlcnNlY3RzKHJpZ2h0LCBsZWZ0KTtcbi8vICAgZm9yIChsZXQgaSBvZiBsZWZ0KSB7XG4vLyAgICAgaWYgKHJpZ2h0LmhhcyhpKSkgcmV0dXJuIHRydWU7XG4vLyAgIH1cbi8vICAgcmV0dXJuIGZhbHNlO1xuLy8gfVxuXG4vLyBjb25zdCBUSUxFX0VGRkVDVFNfQllfVElMRVNFVCA9IHtcbi8vICAgMHg4MDogMHhiMyxcbi8vICAgMHg4NDogMHhiNCxcbi8vICAgMHg4ODogMHhiNSxcbi8vICAgMHg4YzogMHhiNixcbi8vICAgMHg5MDogMHhiNyxcbi8vICAgMHg5NDogMHhiOCxcbi8vICAgMHg5ODogMHhiOSxcbi8vICAgMHg5YzogMHhiYSxcbi8vICAgMHhhMDogMHhiYixcbi8vICAgMHhhNDogMHhiYyxcbi8vICAgMHhhODogMHhiNSxcbi8vICAgMHhhYzogMHhiZCxcbi8vIH07XG5cbi8vIE9ubHkgbWFrZXMgc2Vuc2UgaW4gdGhlIGJyb3dzZXIuXG5mdW5jdGlvbiBwaWNrRmlsZShyZWNlaXZlcj86IChwaWNrZXI6IEVsZW1lbnQpID0+IHZvaWQpOiBQcm9taXNlPFVpbnQ4QXJyYXk+IHtcbiAgaWYgKCFyZWNlaXZlcikgcmVjZWl2ZXIgPSBwaWNrZXIgPT4gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwaWNrZXIpO1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2ggIT09ICcjcmVzZXQnKSB7XG4gICAgICBjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JvbScpO1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoXG4gICAgICAgICAgICBVaW50OEFycmF5LmZyb20oXG4gICAgICAgICAgICAgICAgbmV3IEFycmF5KGRhdGEubGVuZ3RoIC8gMikuZmlsbCgwKS5tYXAoXG4gICAgICAgICAgICAgICAgICAgIChfLCBpKSA9PiBOdW1iZXIucGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhWzIgKiBpXSArIGRhdGFbMiAqIGkgKyAxXSwgMTYpKSkpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB1cGxvYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodXBsb2FkKTtcbiAgICB1cGxvYWQudHlwZSA9ICdmaWxlJztcbiAgICB1cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsZSA9IHVwbG9hZC5maWxlcyFbMF07XG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlbmQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KHJlYWRlci5yZXN1bHQgYXMgQXJyYXlCdWZmZXIpO1xuICAgICAgICBjb25zdCBzdHIgPSBBcnJheS5mcm9tKGFyciwgaGV4KS5qb2luKCcnKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JvbScsIHN0cik7XG4gICAgICAgIHVwbG9hZC5yZW1vdmUoKTtcbiAgICAgICAgcmVzb2x2ZShhcnIpO1xuICAgICAgfSk7XG4gICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgY29uc3QgRVhQRUNURURfQ1JDMzIgPSAweDFiZDM5MDMyO1xuXG4vLyBGb3JtYXQ6IFthZGRyZXNzLCBicm9rZW4sIGZpeGVkXVxuY29uc3QgQURKVVNUTUVOVFMgPSBbXG4gIC8vIEZpeCBzb2Z0bG9jayBpbiBjcnlwdCBkdWUgdG8gZmx5YWJsZSB3YWxsIChlZmZlY3RzICRiNiB0aWxlICQ0NilcbiAgWzB4MTM2NDYsIDB4MDIsIDB4MDZdLFxuICAvLyBGaXggYnJva2VuIChmYWxsLXRocm91Z2gpIGV4aXQgb3V0c2lkZSBzdGFydFxuICBbMHgxNDU2YSwgMHgwMCwgMHhmZl0sXG4gIC8vIFJlZHVuZGFudCBleGl0IG5leHQgdG8gc3RvbSdzIGRvb3IgaW4gJDE5XG4gIFsweDE0YWViLCAweDA5LCAweGZmXSxcbiAgLy8gRml4IGdhcmJhZ2UgbWFwIHNxdWFyZSBpbiBib3R0b20tcmlnaHQgb2YgTXQgU2FicmUgV2VzdCBjYXZlXG4gIFsweDE0ZGI5LCAweDA4LCAweDgwXSxcbiAgLy8gRml4IGdhcmJhZ2UgbWFwIHNxdWFyZSBpbiBib3R0b20tbGVmdCBvZiBMaW1lIFRyZWUgVmFsbGV5XG4gIFsweDE1NDVkLCAweGZmLCAweDAwXSxcbiAgLy8gUmVtb3ZlIHVudXNlZCBtYXAgc2NyZWVucyBmcm9tIEV2aWwgU3Bpcml0IGxvd2VyXG4gIFsweDE1YmFmLCAweGYwLCAweDgwXSxcbiAgWzB4MTViYjYsIDB4ZGYsIDB4ODBdLFxuICBbMHgxNWJiNywgMHg5NiwgMHg4MF0sXG4gIC8vIEZpeCBnYXJiYWdlIGF0IGJvdHRvbSBvZiBvYXNpcyBjYXZlIG1hcCAoaXQncyA4eDExLCBub3QgOHgxMiA9PiBmaXggaGVpZ2h0KVxuICBbMHgxNjRmZiwgMHgwYiwgMHgwYV0sXG4gIC8vIEZpeCBiYWQgbXVzaWMgaW4gem9tYmlldG93biBob3VzZXM6ICQxMCBzaG91bGQgYmUgJDAxXG4gIFsweDE3ODJhLCAweDEwLCAweDAxXSxcbiAgWzB4MTc4NTcsIDB4MTAsIDB4MDFdLFxuICAvLyBGaXggYmFkIHNwYXduIGluIE10IEh5ZHJhIChtYWtlIGl0IGFuIGV4dHJhIHB1ZGRsZSkuXG4gIFsweDE5ZjAyLCAweDQwLCAweDgwXSxcbiAgWzB4MTlmMDMsIDB4MzMsIDB4MzJdLFxuICAvLyBQb2ludCBBbWF6b25lcyBvdXRlciBndWFyZCB0byBwb3N0LW92ZXJmbG93IG1lc3NhZ2UgdGhhdCdzIGFjdHVhbGx5IHNob3duLlxuICBbMHgxY2YwNSwgMHg0NywgMHg0OF0sXG4gIC8vIFJlbW92ZSBzdHJheSBmbGlnaHQgZ3JhbnRlciBpbiBab21iaWV0b3duLlxuICBbMHgxZDMxMSwgMHgyMCwgMHhhMF0sXG4gIFsweDFkMzEyLCAweDMwLCAweDAwXSxcbiAgLy8gRml4IHF1ZWVuJ3MgZGlhbG9nIHRvIHRlcm1pbmF0ZSBvbiBsYXN0IGl0ZW0sIHJhdGhlciB0aGFuIG92ZXJmbG93LFxuICAvLyBzbyB0aGF0IHdlIGRvbid0IHBhcnNlIGdhcmJhZ2UuXG4gIFsweDFjZmY5LCAweDYwLCAweGUwXSxcbiAgLy8gRml4IEFtYXpvbmVzIG91dGVyIGd1YXJkIG1lc3NhZ2UgdG8gbm90IG92ZXJmbG93LlxuICBbMHgyY2E5MCwgMHgwMiwgMHgwMF0sXG4gIC8vIEZpeCBzZWVtaW5nbHktdW51c2VkIGtlbnN1IG1lc3NhZ2UgMWQ6MTcgb3ZlcmZsb3dpbmcgaW50byAxZDoxOFxuICBbMHgyZjU3MywgMHgwMiwgMHgwMF0sXG4gIC8vIEZpeCB1bnVzZWQga2FybWluZSB0cmVhc3VyZSBjaGVzdCBtZXNzYWdlIDIwOjE4LlxuICBbMHgyZmFlNCwgMHg1ZiwgMHgwMF0sXG5dIGFzIGNvbnN0O1xuIl19