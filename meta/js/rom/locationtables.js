import { DataTuple, hex } from './util.js';
export class Entrance extends DataTuple {
    constructor() {
        super(...arguments);
        this.x = this.prop([0], [1, 0xff, -8]);
        this.y = this.prop([2], [3, 0xff, -8]);
        this.screen = this.prop([3, 0x0f, -4], [1, 0x0f]);
        this.tile = this.prop([2, 0xf0], [0, 0xf0, 4]);
        this.coord = this.prop([2, 0xff, -8], [0, 0xff]);
    }
    get used() {
        return this.data[1] != 0xff;
    }
    ;
    toString() {
        return `Entrance ${this.hex()}: (${hex(this.y)}, ${hex(this.x)})`;
    }
}
Entrance.size = 4;
export class Exit extends DataTuple {
    constructor() {
        super(...arguments);
        this.x = this.prop([0, 0xff, -4]);
        this.xt = this.prop([0]);
        this.y = this.prop([1, 0xff, -4]);
        this.yt = this.prop([1]);
        this.screen = this.prop([1, 0xf0], [0, 0xf0, 4]);
        this.tile = this.prop([1, 0x0f, -4], [0, 0x0f]);
        this.coord = this.prop([1, 0x0f, -12], [0, 0x0f, -4]);
        this.dest = this.prop([2]);
        this.entrance = this.prop([3]);
    }
    isSeamless() {
        return Boolean(this.entrance & 0x20);
    }
    toString() {
        return `Exit ${this.hex()}: (${hex(this.y)}, ${hex(this.x)}) => ${this.dest}:${this.entrance}`;
    }
}
Exit.size = 4;
export class Flag extends DataTuple {
    constructor() {
        super(...arguments);
        this.x = this.prop([1, 0x07, -8]);
        this.xs = this.prop([1, 0x07]);
        this.y = this.prop([1, 0xf0, -4]);
        this.ys = this.prop([1, 0xf0, 4]);
        this.screen = this.prop([1]);
    }
    get flag() {
        return this.data[0] | 0x200;
    }
    set flag(f) {
        if ((f & ~0xff) !== 0x200)
            throw new Error(`bad flag: ${hex(f)}`);
        this.data[0] = f & 0xff;
    }
    toString() {
        return `Flag ${this.hex()}: ${hex(this.screen)} @ ${hex(this.flag)}`;
    }
}
Flag.size = 2;
export class Pit extends DataTuple {
    constructor() {
        super(...arguments);
        this.fromXs = this.prop([1, 0x70, 4]);
        this.toXs = this.prop([1, 0x07]);
        this.fromYs = this.prop([3, 0xf0, 4]);
        this.toYs = this.prop([3, 0x0f]);
        this.dest = this.prop([0]);
    }
    toString() {
        return `Pit ${this.hex()}: (${hex(this.fromXs)}, ${hex(this.fromYs)}) => ${hex(this.dest)}:(${hex(this.toXs)}, ${hex(this.toYs)})`;
    }
}
Pit.size = 4;
export class Spawn extends DataTuple {
    constructor() {
        super(...arguments);
        this.y = this.prop([0, 0xff, -4]);
        this.yt = this.prop([0]);
        this.x = this.prop([1, 0x7f, -4], [2, 0x40, 3]);
        this.xt = this.prop([1, 0x7f]);
        this.timed = this.booleanProp(1, 7);
        this.screen = this.prop([0, 0xf0], [1, 0x70, 4]);
        this.tile = this.prop([0, 0x0f, -4], [1, 0x0f]);
        this.coord = this.prop([0, 0xff, -8], [1, 0x7f, -4], [2, 0x40, 3]);
        this.type = this.prop([2, 0x07]);
        this.id = this.prop([3]);
        this.patternBank = this.prop([2, 0x80, 7]);
    }
    get used() {
        return this.data[0] !== 0xfe;
    }
    set used(used) {
        this.data[0] = used ? 0 : 0xfe;
    }
    get monsterId() {
        return (this.id + 0x50) & 0xff;
    }
    set monsterId(id) {
        this.id = (id - 0x50) & 0xff;
    }
    isChest() { return this.type === 2 && this.id < 0x80; }
    isInvisible() {
        return this.isChest() && Boolean(this.data[2] & 0x20);
    }
    isTrigger() { return this.type === 2 && this.id >= 0x80; }
    isNpc() { return this.type === 1 && this.id < 0xc0; }
    isBoss() { return this.type === 1 && this.id >= 0xc0; }
    isMonster() { return this.type === 0; }
    isWall() {
        return Boolean(this.type === 3 && (this.id < 4 || (this.data[2] & 0x20)));
    }
    isShootingWall(location) {
        return this.isWall() &&
            !!(this.data[2] & 0x20 ? this.data[2] & 0x10 :
                location.id === 0x8f || location.id === 0xa8);
    }
    wallType() {
        if (this.type !== 3)
            return '';
        const obj = this.data[2] & 0x20 ? this.id >>> 4 : this.id;
        if (obj >= 4)
            return '';
        return obj === 2 ? 'bridge' : 'wall';
    }
    wallElement() {
        if (!this.isWall())
            return -1;
        return this.id & 3;
    }
    toString() {
        return `Spawn ${this.hex()}: (${hex(this.x)}, ${hex(this.y)}) ${this.timed ? 'timed' : 'fixed'} ${this.type}:${hex(this.id)}`;
    }
}
Spawn.size = 4;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibG9jYXRpb250YWJsZXMuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvanMvcm9tL2xvY2F0aW9udGFibGVzLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxTQUFTLEVBQUUsR0FBRyxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBR3pDLE1BQU0sT0FBTyxRQUFTLFNBQVEsU0FBUztJQUF2Qzs7UUFTRSxNQUFDLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEMsTUFBQyxHQUFHLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBT2xDLFdBQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFFN0MsU0FBSSxHQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFNUMsVUFBSyxHQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQVUvQyxDQUFDO0lBUEMsSUFBSSxJQUFJO1FBQ04sT0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLElBQUksQ0FBQztJQUM5QixDQUFDO0lBQUEsQ0FBQztJQUVGLFFBQVE7UUFDTixPQUFPLFlBQVks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QUssR0FBRyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUM7SUFDbEUsQ0FBQzs7QUFsQk0sUUFBSSxHQUFHLENBQUMsQ0FBQztBQXFCbEIsTUFBTSxPQUFPLEtBQU0sU0FBUSxTQUFTO0lBQXBDOztRQU9FLE1BQUMsR0FBUSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFbEMsT0FBRSxHQUFPLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBR3hCLE1BQUMsR0FBUSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRWhELE9BQUUsR0FBTyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFHOUIsVUFBSyxHQUFJLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO1FBR2hDLFdBQU0sR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBRTVDLFNBQUksR0FBSyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUM7UUFFN0MsVUFBSyxHQUFJLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFHL0QsU0FBSSxHQUFLLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztRQUU5QixPQUFFLEdBQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFHeEIsZ0JBQVcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBK0R4QyxDQUFDO0lBeERDLElBQUksSUFBSTtRQUNOLE9BQU8sSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxJQUFJLENBQUM7SUFDL0IsQ0FBQztJQUNELElBQUksSUFBSSxDQUFDLElBQWE7UUFDcEIsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDO0lBQ2pDLENBQUM7SUFHRCxJQUFJLFNBQVM7UUFDWCxPQUFPLENBQUMsSUFBSSxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDakMsQ0FBQztJQUNELElBQUksU0FBUyxDQUFDLEVBQVU7UUFDdEIsSUFBSSxDQUFDLEVBQUUsR0FBRyxDQUFDLEVBQUUsR0FBRyxJQUFJLENBQUMsR0FBRyxJQUFJLENBQUM7SUFDL0IsQ0FBQztJQUdELE9BQU8sS0FBYyxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUVoRSxXQUFXO1FBQ1QsT0FBTyxJQUFJLENBQUMsT0FBTyxFQUFFLElBQUksT0FBTyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUM7SUFDeEQsQ0FBQztJQUVELFNBQVMsS0FBYyxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxJQUFJLElBQUksQ0FBQyxFQUFFLElBQUksSUFBSSxDQUFDLENBQUMsQ0FBQztJQUVuRSxLQUFLLEtBQWMsT0FBTyxJQUFJLENBQUMsSUFBSSxLQUFLLENBQUMsSUFBSSxJQUFJLENBQUMsRUFBRSxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7SUFFOUQsTUFBTSxLQUFjLE9BQU8sSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksSUFBSSxDQUFDLEVBQUUsSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBRWhFLFNBQVMsS0FBYyxPQUFPLElBQUksQ0FBQyxJQUFJLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUVoRCxNQUFNO1FBQ0osT0FBTyxPQUFPLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQzVFLENBQUM7SUFFRCxjQUFjLENBQUMsUUFBa0I7UUFDL0IsT0FBTyxJQUFJLENBQUMsTUFBTSxFQUFFO1lBQ2hCLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLEdBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDO2dCQUMzQyxRQUFRLENBQUMsRUFBRSxLQUFLLElBQUksSUFBSSxRQUFRLENBQUMsRUFBRSxLQUFLLElBQUksQ0FBQyxDQUFDO0lBQ3ZELENBQUM7SUFFRCxRQUFRO1FBQ04sSUFBSSxJQUFJLENBQUMsSUFBSSxLQUFLLENBQUM7WUFBRSxPQUFPLEVBQUUsQ0FBQztRQUMvQixNQUFNLEdBQUcsR0FBRyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUFFLENBQUM7UUFDMUQsSUFBSSxHQUFHLElBQUksQ0FBQztZQUFFLE9BQU8sRUFBRSxDQUFDO1FBQ3hCLE9BQU8sR0FBRyxLQUFLLENBQUMsQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUM7SUFDdkMsQ0FBQztJQUVELFdBQVc7UUFDVCxJQUFJLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRTtZQUFFLE9BQU8sQ0FBQyxDQUFDLENBQUM7UUFDOUIsT0FBTyxJQUFJLENBQUMsRUFBRSxHQUFHLENBQUMsQ0FBQztJQUNyQixDQUFDO0lBRUQsUUFBUTtRQUNOLE9BQU8sU0FBUyxJQUFJLENBQUMsR0FBRyxFQUFFLE1BQU0sR0FBRyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsS0FBSyxHQUFHLENBQUMsSUFBSSxDQUFDLENBQUMsQ0FBQyxLQUNuRCxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDLE9BQU8sSUFBSSxJQUFJLENBQUMsSUFBSSxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQztJQUN4RSxDQUFDOztBQTdGTSxVQUFJLEdBQUcsQ0FBQyxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtEYXRhVHVwbGUsIGhleH0gZnJvbSAnLi91dGlsLmpzJztcblxuLyoqIEEgc2luZ2xlIHNjcmVlbiBlbnRyYW5jZSBjb29yZGluYXRlLiAqL1xuZXhwb3J0IGNsYXNzIEVudHJhbmNlIGV4dGVuZHMgRGF0YVR1cGxlIHtcbiAgLy8gQmFzaWMgcGF0dGVybjogeGxvIHhoaSB5bG8geWhpID0gKHhwKSh4dCkgKHhzKSgwKSAoeXApKHl0KSAoeXMpKDApXG4gIC8vIHdoZXJlIHhwIGlzIHBpeGVsIHBvc2l0aW9uIHdpdGhpbiB0aWxlLCB4dCBpcyB0aWxlLCBhbmQgeHMgaXMgc2NyZWVuXG4gIHN0YXRpYyBzaXplID0gNDtcblxuICAvLyB4ID0gdGhpcy5iaXRzKFswLCAxNl0pXG4gIC8vIHkgPSB0aGlzLmJpdHMoWzE2LCAzMl0pXG5cbiAgLyoqIEZ1bGwgMTEtYml0IHgtY29vcmRpbmF0ZSBvZiB0aGUgZW50cmFuY2UuICovXG4gIHggPSB0aGlzLnByb3AoWzBdLCBbMSwgMHhmZiwgLThdKTtcbiAgLyoqIEZ1bGwgMTItYml0IHktY29vcmRpbmF0ZSBvZiB0aGUgZW50cmFuY2UuICovXG4gIHkgPSB0aGlzLnByb3AoWzJdLCBbMywgMHhmZiwgLThdKTtcblxuICAvLyBzY3JlZW4gPSB0aGlzLmJpdHMoWzgsIDEyXSwgWzI0LCAyOF0pO1xuICAvLyB0aWxlICAgPSB0aGlzLmJpdHMoWzQsIDhdLCBbMjAsIDI0XSk7XG4gIC8vIGNvb3JkICA9IHRoaXMuYml0cyhbMCwgOF0sIFsxNiwgMjRdKTtcblxuICAvKiogOC1iaXQgc2NyZWVuICh5eCkuICovXG4gIHNjcmVlbiA9IHRoaXMucHJvcChbMywgMHgwZiwgLTRdLCBbMSwgMHgwZl0pO1xuICAvKiogOC1iaXQgdGlsZSB3aXRoaW4gdGhlIHNjcmVlbiAoeXgpLiAqL1xuICB0aWxlICAgPSB0aGlzLnByb3AoWzIsIDB4ZjBdLCBbMCwgMHhmMCwgNF0pO1xuICAvKiogMTYtYml0IGNvb3JkaW5hdGUgd2l0aGluIHRoZSBzY3JlZW4gKHl5eHgpLiAqL1xuICBjb29yZCAgPSB0aGlzLnByb3AoWzIsIDB4ZmYsIC04XSwgWzAsIDB4ZmZdKTtcblxuICAvKiogV2hldGhlciB0aGUgZW50cmFuY2UgaGFzIG5vdCBiZWVuIGRpc2FibGVkIGJ5IHNldHRpbmcgaXRzIHggdG8gZmZfXy4gKi9cbiAgZ2V0IHVzZWQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVsxXSAhPSAweGZmO1xuICB9O1xuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBFbnRyYW5jZSAke3RoaXMuaGV4KCl9OiAoJHtoZXgodGhpcy55KX0sICR7aGV4KHRoaXMueCl9KWA7XG4gIH1cbn1cblxuLyoqIEEgc2luZ2xlIHNjcmVlbiBleGl0IHRpbGUuICovXG5leHBvcnQgY2xhc3MgRXhpdCBleHRlbmRzIERhdGFUdXBsZSB7XG4gIHN0YXRpYyBzaXplID0gNDtcblxuICAvKiogMTEtYml0IHgtY29vcmRpbmF0ZSBvZiBleGl0IHBpeGVsIChsb3cgNCBiaXRzIGFsd2F5cyB6ZXJvKS4gKi9cbiAgeCAgICAgICAgPSB0aGlzLnByb3AoWzAsIDB4ZmYsIC00XSk7XG4gIC8qKiA3LWJpdCB4LWNvb3JkaW5hdGUgb2YgZXhpdCB0aWxlIChzY3JlZW4tdGlsZSkuICovXG4gIHh0ICAgICAgID0gdGhpcy5wcm9wKFswXSk7XG5cbiAgLyoqIDEyLWJpdCB5LWNvb3JkaW5hdGUgb2YgZXhpdCBwaXhlbCAobG93IDQgYml0cyBhbHdheXMgemVybykuICovXG4gIHkgICAgICAgID0gdGhpcy5wcm9wKFsxLCAweGZmLCAtNF0pO1xuICAvKiogOC1iaXQgeS1jb29yZGluYXRlIG9mIGV4aXQgdGlsZSAoc2NyZWVuLXRpbGUpLiAqL1xuICB5dCAgICAgICA9IHRoaXMucHJvcChbMV0pO1xuXG4gIC8qKiA4LWJpdCBzY3JlZW4gKHl4KS4gKi9cbiAgc2NyZWVuICAgPSB0aGlzLnByb3AoWzEsIDB4ZjBdLCBbMCwgMHhmMCwgNF0pO1xuICAvKiogOC1iaXQgdGlsZSB3aXRoaW4gdGhlIHNjcmVlbiAoeXgpLiAqL1xuICB0aWxlICAgICA9IHRoaXMucHJvcChbMSwgMHgwZiwgLTRdLCBbMCwgMHgwZl0pO1xuICAvKiogMTYtYml0IGNvb3JkaW5hdGUgd2l0aGluIHRoZSBzY3JlZW4gKHkweDApLiAqL1xuICBjb29yZCAgICA9IHRoaXMucHJvcChbMSwgMHgwZiwgLTEyXSwgWzAsIDB4MGYsIC00XSk7XG5cbiAgLyoqIERlc3RpbmF0aW9uIGxvY2F0aW9uIElELiAqL1xuICBkZXN0ICAgICA9IHRoaXMucHJvcChbMl0pO1xuXG4gIC8qKiBEZXN0aW5hdGlvbiBlbnRyYW5jZSBpbmRleC4gKi9cbiAgZW50cmFuY2UgPSB0aGlzLnByb3AoWzNdKTtcblxuICBpc1NlYW1sZXNzKHRoaXM6IGFueSk6IGJvb2xlYW4ge1xuICAgIHJldHVybiBCb29sZWFuKHRoaXMuZW50cmFuY2UgJiAweDIwKTtcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBFeGl0ICR7dGhpcy5oZXgoKX06ICgke2hleCh0aGlzLnkpfSwgJHtoZXgodGhpcy54KX0pID0+ICR7XG4gICAgICAgICAgICB0aGlzLmRlc3R9OiR7dGhpcy5lbnRyYW5jZX1gO1xuICB9XG59XG5cbi8qKiBNYXBwaW5nIGZyb20gc2NyZWVuIHBvc2l0aW9uIHRvIGZsYWcgSUQuICovXG5leHBvcnQgY2xhc3MgRmxhZyBleHRlbmRzIERhdGFUdXBsZSB7XG4gIHN0YXRpYyBzaXplID0gMjtcblxuICAvKiogTWFwcGVkIGZsYWcsIGFsd2F5cyBiZXR3ZWVuICQyMDAgYW5kICQyZmYuICovXG4gIGdldCBmbGFnKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIHRoaXMuZGF0YVswXSB8IDB4MjAwO1xuICB9XG4gIHNldCBmbGFnKGY6IG51bWJlcikge1xuICAgIGlmICgoZiAmIH4weGZmKSAhPT0gMHgyMDApIHRocm93IG5ldyBFcnJvcihgYmFkIGZsYWc6ICR7aGV4KGYpfWApO1xuICAgIHRoaXMuZGF0YVswXSA9IGYgJiAweGZmO1xuICB9XG5cbiAgLyoqIDExLWJpdCB4LWNvb3JkaW5hdGUgb2YgdG9wLWxlZnQgcGl4ZWwgb2YgdGhlIGZsYWdnZWQgc2NyZWVuLiAqL1xuICB4ICAgICAgPSB0aGlzLnByb3AoWzEsIDB4MDcsIC04XSk7XG4gIC8qKiAzLWJpdCB4LWNvb3JkaW5hdGUgb2YgZmxhZ2dlZCBzY3JlZW4uICovXG4gIHhzICAgICA9IHRoaXMucHJvcChbMSwgMHgwN10pO1xuXG4gIC8qKiAxMi1iaXQgeS1jb29yZGluYXRlIG9mIHRvcC1sZWZ0IHBpeGVsIG9mIHRoZSBmbGFnZ2VkIHNjcmVlbi4gKi9cbiAgeSAgICAgID0gdGhpcy5wcm9wKFsxLCAweGYwLCAtNF0pO1xuICAvKiogNC1iaXQgeS1jb29yZGluYXRlIG9mIGZsYWdnZWQgc2NyZWVuLiAqL1xuICB5cyAgICAgPSB0aGlzLnByb3AoWzEsIDB4ZjAsIDRdKTtcblxuICAvKiogOC1iaXQgc2NyZWVuICh5eCkuICovXG4gIHNjcmVlbiA9IHRoaXMucHJvcChbMV0pO1xuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBGbGFnICR7dGhpcy5oZXgoKX06ICR7aGV4KHRoaXMuc2NyZWVuKX0gQCAke2hleCh0aGlzLmZsYWcpfWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFBpdCBleHRlbmRzIERhdGFUdXBsZSB7XG4gIHN0YXRpYyBzaXplID0gNDtcblxuICAvKiogMy1iaXQgeC1jb29yZGluYXRlIG9mIHBpdCdzIHNjcmVlbiBvbiB0aGlzIG1hcC4gKi9cbiAgZnJvbVhzID0gdGhpcy5wcm9wKFsxLCAweDcwLCA0XSk7XG4gIC8qKiAzLWJpdCB4LWNvb3JkaW5hdGUgb2YgZGVzdGluYXRpb24gc2NyZWVuIG9uIGRlc3RpbmF0aW9uIG1hcC4gKi9cbiAgdG9YcyAgID0gdGhpcy5wcm9wKFsxLCAweDA3XSk7XG5cbiAgLyoqIDQtYml0IHktY29vcmRpbmF0ZSBvZiBwaXQncyBzY3JlZW4gb24gdGhpcyBtYXAuICovXG4gIGZyb21ZcyA9IHRoaXMucHJvcChbMywgMHhmMCwgNF0pO1xuICAvKiogNC1iaXQgeS1jb29yZGluYXRlIG9mIGRlc3RpbmF0aW9uIHNjcmVlbiBvbiBkZXN0aW5hdGlvbiBtYXAuICovXG4gIHRvWXMgICA9IHRoaXMucHJvcChbMywgMHgwZl0pO1xuXG4gIC8qKiBMb2NhdGlvbiBJRCBvZiBkZXN0aW5hdGlvbi4gKi9cbiAgZGVzdCAgID0gdGhpcy5wcm9wKFswXSk7XG5cbiAgdG9TdHJpbmcoKTogc3RyaW5nIHtcbiAgICByZXR1cm4gYFBpdCAke3RoaXMuaGV4KCl9OiAoJHtoZXgodGhpcy5mcm9tWHMpfSwgJHtoZXgodGhpcy5mcm9tWXMpfSkgPT4gJHtcbiAgICAgICAgICAgIGhleCh0aGlzLmRlc3QpfTooJHtoZXgodGhpcy50b1hzKX0sICR7aGV4KHRoaXMudG9Zcyl9KWA7XG4gIH1cbn1cblxuZXhwb3J0IGNsYXNzIFNwYXduIGV4dGVuZHMgRGF0YVR1cGxlIHtcbiAgc3RhdGljIHNpemUgPSA0O1xuXG4gIC8vIGdldCB5KCk6IG51bWJlciAgeyByZXR1cm4gU1BBV05fWS5nZXQodGhpcyk7IH1cbiAgLy8gc2V0IHkoeTogbnVtYmVyKSB7IFNQQVdOX1kuc2V0KHRoaXMsIHkpOyB9XG5cbiAgLyoqIDEyLWJpdCB5LWNvb3JkaW5hdGUgb2Ygc3Bhd24gcGl4ZWwuICovXG4gIHkgICAgICA9IHRoaXMucHJvcChbMCwgMHhmZiwgLTRdKTtcbiAgLyoqIDgtYml0IHktY29vcmRpbmF0ZSBvZiBzcGF3biB0aWxlLiAqL1xuICB5dCAgICAgPSB0aGlzLnByb3AoWzBdKTtcblxuICAvKiogMTEtYml0IHgtY29vcmRpbmF0ZSBvZiBzcGF3biBwaXhlbC4gKi9cbiAgeCAgICAgID0gdGhpcy5wcm9wKFsxLCAweDdmLCAtNF0sIFsyLCAweDQwLCAzXSk7XG4gIC8qKiA3LWJpdCB4LWNvb3JkaW5hdGUgb2Ygc3Bhd24gdGlsZS4gKi9cbiAgeHQgICAgID0gdGhpcy5wcm9wKFsxLCAweDdmXSk7XG5cbiAgLyoqIFRydWUgZm9yIHRpbWVkIHJlc3Bhd24sIGZhbHNlIGZvciBpbml0aWFsIHNwYXduLiAqL1xuICB0aW1lZCAgPSB0aGlzLmJvb2xlYW5Qcm9wKDEsIDcpO1xuXG4gIC8qKiA4LWJpdCBzY3JlZW4gY29vcmRpbmF0ZSAoeXgpLiAqL1xuICBzY3JlZW4gPSB0aGlzLnByb3AoWzAsIDB4ZjBdLCBbMSwgMHg3MCwgNF0pO1xuICAvKiogOC1iaXQgdGlsZSBjb29yZGluYXRlIHdpdGhpbiB0aGUgc2NyZWVuICh5eCkuICovXG4gIHRpbGUgICA9IHRoaXMucHJvcChbMCwgMHgwZiwgLTRdLCBbMSwgMHgwZl0pO1xuICAvKiogMTYtYml0IHBpeGVsIGNvb3JkaW5hdGUgd2l0aGluIHRoZSBzY3JlZW4gKHkweHgpLiAqL1xuICBjb29yZCAgPSB0aGlzLnByb3AoWzAsIDB4ZmYsIC04XSwgWzEsIDB4N2YsIC00XSwgWzIsIDB4NDAsIDNdKTtcblxuICAvKiogU3Bhd24gdHlwZSAoMC4uNCkuICovXG4gIHR5cGUgICA9IHRoaXMucHJvcChbMiwgMHgwN10pO1xuICAvKiogU3Bhd25lZCBvYmplY3QgSUQgKGV4YWN0IGludGVycHJldGF0aW9uIGRlcGVuZHMgb24gdHlwZSkuICovXG4gIGlkICAgICA9IHRoaXMucHJvcChbM10pO1xuXG4gIC8qKiBQYXR0ZXJuIGJhbmsgc2hpZnQgKDAgb3IgMSkgdG8gc3RvcmUgaW4gMzgwLHg6MjAuICovXG4gIHBhdHRlcm5CYW5rID0gdGhpcy5wcm9wKFsyLCAweDgwLCA3XSk7XG5cbi8vIHBhdHRlcm5CYW5rOiB7Z2V0KHRoaXM6IGFueSk6IG51bWJlciB7IHJldHVybiB0aGlzLmRhdGFbMl0gPj4+IDc7IH0sXG4vLyAgICAgICAgICAgICAgIHNldCh0aGlzOiBhbnksIHY6IG51bWJlcikgeyBpZiAodGhpcy5kYXRhWzNdID09PSAxMjApIGRlYnVnZ2VyO1xuLy8gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHYpIHRoaXMuZGF0YVsyXSB8PSAweDgwOyBlbHNlIHRoaXMuZGF0YVsyXSAmPSAweDdmOyB9fSxcblxuICAvKiogV2hldGhlciB0aGlzIHNwYXduIGlzIGFjdGl2ZSAoaW5hY3RpdmUgaW5kaWNhdGVkIGJ5ICRmZSBpbiBbMF0pLiAqL1xuICBnZXQgdXNlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5kYXRhWzBdICE9PSAweGZlO1xuICB9XG4gIHNldCB1c2VkKHVzZWQ6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRhdGFbMF0gPSB1c2VkID8gMCA6IDB4ZmU7XG4gIH1cblxuICAvKiogT2JqZWN0IElEIG9mIG1vbnN0ZXIgc3Bhd24gKHNoaWZ0ZWQgYnkgJDUwIGZyb20gSUQpLiAqL1xuICBnZXQgbW9uc3RlcklkKCk6IG51bWJlciB7XG4gICAgcmV0dXJuICh0aGlzLmlkICsgMHg1MCkgJiAweGZmO1xuICB9XG4gIHNldCBtb25zdGVySWQoaWQ6IG51bWJlcikge1xuICAgIHRoaXMuaWQgPSAoaWQgLSAweDUwKSAmIDB4ZmY7XG4gIH1cblxuICAvKiogV2hldGhlciB0aGlzIHNwYXduIGlzIGEgdHJlYXN1cmUgY2hlc3QgKG5vdGU6IGluY2x1ZGVzIG1pbWljcykuICovXG4gIGlzQ2hlc3QoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnR5cGUgPT09IDIgJiYgdGhpcy5pZCA8IDB4ODA7IH1cbiAgLyoqIFdoZXRoZXIgdGhpcyBzcGF3biBpcyBhbiBpbnZpc2libGUgdHJlYXN1cmUgY2hlc3QuICovXG4gIGlzSW52aXNpYmxlKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLmlzQ2hlc3QoKSAmJiBCb29sZWFuKHRoaXMuZGF0YVsyXSAmIDB4MjApO1xuICB9XG4gIC8qKiBXaGV0aGVyIHRoaXMgc3Bhd24gaXMgYSB0cmlnZ2VyICh0eXBlIDIsIHVwcGVyIElEcykuICovXG4gIGlzVHJpZ2dlcigpOiBib29sZWFuIHsgcmV0dXJuIHRoaXMudHlwZSA9PT0gMiAmJiB0aGlzLmlkID49IDB4ODA7IH1cbiAgLyoqIFdoZXRoZXIgdGhpcyBzcGF3biBpcyBhbiBOUEMgKHR5cGUgMSwgbG93ZXIgSURzKS4gKi9cbiAgaXNOcGMoKTogYm9vbGVhbiB7IHJldHVybiB0aGlzLnR5cGUgPT09IDEgJiYgdGhpcy5pZCA8IDB4YzA7IH1cbiAgLyoqIFdoZXRoZXIgdGhpcyBzcGF3biBpcyBhIGJvc3MgKHR5cGUgMSwgdXBwZXIgSURzKS4gKi9cbiAgaXNCb3NzKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy50eXBlID09PSAxICYmIHRoaXMuaWQgPj0gMHhjMDsgfVxuICAvKiogV2hldGhlciB0aGlzIHNwYXduIGlzIGEgbW9uc3RlciAodHlwZSAwKS4gKi9cbiAgaXNNb25zdGVyKCk6IGJvb2xlYW4geyByZXR1cm4gdGhpcy50eXBlID09PSAwOyB9XG4gIC8qKiBXaGV0aGVyIHRoaXMgc3Bhd24gaXMgYSB3YWxsIGhpdGJveCAodHlwZSAzLCBtb3N0bHkpLiAqL1xuICBpc1dhbGwoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIEJvb2xlYW4odGhpcy50eXBlID09PSAzICYmICh0aGlzLmlkIDwgNCB8fCAodGhpcy5kYXRhWzJdICYgMHgyMCkpKTtcbiAgfVxuICAvKiogV2hldGhlciB0aGlzIHNwYXduIGlzIGEgc2hvb3Rpbmcgd2FsbCAodXNlcyBjdXN0b20gbG9naWMpLiAqL1xuICBpc1Nob290aW5nV2FsbChsb2NhdGlvbjogTG9jYXRpb24pOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5pc1dhbGwoKSAmJlxuICAgICAgICAhISh0aGlzLmRhdGFbMl0gJiAweDIwID8gdGhpcy5kYXRhWzJdICYgMHgxMCA6XG4gICAgICAgICAgIGxvY2F0aW9uLmlkID09PSAweDhmIHx8IGxvY2F0aW9uLmlkID09PSAweGE4KTtcbiAgfVxuICAvKiogVHlwZSBvZiB3YWxsIChpLmUuIHdhbGwvYnJpZGdlKSBvciBlbXB0eSBpZiBuZWl0aGVyLiAqL1xuICB3YWxsVHlwZSgpOiAnJyB8ICd3YWxsJyB8ICdicmlkZ2UnIHtcbiAgICBpZiAodGhpcy50eXBlICE9PSAzKSByZXR1cm4gJyc7XG4gICAgY29uc3Qgb2JqID0gdGhpcy5kYXRhWzJdICYgMHgyMCA/IHRoaXMuaWQgPj4+IDQgOiB0aGlzLmlkO1xuICAgIGlmIChvYmogPj0gNCkgcmV0dXJuICcnO1xuICAgIHJldHVybiBvYmogPT09IDIgPyAnYnJpZGdlJyA6ICd3YWxsJztcbiAgfVxuICAvKiogRWxlbWVudCBvZiB3YWxsICgwLi4zKSBvciAtMSBpZiBub3QgYSB3YWxsLiAqL1xuICB3YWxsRWxlbWVudCgpOiBudW1iZXIge1xuICAgIGlmICghdGhpcy5pc1dhbGwoKSkgcmV0dXJuIC0xO1xuICAgIHJldHVybiB0aGlzLmlkICYgMztcbiAgfVxuXG4gIHRvU3RyaW5nKCk6IHN0cmluZyB7XG4gICAgcmV0dXJuIGBTcGF3biAke3RoaXMuaGV4KCl9OiAoJHtoZXgodGhpcy54KX0sICR7aGV4KHRoaXMueSl9KSAke1xuICAgICAgICAgICAgdGhpcy50aW1lZCA/ICd0aW1lZCcgOiAnZml4ZWQnfSAke3RoaXMudHlwZX06JHtoZXgodGhpcy5pZCl9YDtcbiAgfVxufVxuXG5pbnRlcmZhY2UgTG9jYXRpb24ge1xuICByZWFkb25seSBpZDogbnVtYmVyO1xufVxuIl19