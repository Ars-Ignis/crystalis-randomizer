import { Spawn } from './locationtables.js';
export var ScreenFix;
(function (ScreenFix) {
    ScreenFix[ScreenFix["Unknown"] = 0] = "Unknown";
    ScreenFix[ScreenFix["GrassLongGrass"] = 1] = "GrassLongGrass";
    ScreenFix[ScreenFix["GrassLongGrassRemapping"] = 2] = "GrassLongGrassRemapping";
    ScreenFix[ScreenFix["RiverShortGrass"] = 3] = "RiverShortGrass";
    ScreenFix[ScreenFix["SeaCaveEntrance"] = 4] = "SeaCaveEntrance";
    ScreenFix[ScreenFix["SeaRocks"] = 5] = "SeaRocks";
    ScreenFix[ScreenFix["SeaMarsh"] = 6] = "SeaMarsh";
    ScreenFix[ScreenFix["SeaTrees"] = 7] = "SeaTrees";
    ScreenFix[ScreenFix["DesertShortGrass"] = 8] = "DesertShortGrass";
    ScreenFix[ScreenFix["DesertLongGrass"] = 9] = "DesertLongGrass";
    ScreenFix[ScreenFix["DesertMarsh"] = 10] = "DesertMarsh";
    ScreenFix[ScreenFix["DesertRocks"] = 11] = "DesertRocks";
    ScreenFix[ScreenFix["DesertTrees"] = 12] = "DesertTrees";
    ScreenFix[ScreenFix["DesertTownEntrance"] = 13] = "DesertTownEntrance";
    ScreenFix[ScreenFix["LabyrinthParapets"] = 14] = "LabyrinthParapets";
    ScreenFix[ScreenFix["SwampDoors"] = 15] = "SwampDoors";
    ScreenFix[ScreenFix["ExtraSpikes"] = 16] = "ExtraSpikes";
    ScreenFix[ScreenFix["CloseCaves"] = 17] = "CloseCaves";
})(ScreenFix || (ScreenFix = {}));
export function withRequire(requirement, props) {
    for (const key in props) {
        props[key].requires = [requirement];
    }
    return props;
}
export function fixTilesets(rom) {
    const { desert, grass, lime, mountain, mountainRiver, river, sea } = rom.metatilesets;
    const $ = rom.metascreens;
    $.registerFix(ScreenFix.DesertRocks);
    desert.getTile(0x5f).copyFrom(0x5b).replaceIn($.oasisCave, $.oasisLake);
    desert.getTile(0x5a).copyFrom(0x98).setTiles([, , 0x1a, 0x18]);
    desert.getTile(0x5b).copyFrom(0x80).setTiles([0x34, 0x32, ,]);
    desert.getTile(0x5c).copyFrom(0x80).setTiles([, , 0x37, 0x35]);
    desert.getTile(0x5d).copyFrom(0x80).setTiles([, 0x37, , 0x34]);
    desert.getTile(0x5e).copyFrom(0x80).setTiles([0x35, , 0x32,]);
    $.registerFix(ScreenFix.DesertTrees);
    desert.getTile(0x63).copyFrom(0x71);
    desert.getTile(0x68).copyFrom(0x70);
    desert.getTile(0x69).copyFrom(0x60);
    desert.getTile(0x6a).copyFrom(0x65);
    desert.getTile(0x6c).copyFrom(0x70);
    desert.getTile(0x6e).copyFrom(0x76);
    desert.getTile(0x6f).copyFrom(0x78);
    $.registerFix(ScreenFix.GrassLongGrass);
    grass.getTile(0x40).copyFrom(0x51);
    grass.getTile(0x41).copyFrom(0x52);
    grass.getTile(0x42).copyFrom(0x53);
    grass.getTile(0x43).copyFrom(0x54);
    grass.getTile(0x44).copyFrom(0x55);
    grass.getTile(0x45).copyFrom(0x56);
    grass.getTile(0x46).copyFrom(0x58);
    grass.getTile(0x47).copyFrom(0x59);
    $.registerFix(ScreenFix.SeaCaveEntrance);
    sea.getTile(0xad).copyFrom(0x0a)
        .replaceIn($.beachExitN, $.lighthouseEntrance, $.oceanShrine);
    sea.getTile(0x0a).copyFrom(0xa2);
    $.boundaryN_cave.screen.set2d(0x38, [[null, 0x00, 0x00, null],
        [null, 0x0a, 0x0a, null],
        [null, 0x90, 0x90, null],
        [0xf8, 0xf8, 0xf8, 0xf8]]);
    $.cornerSE_cave.screen.set2d(0x49, [[null, 0x00, 0x00],
        [null, 0x0a, 0x0a],
        [null, 0x90, 0x90],
        [0xf8, 0xf7, 0xf7],
        [null, 0xfd, 0xf7]]);
    $.cornerSE_cave.screen.set2d(0x4a, [[0x00, 0x00],
        [0x0a, 0x0a],
        [0x90, 0x90],
        [0xf8, 0xf7],
        [0x80, 0xfd],
        [0x80, 0xff],
        [0xfa, null]]);
    sea.getTile(0x90).setTiles([0x91, 0x91,
        0x7d, 0x7d]).setAttrs(2).setEffects(2);
    river.getTile(0x90).copyFrom(0xf7);
    grass.getTile(0x90).copyFrom(0xf7);
    desert.getTile(0x90).copyFrom(0xf7);
    $.registerFix(ScreenFix.CloseCaves);
    river.getTile(0x07).copyFrom(0x01).replaceIn(...river);
    river.getTile(0x0e).copyFrom(0x02).replaceIn(...river);
    river.getTile(0x20).copyFrom(0x03).replaceIn(...river);
    river.getTile(0x21).copyFrom(0x04).replaceIn(...river);
    for (const ts of [desert, sea, mountain, mountainRiver, lime]) {
        ts.getTile(0x68).copyFrom(0x01).replaceIn(...ts);
        ts.getTile(0x83).copyFrom(0x02).replaceIn(...ts);
        ts.getTile(0x88).copyFrom(0x03).replaceIn(...ts);
        ts.getTile(0x89).copyFrom(0x04).replaceIn(...ts);
    }
    for (const ts of [river, desert, sea]) {
        ts.getTile(0x01).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x02).copyFrom(0xc1).setAlternative(0x00);
        ts.getTile(0x03).copyFrom(0xd7).setAlternative(0x0a);
        ts.getTile(0x04).copyFrom(0xd7).setAlternative(0x0a);
    }
    const closedCaves = [
        [$.boundaryE_cave, 0x48], [$.boundaryW_cave, 0x79],
        [$.exitW_cave, 0x38], [$.caveAbovePortoa, 0x56],
    ];
    for (const [scr, pos] of closedCaves) {
        scr.screen.set2d(pos, [[1, 2], [3, 4]]);
        scr.addCustomFlag(true);
    }
    {
        const { locations: { CordelPlainEast, CordelPlainWest, WaterfallValleyNorth }, flags: { OpenedSealedCave } } = rom;
        CordelPlainEast.meta.customFlags.set(0x30, OpenedSealedCave);
        CordelPlainWest.meta.customFlags.set(0x30, OpenedSealedCave);
        WaterfallValleyNorth.meta.customFlags.set(0x30, OpenedSealedCave);
        const explosion = Spawn.of({ y: 0x060, x: 0x060, type: 4, id: 0x2c });
        const keyTrigger = Spawn.of({ y: 0x070, x: 0x070, type: 2, id: 0xad });
        WaterfallValleyNorth.spawns.splice(1, 0, explosion);
        WaterfallValleyNorth.spawns.push(keyTrigger);
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2NyZWVuZml4LmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL3JvbS9zY3JlZW5maXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLHFCQUFxQixDQUFDO0FBSTVDLE1BQU0sQ0FBTixJQUFZLFNBMkRYO0FBM0RELFdBQVksU0FBUztJQUNuQiwrQ0FBTyxDQUFBO0lBR1AsNkRBQWMsQ0FBQTtJQUtkLCtFQUF1QixDQUFBO0lBSXZCLCtEQUFlLENBQUE7SUFLZiwrREFBZSxDQUFBO0lBTWYsaURBQVEsQ0FBQTtJQUdSLGlEQUFRLENBQUE7SUFJUixpREFBUSxDQUFBO0lBR1IsaUVBQWdCLENBQUE7SUFHaEIsK0RBQWUsQ0FBQTtJQUlmLHdEQUFXLENBQUE7SUFHWCx3REFBVyxDQUFBO0lBR1gsd0RBQVcsQ0FBQTtJQUdYLHNFQUFrQixDQUFBO0lBRWxCLG9FQUFpQixDQUFBO0lBRWpCLHNEQUFVLENBQUE7SUFFVix3REFBVyxDQUFBO0lBRVgsc0RBQVUsQ0FBQTtBQUNaLENBQUMsRUEzRFcsU0FBUyxLQUFULFNBQVMsUUEyRHBCO0FBR0QsTUFBTSxVQUFVLFdBQVcsQ0FBaUIsV0FBc0IsRUFBRSxLQUFRO0lBQzFFLEtBQUssTUFBTSxHQUFHLElBQUksS0FBSyxFQUFFO1FBQ3ZCLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQyxRQUFRLEdBQUcsQ0FBQyxXQUFXLENBQUMsQ0FBQztLQUNyQztJQUNELE9BQU8sS0FBSyxDQUFDO0FBQ2YsQ0FBQztBQTRDRCxNQUFNLFVBQVUsV0FBVyxDQUFDLEdBQVE7SUFDbEMsTUFBTSxFQUFDLE1BQU0sRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUNuQixRQUFRLEVBQUUsYUFBYSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUMsR0FBRyxHQUFHLENBQUMsWUFBWSxDQUFDO0lBQy9ELE1BQU0sQ0FBQyxHQUFHLEdBQUcsQ0FBQyxXQUFXLENBQUM7SUFJMUIsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDckMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDO0lBRXhFLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLEVBQUUsQUFBRCxFQUFHLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQy9ELE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsQUFBRCxFQUFJLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLEFBQUQsRUFBRyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxFQUFFLElBQUksRUFBRSxBQUFELEVBQUcsSUFBSSxDQUFDLENBQUMsQ0FBQztJQUMvRCxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxJQUFJLEVBQUUsQUFBRCxFQUFHLElBQUksRUFBRyxDQUFDLENBQUM7SUFFL0QsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDckMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDcEMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFJcEMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsY0FBYyxDQUFDLENBQUM7SUFDeEMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDbkMsS0FBSyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFXbkMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsZUFBZSxDQUFDLENBQUM7SUFDekMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDO1NBQzNCLFNBQVMsQ0FBQyxDQUFDLENBQUMsVUFBVSxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsRUFBRSxDQUFDLENBQUMsV0FBVyxDQUFDLENBQUM7SUFDbEUsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7SUFFakMsQ0FBQyxDQUFDLGNBQWMsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ3hCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUMsQ0FBQyxDQUFDO0lBQ2hFLENBQUMsQ0FBQyxhQUFhLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7UUFDbEIsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7SUFDekQsQ0FBQyxDQUFDLGFBQWEsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztJQU1uRCxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJO1FBQ1YsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsUUFBUSxDQUFDLENBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxDQUFDLENBQUMsQ0FBQztJQUNuRSxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNuQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNuQyxNQUFNLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQWFwQyxDQUFDLENBQUMsV0FBVyxDQUFDLFNBQVMsQ0FBQyxVQUFVLENBQUMsQ0FBQztJQUNwQyxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxTQUFTLENBQUMsR0FBRyxLQUFLLENBQUMsQ0FBQztJQUN2RCxLQUFLLE1BQU0sRUFBRSxJQUFJLENBQUMsTUFBTSxFQUFFLEdBQUcsRUFBRSxRQUFRLEVBQUUsYUFBYSxFQUFFLElBQUksQ0FBQyxFQUFFO1FBQzdELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO1FBQ2pELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLFNBQVMsQ0FBQyxHQUFHLEVBQUUsQ0FBQyxDQUFDO0tBQ2xEO0lBQ0QsS0FBSyxNQUFNLEVBQUUsSUFBSSxDQUFDLEtBQUssRUFBRSxNQUFNLEVBQUUsR0FBRyxDQUFDLEVBQUU7UUFDckMsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3REO0lBQ0QsTUFBTSxXQUFXLEdBQWdDO1FBQy9DLENBQUMsQ0FBQyxDQUFDLGNBQWMsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxjQUFjLEVBQUUsSUFBSSxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDLFVBQVUsRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQyxlQUFlLEVBQUUsSUFBSSxDQUFDO0tBQ2hELENBQUM7SUFJRixLQUFLLE1BQU0sQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDLElBQUksV0FBVyxFQUFFO1FBQ3BDLEdBQUcsQ0FBQyxNQUFNLENBQUMsS0FBSyxDQUFDLEdBQUcsRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN4QyxHQUFHLENBQUMsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDO0tBQ3pCO0lBQ0Q7UUFDRSxNQUFNLEVBQUMsU0FBUyxFQUFFLEVBQUMsZUFBZSxFQUFFLGVBQWUsRUFBRSxvQkFBb0IsRUFBQyxFQUNuRSxLQUFLLEVBQUUsRUFBQyxnQkFBZ0IsRUFBQyxFQUFDLEdBQUcsR0FBRyxDQUFDO1FBQ3hDLGVBQWUsQ0FBQyxJQUFJLENBQUMsV0FBVyxDQUFDLEdBQUcsQ0FBQyxJQUFJLEVBQUUsZ0JBQWdCLENBQUMsQ0FBQztRQUM3RCxlQUFlLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLGdCQUFnQixDQUFDLENBQUM7UUFDN0Qsb0JBQW9CLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxHQUFHLENBQUMsSUFBSSxFQUFFLGdCQUFnQixDQUFDLENBQUM7UUFDbEUsTUFBTSxTQUFTLEdBQUcsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFDO1FBQ3BFLE1BQU0sVUFBVSxHQUFHLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRSxvQkFBb0IsQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsU0FBUyxDQUFDLENBQUM7UUFDcEQsb0JBQW9CLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsQ0FBQztLQUM5QztBQTBDSCxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtSb219IGZyb20gJy4uL3JvbS5qcyc7XG5pbXBvcnQgeyBTcGF3biB9IGZyb20gJy4vbG9jYXRpb250YWJsZXMuanMnO1xuaW1wb3J0IHsgTWV0YXNjcmVlbiB9IGZyb20gJy4vbWV0YXNjcmVlbi5qcyc7XG5cbi8vIFNpbXBsZSB0aWxlc2V0LW9ubHkgZml4ZXMgdGhhdCB1bmxvY2sgc29tZSBzY3JlZW4tdGlsZXNldCBjb21iaW5hdGlvbnNcbmV4cG9ydCBlbnVtIFNjcmVlbkZpeCB7XG4gIFVua25vd24sXG4gIC8vIFN1cHBvcnQgXCJsb25nIGdyYXNzXCIgcml2ZXIgc2NyZWVucyBvbiB0aGUgZ3Jhc3MgdGlsZXNldCBieSBjb3B5aW5nXG4gIC8vIHNvbWUgdGlsZXMgZnJvbSA1MS4uNTkgaW50byA0MC4uNDcuXG4gIEdyYXNzTG9uZ0dyYXNzLFxuICAvLyBJbiBhZGRpdGlvbiB0byBqdXN0IG1ha2luZyB0aGUgbmV3IGxvbmcgZ3Jhc3MgdGlsZXMsIHdlIG5lZWQgdG9cbiAgLy8gYWxzbyByZW1hcCB0aGUgZXhpc3Rpbmcgb25lcyBpbiBzb21lIHNpdHVhdGlvbnMgdG8gcG9pbnQgdG8gdGhlXG4gIC8vIG5ldyBvbmVzLCBlLmcuIGZvciBzY3JlZW5zIDFkLDI5IHRvIHdvcmsgb24gcml2ZXIsIHdlIG5lZWQgdG8gdXNlXG4gIC8vIHRoZSA0eCB0aWxlcyBpbnN0ZWFkIG9mIHRoZSA1eCBvbmVzIHRvIGZpeCB0aGUgc3Vycm91bmRpbmcuXG4gIEdyYXNzTG9uZ0dyYXNzUmVtYXBwaW5nLCAvLyBUT0RPXG4gIC8vIFJpdmVyIHRpbGVzZXRzIGRvbid0IGRlZmluZSAxMCwxMiwxNCwxNiwxNywxYSwxYiwxYywyMiwyMywyNCwyNSwyNixcbiAgLy8gd2hpY2ggYXJlIHVzZWQgZm9yIHRoZSBcInNob3J0IGdyYXNzXCIgaW4gdGhlIGdyYXNzIHRpbGVzZXQuICBUaGVzZVxuICAvLyB3b3VsZCBiZSBlYXN5IHRvIGNvcHkgZnJvbSBzb21ld2hlcmUgZWxzZSB0byBvcGVuIHVwIGEgZmV3IHNjcmVlbnMuXG4gIFJpdmVyU2hvcnRHcmFzcywgLy8gVE9ET1xuICAvLyBBbmdyeSBzZWEgdXNlcyAwYSBvZGRseSBmb3IgYSBzaW1wbGUgZGlhZ29uYWwgYmVhY2gvbW91bnRhaW4gdGlsZSxcbiAgLy8gcHJldmVudGluZyBwYXJpdHkgd2l0aCBncmFzcy9yaXZlciBjYXZlIGVudHJhbmNlIGJvdHRvbXMuICBNb3ZlIHRoaXNcbiAgLy8gdGlsZSBlbHNld2hlcmUgKGFkKSBhbmQgZml4IHRoZSBncmFwaGljcy9lZmZlY3RzLiAgTm90ZSB0aGF0IHRoZVxuICAvLyBhY3R1YWwgZml4IGlzIG5vdCBlbnRpcmVseSBzYXRpc2Z5aW5nLlxuICBTZWFDYXZlRW50cmFuY2UsXG4gIC8vIEFuZ3J5IHNlYSBkb2VzIG5vdCBoYW5kbGUgcm9ja3MgY29ycmVjdGx5LiAgRml4IDVhLi41ZSBmb3IgcGFyaXR5XG4gIC8vIHdpdGggZ3Jhc3Mvcml2ZXIgdGlsZXNldHMuICBUT0RPIC0gaW1wbGVtZW50IHRoZSBmaXggKHdlIGNvdWxkIG1vdmVcbiAgLy8gdGhlIGV4aXN0aW5nIHRpbGVzLCB1c2VkIGJ5IG1vdW50YWluIGdhdGVzLCBlbHNld2hlcmUgcHJldHR5IGVhc2lseSxcbiAgLy8gb3IgYWx0ZXJuYXRpdmVseSBtb3ZlIGFsbCB0aGUgNWEuLjVlIGluIGFsbCBvdGhlciB0aWxlc2V0cyBpbnRvXG4gIC8vIDg5LDhhLDkwLDk5LDlkLGQxLGQyIHdoaWNoIGFyZSBmcmVlIGluIDgwLDkwLDk0LDljKS5cbiAgU2VhUm9ja3MsIC8vIFRPRE9cbiAgLy8gQWxsb3cgdGhlIHNlYSB0byBzdXBwb3J0IDM0LDM4LDNjLi4zZiwgdXNlZCBhcyBtYXJzaCBpbiByaXZlciB0aWxlc2V0LlxuICAvLyBUaGVzZSB3b3VsZCBuZWVkIHRvIG1hcCB0byBzaW1wbGUgb2NlYW4gdGlsZXMuICBUT0RPIC0gaW1wbGVtZW50LlxuICBTZWFNYXJzaCwgLy8gVE9ET1xuICAvLyBTdXBwb3J0IDZ4LDd4IHRpbGVzICh0cmVlcykgb24gYW5ncnkgc2VhLiAgUHJvYmFibHkgbm90IHdvcnRoIGl0LlxuICAvLyBXb3VsZCBuZWVkIHRvIG1vdmUgKGUuZy4pIExpbWUgVHJlZSBMYWtlIHRvIGEgdG90YWxseSBkaWZmZXJlbnQgdGlsZXNldFxuICAvLyB0byBmcmVlIHVwIHRoZSBtZXRhdGlsZXMuXG4gIFNlYVRyZWVzLCAvLyBUT0RPXG4gIC8vIEZpeGluZyBSaXZlclNob3J0R3Jhc3MgZm9yIGRlc2VydCBpcyBhIGxvdCBoYXJkZXIgYmVjYXVzZSBpdCB0b3VjaGVzIGFcbiAgLy8gYnVuY2ggb2YgdGlsZXMgdXNlZCBieSB0aGUgbW91bnRhaW5SaXZlciB0aWxlc2V0ICgxMCwxNCwyeCkuXG4gIERlc2VydFNob3J0R3Jhc3MsIC8vIFRPRE9cbiAgLy8gRml4aW5nIEdyYXNzTG9uZ0dyYXNzIGZvciBkZXNlcnQgaXMgZGlmZmljdWx0IGJlY2F1c2UgdGhlIDR4IHRpbGVzXG4gIC8vIGFyZSB1c2VkIGJ5IG1vdW50YWluUml2ZXIuXG4gIERlc2VydExvbmdHcmFzcywgLy8gVE9ET1xuICAvLyBEZXNlcnQgZG9lc24ndCBzdXBwb3J0IHRoZSAzeCBtYXJzaCB0aWxlcyAoY2xhc2ggd2l0aCBtb3VudGFpblJpdmVyKS5cbiAgLy8gSXQncyBwcm9iYWJseSBub3QgZmVhc2libGUgdG8gYWRkIHN1cHBvcnQgLSBpdCB3b3VsZCBhbGxvdyBzY3JlZW4gMzMsXG4gIC8vIGJ1dCB0aGVyZSdzIGEgc2ltaWxhciBzb3V0aC1lZGdlLWV4aXQgc2NyZWVuIHdpdGggRGVzZXJ0VG93bkVudHJhbmNlLlxuICBEZXNlcnRNYXJzaCwgLy8gVE9ET1xuICAvLyBGaXggNWEuLjVlIHRvIGJlIGNvbXBhdGlibGUgd2l0aCBncmFzcy9yaXZlci4gIDViIGlzIGFscmVhZHkgaW4gdXNlXG4gIC8vIG9uIHRoZSB0d28gb2FzaXMgc2NyZWVucywgc28gdGhhdCB0aWxlIGlzIG1vdmVkIHRvIDVmIHRvIG1ha2Ugc3BhY2UuXG4gIERlc2VydFJvY2tzLFxuICAvLyBBZGQgc29tZSBtaXNzaW5nIHRyZWUgdGlsZXMgaW4gNjMsNjgsNjksNmEsNmMsNmUsNmYsIHJlcXVpcmVkIGZvclxuICAvLyBwYXJpdHkgd2l0aCBzb21lIHJpdmVyIHNjcmVlbnMuXG4gIERlc2VydFRyZWVzLFxuICAvLyBTb3V0aC1mYWNpbmcgdG93biBlbnRyYW5jZXMgdXNlIDA3IGZvciB0aGUgdG9wIG9mIHRoZSB0b3duIHdhbGwuXG4gIC8vIFRoaXMgY291bGQgYmUgcmVwbGFjZWQgd2l0aCAoZS5nLiA4Yykgb3IgbWF5YmUgc29tZXRoaW5nIGJldHRlci5cbiAgRGVzZXJ0VG93bkVudHJhbmNlLCAvLyBUT0RPXG4gIC8vIExhYnlyaW50aCBwYXJhcGV0cyBjYW4gYmUgYmxvY2tlZC91bmJsb2NrZWQgd2l0aCBhIGZsYWcuXG4gIExhYnlyaW50aFBhcmFwZXRzLCAvLyBUT0RPIChzZWUgbWF6ZS9nb2EpXG4gIC8vIEFkZHMgZmxhZ2dhYmxlIGRvb3JzIHRvIHZhcmlvdXMgc2NyZWVucy5cbiAgU3dhbXBEb29ycywgLy8gVE9ETyAoc2VlIG1hemUvc3dhbXApXG4gIC8vIEFkZHMgc29tZSBleHRyYSBzcGlrZSBzY3JlZW5zLlxuICBFeHRyYVNwaWtlcywgLy8gVE9ET1xuICAvLyBNYWtlIGNhdmVzIGNsb3NlYWJsZS5cbiAgQ2xvc2VDYXZlcyxcbn1cblxudHlwZSBSZXFzID0gUmVjb3JkPGFueSwge3JlcXVpcmVzPzogU2NyZWVuRml4W119PlxuZXhwb3J0IGZ1bmN0aW9uIHdpdGhSZXF1aXJlPFQgZXh0ZW5kcyBSZXFzPihyZXF1aXJlbWVudDogU2NyZWVuRml4LCBwcm9wczogVCkge1xuICBmb3IgKGNvbnN0IGtleSBpbiBwcm9wcykge1xuICAgIHByb3BzW2tleV0ucmVxdWlyZXMgPSBbcmVxdWlyZW1lbnRdO1xuICB9XG4gIHJldHVybiBwcm9wcztcbn1cblxuXG4gIC8vIC8vIEFkZHMgYWJpbGl0eSB0byBjbG9zZSBjYXZlcy5cbiAgLy8gQ2xvc2VDYXZlcyxcblxuXG4vLyAvKiogQWRkcyBhICdDbG9zZUNhdmVzJyByZXF1aXJlbWVudCBvbiBhbGwgdGhlIHByb3BlcnRpZXMuICovXG4vLyBmdW5jdGlvbiBjbG9zZUNhdmVzPFQgZXh0ZW5kcyBSZWNvcmQ8YW55LCB7cmVxdWlyZXM6IFNjcmVlbkZpeFtdfT4+KHByb3BzOiBUKSB7XG4vLyAgIGZvciAoY29uc3Qga2V5IGluIHByb3BzKSB7XG4vLyAgICAgcHJvcHNba2V5XS5yZXF1aXJlcyA9IFtTY3JlZW5GaXguQ2xvc2VDYXZlc107XG4vLyAgIH1cbi8vICAgcmV0dXJuIHByb3BzO1xuLy8gfVxuXG5cbi8vIE5PVEU6IExpc3RpbmcgZXhwbGljaXQgZmxhZ3MgZG9lc24ndCBxdWl0ZSB3b3JrLlxuLy8gZW51bSBGbGFnIHtcbi8vICAgQWx3YXlzID0gMHgyZjAsXG4vLyAgIFdpbmRtaWxsID0gMHgyZWUsXG4vLyAgIFByaXNvbiA9IDB4MmQ4LFxuLy8gICBDYWxtID0gMHgyODMsXG4vLyAgIFN0eXggPSAweDJiMCxcbi8vICAgRHJheWdvbjEgPSAweDI4Zixcbi8vICAgRHJheWdvbjIgPSAweDI4ZCxcbi8vIH1cblxuLy8gY29uc3QgR1JBU1MgPSAweDgwO1xuLy8gY29uc3QgVE9XTiA9IDB4ODQ7XG4vLyBjb25zdCBDQVZFID0gMHg4ODtcbi8vIGNvbnN0IFBZUkFNSUQgPSAweDhjO1xuLy8gY29uc3QgUklWRVIgPSAweDkwO1xuLy8gY29uc3QgTU9VTlRBSU4gPSAweDk0O1xuLy8gY29uc3QgU0VBID0gMHg5NDtcbi8vIGNvbnN0IFNIUklORSA9IDB4OTg7XG4vLyBjb25zdCBERVNFUlQgPSAweDljO1xuLy8gY29uc3QgTU9VTlRBSU5fUklWRVIgPSAweDljO1xuLy8gY29uc3QgU1dBTVAgPSAweGEwO1xuLy8gY29uc3QgSE9VU0UgPSAweGEwO1xuLy8gY29uc3QgRk9SVFJFU1MgPSAweGE0O1xuLy8gY29uc3QgSUNFX0NBVkUgPSAweGE4O1xuLy8gY29uc3QgVE9XRVIgPSAweGFjO1xuXG4vKiogQXBwbHkgc3RhbmRhcmQgdGlsZXNldCBmaXhlcy4gIE90aGVycyBtYXkgYmUgYXBwbGllZCBsYXRlci4gKi9cbmV4cG9ydCBmdW5jdGlvbiBmaXhUaWxlc2V0cyhyb206IFJvbSkge1xuICBjb25zdCB7ZGVzZXJ0LCBncmFzcywgbGltZSxcbiAgICAgICAgIG1vdW50YWluLCBtb3VudGFpblJpdmVyLCByaXZlciwgc2VhfSA9IHJvbS5tZXRhdGlsZXNldHM7XG4gIGNvbnN0ICQgPSByb20ubWV0YXNjcmVlbnM7XG5cbiAgLy8gU2V2ZXJhbCBvZiB0aGUgZ3Jhc3Mvcml2ZXIgc2NyZWVucyB3aXRoIGZvcmVzdCB0aWxlcyBkb24ndCB3b3JrIG9uXG4gIC8vIGRlc2VydC4gIEZpeCB0aGVtIGJ5IG1ha2luZyA1YS4uNmYgd29yayBjb3JyZWN0bHkuXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkRlc2VydFJvY2tzKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1ZikuY29weUZyb20oMHg1YikucmVwbGFjZUluKCQub2FzaXNDYXZlLCAkLm9hc2lzTGFrZSk7XG5cbiAgZGVzZXJ0LmdldFRpbGUoMHg1YSkuY29weUZyb20oMHg5OCkuc2V0VGlsZXMoWywgLCAweDFhLCAweDE4XSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWIpLmNvcHlGcm9tKDB4ODApLnNldFRpbGVzKFsweDM0LCAweDMyLCAsIF0pO1xuICBkZXNlcnQuZ2V0VGlsZSgweDVjKS5jb3B5RnJvbSgweDgwKS5zZXRUaWxlcyhbLCAsIDB4MzcsIDB4MzVdKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg1ZCkuY29weUZyb20oMHg4MCkuc2V0VGlsZXMoWywgMHgzNywgLCAweDM0XSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NWUpLmNvcHlGcm9tKDB4ODApLnNldFRpbGVzKFsweDM1LCAsIDB4MzIsIF0pO1xuXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LkRlc2VydFRyZWVzKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2MykuY29weUZyb20oMHg3MSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NjgpLmNvcHlGcm9tKDB4NzApO1xuICBkZXNlcnQuZ2V0VGlsZSgweDY5KS5jb3B5RnJvbSgweDYwKTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2YSkuY29weUZyb20oMHg2NSk7XG4gIGRlc2VydC5nZXRUaWxlKDB4NmMpLmNvcHlGcm9tKDB4NzApO1xuICBkZXNlcnQuZ2V0VGlsZSgweDZlKS5jb3B5RnJvbSgweDc2KTtcbiAgZGVzZXJ0LmdldFRpbGUoMHg2ZikuY29weUZyb20oMHg3OCk7XG5cbiAgLy8gTG9uZyBncmFzcyBzY3JlZW5zIGRvbid0IHdvcmsgb24gZ3Jhc3MgdGlsZXNldHMgYmVjYXVzZSBvZiBhIGZld1xuICAvLyBkaWZmZXJlbnQgdGlsZXMgLSBjb3B5IHRoZW0gd2hlcmUgdGhleSBuZWVkIHRvIGdvLlxuICAkLnJlZ2lzdGVyRml4KFNjcmVlbkZpeC5HcmFzc0xvbmdHcmFzcyk7XG4gIGdyYXNzLmdldFRpbGUoMHg0MCkuY29weUZyb20oMHg1MSk7XG4gIGdyYXNzLmdldFRpbGUoMHg0MSkuY29weUZyb20oMHg1Mik7XG4gIGdyYXNzLmdldFRpbGUoMHg0MikuY29weUZyb20oMHg1Myk7XG4gIGdyYXNzLmdldFRpbGUoMHg0MykuY29weUZyb20oMHg1NCk7XG4gIGdyYXNzLmdldFRpbGUoMHg0NCkuY29weUZyb20oMHg1NSk7XG4gIGdyYXNzLmdldFRpbGUoMHg0NSkuY29weUZyb20oMHg1Nik7XG4gIGdyYXNzLmdldFRpbGUoMHg0NikuY29weUZyb20oMHg1OCk7XG4gIGdyYXNzLmdldFRpbGUoMHg0NykuY29weUZyb20oMHg1OSk7XG5cbiAgLy8gQW5ncnkgc2VhIHRpbGVzZXQgZG9lc24ndCBzdXBwb3J0IHRpbGUgMGEgKHVzZWQgZWxzZXdoZXJlIGZvciB0aGVcbiAgLy8gYm90dG9tIHRpbGUgaW4gY2F2ZSBlbnRyYW5jZXMpIGJlY2F1c2UgaXQncyBhbHJlYWR5IGluIHVzZSAoYnV0XG4gIC8vIG5vdCBhcyBhbiBhbHRlcm5hdGl2ZSkuICBNb3ZlIGl0IHRvIGFkIGFuZCBnZXQgMGEgYmFjay4gIEFsc28gYWRqdXN0XG4gIC8vIHRoZSB0aWxlcyBhcm91bmQgdGhlIGNhdmUgZW50cmFuY2VzIHRvIG5vdCBoYXZlIGRhbWFnZSB0aWxlcyBpbiB0aGVcbiAgLy8gZGVzZXJ0IHRpbGVzZXQuICBUaGlzIGNoYW5nZXMgdGhlIGdyYXBoaWNzIGEgYml0IChmcm9tIGRhcmsgYmx1ZVxuICAvLyB3YXRlciB0byBsaWdodCBibHVlKSwgd2hpY2ggZG9lc24ndCBsb29rIHF1aXRlIGFzIG5pY2UuICBUaGUgb3RoZXJcbiAgLy8gYWx0ZXJuYXRpdmUgaXMgdG8gYWxsb2NhdGUgMyBuZXcgdGlsZXMsIGNvcGllZCBmcm9tIDB4ODAgaW4gc2VhIGJ1dFxuICAvLyBmcm9tIDB4ZjcsIDB4ZjgsIGFuZCAweGZkIGluIGRlc2VydC9yaXZlci9ncmFzcy4gIFRoZW4gc2VhIGNhbiBrZWVwXG4gIC8vIGl0cyBkZWVwIHdhdGVyIGJ1dCBkZXNlcnQgYXZvaWRzIHRoZSBkYW1hZ2UuXG4gICQucmVnaXN0ZXJGaXgoU2NyZWVuRml4LlNlYUNhdmVFbnRyYW5jZSk7XG4gIHNlYS5nZXRUaWxlKDB4YWQpLmNvcHlGcm9tKDB4MGEpXG4gICAgICAucmVwbGFjZUluKCQuYmVhY2hFeGl0TiwgJC5saWdodGhvdXNlRW50cmFuY2UsICQub2NlYW5TaHJpbmUpO1xuICBzZWEuZ2V0VGlsZSgweDBhKS5jb3B5RnJvbSgweGEyKTsgLy8gZG9uJ3QgYm90aGVyIHNldHRpbmcgYW4gYWx0ZXJuYXRpdmUuXG4gIC8vc2VhLmdldFRpbGUoMHgwYSkuc2V0VGlsZXMoWzB4OTEsIDB4OTEsIDB4N2QsIDB4N2RdKS5zZXRBdHRycygyKTtcbiAgJC5ib3VuZGFyeU5fY2F2ZS5zY3JlZW4uc2V0MmQoMHgzOCwgW1tudWxsLCAweDAwLCAweDAwLCBudWxsXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtudWxsLCAweDBhLCAweDBhLCBudWxsXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtudWxsLCAweDkwLCAweDkwLCBudWxsXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweGY4LCAweGY4LCAweGY4LCAweGY4XV0pO1xuICAkLmNvcm5lclNFX2NhdmUuc2NyZWVuLnNldDJkKDB4NDksIFtbbnVsbCwgMHgwMCwgMHgwMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtudWxsLCAweDBhLCAweDBhXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW251bGwsIDB4OTAsIDB4OTBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmOCwgMHhmNywgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFtudWxsLCAweGZkLCAweGY3XV0pO1xuICAkLmNvcm5lclNFX2NhdmUuc2NyZWVuLnNldDJkKDB4NGEsIFtbMHgwMCwgMHgwMF0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweDBhLCAweDBhXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4OTAsIDB4OTBdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmOCwgMHhmN10sXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFsweDgwLCAweGZkXSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWzB4ODAsIDB4ZmZdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbMHhmYSwgbnVsbF1dKTtcblxuICAvLyBUT0RPIC0gdGhpcyBhZGRzIGEgbGl0dGxlIGZvYW0gdG8gdGhlIGJvdHRvbSBvZiB0aGUgY2F2ZSwgYXQgdGhlIGNvc3Qgb2ZcbiAgLy8gb25lIG1ldGF0aWxlLiAgVG8gcmV2ZXJ0LCBqdXN0IGNoYW5nZSB0aGUgMHg5MCdzIGFib3ZlIGJhY2sgdG8gMHhmNydzLlxuICAvLyBOT1RFOiB3ZSBjYW4gY2hhbmdlIHRoZSByb3cgYmVuZWF0aCAweDBhIHRvIDB4OTAgYW5kIHNldCBpdHMgZ3JhcGhpY3NcbiAgLy8gdG8gc29tZXRoaW5nIG5pY2VyLlxuICBzZWEuZ2V0VGlsZSgweDkwKS5zZXRUaWxlcyhbMHg5MSwgMHg5MSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDB4N2QsIDB4N2RdKS5zZXRBdHRycygyKS5zZXRFZmZlY3RzKDIpO1xuICByaXZlci5nZXRUaWxlKDB4OTApLmNvcHlGcm9tKDB4ZjcpO1xuICBncmFzcy5nZXRUaWxlKDB4OTApLmNvcHlGcm9tKDB4ZjcpO1xuICBkZXNlcnQuZ2V0VGlsZSgweDkwKS5jb3B5RnJvbSgweGY3KTtcblxuXG4gICAgIC8vICwgWzB4ZjgsIDB4ZjhdLCBbbnVsbCwgMHhmZF1dKTtcbiAgLy8gc2VhLnNjcmVlbnMuYWRkKCQuYm91bmRhcnlXX2NhdmUpO1xuICAvLyBzZWEuc2NyZWVucy5hZGQoJC5kZXNlcnRDYXZlRW50cmFuY2UpO1xuXG4gIC8vIFRvIGFsbG93IGNhdmVzIHRvIGJlIGNsb3NlZCwgd2UgY2xlYXIgb3V0IG1ldGF0aWxlcyAwMS4uMDQsIHRvIGJlIHVzZWQgYXNcbiAgLy8gdGhlIGZvdXIgY29ybmVycyBvZiB0aGUgY2F2ZTogW1swMSwgMDJdLCBbMDMsIDA0XV0uICBUaGVzZSBhcmUgY29waWVkIGZyb21cbiAgLy8gYzEsYzEsZDcsZDcuICBbVE9ETyAtIHNlZW1zIGxpa2Ugd2UgY291bGQganVzdCB1c2UgMiBpbnN0ZWFkIG9mIDQgaGVyZV0uXG4gIC8vIFNvbWUgdGlsZXNldHMgYWxyZWFkeSBoYXZlIG1ldGF0aWxlcyBpbiAwMS4uMDQgc28gd2UgbmVlZCB0byBtb3ZlIHRoZW0gdG9cbiAgLy8gdW5vY2N1cGllZCBzcG90cyBvbiBhIHBlci10aWxlc2V0IGJhc2lzIChub3RlIHRoYXQgc2VhICg5NCkgYW5kIGRlc2VydCAoOWMpXG4gIC8vIGFyZSBlbnRhbmdsZWQgaGVyZSkuICBbVE9ETyAtIGNsZWFuIHVwIDJjIGFuZCAyZCBhcyB3ZWxsXVxuICAkLnJlZ2lzdGVyRml4KFNjcmVlbkZpeC5DbG9zZUNhdmVzKTtcbiAgcml2ZXIuZ2V0VGlsZSgweDA3KS5jb3B5RnJvbSgweDAxKS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICByaXZlci5nZXRUaWxlKDB4MGUpLmNvcHlGcm9tKDB4MDIpLnJlcGxhY2VJbiguLi5yaXZlcik7XG4gIHJpdmVyLmdldFRpbGUoMHgyMCkuY29weUZyb20oMHgwMykucmVwbGFjZUluKC4uLnJpdmVyKTtcbiAgcml2ZXIuZ2V0VGlsZSgweDIxKS5jb3B5RnJvbSgweDA0KS5yZXBsYWNlSW4oLi4ucml2ZXIpO1xuICBmb3IgKGNvbnN0IHRzIG9mIFtkZXNlcnQsIHNlYSwgbW91bnRhaW4sIG1vdW50YWluUml2ZXIsIGxpbWVdKSB7XG4gICAgdHMuZ2V0VGlsZSgweDY4KS5jb3B5RnJvbSgweDAxKS5yZXBsYWNlSW4oLi4udHMpO1xuICAgIHRzLmdldFRpbGUoMHg4MykuY29weUZyb20oMHgwMikucmVwbGFjZUluKC4uLnRzKTtcbiAgICB0cy5nZXRUaWxlKDB4ODgpLmNvcHlGcm9tKDB4MDMpLnJlcGxhY2VJbiguLi50cyk7XG4gICAgdHMuZ2V0VGlsZSgweDg5KS5jb3B5RnJvbSgweDA0KS5yZXBsYWNlSW4oLi4udHMpO1xuICB9XG4gIGZvciAoY29uc3QgdHMgb2YgW3JpdmVyLCBkZXNlcnQsIHNlYV0pIHtcbiAgICB0cy5nZXRUaWxlKDB4MDEpLmNvcHlGcm9tKDB4YzEpLnNldEFsdGVybmF0aXZlKDB4MDApO1xuICAgIHRzLmdldFRpbGUoMHgwMikuY29weUZyb20oMHhjMSkuc2V0QWx0ZXJuYXRpdmUoMHgwMCk7XG4gICAgdHMuZ2V0VGlsZSgweDAzKS5jb3B5RnJvbSgweGQ3KS5zZXRBbHRlcm5hdGl2ZSgweDBhKTtcbiAgICB0cy5nZXRUaWxlKDB4MDQpLmNvcHlGcm9tKDB4ZDcpLnNldEFsdGVybmF0aXZlKDB4MGEpO1xuICB9XG4gIGNvbnN0IGNsb3NlZENhdmVzOiBBcnJheTxbTWV0YXNjcmVlbiwgbnVtYmVyXT4gPSBbXG4gICAgWyQuYm91bmRhcnlFX2NhdmUsIDB4NDhdLCBbJC5ib3VuZGFyeVdfY2F2ZSwgMHg3OV0sXG4gICAgWyQuZXhpdFdfY2F2ZSwgMHgzOF0sIFskLmNhdmVBYm92ZVBvcnRvYSwgMHg1Nl0sXG4gIF07XG4gIC8vIGlmICgkLmlzRml4ZWQoU2NyZWVuRml4LlNlYUNhdmVFbnRyYW5jZXMpKSB7XG4gIC8vICAgLy8gVE9ETyAtIGFkZCAkLmJvdW5kYXJ5Tl9jYXZlIGFuZCBjb3JuZXJTRV9jYXZlIHRvIHRoZSBsaXN0Li4uP1xuICAvLyB9XG4gIGZvciAoY29uc3QgW3NjciwgcG9zXSBvZiBjbG9zZWRDYXZlcykge1xuICAgIHNjci5zY3JlZW4uc2V0MmQocG9zLCBbWzEsIDJdLCBbMywgNF1dKTtcbiAgICBzY3IuYWRkQ3VzdG9tRmxhZyh0cnVlKTtcbiAgfVxuICB7XG4gICAgY29uc3Qge2xvY2F0aW9uczoge0NvcmRlbFBsYWluRWFzdCwgQ29yZGVsUGxhaW5XZXN0LCBXYXRlcmZhbGxWYWxsZXlOb3J0aH0sXG4gICAgICAgICAgIGZsYWdzOiB7T3BlbmVkU2VhbGVkQ2F2ZX19ID0gcm9tO1xuICAgIENvcmRlbFBsYWluRWFzdC5tZXRhLmN1c3RvbUZsYWdzLnNldCgweDMwLCBPcGVuZWRTZWFsZWRDYXZlKTtcbiAgICBDb3JkZWxQbGFpbldlc3QubWV0YS5jdXN0b21GbGFncy5zZXQoMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4gICAgV2F0ZXJmYWxsVmFsbGV5Tm9ydGgubWV0YS5jdXN0b21GbGFncy5zZXQoMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4gICAgY29uc3QgZXhwbG9zaW9uID0gU3Bhd24ub2Yoe3k6IDB4MDYwLCB4OiAweDA2MCwgdHlwZTogNCwgaWQ6IDB4MmN9KTtcbiAgICBjb25zdCBrZXlUcmlnZ2VyID0gU3Bhd24ub2Yoe3k6IDB4MDcwLCB4OiAweDA3MCwgdHlwZTogMiwgaWQ6IDB4YWR9KTtcbiAgICBXYXRlcmZhbGxWYWxsZXlOb3J0aC5zcGF3bnMuc3BsaWNlKDEsIDAsIGV4cGxvc2lvbik7XG4gICAgV2F0ZXJmYWxsVmFsbGV5Tm9ydGguc3Bhd25zLnB1c2goa2V5VHJpZ2dlcik7XG4gIH1cblxuICAvLyBzZWEuZ2V0VGlsZSgweDBhKS5jb3B5RnJvbSgweGEyKS5zZXRUaWxlcyhbLCwweDkxLDB4OTFdKS5zZXRBdHRycygwKTtcbiAgLy8gVGhpcyBkb2VzIG9wZW4gdXAgc2NyZWVuICRjZSAoZGVzZXJ0IGNhdmUgZW50cmFuY2UpIGZvciB1c2UgaW4gdGhlIHNlYSxcbiAgLy8gd2hpY2ggaXMgaW50ZXJlc3RpbmcgYmVjYXVzZSB3aGlybHBvb2xzIGNhbid0IGJlIGZsb3duIHBhc3QgLSB3ZSdkIG5lZWRcbiAgLy8gdG8gYWRkIGZsYWdzIHRvIGNsZWFyIHRoZSB3aGlybHBvb2xzLCBidXQgaXQgd291bGQgYmUgYSBjYXZlIHRoYXQnc1xuICAvLyBibG9ja2VkIG9uIGNhbG1pbmcgdGhlIHNlYS4uLlxuXG4gIC8vIFdlIGNvdWxkIGFkZCBhIG51bWJlciBvZiBzY3JlZW5zIHRvIHRoZSBzZWEgaWYgd2UgY291bGQgbW92ZSA1YS4uNWVcbiAgLy8gKHdoaWNoIGNvbGxpZGVzIHdpdGggbW91bnRhaW4gZ2F0ZXMpLiAgODksOGEsOTAsOTksOWQsZDEsZDIgYXJlIGZyZWVcbiAgLy8gaW4gODAgKGdyYXNzKSwgOTAgKHJpdmVyKSwgYW5kIDljIChkZXNlcnQpLiAgVGhlIG1haW4gcHJvYmxlbSBpcyB0aGF0XG4gIC8vIGF0IGxlYXN0IHRoZSBjYXZlIGVudHJhbmNlcyBkb24ndCBxdWl0ZSB3b3JrIGZvciB0aGVzZSAtIHRoZXkgZW5kIHVwXG4gIC8vIGluIHNoYWxsb3cgd2F0ZXIsIGFyZSBhIGxpdHRsZSB0b28gc2hvcnQsIGFuZCBpdCBzZWVtcyB0byBiZSBpbXBvc3NpYmxlXG4gIC8vIHRvIHBpY2sgYSBwYWxldHRlIHRoYXQgaXMgbGlnaHQgYmx1ZSBvbiBib3R0b20gYW5kIGJsYWNrIG9uIHRvcC5cbiAgLy9cbiAgLy8gT3RoZXIgb3B0aW9ucyBmb3IgdGhlIHNlYSBhcmUgMzQsMzgsM2MuLjNmIHdoaWNoIGFyZSBtYXJzaCB0aWxlcyBpblxuICAvLyByaXZlciAtIHdvdWxkIG9wZW4gdXAgc29tZSBuYXJyb3cgcGFzc2FnZXMgKDMzLCBcblxuXG4gIC8vICByb20ubWV0YXNjcmVlbnM7XG5cbiAgLy8gZm9yIChjb25zdCB4IG9mIE9iamVjdC52YWx1ZXMoVElMRVNFVF9GSVhFUykpIHtcbiAgLy8gICBjb25zdCBpZCA9IHguaWQ7XG4gIC8vICAgY29uc3QgdHMgPSByb20udGlsZXNldHNbaWRdO1xuICAvLyAgIGNvbnN0IHRlID0gdHMuZWZmZWN0cygpO1xuICAvLyAgIGZvciAoY29uc3QgdHN0ciBpbiB4KSB7XG4gIC8vICAgICBjb25zdCB0ID0gTnVtYmVyKHRzdHIpO1xuICAvLyAgICAgaWYgKGlzTmFOKHQpKSBjb250aW51ZTtcbiAgLy8gICAgIGNvbnN0IHk6IG51bWJlcnx7YmFzZTogbnVtYmVyfSA9ICh4IGFzIGFueSlbdF07XG4gIC8vICAgICBjb25zdCBiYXNlID0gdHlwZW9mIHkgPT09ICdudW1iZXInID8geSA6ICh5IGFzIGFueSkuYmFzZTtcbiAgLy8gICAgIGNvbnN0IHJlc3Q6IGFueSA9IHR5cGVvZiB5ID09PSAnbnVtYmVyJyA/IHt9IDogeTtcbiAgLy8gICAgIHRzLmF0dHJzW3RdID0gdHMuYXR0cnNbYmFzZV07XG4gIC8vICAgICB0ZS5lZmZlY3RzW3RdID0gdGUuZWZmZWN0c1tiYXNlXTtcbiAgLy8gICAgIFtyZXN0LnRsLCByZXN0LnRyLCByZXN0LmJsLCByZXN0LmJyXS5mb3JFYWNoKChtLCBpKSA9PiB7XG4gIC8vICAgICAgIHRzLnRpbGVzW2ldW3RdID0gdHMudGlsZXNbaV1bbSAhPSBudWxsID8gbSA6IGJhc2VdO1xuICAvLyAgICAgfSk7XG4gIC8vICAgICBpZiAocmVzdC5tb3ZlKSB7fVxuICAvLyAgICAgLy8gaWYgKHJlc3QudGlsZXMpIHtcbiAgLy8gICAgIC8vICAgcmVzdC50aWxlcy5mb3JFYWNoKChzOiBudW1iZXIsIGk6IG51bWJlcikgPT4gdm9pZCAodHMudGlsZXNbaV1bdF0gPSBzKSk7XG4gIC8vICAgICAvLyB9XG4gIC8vICAgfVxuICAvLyB9XG59XG5cblxuLy8gY29uc3QgVElMRVNFVF9GSVhFUyA9IHtcbi8vICAgZ3Jhc3M6IHtcbi8vICAgICBpZDogMHg4MCxcbi8vICAgICAweDQwOiAweDUxLFxuLy8gICAgIDB4NDE6IDB4NTIsXG4vLyAgICAgMHg0MjogMHg1Myxcbi8vICAgICAweDQzOiAweDU0LFxuLy8gICAgIDB4NDQ6IDB4NTUsXG4vLyAgICAgMHg0NTogMHg1Nixcbi8vICAgICAweDQ2OiAweDU4LFxuLy8gICAgIDB4NDc6IDB4NTksXG4vLyAgIH0sXG4vLyAgIGRlc2VydDoge1xuLy8gICAgIGlkOiAweDljLFxuLy8gICAgIDB4NWE6IHtiYXNlOiAweDk4LCBibDogMHg5NCwgYnI6IDB4OTR9LFxuLy8gICAgIDB4NWI6IHtiYXNlOiAweDgwLCB0bDogMHhmZCwgdHI6IDB4ZmN9LFxuLy8gICAgIDB4NWM6IHtiYXNlOiAweDgwLCBibDogMHhmZiwgYnI6IDB4ZmV9LFxuLy8gICAgIDB4NWQ6IHtiYXNlOiAweDgwLCB0cjogMHhmZiwgYnI6IDB4ZmR9LFxuLy8gICAgIDB4NWU6IHtiYXNlOiAweDgwLCB0bDogMHhmZSwgYmw6IDB4ZmN9LFxuLy8gICAgIDB4NjM6IDB4NzEsXG4vLyAgICAgMHg2ODogMHg3MCxcbi8vICAgICAweDY5OiAweDYwLFxuLy8gICAgIDB4NmE6IDB4NjUsXG4vLyAgICAgMHg2YzogMHg3MCxcbi8vICAgICAweDZlOiAweDc2LFxuLy8gICAgIDB4NmY6IDB4NzgsXG4vLyAgIH0sXG4vLyB9IGFzIGNvbnN0O1xuXG4vLyBjb25zdCBTQ1JFRU5fUkVNQVBTID0gW1xuLy8gICB7dGlsZXNldHM6IFsweDljXSwgc3JjOiAweDViLCBkZXN0OiAweDVmLCBzY3JlZW5zOiBbMHhjZl19LFxuLy8gXTtcbi8vIGNvbnN0IFtdID0gU0NSRUVOX1JFTUFQUztcblxuLy8gVE9ETyAtIGNvcHkgNWYgPC0gNWIgaW4gOWMsIHRoZW4gcmVtYXAgaW4gc2NyZWVuIGNmXG4vLyAgICAgIC0gYmV0dGVyIG5vdGF0aW9uP1xuLy8gQ29uc2lkZXIgZG9pbmcgdGhpcyBwcm9ncmFtbWF0aWNhbGx5LCB0aG91Z2ggd2UnZCB3YW50IHRvIHVzZVxuLy8gdGhlIF9hY3R1YWxfIHNjcmVlbi10aWxlc2V0IHVzYWdlcyByYXRoZXIgdGhhbiBkZWNsYXJlZCBvcHRpb25zXG5cbi8vIGNsYXNzIFgge1xuLy8gICByZWFkb25seSBtOiBNZXRhc2NyZWVucztcbi8vICAgY29uc3RydWN0b3IocjogUm9tKSB7XG4vLyAgICAgdGhpcy5tID0gbmV3IE1ldGFzY3JlZW5zKHIpO1xuLy8gICB9XG4vLyB9XG4iXX0=