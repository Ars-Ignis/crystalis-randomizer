import { Flag, Spawn } from '../rom/locationtables.js';
import { Metalocation } from '../rom/metalocation.js';
export function standardMapEdits(rom, opts) {
    if (opts.eastCave) {
        eastCave(rom, opts.eastCave);
    }
    else if (opts.classicLimeTreeToLeaf) {
        connectLimeTreeToLeaf(rom);
    }
    addTowerExit(rom);
    reversibleSwanGate(rom);
    shrinkMado2(rom);
}
(function (standardMapEdits) {
    function generateOptions(flags, random) {
        const options = {};
        if (flags.addEastCave()) {
            options.eastCave = {};
            const exits = ['cordel', 'lime', 'goa', 'desert'];
            let i = random.nextInt(4);
            [options.eastCave.exit1] = exits.splice(i, 1);
            options.eastCave.exit2 = random.pick(exits);
        }
        else if (flags.connectLimeTreeToLeaf()) {
            options.classicLimeTreeToLeaf = true;
        }
        return options;
    }
    standardMapEdits.generateOptions = generateOptions;
})(standardMapEdits || (standardMapEdits = {}));
function eastCave(rom, opts) {
    const { locations: { EastCave1, EastCave2, EastCave3, SealedCave1, ValleyOfWind }, metascreens: { boundaryE_cave, branchNSE, branchNWE, branchNWSE, branchNWS, branchWSE, caveEmpty, deadEndE, deadEndE_downStair, deadEndE_upStair, deadEndN_stairs, deadEndS, deadEndS_stairs, deadEndW, deadEndW_downStair, exit, hallNE, hallNS, hallNW, hallSE, hallWS, hallWE, hallNS_entrance, hallNS_stairs, hallNS_wall, }, } = rom;
    rom.locations.allocate(rom.locations.EastCave1);
    rom.locations.allocate(rom.locations.EastCave2);
    if (opts.exit2)
        rom.locations.allocate(rom.locations.EastCave3);
    for (const l of [EastCave1, EastCave2, EastCave3]) {
        l.bgm = l.originalBgm = 0x17;
        l.entrances = [];
        l.exits = [];
        l.pits = [];
        l.spawns = [];
        l.flags = [];
        l.width = l.height = 1;
        l.screens = [[0x80]];
        l.tilePalettes = [0x1a, 0x1b, 0x05];
        l.originalTilePalettes = [0x1a, 0x1b, 0x05];
        l.tileset = 0x88;
        l.tileEffects = 0xb5;
        l.tilePatterns = [0x14, 0x02];
        l.spritePatterns = [...SealedCave1.spritePatterns];
        l.spritePalettes = [...SealedCave1.spritePalettes];
    }
    EastCave1.meta = new Metalocation(EastCave1.id, rom.metatilesets.cave, 5, 5);
    EastCave1.meta.set2d(0x00, [
        [deadEndE, hallWS, caveEmpty, hallSE, deadEndW],
        [caveEmpty, hallNS, hallSE, hallNW, caveEmpty],
        [hallSE, branchNWSE, branchNWS, caveEmpty, caveEmpty],
        [hallNS, hallNS_stairs, hallNE, hallWE, hallWS],
        [hallNS_entrance, hallNE, deadEndW, deadEndE_upStair, hallNW],
        [exit, caveEmpty, caveEmpty, caveEmpty, caveEmpty],
    ]);
    EastCave2.meta = new Metalocation(EastCave2.id, rom.metatilesets.cave, 5, 5);
    EastCave2.meta.set2d(0x00, [
        [deadEndE, hallWS, deadEndS, caveEmpty, deadEndS],
        [caveEmpty, hallNS, hallNS, caveEmpty, hallNS],
        [caveEmpty, branchNSE, branchNWE, branchWSE, hallNW],
        [caveEmpty, hallNS_stairs, caveEmpty, hallNE, hallWS],
        [deadEndE, hallNW, caveEmpty, caveEmpty, deadEndN_stairs],
    ]);
    ValleyOfWind.meta.set2d(0x33, [[boundaryE_cave]]);
    rom.tileEffects[0].effects[0xc0] = 0;
    EastCave1.meta.attach(0x43, EastCave2.meta, 0x44);
    EastCave1.meta.attach(0x40, ValleyOfWind.meta, 0x33);
    if (opts.exit1) {
        EastCave1.meta.set2d(0x04, [[deadEndW_downStair]]);
        connectEastCaveExit(EastCave1, 0x04, opts.exit1);
    }
    if (opts.exit2) {
        rom.locations.allocate(EastCave3);
        EastCave3.meta = new Metalocation(EastCave3.id, rom.metatilesets.cave, 3, 1);
        EastCave3.meta.set2d(0x00, [
            [deadEndS_stairs],
            [hallNS_wall],
            [hallNS_entrance],
            [exit],
        ]);
        EastCave3.spawns.push(Spawn.from([0x18, 0x07, 0x23, 0x00]));
        EastCave3.flags.push(Flag.of({ screen: 0x10, flag: rom.flags.alloc(0x200) }));
        EastCave2.meta.set2d(0x40, [[deadEndE_downStair]]);
        EastCave2.meta.attach(0x40, EastCave3.meta, 0x00);
        connectEastCaveExit(EastCave3, 0x20, opts.exit2);
    }
    EastCave1.spawns.push(Spawn.of({ screen: 0x21, tile: 0x87, timed: true, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x88, timed: false, id: 0x2 }), Spawn.of({ screen: 0x13, tile: 0x89, timed: true, id: 0x2 }), Spawn.of({ screen: 0x32, tile: 0x68, timed: false, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x03, tile: 0x88, timed: true, id: 0x2 }));
    EastCave2.spawns.push(Spawn.of({ screen: 0x01, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x11, tile: 0x48, timed: false, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x77, timed: true, id: 0x2 }), Spawn.of({ screen: 0x14, tile: 0x28, timed: false, id: 0x2 }), Spawn.of({ screen: 0x23, tile: 0x85, timed: true, id: 0x2 }), Spawn.of({ screen: 0x31, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x8a, timed: false, id: 0x2 }), Spawn.of({ screen: 0x34, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x82, timed: true, id: 0x2 }), Spawn.of({ y: 0x110, x: 0x478, type: 2, id: 0x31 }), Spawn.of({ y: 0x070, x: 0x108, type: 2, id: 0x70 }));
    rom.npcs.WindmillGuard.data[1] = 0x59;
}
function connectEastCaveExit(loc, scr, exit) {
    const { metascreens: { bendNE, bendSE, boundaryN_trees, boundaryW_cave, cornerNE, cornerNW, cornerSE, cornerSE_cave, cornerSW, overworldEmpty, } } = loc.rom;
    let dest;
    let destScr;
    switch (exit) {
        case 'lime':
            dest = loc.rom.locations.LimeTreeValley;
            destScr = 0x10;
            dest.resizeScreens(0, 1, 0, 0);
            dest.meta.spliceColumns(0, 1, 2, [
                [overworldEmpty, overworldEmpty],
                [cornerNW, boundaryN_trees],
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
                [overworldEmpty, overworldEmpty],
            ]);
            break;
        case 'cordel':
            const mapEdit = [
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
            ];
            dest = loc.rom.locations.CordelPlainEast;
            destScr = 0x55;
            dest.meta.set2d(0x55, mapEdit);
            loc.rom.locations.CordelPlainWest.meta.set2d(0x55, mapEdit);
            break;
        case 'goa':
            dest = loc.rom.locations.GoaValley;
            destScr = 0x11;
            dest.meta.set2d(0x01, [
                [cornerNW, cornerNE],
                [boundaryW_cave, bendNE]
            ]);
            break;
        case 'desert':
            dest = loc.rom.locations.Desert2;
            destScr = 0x53;
            dest.meta.set2d(0x53, [[cornerSE_cave]]);
            break;
    }
    loc.meta.attach(scr, dest.meta, destScr);
}
function connectLimeTreeToLeaf(rom) {
    const { locations: { ValleyOfWind, LimeTreeValley }, metascreens: { exitE, exitW_southwest, overworldEmpty_alt }, } = rom;
    ValleyOfWind.meta.set2d(0x54, [[exitE]]);
    LimeTreeValley.meta.set2d(0x10, [[exitW_southwest],
        [overworldEmpty_alt]]);
    ValleyOfWind.meta.attach(0x54, LimeTreeValley.meta, 0x10);
}
function addTowerExit(rom) {
    const { TowerEntrance, Crypt_Teleporter } = rom.locations;
    Crypt_Teleporter.meta.attach(0x00, TowerEntrance.meta, 0x00, 'teleporter', 'teleporter');
}
function reversibleSwanGate(rom) {
    const { flags: { OpenedSwanGate }, locations: { SwanGate }, npcs: { SoldierGuard }, } = rom;
    SwanGate.spawns.push(Spawn.of({ xt: 0x0a, yt: 0x02, type: 1, id: 0x2d }), Spawn.of({ xt: 0x0b, yt: 0x02, type: 1, id: 0x2d }));
    SoldierGuard.localDialogs.get(SwanGate.id)[0].flags.push(OpenedSwanGate.id);
}
function shrinkMado2(rom) {
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhbmRhcmRtYXBlZGl0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9wYXNzL3N0YW5kYXJkbWFwZWRpdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUVyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFjdEQsTUFBTSxVQUFVLGdCQUFnQixDQUFDLEdBQVEsRUFBRSxJQUFhO0lBQ3RELElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUNqQixRQUFRLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM5QjtTQUFNLElBQUksSUFBSSxDQUFDLHFCQUFxQixFQUFFO1FBQ3JDLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQzVCO0lBQ0QsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xCLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUVuQixDQUFDO0FBRUQsV0FBaUIsZ0JBQWdCO0lBQy9CLFNBQWdCLGVBQWUsQ0FBQyxLQUFjLEVBQUUsTUFBYztRQUM1RCxNQUFNLE9BQU8sR0FBWSxFQUFFLENBQUM7UUFDNUIsSUFBSSxLQUFLLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDdkIsT0FBTyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDdEIsTUFBTSxLQUFLLEdBQW1CLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDbEUsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUs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U0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1RCxTQUFTLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsR0FBRyxDQUFDLEtBQUssQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUMsQ0FBQyxDQUFDLENBQUM7UUFHNUUsU0FBUyxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxrQkFBa0IsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNuRCxTQUFTLENBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsU0FBUyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUNsRCxtQkFBbUIsQ0FBQyxTQUFTLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQztLQUNsRDtJQUdELFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUNuQixLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDM0QsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzNELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLENBQzNELENBQUM7SUFDRixTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDbkIsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzNELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFFMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxFQUVqRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSxDQUFDLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBQyxDQUFDLENBQ2xELENBQUM7SUFDRixHQUFHLENBQUMsSUFBSSxDQUFDLGFBQWEsQ0FBQyxJ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QUMsRUFBRSxDQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxjQUFjLENBQUMsRUFBRSxDQUFDLENBQUM7QUFHL0UsQ0FBQztBQUdELFNBQVMsV0FBVyxDQUFDLEdBQVE7QUFHN0IsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7RmxhZ1NldH0gZnJvbSAnLi4vZmxhZ3NldC5qcyc7XG5pbXBvcnQge1JhbmRvbX0gZnJvbSAnLi4vcmFuZG9tLmpzJztcbmltcG9ydCB7Um9tfSBmcm9tICcuLi9yb20uanMnO1xuaW1wb3J0IHtGbGFnLCBTcGF3bn0gZnJvbSAnLi4vcm9tL2xvY2F0aW9udGFibGVzLmpzJztcbmltcG9ydCB7TG9jYXRpb259IGZyb20gJy4uL3JvbS9sb2NhdGlvbi5qcyc7XG5pbXBvcnQgeyBNZXRhbG9jYXRpb24gfSBmcm9tICcuLi9yb20vbWV0YWxvY2F0aW9uLmpzJztcblxudHlwZSBFYXN0Q2F2ZUV4aXQgPSAnY29yZGVsJyB8ICdsaW1lJyB8ICdnb2EnIHwgJ2Rlc2VydCc7XG5cbmludGVyZmFjZSBFYXN0Q2F2ZU9wdGlvbnMge1xuICBleGl0MT86IEVhc3RDYXZlRXhpdDtcbiAgZXhpdDI/OiBFYXN0Q2F2ZUV4aXQ7XG59XG5cbmludGVyZmFjZSBPcHRpb25zIHtcbiAgZWFzdENhdmU/OiBFYXN0Q2F2ZU9wdGlvbnM7XG4gIGNsYXNzaWNMaW1lVHJlZVRvTGVhZj86IGJvb2xlYW47XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBzdGFuZGFyZE1hcEVkaXRzKHJvbTogUm9tLCBvcHRzOiBPcHRpb25zKSB7XG4gIGlmIChvcHRzLmVhc3RDYXZlKSB7XG4gICAgZWFzdENhdmUocm9tLCBvcHRzLmVhc3RDYXZlKTtcbiAgfSBlbHNlIGlmIChvcHRzLmNsYXNzaWNMaW1lVHJlZVRvTGVhZikge1xuICAgIGNvbm5lY3RMaW1lVHJlZVRvTGVhZihyb20pO1xuICB9XG4gIGFkZFRvd2VyRXhpdChyb20pO1xuICByZXZlcnNpYmxlU3dhbkdhdGUocm9tKTtcbiAgc2hyaW5rTWFkbzIocm9tKTtcbiAgLy8gY2xvc2VDYXZlRW50cmFuY2VzKHJvbSk7IC8vIE5PVEU6IGFmdGVyIG90aGVyIG1hcCBlZGl0c1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIHN0YW5kYXJkTWFwRWRpdHMge1xuICBleHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVPcHRpb25zKGZsYWdzOiBGbGFnU2V0LCByYW5kb206IFJhbmRvbSk6IE9wdGlvbnMge1xuICAgIGNvbnN0IG9wdGlvbnM6IE9wdGlvbnMgPSB7fTtcbiAgICBpZiAoZmxhZ3MuYWRkRWFzdENhdmUoKSkge1xuICAgICAgb3B0aW9ucy5lYXN0Q2F2ZSA9IHt9O1xuICAgICAgY29uc3QgZXhpdHM6IEVhc3RDYXZlRXhpdFtdID0gWydjb3JkZWwnLCAnbGltZScsICdnb2EnLCAnZGVzZXJ0J107XG4gICAgICBsZXQgaSA9IHJhbmRvbS5uZXh0SW50KDQpO1xuICAgICAgW29wdGlvbnMuZWFzdENhdmUuZXhpdDFdID0gZXhpdHMuc3BsaWNlKGksIDEpO1xuICAgICAgb3B0aW9ucy5lYXN0Q2F2ZS5leGl0MiA9IHJhbmRvbS5waWNrKGV4aXRzKTtcbiAgICB9IGVsc2UgaWYgKGZsYWdzLmNvbm5lY3RMaW1lVHJlZVRvTGVhZigpKSB7XG4gICAgICBvcHRpb25zLmNsYXNzaWNMaW1lVHJlZVRvTGVhZiA9IHRydWU7XG4gICAgfVxuICAgIHJldHVybiBvcHRpb25zO1xuICB9XG59XG5cbmZ1bmN0aW9uIGVhc3RDYXZlKHJvbTogUm9tLCBvcHRzOiBFYXN0Q2F2ZU9wdGlvbnMpIHtcbiAgY29uc3Qge1xuICAgIGxvY2F0aW9uczoge0Vhc3RDYXZlMSwgRWFzdENhdmUyLCBFYXN0Q2F2ZTMsIFNlYWxlZENhdmUxLCBWYWxsZXlPZldpbmR9LFxuICAgIG1ldGFzY3JlZW5zOiB7Ym91bmRhcnlFX2NhdmUsXG4gICAgICAgICAgICAgICAgICBicmFuY2hOU0UsIGJyYW5jaE5XRSwgYnJhbmNoTldTRSwgYnJhbmNoTldTLCBicmFuY2hXU0UsXG4gICAgICAgICAgICAgICAgICBjYXZlRW1wdHksXG4gICAgICAgICAgICAgICAgICBkZWFkRW5kRSwgZGVhZEVuZEVfZG93blN0YWlyLCBkZWFkRW5kRV91cFN0YWlyLFxuICAgICAgICAgICAgICAgICAgZGVhZEVuZE5fc3RhaXJzLCBkZWFkRW5kUywgZGVhZEVuZFNfc3RhaXJzLFxuICAgICAgICAgICAgICAgICAgZGVhZEVuZFcsIGRlYWRFbmRXX2Rvd25TdGFpciwgZXhpdCxcbiAgICAgICAgICAgICAgICAgIGhhbGxORSwgaGFsbE5TLCBoYWxsTlcsIGhhbGxTRSwgaGFsbFdTLCBoYWxsV0UsXG4gICAgICAgICAgICAgICAgICBoYWxsTlNfZW50cmFuY2UsIGhhbGxOU19zdGFpcnMsIGhhbGxOU193YWxsLFxuICAgICAgICAgICAgICAgICB9LFxuICAgIC8vZmxhZ3M6IHtBbHdheXNUcnVlfSxcbiAgfSA9IHJvbTtcblxuICByb20ubG9jYXRpb25zLmFsbG9jYXRlKHJvbS5sb2NhdGlvbnMuRWFzdENhdmUxKTtcbiAgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShyb20ubG9jYXRpb25zLkVhc3RDYXZlMik7XG4gIGlmIChvcHRzLmV4aXQyKSByb20ubG9jYXRpb25zLmFsbG9jYXRlKHJvbS5sb2NhdGlvbnMuRWFzdENhdmUzKTtcblxuICBmb3IgKGNvbnN0IGwgb2YgW0Vhc3RDYXZlMSwgRWFzdENhdmUyLCBFYXN0Q2F2ZTNdKSB7XG4gICAgbC5iZ20gPSBsLm9yaWdpbmFsQmdtID0gMHgxNzsgLy8gbXQgc2FicmUgY2F2ZSBtdXNpYz9cbiAgICBsLmVudHJhbmNlcyA9IFtdO1xuICAgIGwuZXhpdHMgPSBbXTtcbiAgICBsLnBpdHMgPSBbXTtcbiAgICBsLnNwYXducyA9IFtdO1xuICAgIGwuZmxhZ3MgPSBbXTtcbiAgICBsLndpZHRoID0gbC5oZWlnaHQgPSAxO1xuICAgIGwuc2NyZWVucyA9IFtbMHg4MF1dO1xuICAgIGwudGlsZVBhbGV0dGVzID0gWzB4MWEsIDB4MWIsIDB4MDVdOyAvLyByb2NrIHdhbGxcbiAgICBsLm9yaWdpbmFsVGlsZVBhbGV0dGVzID0gWzB4MWEsIDB4MWIsIDB4MDVdOyAvLyByb2NrIHdhbGxcbiAgICBsLnRpbGVzZXQgPSAweDg4O1xuICAgIGwudGlsZUVmZmVjdHMgPSAweGI1O1xuICAgIGwudGlsZVBhdHRlcm5zID0gWzB4MTQsIDB4MDJdO1xuICAgIGwuc3ByaXRlUGF0dGVybnMgPSBbLi4uU2VhbGVkQ2F2ZTEuc3ByaXRlUGF0dGVybnNdIGFzIFtudW1iZXIsIG51bWJlcl07XG4gICAgbC5zcHJpdGVQYWxldHRlcyA9IFsuLi5TZWFsZWRDYXZlMS5zcHJpdGVQYWxldHRlc10gYXMgW251bWJlciwgbnVtYmVyXTtcbiAgfVxuXG4gIC8vIE5PVEU6IDB4OWMgY2FuIGJlY29tZSAweDk5IGluIHRvcCBsZWZ0IG9yIDB4OTcgaW4gdG9wIHJpZ2h0IG9yIGJvdHRvbSBtaWRkbGUgZm9yIGEgY2F2ZSBleGl0XG4gIEVhc3RDYXZlMS5tZXRhID0gbmV3IE1ldGFsb2NhdGlvbihFYXN0Q2F2ZTEuaWQsIHJvbS5tZXRhdGlsZXNldHMuY2F2ZSwgNSwgNSk7XG4gIEVhc3RDYXZlMS5tZXRhLnNldDJkKDB4MDAsIFtcbiAgICBbZGVhZEVuZEUsICAgICAgICBoYWxsV1MsICAgICAgICBjYXZlRW1wdHksIGhhbGxTRSwgICAgICAgICAgIGRlYWRFbmRXXSxcbiAgICBbY2F2ZUVtcHR5LCAgICAgICBoYWxsTlMsICAgICAgICBoYWxsU0UsICAgIGhhbGxOVywgICAgICAgICAgIGNhdmVFbXB0eV0sXG4gICAgW2hhbGxTRSwgICAgICAgICAgYnJhbmNoTldTRSwgICAgYnJhbmNoTldTLCBjYXZlRW1wdHksICAgICAgICBjYXZlRW1wdHldLFxuICAgIFtoYWxsTlMsICAgICAgICAgIGhhbGxOU19zdGFpcnMsIGhhbGxORSwgICAgaGFsbFdFLCAgICAgICAgICAgaGFsbFdTXSxcbiAgICBbaGFsbE5TX2VudHJhbmNlLCBoYWxsTkUsICAgICAgICBkZWFkRW5kVywgIGRlYWRFbmRFX3VwU3RhaXIsIGhhbGxOV10sXG4gICAgLy8gQm9yZGVyXG4gICAgW2V4aXQsICAgICAgICAgICAgY2F2ZUVtcHR5LCAgICAgY2F2ZUVtcHR5LCBjYXZlRW1wdHksICAgICAgICBjYXZlRW1wdHldLFxuICBdKTtcblxuICBFYXN0Q2F2ZTIubWV0YSA9IG5ldyBNZXRhbG9jYXRpb24oRWFzdENhdmUyLmlkLCByb20ubWV0YXRpbGVzZXRzLmNhdmUsIDUsIDUpO1xuICBFYXN0Q2F2ZTIubWV0YS5zZXQyZCgweDAwLCBbXG4gICAgW2RlYWRFbmRFLCAgaGFsbFdTLCAgICAgICAgZGVhZEVuZFMsICBjYXZlRW1wdHksIGRlYWRFbmRTXSxcbiAgICBbY2F2ZUVtcHR5LCBoYWxsTlMsICAgICAgICBoYWxsTlMsICAgIGNhdmVFbXB0eSwgaGFsbE5TXSxcbiAgICBbY2F2ZUVtcHR5LCBicmFuY2hOU0UsICAgICBicmFuY2hOV0UsIGJyYW5jaFdTRSwgaGFsbE5XXSxcbiAgICBbY2F2ZUVtcHR5LCBoYWxsTlNfc3RhaXJzLCBjYXZlRW1wdHksIGhhbGxORSwgICAgaGFsbFdTXSxcbiAgICBbZGVhZEVuZEUsICBoYWxsTlcsICAgICAgICBjYXZlRW1wdHksIGNhdmVFbXB0eSwgZGVhZEVuZE5fc3RhaXJzXSxcbiAgXSk7XG5cblxuICAvLyBBZGQgZW50cmFuY2UgdG8gdmFsbGV5IG9mIHdpbmRcbiAgVmFsbGV5T2ZXaW5kLm1ldGEuc2V0MmQoMHgzMywgW1tib3VuZGFyeUVfY2F2ZV1dKTtcbiAgcm9tLnRpbGVFZmZlY3RzWzBdLmVmZmVjdHNbMHhjMF0gPSAwO1xuICAvLyBUT0RPIC0gZG8gdGhpcyBvbmNlIHdlIGZpeCB0aGUgc2VhIHRpbGVzZXRcbiAgLy8gcm9tLnNjcmVlbnNbMHhjMl0udGlsZXNbMHg1YV0gPSAweDBhO1xuICAvLyByb20uc2NyZWVuc1sweGMyXS50aWxlc1sweDViXSA9IDB4MGE7XG5cbiAgLy8gQ29ubmVjdCBtYXBzXG4gIEVhc3RDYXZlMS5tZXRhLmF0dGFjaCgweDQzLCBFYXN0Q2F2ZTIubWV0YSwgMHg0NCk7XG4gIEVhc3RDYXZlMS5tZXRhLmF0dGFjaCgweDQwLCBWYWxsZXlPZldpbmQubWV0YSwgMHgzMyk7XG5cbiAgaWYgKG9wdHMuZXhpdDEpIHtcbiAgICBFYXN0Q2F2ZTEubWV0YS5zZXQyZCgweDA0LCBbW2RlYWRFbmRXX2Rvd25TdGFpcl1dKTsgLy8gZG93biBzdGFpclxuICAgIGNvbm5lY3RFYXN0Q2F2ZUV4aXQoRWFzdENhdmUxLCAweDA0LCBvcHRzLmV4aXQxKTtcbiAgfVxuXG4gIGlmIChvcHRzLmV4aXQyKSB7XG4gICAgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShFYXN0Q2F2ZTMpO1xuICAgIEVhc3RDYXZlMy5tZXRhID0gbmV3IE1ldGFsb2NhdGlvbihFYXN0Q2F2ZTMuaWQsIHJvbS5tZXRhdGlsZXNldHMuY2F2ZSwgMywgMSk7XG4gICAgRWFzdENhdmUzLm1ldGEuc2V0MmQoMHgwMCwgW1xuICAgICAgW2RlYWRFbmRTX3N0YWlyc10sXG4gICAgICBbaGFsbE5TX3dhbGxdLFxuICAgICAgW2hhbGxOU19lbnRyYW5jZV0sXG4gICAgICBbZXhpdF0sIC8vIEJvcmRlclxuICAgIF0pO1xuXG4gICAgLy8gQWRkIGEgcm9jayB3YWxsIChpZD0wKS5cbiAgICBFYXN0Q2F2ZTMuc3Bhd25zLnB1c2goU3Bhd24uZnJvbShbMHgxOCwgMHgwNywgMHgyMywgMHgwMF0pKTtcbiAgICBFYXN0Q2F2ZTMuZmxhZ3MucHVzaChGbGFnLm9mKHtzY3JlZW46IDB4MTAsIGZsYWc6IHJvbS5mbGFncy5hbGxvYygweDIwMCl9KSk7XG5cbiAgICAvLyBNYWtlIHRoZSBjb25uZWN0aW9ucy5cbiAgICBFYXN0Q2F2ZTIubWV0YS5zZXQyZCgweDQwLCBbW2RlYWRFbmRFX2Rvd25TdGFpcl1dKTtcbiAgICBFYXN0Q2F2ZTIubWV0YS5hdHRhY2goMHg0MCwgRWFzdENhdmUzLm1ldGEsIDB4MDApO1xuICAgIGNvbm5lY3RFYXN0Q2F2ZUV4aXQoRWFzdENhdmUzLCAweDIwLCBvcHRzLmV4aXQyKTtcbiAgfVxuXG4gIC8vIEFkZCBtb25zdGVyc1xuICBFYXN0Q2F2ZTEuc3Bhd25zLnB1c2goXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgyMSwgdGlsZTogMHg4NywgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEyLCB0aWxlOiAweDg4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEzLCB0aWxlOiAweDg5LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MzIsIHRpbGU6IDB4NjgsIHRpbWVkOiBmYWxzZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4NDEsIHRpbGU6IDB4ODgsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzMywgdGlsZTogMHg5OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDAzLCB0aWxlOiAweDg4LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICApO1xuICBFYXN0Q2F2ZTIuc3Bhd25zLnB1c2goXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgwMSwgdGlsZTogMHg4OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDExLCB0aWxlOiAweDQ4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDEyLCB0aWxlOiAweDc3LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MTQsIHRpbGU6IDB4MjgsIHRpbWVkOiBmYWxzZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MjMsIHRpbGU6IDB4ODUsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzMSwgdGlsZTogMHg4OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDMzLCB0aWxlOiAweDhhLCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDM0LCB0aWxlOiAweDk4LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4NDEsIHRpbGU6IDB4ODIsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgLy8gY2hlc3Q6IGFsYXJtIGZsdXRlXG4gICAgU3Bhd24ub2Yoe3k6IDB4MTEwLCB4OiAweDQ3OCwgdHlwZTogMiwgaWQ6IDB4MzF9KSxcbiAgICAvLyBjaGVzdDogbWltaWNcbiAgICBTcGF3bi5vZih7eTogMHgwNzAsIHg6IDB4MTA4LCB0eXBlOiAyLCBpZDogMHg3MH0pLFxuICApO1xuICByb20ubnBjcy5XaW5kbWlsbEd1YXJkLmRhdGFbMV0gPSAweDU5OyAvLyBhbGFybSBmbHV0ZSAtPiBtZWRpY2FsIGhlcmJcbn1cblxuZnVuY3Rpb24gY29ubmVjdEVhc3RDYXZlRXhpdChsb2M6IExvY2F0aW9uLCBzY3I6IG51bWJlciwgZXhpdDogRWFzdENhdmVFeGl0KSB7XG4gIGNvbnN0IHttZXRhc2NyZWVuczoge1xuICAgIGJlbmRORSwgYmVuZFNFLFxuICAgIGJvdW5kYXJ5Tl90cmVlcywgYm91bmRhcnlXX2NhdmUsXG4gICAgY29ybmVyTkUsIGNvcm5lck5XLCBjb3JuZXJTRSwgY29ybmVyU0VfY2F2ZSwgY29ybmVyU1csXG4gICAgb3ZlcndvcmxkRW1wdHksXG4gIH19ID0gbG9jLnJvbTtcbiAgbGV0IGRlc3Q6IExvY2F0aW9uO1xuICBsZXQgZGVzdFNjcjogbnVtYmVyO1xuICBzd2l0Y2ggKGV4aXQpIHtcbiAgICBjYXNlICdsaW1lJzpcbiAgICAgIC8vIEFkZCBlbnRyYW5jZSB0byBsaW1lIHRyZWUgdmFsbGV5XG4gICAgICBkZXN0ID0gbG9jLnJvbS5sb2NhdGlvbnMuTGltZVRyZWVWYWxsZXk7XG4gICAgICBkZXN0U2NyID0gMHgxMDtcbiAgICAgIGRlc3QucmVzaXplU2NyZWVucygwLCAxLCAwLCAwKTsgLy8gYWRkIG9uZSBzY3JlZW4gdG8gbGVmdCBlZGdlXG4gICAgICBkZXN0Lm1ldGEuc3BsaWNlQ29sdW1ucygwLCAxLCAyLCBbXG4gICAgICAgIFtvdmVyd29ybGRFbXB0eSwgb3ZlcndvcmxkRW1wdHldLCAvLyB0b3AgYm9yZGVyXG4gICAgICAgIFtjb3JuZXJOVywgICAgICAgYm91bmRhcnlOX3RyZWVzXSxcbiAgICAgICAgW2JvdW5kYXJ5V19jYXZlLCBiZW5kU0VdLFxuICAgICAgICBbY29ybmVyU1csICAgICAgIGNvcm5lclNFXSxcbiAgICAgICAgW292ZXJ3b3JsZEVtcHR5LCBvdmVyd29ybGRFbXB0eV0sIC8vIGJvdHRvbSBib3JkZXJcbiAgICAgIF0pO1xuICAgICAgYnJlYWs7XG5cbiAgICBjYXNlICdjb3JkZWwnOlxuICAgICAgY29uc3QgbWFwRWRpdCA9IFtcbiAgICAgICAgW2JvdW5kYXJ5V19jYXZlLCBiZW5kU0VdLFxuICAgICAgICBbY29ybmVyU1csICAgICAgIGNvcm5lclNFXSxcbiAgICAgIF07XG4gICAgICBkZXN0ID0gbG9jLnJvbS5sb2NhdGlvbnMuQ29yZGVsUGxhaW5FYXN0O1xuICAgICAgZGVzdFNjciA9IDB4NTU7XG4gICAgICBkZXN0Lm1ldGEuc2V0MmQoMHg1NSwgbWFwRWRpdCk7XG4gICAgICAvLyBBbHNvIG5lZWQgdG8gbWlycm9yIHRoZSBtYXAgZWRpdCBvbiB3ZXN0XG4gICAgICBsb2Mucm9tLmxvY2F0aW9ucy5Db3JkZWxQbGFpbldlc3QubWV0YS5zZXQyZCgweDU1LCBtYXBFZGl0KTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZ29hJzpcbiAgICAgIGRlc3QgPSBsb2Mucm9tLmxvY2F0aW9ucy5Hb2FWYWxsZXk7XG4gICAgICBkZXN0U2NyID0gMHgxMTtcbiAgICAgIGRlc3QubWV0YS5zZXQyZCgweDAxLCBbXG4gICAgICAgIFtjb3JuZXJOVywgICAgICAgY29ybmVyTkVdLFxuICAgICAgICBbYm91bmRhcnlXX2NhdmUsIGJlbmRORV1dKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnZGVzZXJ0JzpcbiAgICAgIGRlc3QgPSBsb2Mucm9tLmxvY2F0aW9ucy5EZXNlcnQyO1xuICAgICAgZGVzdFNjciA9IDB4NTM7XG4gICAgICBkZXN0Lm1ldGEuc2V0MmQoMHg1MywgW1tjb3JuZXJTRV9jYXZlXV0pO1xuICAgICAgYnJlYWs7XG4gIH1cbiAgbG9jLm1ldGEuYXR0YWNoKHNjciwgZGVzdC5tZXRhLCBkZXN0U2NyKTtcbn1cblxuLy8gUHJvZ3JhbW1hdGljYWxseSBhZGQgYSBob2xlIGJldHdlZW4gdmFsbGV5IG9mIHdpbmQgYW5kIGxpbWUgdHJlZSB2YWxsZXlcbmZ1bmN0aW9uIGNvbm5lY3RMaW1lVHJlZVRvTGVhZihyb206IFJvbSkge1xuICBjb25zdCB7XG4gICAgbG9jYXRpb25zOiB7VmFsbGV5T2ZXaW5kLCBMaW1lVHJlZVZhbGxleX0sXG4gICAgbWV0YXNjcmVlbnM6IHtleGl0RSwgZXhpdFdfc291dGh3ZXN0LCBvdmVyd29ybGRFbXB0eV9hbHR9LFxuICB9ID0gcm9tO1xuXG4gIFZhbGxleU9mV2luZC5tZXRhLnNldDJkKDB4NTQsIFtbZXhpdEVdXSk7XG4gIExpbWVUcmVlVmFsbGV5Lm1ldGEuc2V0MmQoMHgxMCwgW1tleGl0V19zb3V0aHdlc3RdLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBbb3ZlcndvcmxkRW1wdHlfYWx0XV0pO1xuICBWYWxsZXlPZldpbmQubWV0YS5hdHRhY2goMHg1NCwgTGltZVRyZWVWYWxsZXkubWV0YSwgMHgxMCk7XG59XG5cbmZ1bmN0aW9uIGFkZFRvd2VyRXhpdChyb206IFJvbSkge1xuICBjb25zdCB7VG93ZXJFbnRyYW5jZSwgQ3J5cHRfVGVsZXBvcnRlcn0gPSByb20ubG9jYXRpb25zO1xuICBDcnlwdF9UZWxlcG9ydGVyLm1ldGEuYXR0YWNoKDB4MDAsIFRvd2VyRW50cmFuY2UubWV0YSwgMHgwMCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAndGVsZXBvcnRlcicsICd0ZWxlcG9ydGVyJyk7XG59XG5cbmZ1bmN0aW9uIHJldmVyc2libGVTd2FuR2F0ZShyb206IFJvbSkge1xuICBjb25zdCB7XG4gICAgZmxhZ3M6IHtPcGVuZWRTd2FuR2F0ZX0sXG4gICAgbG9jYXRpb25zOiB7U3dhbkdhdGV9LFxuICAgIG5wY3M6IHtTb2xkaWVyR3VhcmR9LFxuICB9ID0gcm9tO1xuICAvLyBBbGxvdyBvcGVuaW5nIFN3YW4gZnJvbSBlaXRoZXIgc2lkZSBieSBhZGRpbmcgYSBwYWlyIG9mIGd1YXJkcyBvbiB0aGVcbiAgLy8gb3Bwb3NpdGUgc2lkZSBvZiB0aGUgZ2F0ZS5cbiAgU3dhbkdhdGUuc3Bhd25zLnB1c2goXG4gICAgLy8gTk9URTogU29sZGllcnMgbXVzdCBjb21lIGluIHBhaXJzICh3aXRoIGluZGV4IF4xIGZyb20gZWFjaCBvdGhlcilcbiAgICBTcGF3bi5vZih7eHQ6IDB4MGEsIHl0OiAweDAyLCB0eXBlOiAxLCBpZDogMHgyZH0pLCAvLyBuZXcgc29sZGllclxuICAgIFNwYXduLm9mKHt4dDogMHgwYiwgeXQ6IDB4MDIsIHR5cGU6IDEsIGlkOiAweDJkfSksIC8vIG5ldyBzb2xkaWVyXG4gICAgLy9TcGF3bi5vZih7eHQ6IDB4MGUsIHl0OiAweDBhLCB0eXBlOiAyLCBpZDogMHhiM30pLCAvLyBuZXcgdHJpZ2dlcjogZXJhc2UgZ3VhcmRzXG4gICk7XG5cbiAgLy8gLy8gTk9URToganVzdCB1c2UgdGhlIGFjdHVhbCBmbGFnIGluc3RlYWQ/XG4gIC8vIC8vIEd1YXJkcyAoJDJkKSBhdCBzd2FuIGdhdGUgKCQ3MykgfiBzZXQgMGVmIGFmdGVyIG9wZW5pbmcgZ2F0ZSA9PiBjb25kaXRpb24gZm9yIGRlc3Bhd25cbiAgLy8gcm9tLm5wY3NbMHgyZF0ubG9jYWxEaWFsb2dzLmdldCgweDczKSFbMF0uZmxhZ3MucHVzaCgweDBlZik7XG4gIC8vIC8vIERlc3Bhd24gZ3VhcmQgdHJpZ2dlciByZXF1aXJlcyAwZWZcbiAgLy8gcm9tLnRyaWdnZXIoMHhiMykuY29uZGl0aW9ucy5wdXNoKDB4MGVmKTtcbiAgU29sZGllckd1YXJkLmxvY2FsRGlhbG9ncy5nZXQoU3dhbkdhdGUuaWQpIVswXS5mbGFncy5wdXNoKE9wZW5lZFN3YW5HYXRlLmlkKTtcbiAgLy9yb20udHJpZ2dlcigweGIzKS5jb25kaXRpb25zLnB1c2goT3BlbmVkU3dhbkdhdGUuaWQpO1xuICAvLyBUT0RPIC0gY2FuIHdlIGRvIGF3YXkgd2l0aCB0aGUgdHJpZ2dlcj8gIEp1c3Qgc3Bhd24gdGhlbSBvbiB0aGUgc2FtZSBjb25kaXRpb24uLi5cbn1cblxuLyoqIE1hZG8gMidzIGFyZWEgaGFzIGEgNHg0IHNlY3Rpb24gb2YgdW51c2VkIHRpbGVzIGF0IHRoZSB0b3AuICBEZWxldGUgdGhlbS4gKi9cbmZ1bmN0aW9uIHNocmlua01hZG8yKHJvbTogUm9tKSB7XG4gIC8vIFRPRE8gLSBpbXBsZW1lbnQgc3BsaWNlUm93c1xuICAvLyByb20ubG9jYXRpb25zLkdvYUZvcnRyZXNzX01hZG8zLm1ldGEuc3BsaWNlUm93cygwLCA0LCAwLCBbXSk7XG59XG5cbi8vIGZ1bmN0aW9uIGNsb3NlQ2F2ZUVudHJhbmNlcyhyb206IFJvbSk6IHZvaWQge1xuLy8gICAvLyBEZXN0cnVjdHVyZSBvdXQgYSBmZXcgbG9jYXRpb25zIGJ5IG5hbWVcbi8vICAgY29uc3Qge1xuLy8gICAgIGZsYWdzOiB7QWx3YXlzVHJ1ZSwgT3BlbmVkU2VhbGVkQ2F2ZSwgT3BlbmVkUHJpc29ufSxcbi8vICAgICBsb2NhdGlvbnM6IHtcbi8vICAgICAgIENvcmRlbFBsYWluRWFzdCwgQ29yZGVsUGxhaW5XZXN0LCBEZXNlcnQyLFxuLy8gICAgICAgS2lyaXNhTWVhZG93LCBTYWhhcmFPdXRzaWRlQ2F2ZSwgVmFsbGV5T2ZXaW5kLFxuLy8gICAgICAgV2F0ZXJmYWxsVmFsbGV5Tm9ydGgsIFdhdGVyZmFsbFZhbGxleVNvdXRoLFxuLy8gICAgIH0sXG4vLyAgIH0gPSByb207XG5cbi8vICAgLy8gLy8gUHJldmVudCBzb2Z0bG9jayBmcm9tIGV4aXRpbmcgc2VhbGVkIGNhdmUgYmVmb3JlIHdpbmRtaWxsIHN0YXJ0ZWRcbi8vICAgLy8gVmFsbGV5T2ZXaW5kLmVudHJhbmNlc1sxXS55ICs9IDE2OyAvLyB1bm5lZWRlZCBhZnRlciBlbnRyYW5jZSBub3JtYWxpemF0aW9uXG5cbi8vICAgLy8gQ2xlYXIgdGlsZXMgMSwyLDMsNCBmb3IgYmxvY2thYmxlIGNhdmVzIGluIHRpbGVzZXRzIDkwLCA5NCwgYW5kIDljXG5cbi8vICAgLy8gLy8gTk9URTogZmxhZyAyZjAgaXMgQUxXQVlTIHNldCAtIHVzZSBpdCBhcyBhIGJhc2VsaW5lLlxuLy8gICAvLyBjb25zdCBmbGFnc1RvQ2xlYXI6IFtMb2NhdGlvbiwgbnVtYmVyXVtdID0gW1xuLy8gICAvLyAgIFtWYWxsZXlPZldpbmQsIDB4MzBdLCAvLyB2YWxsZXkgb2Ygd2luZCwgemVidSdzIGNhdmVcbi8vICAgLy8gICAvL1tDb3JkZWxQbGFpbldlc3QsIDB4MzBdLCAvLyBjb3JkZWwgd2VzdCwgdmFtcGlyZSBjYXZlXG4vLyAgIC8vICAgLy9bQ29yZGVsUGxhaW5FYXN0LCAweDMwXSwgLy8gY29yZGVsIGVhc3QsIHZhbXBpcmUgY2F2ZVxuLy8gICAvLyAgIC8vW1dhdGVyZmFsbFZhbGxleU5vcnRoLCAweDAwXSwgLy8gd2F0ZXJmYWxsIG5vcnRoLCBwcmlzb24gY2F2ZVxuLy8gICAvLyAgIFtXYXRlcmZhbGxWYWxsZXlOb3J0aCwgMHgxNF0sIC8vIHdhdGVyZmFsbCBub3J0aCwgZm9nIGxhbXBcbi8vICAgLy8gICBbV2F0ZXJmYWxsVmFsbGV5U291dGgsIDB4NzRdLCAvLyB3YXRlcmZhbGwgc291dGgsIGtpcmlzYVxuLy8gICAvLyAgIFtLaXJpc2FNZWFkb3csIDB4MTBdLCAvLyBraXJpc2EgbWVhZG93XG4vLyAgIC8vICAgW1NhaGFyYU91dHNpZGVDYXZlLCAweDAwXSwgLy8gY2F2ZSB0byBkZXNlcnRcbi8vICAgLy8gICBbRGVzZXJ0MiwgMHg0MV0sXG4vLyAgIC8vIF07XG4vLyAgIC8vIGZ1bmN0aW9uIHB1c2hGbGFnKGxvYzogTG9jYXRpb24sIHNjcmVlbjogbnVtYmVyLCBmbGFnOiBmbGFncy5GbGFnKSB7XG4vLyAgIC8vICAgbG9jLmZsYWdzLnB1c2goRmxhZy5vZih7c2NyZWVuLCBmbGFnOiBmbGFnLmlkfSkpO1xuLy8gICAvLyB9XG5cbi8vICAgLy8gZm9yIChjb25zdCBbbG9jLCBzY3JlZW5dIG9mIGZsYWdzVG9DbGVhcikge1xuLy8gICAvLyAgIHB1c2hGbGFnKGxvYywgc2NyZWVuLCBBbHdheXNUcnVlKTtcbi8vICAgLy8gfVxuXG4vLyAgIC8vIE5PVEUgLSB0aGlzIHVzZWQgdG8gYmUgY29uZmlndXJhYmxlLi4uXG5cbi8vICAgLy8gZnVuY3Rpb24gcmVwbGFjZUZsYWcobG9jOiBMb2NhdGlvbiwgeXg6IG51bWJlciwgZmxhZzogbnVtYmVyKTogdm9pZCB7XG4vLyAgIC8vICAgZm9yIChjb25zdCBmIG9mIGxvYy5mbGFncykge1xuLy8gICAvLyAgICAgaWYgKGYueXggPT09IHl4KSB7XG4vLyAgIC8vICAgICAgIGYuZmxhZyA9IGZsYWc7XG4vLyAgIC8vICAgICAgIHJldHVybjtcbi8vICAgLy8gICAgIH1cbi8vICAgLy8gICB9XG4vLyAgIC8vICAgdGhyb3cgbmV3IEVycm9yKGBDb3VsZCBub3QgZmluZCBmbGFnIHRvIHJlcGxhY2UgYXQgJHtsb2N9OiR7eXh9YCk7XG4vLyAgIC8vIH07XG5cbi8vICAgLy8gTk9URTogd2UgY291bGQgYWxzbyBjbG9zZSBpdCBvZmYgdW50aWwgYm9zcyBraWxsZWQuLi4/XG4vLyAgIC8vICAtIGNvbnN0IHZhbXBpcmVGbGFnID0gfnJvbS5ucGNTcGF3bnNbMHhjMF0uY29uZGl0aW9uc1sweDBhXVswXTtcbi8vICAgLy8gIC0+IGtlbGJlc3F1ZSBmb3IgdGhlIG90aGVyIG9uZS5cbi8vICAgcHVzaEZsYWcoQ29yZGVsUGxhaW5XZXN0LCAweDMwLCBPcGVuZWRTZWFsZWRDYXZlKTtcbi8vICAgcHVzaEZsYWcoQ29yZGVsUGxhaW5FYXN0LCAweDMwLCBPcGVuZWRTZWFsZWRDYXZlKTtcbi8vICAgcHVzaEZsYWcoV2F0ZXJmYWxsVmFsbGV5Tm9ydGgsIDB4MDAsIE9wZW5lZFByaXNvbik7XG4vLyAgIGNvbnN0IGV4cGxvc2lvbiA9IFNwYXduLm9mKHt5OiAweDA2MCwgeDogMHgwNjAsIHR5cGU6IDQsIGlkOiAweDJjfSk7XG4vLyAgIGNvbnN0IGtleVRyaWdnZXIgPSBTcGF3bi5vZih7eTogMHgwNzAsIHg6IDB4MDcwLCB0eXBlOiAyLCBpZDogMHhhZH0pO1xuLy8gICBXYXRlcmZhbGxWYWxsZXlOb3J0aC5zcGF3bnMuc3BsaWNlKDEsIDAsIGV4cGxvc2lvbik7XG4vLyAgIFdhdGVyZmFsbFZhbGxleU5vcnRoLnNwYXducy5wdXNoKGtleVRyaWdnZXIpO1xuLy8gfVxuIl19