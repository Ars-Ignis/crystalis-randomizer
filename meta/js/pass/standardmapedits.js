import { Flag, Spawn } from '../rom/locationtables.js';
import { Metalocation } from '../rom/metalocation.js';
export function standardMapEdits(rom, opts) {
    if (opts.eastCave) {
        eastCave(rom, opts.eastCave);
    }
    else if (opts.classicLimeTreeToLeaf) {
        connectLimeTreeToLeaf(rom);
    }
    addTowerExit(rom);
    reversibleSwanGate(rom);
    shrinkMado2(rom);
}
(function (standardMapEdits) {
    function generateOptions(flags, random) {
        const options = {};
        if (flags.addEastCave()) {
            options.eastCave = {};
            const exits = ['cordel', 'lime', 'goa', 'desert'];
            let i = random.nextInt(4);
            [options.eastCave.exit1] = exits.splice(i, 1);
            options.eastCave.exit2 = random.pick(exits);
        }
        else if (flags.connectLimeTreeToLeaf()) {
            options.classicLimeTreeToLeaf = true;
        }
        return options;
    }
    standardMapEdits.generateOptions = generateOptions;
})(standardMapEdits || (standardMapEdits = {}));
function eastCave(rom, opts) {
    const { locations: { EastCave1, EastCave2, EastCave3, Leaf_StudentHouse, SealedCave1, ValleyOfWind, }, metascreens: { boundaryE_cave, branchNSE, branchNWE, branchNWSE, branchNWS, branchWSE, caveEmpty, deadEndE, deadEndE_downStair, deadEndE_upStair, deadEndN_stairs, deadEndS, deadEndS_stairs, deadEndW, deadEndW_downStair, exit, hallNE, hallNS, hallNW, hallSE, hallWS, hallWE, hallNS_entrance, hallNS_stairs, hallNS_wall, }, npcs: { WindmillGuard }, } = rom;
    rom.locations.allocate(EastCave1);
    rom.locations.allocate(EastCave2);
    if (opts.exit2)
        rom.locations.allocate(rom.locations.EastCave3);
    for (const l of [EastCave1, EastCave2, EastCave3]) {
        l.bgm = l.originalBgm = 0x17;
        l.entrances = [];
        l.exits = [];
        l.pits = [];
        l.spawns = [];
        l.flags = [];
        l.width = l.height = 1;
        l.screens = [[0x80]];
        l.tilePalettes = [0x1a, 0x1b, 0x05];
        l.originalTilePalettes = [0x1a, 0x1b, 0x05];
        l.tileset = 0x88;
        l.tileEffects = 0xb5;
        l.tilePatterns = [0x14, 0x02];
        l.spritePatterns = [...SealedCave1.spritePatterns];
        l.spritePalettes = [...SealedCave1.spritePalettes];
    }
    EastCave1.meta = new Metalocation(EastCave1.id, rom.metatilesets.cave, 5, 5);
    EastCave1.meta.set2d(0x00, [
        [deadEndE, hallWS, caveEmpty, hallSE, deadEndW],
        [caveEmpty, hallNS, hallSE, hallNW, caveEmpty],
        [hallSE, branchNWSE, branchNWS, caveEmpty, caveEmpty],
        [hallNS, hallNS_stairs, hallNE, hallWE, hallWS],
        [hallNS_entrance, hallNE, deadEndW, deadEndE_upStair, hallNW],
        [exit, caveEmpty, caveEmpty, caveEmpty, caveEmpty],
    ]);
    EastCave2.meta = new Metalocation(EastCave2.id, rom.metatilesets.cave, 5, 5);
    EastCave2.meta.set2d(0x00, [
        [deadEndE, hallWS, deadEndS, caveEmpty, deadEndS],
        [caveEmpty, hallNS, hallNS, caveEmpty, hallNS],
        [caveEmpty, branchNSE, branchNWE, branchWSE, hallNW],
        [caveEmpty, hallNS_stairs, caveEmpty, hallNE, hallWS],
        [deadEndE, hallNW, caveEmpty, caveEmpty, deadEndN_stairs],
    ]);
    ValleyOfWind.meta.set2d(0x33, [[boundaryE_cave]]);
    rom.tileEffects[0].effects[0xc0] = 0;
    EastCave1.meta.attach(0x43, EastCave2.meta, 0x44);
    EastCave1.meta.attach(0x40, ValleyOfWind.meta, 0x33);
    if (opts.exit1) {
        EastCave1.meta.set2d(0x04, [[deadEndW_downStair]]);
        connectEastCaveExit(EastCave1, 0x04, opts.exit1);
    }
    if (opts.exit2) {
        rom.locations.allocate(EastCave3);
        EastCave3.meta = new Metalocation(EastCave3.id, rom.metatilesets.cave, 3, 1);
        EastCave3.meta.set2d(0x00, [
            [deadEndS_stairs],
            [hallNS_wall],
            [hallNS_entrance],
            [exit],
        ]);
        EastCave3.spawns.push(Spawn.from([0x18, 0x07, 0x23, 0x00]));
        EastCave3.flags.push(Flag.of({ screen: 0x10, flag: rom.flags.alloc(0x200) }));
        EastCave2.meta.set2d(0x40, [[deadEndE_downStair]]);
        EastCave2.meta.attach(0x40, EastCave3.meta, 0x00);
        connectEastCaveExit(EastCave3, 0x20, opts.exit2);
    }
    EastCave1.spawns.push(Spawn.of({ screen: 0x21, tile: 0x87, timed: true, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x88, timed: false, id: 0x2 }), Spawn.of({ screen: 0x13, tile: 0x89, timed: true, id: 0x2 }), Spawn.of({ screen: 0x32, tile: 0x68, timed: false, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x03, tile: 0x88, timed: true, id: 0x2 }));
    EastCave2.spawns.push(Spawn.of({ screen: 0x01, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x11, tile: 0x48, timed: false, id: 0x2 }), Spawn.of({ screen: 0x12, tile: 0x77, timed: true, id: 0x2 }), Spawn.of({ screen: 0x14, tile: 0x28, timed: false, id: 0x2 }), Spawn.of({ screen: 0x23, tile: 0x85, timed: true, id: 0x2 }), Spawn.of({ screen: 0x31, tile: 0x88, timed: true, id: 0x2 }), Spawn.of({ screen: 0x33, tile: 0x8a, timed: false, id: 0x2 }), Spawn.of({ screen: 0x34, tile: 0x98, timed: true, id: 0x2 }), Spawn.of({ screen: 0x41, tile: 0x82, timed: true, id: 0x2 }), Spawn.of({ y: 0x110, x: 0x478, type: 2, id: 0x31 }), Spawn.of({ y: 0x070, x: 0x108, type: 2, id: 0x7c }));
    WindmillGuard.data[1] = 0x59;
    WindmillGuard.dialog(Leaf_StudentHouse)[0].condition = ~0x159;
}
function connectEastCaveExit(loc, scr, exit) {
    const { metascreens: { bendNE, bendSE, boundaryN_trees, boundaryW_cave, cornerNE, cornerNW, cornerSE, cornerSE_cave, cornerSW, overworldEmpty, } } = loc.rom;
    let dest;
    let destScr;
    switch (exit) {
        case 'lime':
            dest = loc.rom.locations.LimeTreeValley;
            destScr = 0x10;
            dest.resizeScreens(0, 1, 0, 0);
            dest.meta.spliceColumns(0, 1, 2, [
                [overworldEmpty, overworldEmpty],
                [cornerNW, boundaryN_trees],
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
                [overworldEmpty, overworldEmpty],
            ]);
            break;
        case 'cordel':
            const mapEdit = [
                [boundaryW_cave, bendSE],
                [cornerSW, cornerSE],
            ];
            dest = loc.rom.locations.CordelPlainEast;
            destScr = 0x55;
            dest.meta.set2d(0x55, mapEdit);
            loc.rom.locations.CordelPlainWest.meta.set2d(0x55, mapEdit);
            break;
        case 'goa':
            dest = loc.rom.locations.GoaValley;
            destScr = 0x11;
            dest.meta.set2d(0x01, [
                [cornerNW, cornerNE],
                [boundaryW_cave, bendNE]
            ]);
            break;
        case 'desert':
            dest = loc.rom.locations.Desert2;
            destScr = 0x53;
            dest.meta.set2d(0x53, [[cornerSE_cave]]);
            break;
    }
    loc.meta.attach(scr, dest.meta, destScr);
}
function connectLimeTreeToLeaf(rom) {
    const { locations: { ValleyOfWind, LimeTreeValley }, metascreens: { exitE, exitW_southwest, overworldEmpty_alt }, } = rom;
    ValleyOfWind.meta.set2d(0x54, [[exitE]]);
    LimeTreeValley.meta.set2d(0x10, [[exitW_southwest],
        [overworldEmpty_alt]]);
    ValleyOfWind.meta.attach(0x54, LimeTreeValley.meta, 0x10);
}
function addTowerExit(rom) {
    const { TowerEntrance, Crypt_Teleporter } = rom.locations;
    Crypt_Teleporter.meta.attach(0x00, TowerEntrance.meta, 0x00, 'teleporter', 'teleporter');
}
function reversibleSwanGate(rom) {
    const { flags: { OpenedSwanGate }, locations: { SwanGate }, npcs: { SoldierGuard }, } = rom;
    SwanGate.spawns.push(Spawn.of({ xt: 0x0a, yt: 0x02, type: 1, id: 0x2d }), Spawn.of({ xt: 0x0b, yt: 0x02, type: 1, id: 0x2d }));
    SoldierGuard.localDialogs.get(SwanGate.id)[0].flags.push(OpenedSwanGate.id);
}
function shrinkMado2(rom) {
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3RhbmRhcmRtYXBlZGl0cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9wYXNzL3N0YW5kYXJkbWFwZWRpdHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFDLElBQUksRUFBRSxLQUFLLEVBQUMsTUFBTSwwQkFBMEIsQ0FBQztBQUVyRCxPQUFPLEVBQUUsWUFBWSxFQUFFLE1BQU0sd0JBQXdCLENBQUM7QUFjdEQsTUFBTSxVQUFVLGdCQUFnQixDQUFDLEdBQVEsRUFBRSxJQUFhO0lBQ3RELElBQUksSUFBSSxDQUFDLFFBQVEsRUFBRTtRQUNqQixRQUFRLENBQUMsR0FBRyxFQUFFLElBQUksQ0FBQyxRQUFRLENBQUMsQ0FBQztLQUM5QjtTQUFNLElBQUksSUFBSSxDQUFDLHFCQUFxQixFQUFFO1FBQ3JDLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0tBQzVCO0lBQ0QsWUFBWSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ2xCLGtCQUFrQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hCLFdBQVcsQ0FBQyxHQUFHLENBQUMsQ0FBQztBQUVuQixDQUFDO0FBRUQsV0FBaUIsZ0JBQWdCO0lBQy9CLFNBQWdCLGVBQWUsQ0FBQyxLQUFjLEVBQUUsTUFBYztRQUM1RCxNQUFNLE9BQU8sR0FBWSxFQUFFLENBQUM7UUFDNUIsSUFBSSxLQUFLLENBQUMsV0FBVyxFQUFFLEVBQUU7WUFDdkIsT0FBTyxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUM7WUFDdEIsTUFBTSxLQUFLLEdBQW1CLENBQUMsUUFBUSxFQUFFLE1BQU0sRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDLENBQUM7WUFDbEUsSUFBSSxDQUFDLEdBQUcsTUFBTSxDQUFDLE9BQU8sQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUMxQixDQUFDLE9BQU8sQ0FBQyxRQUFRLENBQUMsS0FBSyxDQUFDLEdBQUcsS0FBSyxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUs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QUdILFNBQVMsQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUQsU0FBUyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxFQUFDLENBQUMsQ0FBQyxDQUFDO1FBRzVFLFNBQVMsQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsa0JBQWtCLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbkQsU0FBUyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLFNBQVMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDbEQsbUJBQW1CLENBQUMsU0FBUyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7S0FDbEQ7SUFHRCxTQUFTLENBQUMsTUFBTSxDQUFDLElBQUksQ0FDbkIsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxLQUFLLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzNELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxDQUMzRCxDQUFDO0lBQ0YsU0FBUyxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQ25CLEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDMUQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsS0FBSyxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMzRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDM0QsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBQzFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsS0FBSyxFQUFFLEtBQUssRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFDLENBQUMsRUFDM0QsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLE1BQU0sRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLEVBQUUsRUFBRSxHQUFHLEVBQUMsQ0FBQyxFQUMxRCxLQUFLLENBQUMsRUFBRSxDQUFDLEVBQUMsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsRUFBRSxFQUFFLEdBQUcsRUFBQyxDQUFDLEVBRTFELEtBQUssQ0FBQyxFQUFFLENBQUMsRUFBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFDLENBQUMsRUFFakQsS0FBSyxDQUFDLEVBQUUsQ0FBQyxFQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsQ0FBQyxFQUFFLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUNsRCxDQUFDO0lBQ0YsYUFBYSxDQUFDLElBQUksQ0FBQyxDQUFDLENB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QUFJLEVBQUMsQ0FBQyxDQUVsRCxDQUFDO0lBT0YsWUFBWSxDQUFDLFlBQVksQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLEVBQUUsQ0FBRSxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLEVBQUUsQ0FBQyxDQUFDO0FBRy9FLENBQUM7QUFHRCxTQUFTLFdBQVcsQ0FBQyxHQUFRO0FBRzdCLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0ZsYWdTZXR9IGZyb20gJy4uL2ZsYWdzZXQuanMnO1xuaW1wb3J0IHtSYW5kb219IGZyb20gJy4uL3JhbmRvbS5qcyc7XG5pbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7RmxhZywgU3Bhd259IGZyb20gJy4uL3JvbS9sb2NhdGlvbnRhYmxlcy5qcyc7XG5pbXBvcnQge0xvY2F0aW9ufSBmcm9tICcuLi9yb20vbG9jYXRpb24uanMnO1xuaW1wb3J0IHsgTWV0YWxvY2F0aW9uIH0gZnJvbSAnLi4vcm9tL21ldGFsb2NhdGlvbi5qcyc7XG5cbnR5cGUgRWFzdENhdmVFeGl0ID0gJ2NvcmRlbCcgfCAnbGltZScgfCAnZ29hJyB8ICdkZXNlcnQnO1xuXG5pbnRlcmZhY2UgRWFzdENhdmVPcHRpb25zIHtcbiAgZXhpdDE/OiBFYXN0Q2F2ZUV4aXQ7XG4gIGV4aXQyPzogRWFzdENhdmVFeGl0O1xufVxuXG5pbnRlcmZhY2UgT3B0aW9ucyB7XG4gIGVhc3RDYXZlPzogRWFzdENhdmVPcHRpb25zO1xuICBjbGFzc2ljTGltZVRyZWVUb0xlYWY/OiBib29sZWFuO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gc3RhbmRhcmRNYXBFZGl0cyhyb206IFJvbSwgb3B0czogT3B0aW9ucykge1xuICBpZiAob3B0cy5lYXN0Q2F2ZSkge1xuICAgIGVhc3RDYXZlKHJvbSwgb3B0cy5lYXN0Q2F2ZSk7XG4gIH0gZWxzZSBpZiAob3B0cy5jbGFzc2ljTGltZVRyZWVUb0xlYWYpIHtcbiAgICBjb25uZWN0TGltZVRyZWVUb0xlYWYocm9tKTtcbiAgfVxuICBhZGRUb3dlckV4aXQocm9tKTtcbiAgcmV2ZXJzaWJsZVN3YW5HYXRlKHJvbSk7XG4gIHNocmlua01hZG8yKHJvbSk7XG4gIC8vIGNsb3NlQ2F2ZUVudHJhbmNlcyhyb20pOyAvLyBOT1RFOiBhZnRlciBvdGhlciBtYXAgZWRpdHNcbn1cblxuZXhwb3J0IG5hbWVzcGFjZSBzdGFuZGFyZE1hcEVkaXRzIHtcbiAgZXhwb3J0IGZ1bmN0aW9uIGdlbmVyYXRlT3B0aW9ucyhmbGFnczogRmxhZ1NldCwgcmFuZG9tOiBSYW5kb20pOiBPcHRpb25zIHtcbiAgICBjb25zdCBvcHRpb25zOiBPcHRpb25zID0ge307XG4gICAgaWYgKGZsYWdzLmFkZEVhc3RDYXZlKCkpIHtcbiAgICAgIG9wdGlvbnMuZWFzdENhdmUgPSB7fTtcbiAgICAgIGNvbnN0IGV4aXRzOiBFYXN0Q2F2ZUV4aXRbXSA9IFsnY29yZGVsJywgJ2xpbWUnLCAnZ29hJywgJ2Rlc2VydCddO1xuICAgICAgbGV0IGkgPSByYW5kb20ubmV4dEludCg0KTtcbiAgICAgIFtvcHRpb25zLmVhc3RDYXZlLmV4aXQxXSA9IGV4aXRzLnNwbGljZShpLCAxKTtcbiAgICAgIG9wdGlvbnMuZWFzdENhdmUuZXhpdDIgPSByYW5kb20ucGljayhleGl0cyk7XG4gICAgfSBlbHNlIGlmIChmbGFncy5jb25uZWN0TGltZVRyZWVUb0xlYWYoKSkge1xuICAgICAgb3B0aW9ucy5jbGFzc2ljTGltZVRyZWVUb0xlYWYgPSB0cnVlO1xuICAgIH1cbiAgICByZXR1cm4gb3B0aW9ucztcbiAgfVxufVxuXG5mdW5jdGlvbiBlYXN0Q2F2ZShyb206IFJvbSwgb3B0czogRWFzdENhdmVPcHRpb25zKSB7XG4gIGNvbnN0IHtcbiAgICBsb2NhdGlvbnM6IHtFYXN0Q2F2ZTEsIEVhc3RDYXZlMiwgRWFzdENhdmUzLFxuICAgICAgICAgICAgICAgIExlYWZfU3R1ZGVudEhvdXNlLCBTZWFsZWRDYXZlMSwgVmFsbGV5T2ZXaW5kLFxuICAgICAgICAgICAgICAgfSxcbiAgICBtZXRhc2NyZWVuczoge2JvdW5kYXJ5RV9jYXZlLFxuICAgICAgICAgICAgICAgICAgYnJhbmNoTlNFLCBicmFuY2hOV0UsIGJyYW5jaE5XU0UsIGJyYW5jaE5XUywgYnJhbmNoV1NFLFxuICAgICAgICAgICAgICAgICAgY2F2ZUVtcHR5LFxuICAgICAgICAgICAgICAgICAgZGVhZEVuZEUsIGRlYWRFbmRFX2Rvd25TdGFpciwgZGVhZEVuZEVfdXBTdGFpcixcbiAgICAgICAgICAgICAgICAgIGRlYWRFbmROX3N0YWlycywgZGVhZEVuZFMsIGRlYWRFbmRTX3N0YWlycyxcbiAgICAgICAgICAgICAgICAgIGRlYWRFbmRXLCBkZWFkRW5kV19kb3duU3RhaXIsIGV4aXQsXG4gICAgICAgICAgICAgICAgICBoYWxsTkUsIGhhbGxOUywgaGFsbE5XLCBoYWxsU0UsIGhhbGxXUywgaGFsbFdFLFxuICAgICAgICAgICAgICAgICAgaGFsbE5TX2VudHJhbmNlLCBoYWxsTlNfc3RhaXJzLCBoYWxsTlNfd2FsbCxcbiAgICAgICAgICAgICAgICAgfSxcbiAgICBucGNzOiB7V2luZG1pbGxHdWFyZH0sXG4gICAgLy9mbGFnczoge0Fsd2F5c1RydWV9LFxuICB9ID0gcm9tO1xuXG4gIHJvbS5sb2NhdGlvbnMuYWxsb2NhdGUoRWFzdENhdmUxKTtcbiAgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShFYXN0Q2F2ZTIpO1xuICBpZiAob3B0cy5leGl0Mikgcm9tLmxvY2F0aW9ucy5hbGxvY2F0ZShyb20ubG9jYXRpb25zLkVhc3RDYXZlMyk7XG5cbiAgZm9yIChjb25zdCBsIG9mIFtFYXN0Q2F2ZTEsIEVhc3RDYXZlMiwgRWFzdENhdmUzXSkge1xuICAgIGwuYmdtID0gbC5vcmlnaW5hbEJnbSA9IDB4MTc7IC8vIG10IHNhYnJlIGNhdmUgbXVzaWM/XG4gICAgbC5lbnRyYW5jZXMgPSBbXTtcbiAgICBsLmV4aXRzID0gW107XG4gICAgbC5waXRzID0gW107XG4gICAgbC5zcGF3bnMgPSBbXTtcbiAgICBsLmZsYWdzID0gW107XG4gICAgbC53aWR0aCA9IGwuaGVpZ2h0ID0gMTtcbiAgICBsLnNjcmVlbnMgPSBbWzB4ODBdXTtcbiAgICBsLnRpbGVQYWxldHRlcyA9IFsweDFhLCAweDFiLCAweDA1XTsgLy8gcm9jayB3YWxsXG4gICAgbC5vcmlnaW5hbFRpbGVQYWxldHRlcyA9IFsweDFhLCAweDFiLCAweDA1XTsgLy8gcm9jayB3YWxsXG4gICAgbC50aWxlc2V0ID0gMHg4ODtcbiAgICBsLnRpbGVFZmZlY3RzID0gMHhiNTtcbiAgICBsLnRpbGVQYXR0ZXJucyA9IFsweDE0LCAweDAyXTtcbiAgICBsLnNwcml0ZVBhdHRlcm5zID0gWy4uLlNlYWxlZENhdmUxLnNwcml0ZVBhdHRlcm5zXSBhcyBbbnVtYmVyLCBudW1iZXJdO1xuICAgIGwuc3ByaXRlUGFsZXR0ZXMgPSBbLi4uU2VhbGVkQ2F2ZTEuc3ByaXRlUGFsZXR0ZXNdIGFzIFtudW1iZXIsIG51bWJlcl07XG4gIH1cblxuICAvLyBOT1RFOiAweDljIGNhbiBiZWNvbWUgMHg5OSBpbiB0b3AgbGVmdCBvciAweDk3IGluIHRvcCByaWdodCBvciBib3R0b20gbWlkZGxlIGZvciBhIGNhdmUgZXhpdFxuICBFYXN0Q2F2ZTEubWV0YSA9IG5ldyBNZXRhbG9jYXRpb24oRWFzdENhdmUxLmlkLCByb20ubWV0YXRpbGVzZXRzLmNhdmUsIDUsIDUpO1xuICBFYXN0Q2F2ZTEubWV0YS5zZXQyZCgweDAwLCBbXG4gICAgW2RlYWRFbmRFLCAgICAgICAgaGFsbFdTLCAgICAgICAgY2F2ZUVtcHR5LCBoYWxsU0UsICAgICAgICAgICBkZWFkRW5kV10sXG4gICAgW2NhdmVFbXB0eSwgICAgICAgaGFsbE5TLCAgICAgICAgaGFsbFNFLCAgICBoYWxsTlcsICAgICAgICAgICBjYXZlRW1wdHldLFxuICAgIFtoYWxsU0UsICAgICAgICAgIGJyYW5jaE5XU0UsICAgIGJyYW5jaE5XUywgY2F2ZUVtcHR5LCAgICAgICAgY2F2ZUVtcHR5XSxcbiAgICBbaGFsbE5TLCAgICAgICAgICBoYWxsTlNfc3RhaXJzLCBoYWxsTkUsICAgIGhhbGxXRSwgICAgICAgICAgIGhhbGxXU10sXG4gICAgW2hhbGxOU19lbnRyYW5jZSwgaGFsbE5FLCAgICAgICAgZGVhZEVuZFcsICBkZWFkRW5kRV91cFN0YWlyLCBoYWxsTlddLFxuICAgIC8vIEJvcmRlclxuICAgIFtleGl0LCAgICAgICAgICAgIGNhdmVFbXB0eSwgICAgIGNhdmVFbXB0eSwgY2F2ZUVtcHR5LCAgICAgICAgY2F2ZUVtcHR5XSxcbiAgXSk7XG5cbiAgRWFzdENhdmUyLm1ldGEgPSBuZXcgTWV0YWxvY2F0aW9uKEVhc3RDYXZlMi5pZCwgcm9tLm1ldGF0aWxlc2V0cy5jYXZlLCA1LCA1KTtcbiAgRWFzdENhdmUyLm1ldGEuc2V0MmQoMHgwMCwgW1xuICAgIFtkZWFkRW5kRSwgIGhhbGxXUywgICAgICAgIGRlYWRFbmRTLCAgY2F2ZUVtcHR5LCBkZWFkRW5kU10sXG4gICAgW2NhdmVFbXB0eSwgaGFsbE5TLCAgICAgICAgaGFsbE5TLCAgICBjYXZlRW1wdHksIGhhbGxOU10sXG4gICAgW2NhdmVFbXB0eSwgYnJhbmNoTlNFLCAgICAgYnJhbmNoTldFLCBicmFuY2hXU0UsIGhhbGxOV10sXG4gICAgW2NhdmVFbXB0eSwgaGFsbE5TX3N0YWlycywgY2F2ZUVtcHR5LCBoYWxsTkUsICAgIGhhbGxXU10sXG4gICAgW2RlYWRFbmRFLCAgaGFsbE5XLCAgICAgICAgY2F2ZUVtcHR5LCBjYXZlRW1wdHksIGRlYWRFbmROX3N0YWlyc10sXG4gIF0pO1xuXG5cbiAgLy8gQWRkIGVudHJhbmNlIHRvIHZhbGxleSBvZiB3aW5kXG4gIFZhbGxleU9mV2luZC5tZXRhLnNldDJkKDB4MzMsIFtbYm91bmRhcnlFX2NhdmVdXSk7XG4gIHJvbS50aWxlRWZmZWN0c1swXS5lZmZlY3RzWzB4YzBdID0gMDtcbiAgLy8gVE9ETyAtIGRvIHRoaXMgb25jZSB3ZSBmaXggdGhlIHNlYSB0aWxlc2V0XG4gIC8vIHJvbS5zY3JlZW5zWzB4YzJdLnRpbGVzWzB4NWFdID0gMHgwYTtcbiAgLy8gcm9tLnNjcmVlbnNbMHhjMl0udGlsZXNbMHg1Yl0gPSAweDBhO1xuXG4gIC8vIENvbm5lY3QgbWFwc1xuICBFYXN0Q2F2ZTEubWV0YS5hdHRhY2goMHg0MywgRWFzdENhdmUyLm1ldGEsIDB4NDQpO1xuICBFYXN0Q2F2ZTEubWV0YS5hdHRhY2goMHg0MCwgVmFsbGV5T2ZXaW5kLm1ldGEsIDB4MzMpO1xuXG4gIGlmIChvcHRzLmV4aXQxKSB7XG4gICAgRWFzdENhdmUxLm1ldGEuc2V0MmQoMHgwNCwgW1tkZWFkRW5kV19kb3duU3RhaXJdXSk7IC8vIGRvd24gc3RhaXJcbiAgICBjb25uZWN0RWFzdENhdmVFeGl0KEVhc3RDYXZlMSwgMHgwNCwgb3B0cy5leGl0MSk7XG4gIH1cblxuICBpZiAob3B0cy5leGl0Mikge1xuICAgIHJvbS5sb2NhdGlvbnMuYWxsb2NhdGUoRWFzdENhdmUzKTtcbiAgICBFYXN0Q2F2ZTMubWV0YSA9IG5ldyBNZXRhbG9jYXRpb24oRWFzdENhdmUzLmlkLCByb20ubWV0YXRpbGVzZXRzLmNhdmUsIDMsIDEpO1xuICAgIEVhc3RDYXZlMy5tZXRhLnNldDJkKDB4MDAsIFtcbiAgICAgIFtkZWFkRW5kU19zdGFpcnNdLFxuICAgICAgW2hhbGxOU193YWxsXSxcbiAgICAgIFtoYWxsTlNfZW50cmFuY2VdLFxuICAgICAgW2V4aXRdLCAvLyBCb3JkZXJcbiAgICBdKTtcblxuICAgIC8vIEFkZCBhIHJvY2sgd2FsbCAoaWQ9MCkuXG4gICAgRWFzdENhdmUzLnNwYXducy5wdXNoKFNwYXduLmZyb20oWzB4MTgsIDB4MDcsIDB4MjMsIDB4MDBdKSk7XG4gICAgRWFzdENhdmUzLmZsYWdzLnB1c2goRmxhZy5vZih7c2NyZWVuOiAweDEwLCBmbGFnOiByb20uZmxhZ3MuYWxsb2MoMHgyMDApfSkpO1xuXG4gICAgLy8gTWFrZSB0aGUgY29ubmVjdGlvbnMuXG4gICAgRWFzdENhdmUyLm1ldGEuc2V0MmQoMHg0MCwgW1tkZWFkRW5kRV9kb3duU3RhaXJdXSk7XG4gICAgRWFzdENhdmUyLm1ldGEuYXR0YWNoKDB4NDAsIEVhc3RDYXZlMy5tZXRhLCAweDAwKTtcbiAgICBjb25uZWN0RWFzdENhdmVFeGl0KEVhc3RDYXZlMywgMHgyMCwgb3B0cy5leGl0Mik7XG4gIH1cblxuICAvLyBBZGQgbW9uc3RlcnNcbiAgRWFzdENhdmUxLnNwYXducy5wdXNoKFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MjEsIHRpbGU6IDB4ODcsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgxMiwgdGlsZTogMHg4OCwgdGltZWQ6IGZhbHNlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgxMywgdGlsZTogMHg4OSwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDMyLCB0aWxlOiAweDY4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDQxLCB0aWxlOiAweDg4LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MzMsIHRpbGU6IDB4OTgsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgwMywgdGlsZTogMHg4OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgKTtcbiAgRWFzdENhdmUyLnNwYXducy5wdXNoKFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MDEsIHRpbGU6IDB4ODgsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgxMSwgdGlsZTogMHg0OCwgdGltZWQ6IGZhbHNlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgxMiwgdGlsZTogMHg3NywgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDE0LCB0aWxlOiAweDI4LCB0aW1lZDogZmFsc2UsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDIzLCB0aWxlOiAweDg1LCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIFNwYXduLm9mKHtzY3JlZW46IDB4MzEsIHRpbGU6IDB4ODgsIHRpbWVkOiB0cnVlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzMywgdGlsZTogMHg4YSwgdGltZWQ6IGZhbHNlLCBpZDogMHgyfSksXG4gICAgU3Bhd24ub2Yoe3NjcmVlbjogMHgzNCwgdGlsZTogMHg5OCwgdGltZWQ6IHRydWUsIGlkOiAweDJ9KSxcbiAgICBTcGF3bi5vZih7c2NyZWVuOiAweDQxLCB0aWxlOiAweDgyLCB0aW1lZDogdHJ1ZSwgaWQ6IDB4Mn0pLFxuICAgIC8vIGNoZXN0OiBhbGFybSBmbHV0ZVxuICAgIFNwYXduLm9mKHt5OiAweDExMCwgeDogMHg0NzgsIHR5cGU6IDIsIGlkOiAweDMxfSksXG4gICAgLy8gY2hlc3Q6IG1pbWljXG4gICAgU3Bhd24ub2Yoe3k6IDB4MDcwLCB4OiAweDEwOCwgdHlwZTogMiwgaWQ6IDB4N2N9KSxcbiAgKTtcbiAgV2luZG1pbGxHdWFyZC5kYXRhWzFdID0gMHg1OTsgLy8gYWxhcm0gZmx1dGUgLT4gbWVkaWNhbCBoZXJiXG4gIFdpbmRtaWxsR3VhcmQuZGlhbG9nKExlYWZfU3R1ZGVudEhvdXNlKVswXS5jb25kaXRpb24gPSB+MHgxNTk7XG59XG5cbmZ1bmN0aW9uIGNvbm5lY3RFYXN0Q2F2ZUV4aXQobG9jOiBMb2NhdGlvbiwgc2NyOiBudW1iZXIsIGV4aXQ6IEVhc3RDYXZlRXhpdCkge1xuICBjb25zdCB7bWV0YXNjcmVlbnM6IHtcbiAgICBiZW5kTkUsIGJlbmRTRSxcbiAgICBib3VuZGFyeU5fdHJlZXMsIGJvdW5kYXJ5V19jYXZlLFxuICAgIGNvcm5lck5FLCBjb3JuZXJOVywgY29ybmVyU0UsIGNvcm5lclNFX2NhdmUsIGNvcm5lclNXLFxuICAgIG92ZXJ3b3JsZEVtcHR5LFxuICB9fSA9IGxvYy5yb207XG4gIGxldCBkZXN0OiBMb2NhdGlvbjtcbiAgbGV0IGRlc3RTY3I6IG51bWJlcjtcbiAgc3dpdGNoIChleGl0KSB7XG4gICAgY2FzZSAnbGltZSc6XG4gICAgICAvLyBBZGQgZW50cmFuY2UgdG8gbGltZSB0cmVlIHZhbGxleVxuICAgICAgZGVzdCA9IGxvYy5yb20ubG9jYXRpb25zLkxpbWVUcmVlVmFsbGV5O1xuICAgICAgZGVzdFNjciA9IDB4MTA7XG4gICAgICBkZXN0LnJlc2l6ZVNjcmVlbnMoMCwgMSwgMCwgMCk7IC8vIGFkZCBvbmUgc2NyZWVuIHRvIGxlZnQgZWRnZVxuICAgICAgZGVzdC5tZXRhLnNwbGljZUNvbHVtbnMoMCwgMSwgMiwgW1xuICAgICAgICBbb3ZlcndvcmxkRW1wdHksIG92ZXJ3b3JsZEVtcHR5XSwgLy8gdG9wIGJvcmRlclxuICAgICAgICBbY29ybmVyTlcsICAgICAgIGJvdW5kYXJ5Tl90cmVlc10sXG4gICAgICAgIFtib3VuZGFyeVdfY2F2ZSwgYmVuZFNFXSxcbiAgICAgICAgW2Nvcm5lclNXLCAgICAgICBjb3JuZXJTRV0sXG4gICAgICAgIFtvdmVyd29ybGRFbXB0eSwgb3ZlcndvcmxkRW1wdHldLCAvLyBib3R0b20gYm9yZGVyXG4gICAgICBdKTtcbiAgICAgIGJyZWFrO1xuXG4gICAgY2FzZSAnY29yZGVsJzpcbiAgICAgIGNvbnN0IG1hcEVkaXQgPSBbXG4gICAgICAgIFtib3VuZGFyeVdfY2F2ZSwgYmVuZFNFXSxcbiAgICAgICAgW2Nvcm5lclNXLCAgICAgICBjb3JuZXJTRV0sXG4gICAgICBdO1xuICAgICAgZGVzdCA9IGxvYy5yb20ubG9jYXRpb25zLkNvcmRlbFBsYWluRWFzdDtcbiAgICAgIGRlc3RTY3IgPSAweDU1O1xuICAgICAgZGVzdC5tZXRhLnNldDJkKDB4NTUsIG1hcEVkaXQpO1xuICAgICAgLy8gQWxzbyBuZWVkIHRvIG1pcnJvciB0aGUgbWFwIGVkaXQgb24gd2VzdFxuICAgICAgbG9jLnJvbS5sb2NhdGlvbnMuQ29yZGVsUGxhaW5XZXN0Lm1ldGEuc2V0MmQoMHg1NSwgbWFwRWRpdCk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2dvYSc6XG4gICAgICBkZXN0ID0gbG9jLnJvbS5sb2NhdGlvbnMuR29hVmFsbGV5O1xuICAgICAgZGVzdFNjciA9IDB4MTE7XG4gICAgICBkZXN0Lm1ldGEuc2V0MmQoMHgwMSwgW1xuICAgICAgICBbY29ybmVyTlcsICAgICAgIGNvcm5lck5FXSxcbiAgICAgICAgW2JvdW5kYXJ5V19jYXZlLCBiZW5kTkVdXSk7XG4gICAgICBicmVhaztcblxuICAgIGNhc2UgJ2Rlc2VydCc6XG4gICAgICBkZXN0ID0gbG9jLnJvbS5sb2NhdGlvbnMuRGVzZXJ0MjtcbiAgICAgIGRlc3RTY3IgPSAweDUzO1xuICAgICAgZGVzdC5tZXRhLnNldDJkKDB4NTMsIFtbY29ybmVyU0VfY2F2ZV1dKTtcbiAgICAgIGJyZWFrO1xuICB9XG4gIGxvYy5tZXRhLmF0dGFjaChzY3IsIGRlc3QubWV0YSwgZGVzdFNjcik7XG59XG5cbi8vIFByb2dyYW1tYXRpY2FsbHkgYWRkIGEgaG9sZSBiZXR3ZWVuIHZhbGxleSBvZiB3aW5kIGFuZCBsaW1lIHRyZWUgdmFsbGV5XG5mdW5jdGlvbiBjb25uZWN0TGltZVRyZWVUb0xlYWYocm9tOiBSb20pIHtcbiAgY29uc3Qge1xuICAgIGxvY2F0aW9uczoge1ZhbGxleU9mV2luZCwgTGltZVRyZWVWYWxsZXl9LFxuICAgIG1ldGFzY3JlZW5zOiB7ZXhpdEUsIGV4aXRXX3NvdXRod2VzdCwgb3ZlcndvcmxkRW1wdHlfYWx0fSxcbiAgfSA9IHJvbTtcblxuICBWYWxsZXlPZldpbmQubWV0YS5zZXQyZCgweDU0LCBbW2V4aXRFXV0pO1xuICBMaW1lVHJlZVZhbGxleS5tZXRhLnNldDJkKDB4MTAsIFtbZXhpdFdfc291dGh3ZXN0XSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgW292ZXJ3b3JsZEVtcHR5X2FsdF1dKTtcbiAgVmFsbGV5T2ZXaW5kLm1ldGEuYXR0YWNoKDB4NTQsIExpbWVUcmVlVmFsbGV5Lm1ldGEsIDB4MTApO1xufVxuXG5mdW5jdGlvbiBhZGRUb3dlckV4aXQocm9tOiBSb20pIHtcbiAgY29uc3Qge1Rvd2VyRW50cmFuY2UsIENyeXB0X1RlbGVwb3J0ZXJ9ID0gcm9tLmxvY2F0aW9ucztcbiAgQ3J5cHRfVGVsZXBvcnRlci5tZXRhLmF0dGFjaCgweDAwLCBUb3dlckVudHJhbmNlLm1ldGEsIDB4MDAsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ3RlbGVwb3J0ZXInLCAndGVsZXBvcnRlcicpO1xufVxuXG5mdW5jdGlvbiByZXZlcnNpYmxlU3dhbkdhdGUocm9tOiBSb20pIHtcbiAgY29uc3Qge1xuICAgIGZsYWdzOiB7T3BlbmVkU3dhbkdhdGV9LFxuICAgIGxvY2F0aW9uczoge1N3YW5HYXRlfSxcbiAgICBucGNzOiB7U29sZGllckd1YXJkfSxcbiAgfSA9IHJvbTtcbiAgLy8gQWxsb3cgb3BlbmluZyBTd2FuIGZyb20gZWl0aGVyIHNpZGUgYnkgYWRkaW5nIGEgcGFpciBvZiBndWFyZHMgb24gdGhlXG4gIC8vIG9wcG9zaXRlIHNpZGUgb2YgdGhlIGdhdGUuXG4gIFN3YW5HYXRlLnNwYXducy5wdXNoKFxuICAgIC8vIE5PVEU6IFNvbGRpZXJzIG11c3QgY29tZSBpbiBwYWlycyAod2l0aCBpbmRleCBeMSBmcm9tIGVhY2ggb3RoZXIpXG4gICAgU3Bhd24ub2Yoe3h0OiAweDBhLCB5dDogMHgwMiwgdHlwZTogMSwgaWQ6IDB4MmR9KSwgLy8gbmV3IHNvbGRpZXJcbiAgICBTcGF3bi5vZih7eHQ6IDB4MGIsIHl0OiAweDAyLCB0eXBlOiAxLCBpZDogMHgyZH0pLCAvLyBuZXcgc29sZGllclxuICAgIC8vU3Bhd24ub2Yoe3h0OiAweDBlLCB5dDogMHgwYSwgdHlwZTogMiwgaWQ6IDB4YjN9KSwgLy8gbmV3IHRyaWdnZXI6IGVyYXNlIGd1YXJkc1xuICApO1xuXG4gIC8vIC8vIE5PVEU6IGp1c3QgdXNlIHRoZSBhY3R1YWwgZmxhZyBpbnN0ZWFkP1xuICAvLyAvLyBHdWFyZHMgKCQyZCkgYXQgc3dhbiBnYXRlICgkNzMpIH4gc2V0IDBlZiBhZnRlciBvcGVuaW5nIGdhdGUgPT4gY29uZGl0aW9uIGZvciBkZXNwYXduXG4gIC8vIHJvbS5ucGNzWzB4MmRdLmxvY2FsRGlhbG9ncy5nZXQoMHg3MykhWzBdLmZsYWdzLnB1c2goMHgwZWYpO1xuICAvLyAvLyBEZXNwYXduIGd1YXJkIHRyaWdnZXIgcmVxdWlyZXMgMGVmXG4gIC8vIHJvbS50cmlnZ2VyKDB4YjMpLmNvbmRpdGlvbnMucHVzaCgweDBlZik7XG4gIFNvbGRpZXJHdWFyZC5sb2NhbERpYWxvZ3MuZ2V0KFN3YW5HYXRlLmlkKSFbMF0uZmxhZ3MucHVzaChPcGVuZWRTd2FuR2F0ZS5pZCk7XG4gIC8vcm9tLnRyaWdnZXIoMHhiMykuY29uZGl0aW9ucy5wdXNoKE9wZW5lZFN3YW5HYXRlLmlkKTtcbiAgLy8gVE9ETyAtIGNhbiB3ZSBkbyBhd2F5IHdpdGggdGhlIHRyaWdnZXI/ICBKdXN0IHNwYXduIHRoZW0gb24gdGhlIHNhbWUgY29uZGl0aW9uLi4uXG59XG5cbi8qKiBNYWRvIDIncyBhcmVhIGhhcyBhIDR4NCBzZWN0aW9uIG9mIHVudXNlZCB0aWxlcyBhdCB0aGUgdG9wLiAgRGVsZXRlIHRoZW0uICovXG5mdW5jdGlvbiBzaHJpbmtNYWRvMihyb206IFJvbSkge1xuICAvLyBUT0RPIC0gaW1wbGVtZW50IHNwbGljZVJvd3NcbiAgLy8gcm9tLmxvY2F0aW9ucy5Hb2FGb3J0cmVzc19NYWRvMy5tZXRhLnNwbGljZVJvd3MoMCwgNCwgMCwgW10pO1xufVxuXG4vLyBmdW5jdGlvbiBjbG9zZUNhdmVFbnRyYW5jZXMocm9tOiBSb20pOiB2b2lkIHtcbi8vICAgLy8gRGVzdHJ1Y3R1cmUgb3V0IGEgZmV3IGxvY2F0aW9ucyBieSBuYW1lXG4vLyAgIGNvbnN0IHtcbi8vICAgICBmbGFnczoge0Fsd2F5c1RydWUsIE9wZW5lZFNlYWxlZENhdmUsIE9wZW5lZFByaXNvbn0sXG4vLyAgICAgbG9jYXRpb25zOiB7XG4vLyAgICAgICBDb3JkZWxQbGFpbkVhc3QsIENvcmRlbFBsYWluV2VzdCwgRGVzZXJ0Mixcbi8vICAgICAgIEtpcmlzYU1lYWRvdywgU2FoYXJhT3V0c2lkZUNhdmUsIFZhbGxleU9mV2luZCxcbi8vICAgICAgIFdhdGVyZmFsbFZhbGxleU5vcnRoLCBXYXRlcmZhbGxWYWxsZXlTb3V0aCxcbi8vICAgICB9LFxuLy8gICB9ID0gcm9tO1xuXG4vLyAgIC8vIC8vIFByZXZlbnQgc29mdGxvY2sgZnJvbSBleGl0aW5nIHNlYWxlZCBjYXZlIGJlZm9yZSB3aW5kbWlsbCBzdGFydGVkXG4vLyAgIC8vIFZhbGxleU9mV2luZC5lbnRyYW5jZXNbMV0ueSArPSAxNjsgLy8gdW5uZWVkZWQgYWZ0ZXIgZW50cmFuY2Ugbm9ybWFsaXphdGlvblxuXG4vLyAgIC8vIENsZWFyIHRpbGVzIDEsMiwzLDQgZm9yIGJsb2NrYWJsZSBjYXZlcyBpbiB0aWxlc2V0cyA5MCwgOTQsIGFuZCA5Y1xuXG4vLyAgIC8vIC8vIE5PVEU6IGZsYWcgMmYwIGlzIEFMV0FZUyBzZXQgLSB1c2UgaXQgYXMgYSBiYXNlbGluZS5cbi8vICAgLy8gY29uc3QgZmxhZ3NUb0NsZWFyOiBbTG9jYXRpb24sIG51bWJlcl1bXSA9IFtcbi8vICAgLy8gICBbVmFsbGV5T2ZXaW5kLCAweDMwXSwgLy8gdmFsbGV5IG9mIHdpbmQsIHplYnUncyBjYXZlXG4vLyAgIC8vICAgLy9bQ29yZGVsUGxhaW5XZXN0LCAweDMwXSwgLy8gY29yZGVsIHdlc3QsIHZhbXBpcmUgY2F2ZVxuLy8gICAvLyAgIC8vW0NvcmRlbFBsYWluRWFzdCwgMHgzMF0sIC8vIGNvcmRlbCBlYXN0LCB2YW1waXJlIGNhdmVcbi8vICAgLy8gICAvL1tXYXRlcmZhbGxWYWxsZXlOb3J0aCwgMHgwMF0sIC8vIHdhdGVyZmFsbCBub3J0aCwgcHJpc29uIGNhdmVcbi8vICAgLy8gICBbV2F0ZXJmYWxsVmFsbGV5Tm9ydGgsIDB4MTRdLCAvLyB3YXRlcmZhbGwgbm9ydGgsIGZvZyBsYW1wXG4vLyAgIC8vICAgW1dhdGVyZmFsbFZhbGxleVNvdXRoLCAweDc0XSwgLy8gd2F0ZXJmYWxsIHNvdXRoLCBraXJpc2Fcbi8vICAgLy8gICBbS2lyaXNhTWVhZG93LCAweDEwXSwgLy8ga2lyaXNhIG1lYWRvd1xuLy8gICAvLyAgIFtTYWhhcmFPdXRzaWRlQ2F2ZSwgMHgwMF0sIC8vIGNhdmUgdG8gZGVzZXJ0XG4vLyAgIC8vICAgW0Rlc2VydDIsIDB4NDFdLFxuLy8gICAvLyBdO1xuLy8gICAvLyBmdW5jdGlvbiBwdXNoRmxhZyhsb2M6IExvY2F0aW9uLCBzY3JlZW46IG51bWJlciwgZmxhZzogZmxhZ3MuRmxhZykge1xuLy8gICAvLyAgIGxvYy5mbGFncy5wdXNoKEZsYWcub2Yoe3NjcmVlbiwgZmxhZzogZmxhZy5pZH0pKTtcbi8vICAgLy8gfVxuXG4vLyAgIC8vIGZvciAoY29uc3QgW2xvYywgc2NyZWVuXSBvZiBmbGFnc1RvQ2xlYXIpIHtcbi8vICAgLy8gICBwdXNoRmxhZyhsb2MsIHNjcmVlbiwgQWx3YXlzVHJ1ZSk7XG4vLyAgIC8vIH1cblxuLy8gICAvLyBOT1RFIC0gdGhpcyB1c2VkIHRvIGJlIGNvbmZpZ3VyYWJsZS4uLlxuXG4vLyAgIC8vIGZ1bmN0aW9uIHJlcGxhY2VGbGFnKGxvYzogTG9jYXRpb24sIHl4OiBudW1iZXIsIGZsYWc6IG51bWJlcik6IHZvaWQge1xuLy8gICAvLyAgIGZvciAoY29uc3QgZiBvZiBsb2MuZmxhZ3MpIHtcbi8vICAgLy8gICAgIGlmIChmLnl4ID09PSB5eCkge1xuLy8gICAvLyAgICAgICBmLmZsYWcgPSBmbGFnO1xuLy8gICAvLyAgICAgICByZXR1cm47XG4vLyAgIC8vICAgICB9XG4vLyAgIC8vICAgfVxuLy8gICAvLyAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IGZpbmQgZmxhZyB0byByZXBsYWNlIGF0ICR7bG9jfToke3l4fWApO1xuLy8gICAvLyB9O1xuXG4vLyAgIC8vIE5PVEU6IHdlIGNvdWxkIGFsc28gY2xvc2UgaXQgb2ZmIHVudGlsIGJvc3Mga2lsbGVkLi4uP1xuLy8gICAvLyAgLSBjb25zdCB2YW1waXJlRmxhZyA9IH5yb20ubnBjU3Bhd25zWzB4YzBdLmNvbmRpdGlvbnNbMHgwYV1bMF07XG4vLyAgIC8vICAtPiBrZWxiZXNxdWUgZm9yIHRoZSBvdGhlciBvbmUuXG4vLyAgIHB1c2hGbGFnKENvcmRlbFBsYWluV2VzdCwgMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4vLyAgIHB1c2hGbGFnKENvcmRlbFBsYWluRWFzdCwgMHgzMCwgT3BlbmVkU2VhbGVkQ2F2ZSk7XG4vLyAgIHB1c2hGbGFnKFdhdGVyZmFsbFZhbGxleU5vcnRoLCAweDAwLCBPcGVuZWRQcmlzb24pO1xuLy8gICBjb25zdCBleHBsb3Npb24gPSBTcGF3bi5vZih7eTogMHgwNjAsIHg6IDB4MDYwLCB0eXBlOiA0LCBpZDogMHgyY30pO1xuLy8gICBjb25zdCBrZXlUcmlnZ2VyID0gU3Bhd24ub2Yoe3k6IDB4MDcwLCB4OiAweDA3MCwgdHlwZTogMiwgaWQ6IDB4YWR9KTtcbi8vICAgV2F0ZXJmYWxsVmFsbGV5Tm9ydGguc3Bhd25zLnNwbGljZSgxLCAwLCBleHBsb3Npb24pO1xuLy8gICBXYXRlcmZhbGxWYWxsZXlOb3J0aC5zcGF3bnMucHVzaChrZXlUcmlnZ2VyKTtcbi8vIH1cbiJdfQ==