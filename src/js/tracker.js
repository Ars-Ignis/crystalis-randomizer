import { World } from './graph/world.js';
import { Bits } from './bits.js';
import { FlagSet } from './flagset.js';
import { Location, Slot, TrackerNode } from './nodes.js';
import { Rom } from './rom.js';
const BOXES = `
sword-of-wind $00
sword-of-fire $01
sword-of-water $02
sword-of-thunder $03
windmill-key $32
statue-of-onyx $25
insect-flute $27
key-to-prison $33
flute-of-lime $28

ball-of-wind $05 
ball-of-fire $07
ball-of-water $09
ball-of-thunder $0b
kirisa-plant $3c
alarm-flute $31
fog-lamp $35
shell-flute $36
broken-statue $38
eye-glasses $37
glowing-lamp $39

tornado-bracelet $06
flame-bracelet $08
blizzard-bracelet $0a
storm-bracelet $0c
love-pendant $3b
key-to-styx $34
opel-statue $26
sacred-shield $12
ivory-statue $3d

rabbit-boots $2e
gas-mask $29
shield-ring $30
iron-necklace $2c
leather-boots $2f
power-ring $2a
warrior-ring $2b
deos-pendant $2d
bow-of-moon $3e
bow-of-sun $3f

refresh $41
paralysis $42
telepathy $43
teleport $44
recover $45
barrier $46
change $47
flight $48
psycho-armor $1c
bow-of-truth $40
`;
const SLOTS = [
    [0x00, 121, 192],
    [0x01, 274, 176],
    [0x02, 335, 123],
    [0x03, 77, 10],
    [0x05, 89, 107],
    [0x06, 115, 224],
    [0x07, 282, 187],
    [0x08, 47, 182],
    [0x09, 251, 232],
    [0x0a, 206, 249],
    [0x0b, 83, 63],
    [0x0c, 23, 9],
    [0x12, 49, 48],
    [0x14, 77, 3],
    [0x70, 71, 3, 0x89, 0x14],
    [0x70, 83, 3, 0x89, 0x15],
    [0x1b, 168, 97],
    [0x1c, 199, 110],
    [0x1d, 82, 95],
    [0x1e, 82, 101],
    [0x1f, 346, 147],
    [0x70, 346, 153, 0x4a, 0x15],
    [0x70, 346, 159, 0x4a, 0x16],
    [0x20, 126, 52],
    [0x21, 227, 97],
    [0x22, 256, 73],
    [0x23, 58, 115],
    [0x24, 82, 113],
    [0x25, 189, 180],
    [0x26, 18, 172],
    [0x27, 267, 185],
    [0x28, 275, 147],
    [0x29, 147, 206],
    [0x2a, 172, 104],
    [0x2b, 203, 5],
    [0x2c, 249, 69],
    [0x2d, 191, 110],
    [0x2e, 89, 99],
    [0x2f, 164, 104],
    [0x30, 319, 123],
    [0x70, 320, 130, 0x54, 0x13],
    [0x32, 105, 94],
    [0x33, 64, 198],
    [0x34, 83, 71],
    [0x35, 345, 140],
    [0x36, 301, 119],
    [0x37, 233, 118],
    [0x38, 234, 88],
    [0x39, 295, 92],
    [0x3b, 274, 117],
    [0x3c, 338, 226],
    [0x3d, 23, 17],
    [0x3e, 206, 241],
    [0x3f, 101, 6],
    [0x40, 207, 110],
    [0x41, 92, 117],
    [0x42, 279, 126],
    [0x43, 202, 138],
    [0x44, 124, 202],
    [0x45, 304, 128],
    [0x46, 248, 35],
    [0x47, 277, 3],
    [0x48, 15, 25],
    [0x50, 82, 107],
    [0x52, 134, 219],
    [0x53, 59, 219],
    [0x54, 52, 55],
    [0x55, 241, 97],
    [0x56, 123, 23],
    [0x70, 115, 3, 0x85, 0x17],
    [0x57, 70, 9],
    [0x70, 84, 9, 0x89, 0x13],
    [0x58, 32, 38],
    [0x70, 32, 16, 0xb5, 0x0d],
    [0x70, 40, 16, 0xb5, 0x0e],
    [0x70, 40, 38, 0xb5, 0x0f],
    [0x5a, 162, 97],
    [0x10, 327, 123],
    [0x5c, 256, 79],
    [0x5d, 36, 139],
    [0x5e, 14, 229],
    [0x5f, 345, 225],
    [0x60, 18, 94],
    [0x61, 234, 96],
    [0x62, 18, 118],
    [0x63, 36, 54],
    [0x64, 174, 97],
    [0x65, 139, 40],
    [0x66, 66, 160],
    [0x69, 131, 201],
    [0x6a, 76, 226],
    [0x6b, 18, 100],
    [0x6c, 193, 103],
    [0x70, 199, 103, 0xa3, 0x0d],
    [0x6d, 205, 103],
    [0x70, 256, 67, 0x6b, 0x0e],
    [0x6e, 24, 38],
    [0x6f, 44, 97],
];
class Graph {
    constructor(world) {
        this.depgraph = graph.integrate({ tracker: true });
        this.slotElts = new Map();
        this.itemElts = new Map();
        this.always = new Set();
        this.checked = new Set();
        this.grid = document.getElementsByClassName('grid')[0];
        this.map = document.getElementsByClassName('map')[0];
        this.nodeFromSlot = new Map();
        this.mimicSlots = new Map();
        this.nodes = new Map();
        this.route = [];
        for (const n of graph.nodes) {
            this.nodes.set(n.uid, n.name);
            this.route[n.uid] = 4;
            if (n instanceof Slot) {
                if (!n.isMimic()) {
                    this.nodeFromSlot.set(n.slotIndex, n);
                }
                if (n.name == 'Alarm Flute' || n.name == 'Medical Herb') {
                    this.always.add(n.item.uid);
                    this.route[n.item.uid] = 0;
                }
            }
            else if (n instanceof Location) {
                for (const chest of n.chests) {
                    if (chest.isMimic()) {
                        this.mimicSlots.set(n.id << 8 | chest.spawnSlot, chest);
                    }
                }
            }
            else if (n instanceof TrackerNode) {
                const index = this.depgraph.uidToItem[n.uid];
                if (index == null)
                    continue;
                let color = 4;
                if (n.type === TrackerNode.OFF_ROUTE)
                    color = 1;
                if (n.type === TrackerNode.GLITCH)
                    color = 2;
                if (n.type === TrackerNode.HARD)
                    color = 3;
                this.route[n.uid] = color;
            }
        }
        const toggle = (e, slot) => {
            slot = slot || !!e.button;
            let t = e.target;
            const key = slot ? 'slot' : 'item';
            while (t && !t.dataset[key]) {
                t = t.parentElement;
            }
            if (!t)
                return;
            const uid = Number(t.dataset[key]);
            if (slot && e.shiftKey) {
                showReqs(uid);
                return;
            }
            if (slot) {
                if (this.checked.has(uid)) {
                    this.checked.delete(uid);
                }
                else {
                    this.checked.add(uid);
                }
            }
            else {
                this.route[uid] = 4 - this.route[uid];
            }
            if (!slot) {
                t.classList.toggle('got', !this.route[uid]);
            }
            this.update();
            e.preventDefault();
        };
        const reqs = document.getElementById('reqs');
        const clearReqs = () => {
            reqs.dataset['showing'] = '';
            while (reqs.children.length)
                reqs.children[0].remove();
        };
        this.grid.addEventListener('click', e => toggle(e, false));
        this.grid.addEventListener('contextmenu', toggle);
        this.map.addEventListener('click', e => toggle(e, true));
        const showReqs = (uid) => {
            if (Number(reqs.dataset['showing']) == uid)
                return;
            clearReqs();
            reqs.dataset['showing'] = uid;
            const top = document.createElement('span');
            top.textContent = `${this.nodes.get(uid)} requires`;
            reqs.appendChild(top);
            const ul = document.createElement('ul');
            reqs.appendChild(ul);
            const alts = [];
            for (const alt of this.depgraph.routes[this.depgraph.uidToLocation[uid]]) {
                let level = 0;
                const li = document.createElement('li');
                const parts = [];
                for (const bit of Bits.bits(alt)) {
                    const dep = this.depgraph.itemToUid[bit];
                    level = Math.max(level, this.route[dep]);
                    parts.push(this.nodes.get(dep));
                }
                li.textContent = parts.join(' AND ');
                li.classList.add(['available', 'off-route', 'glitched', 'hard', 'blocked'][level]);
                alts.push([li, level]);
            }
            alts.sort((a, b) => (a[1] - b[1]) || (a[0].textContent.length - b[0].textContent.length));
            for (const alt of alts)
                ul.appendChild(alt[0]);
        };
    }
    addSlot(index, x, y, loc, spawn) {
        const mimic = index >= 0x70;
        const slot = !mimic ?
            this.nodeFromSlot.get(index) :
            this.mimicSlots.get(loc << 8 | spawn);
        if (!slot)
            debugger;
        const div = document.createElement('div');
        if (slot.slotType == 'key' ||
            slot.slotType == 'magic' ||
            slot.slotType == 'bonus') {
            div.classList.add('key');
            x--;
            y--;
        }
        x--;
        y--;
        div.dataset['slot'] = slot.uid;
        div.style.left = x + 'px';
        div.style.top = y + 'px';
        const inner = document.createElement('div');
        div.appendChild(inner);
        inner.textContent = mimic ? 'Mimic' : slot.name.replace(' ', '\xa0');
        this.slotElts.set(slot.uid, div);
        this.map.appendChild(div);
    }
    addBox(cls, id) {
        id = Number.parseInt(id.substring(1), 16);
        const outer = document.getElementsByClassName(cls)[0];
        const inner = document.createElement('div');
        outer.appendChild(inner);
        const slot = this.nodeFromSlot.get(id);
        outer.dataset['slot'] = slot.uid;
        outer.dataset['item'] = slot.item.uid;
        this.itemElts.set(slot.item.uid, outer);
    }
    update() {
        main: for (const [uid, elt] of this.slotElts) {
            elt.classList.remove('checked');
            elt.classList.remove('blocked');
            elt.classList.remove('available');
            elt.classList.remove('glitched');
            elt.classList.remove('off-route');
            elt.classList.remove('hard');
            if (this.checked.has(uid)) {
                elt.classList.add('checked');
            }
            else {
                let minLevel = 4;
                for (const alternative of this.depgraph.routes[this.depgraph.uidToLocation[uid]]) {
                    let level = 0;
                    for (const dep of Bits.bits(alternative)) {
                        level = Math.max(level, this.route[this.depgraph.itemToUid[dep]]);
                        if (!(level < 4))
                            break;
                    }
                    minLevel = Math.min(minLevel, level);
                    if (!minLevel)
                        break;
                }
                elt.classList.add(['available', 'off-route', 'glitched', 'hard', 'blocked'][minLevel]);
            }
        }
    }
}
let flags = 'Rlpt Ts';
for (const arg of location.hash.substring(1).split('&')) {
    const [key, value] = arg.split('=');
    if (key === 'flags') {
        flags = decodeURIComponent(value);
    }
}
async function main() {
    const rom = await Rom.load();
    const w = World.build(rom, new FlagSet(flags));
    for (let box of BOXES.split('\n')) {
        box = box.replace(/#.*/, '').trim();
        if (!box)
            continue;
        graph.addBox(...box.split(/ +/g));
    }
    for (const slot of SLOTS) {
        graph.addSlot(...slot);
    }
    graph.update();
    document.getElementById('toggle-map').addEventListener('click', () => {
        graph.map.classList.toggle('hidden');
    });
    document.getElementById('clear-all').addEventListener('click', () => {
        for (let i = 0; i < graph.route.length; i++) {
            if (graph.route[i] == 0)
                graph.route[i] = graph.always.has(i) ? 0 : 4;
        }
        graph.checked.clear();
        graph.update();
        for (const element of document.querySelectorAll('.slot.got')) {
            element.classList.remove('got');
        }
    });
}
;
main();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidHJhY2tlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qcy90cmFja2VyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUdBLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxrQkFBa0IsQ0FBQztBQUN2QyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQy9CLE9BQU8sRUFBQyxPQUFPLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFDckMsT0FBTyxFQUFDLFFBQVEsRUFBRSxJQUFJLEVBQUUsV0FBVyxFQUFDLE1BQU0sWUFBWSxDQUFDO0FBQ3ZELE9BQU8sRUFBQyxHQUFHLEVBQUMsTUFBTSxVQUFVLENBQUM7QUFFN0IsTUFBTSxLQUFLLEdBQUc7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztDQXNEYixDQUFDO0FBRUYsTUFBTSxLQUFLLEdBQUc7SUFDWixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBRyxDQUFDLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFHLENBQUMsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBRyxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUMzQixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUcsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDM0IsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDM0IsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQzNCLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFHLENBQUMsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRTNCLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBRWYsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRyxDQUFDLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFHLENBQUMsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUMsR0FBRyxDQUFDO0lBRWYsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUcsQ0FBQyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDM0IsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFHLENBQUMsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBRyxDQUFDLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUMzQixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQzNCLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBRSxFQUFFLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUMzQixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUUsRUFBRSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFM0IsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFHLEVBQUUsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBRSxFQUFFLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUUsRUFBRSxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUdmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRyxFQUFFLEVBQUMsR0FBRyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLEVBQUcsRUFBRSxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFBQyxHQUFHLENBQUM7SUFDZixDQUFDLElBQUksRUFBRSxHQUFHLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDM0IsQ0FBQyxJQUFJLEVBQUUsR0FBRyxFQUFDLEdBQUcsQ0FBQztJQUNmLENBQUMsSUFBSSxFQUFFLEdBQUcsRUFB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QUFjLENBQUMsV0FBVyxDQUFDLENBQUMsZ0JBQWdCLENBQUMsT0FBTyxFQUFFLEdBQUcsRUFBRTtRQUNsRSxLQUFLLElBQUksQ0FBQyxHQUFHLENBQUMsRUFBRSxDQUFDLEdBQUcsS0FBSyxDQUFDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDM0MsSUFBSSxLQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUM7Z0JBQUUsS0FBSyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsR0FBRyxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDdkU7UUFDRCxLQUFLLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxDQUFDO1FBQ3RCLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztRQUNmLEtBQUssTUFBTSxPQUFPLElBQUksUUFBUSxDQUFDLGdCQUFnQixDQUFDLFdBQVcsQ0FBQyxFQUFFO1lBQzVELE9BQU8sQ0FBQyxTQUFTLENBQUMsTUFBTSxDQUFDLEtBQUssQ0FBQyxDQUFDO1NBQ2pDO0lBQ0gsQ0FBQyxDQUFDLENBQUM7QUFDTCxDQUFDO0FBQUEsQ0FBQztBQUVGLElBQUksRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiLy8gSXRlbSB0cmFja2VyIGZvciB3ZWIuXG4vLyBVc2VzIGZsYWdzZXQgdG8gZmlndXJlIG91dCBhY3R1YWwgZGVwZW5kZW5jaWVzLlxuXG5pbXBvcnQge1dvcmxkfSBmcm9tICcuL2dyYXBoL3dvcmxkLmpzJztcbmltcG9ydCB7Qml0c30gZnJvbSAnLi9iaXRzLmpzJztcbmltcG9ydCB7RmxhZ1NldH0gZnJvbSAnLi9mbGFnc2V0LmpzJztcbmltcG9ydCB7TG9jYXRpb24sIFNsb3QsIFRyYWNrZXJOb2RlfSBmcm9tICcuL25vZGVzLmpzJztcbmltcG9ydCB7Um9tfSBmcm9tICcuL3JvbS5qcyc7XG5cbmNvbnN0IEJPWEVTID0gYFxuc3dvcmQtb2Ytd2luZCAkMDBcbnN3b3JkLW9mLWZpcmUgJDAxXG5zd29yZC1vZi13YXRlciAkMDJcbnN3b3JkLW9mLXRodW5kZXIgJDAzXG53aW5kbWlsbC1rZXkgJDMyXG5zdGF0dWUtb2Ytb255eCAkMjVcbmluc2VjdC1mbHV0ZSAkMjdcbmtleS10by1wcmlzb24gJDMzXG5mbHV0ZS1vZi1saW1lICQyOFxuXG5iYWxsLW9mLXdpbmQgJDA1IFxuYmFsbC1vZi1maXJlICQwN1xuYmFsbC1vZi13YXRlciAkMDlcbmJhbGwtb2YtdGh1bmRlciAkMGJcbmtpcmlzYS1wbGFudCAkM2NcbmFsYXJtLWZsdXRlICQzMVxuZm9nLWxhbXAgJDM1XG5zaGVsbC1mbHV0ZSAkMzZcbmJyb2tlbi1zdGF0dWUgJDM4XG5leWUtZ2xhc3NlcyAkMzdcbmdsb3dpbmctbGFtcCAkMzlcblxudG9ybmFkby1icmFjZWxldCAkMDZcbmZsYW1lLWJyYWNlbGV0ICQwOFxuYmxpenphcmQtYnJhY2VsZXQgJDBhXG5zdG9ybS1icmFjZWxldCAkMGNcbmxvdmUtcGVuZGFudCAkM2JcbmtleS10by1zdHl4ICQzNFxub3BlbC1zdGF0dWUgJDI2XG5zYWNyZWQtc2hpZWxkICQxMlxuaXZvcnktc3RhdHVlICQzZFxuXG5yYWJiaXQtYm9vdHMgJDJlXG5nYXMtbWFzayAkMjlcbnNoaWVsZC1yaW5nICQzMFxuaXJvbi1uZWNrbGFjZSAkMmNcbmxlYXRoZXItYm9vdHMgJDJmXG5wb3dlci1yaW5nICQyYVxud2Fycmlvci1yaW5nICQyYlxuZGVvcy1wZW5kYW50ICQyZFxuYm93LW9mLW1vb24gJDNlXG5ib3ctb2Ytc3VuICQzZlxuXG5yZWZyZXNoICQ0MVxucGFyYWx5c2lzICQ0MlxudGVsZXBhdGh5ICQ0M1xudGVsZXBvcnQgJDQ0XG5yZWNvdmVyICQ0NVxuYmFycmllciAkNDZcbmNoYW5nZSAkNDdcbmZsaWdodCAkNDhcbnBzeWNoby1hcm1vciAkMWNcbmJvdy1vZi10cnV0aCAkNDBcbmA7XG5cbmNvbnN0IFNMT1RTID0gW1xuICBbMHgwMCwgMTIxLDE5Ml0sIC8vIHN3b3JkIG9mIHdpbmRcbiAgWzB4MDEsIDI3NCwxNzZdLCAvLyBzd29yZCBvZiBmaXJlXG4gIFsweDAyLCAzMzUsMTIzXSwgLy8gc3dvcmQgb2Ygd2F0ZXJcbiAgWzB4MDMsICA3NywgMTBdLCAvLyBzd29yZCBvZiB0aHVuZGVyXG4gIFsweDA1LCAgODksMTA3XSwgLy8gYmFsbCBvZiB3aW5kXG4gIFsweDA2LCAxMTUsMjI0XSwgLy8gdG9ybmFkbyBicmFjZWxldFxuICBbMHgwNywgMjgyLDE4N10sIC8vIGJhbGwgb2YgZmlyZVxuICBbMHgwOCwgIDQ3LDE4Ml0sIC8vIGZsYW1lIGJyYWNlbGV0XG4gIFsweDA5LCAyNTEsMjMyXSwgLy8gYmFsbCBvZiB3YXRlclxuICBbMHgwYSwgMjA2LDI0OV0sIC8vIGJsaXp6YXJkIGJyYWNlbGV0XG4gIFsweDBiLCAgODMsIDYzXSwgLy8gYmFsbCBvZiB0aHVuZGVyXG4gIFsweDBjLCAgMjMsICA5XSwgLy8gc3Rvcm0gYnJhY2VsZXRcbiAgWzB4MTIsICA0OSwgNDhdLCAvLyBzYWNyZWQgc2hpZWxkXG4gIFsweDE0LCAgNzcsICAzXSwgLy8gcHN5Y2hvIHNoaWVsZFxuICBbMHg3MCwgIDcxLCAgMywgMHg4OSwgMHgxNF0sIC8vIHBzeWNobyBzaGllbGQgbWltaWMgMVxuICBbMHg3MCwgIDgzLCAgMywgMHg4OSwgMHgxNV0sIC8vIHBzeWNobyBzaGllbGQgbWltaWMgMlxuICBbMHgxYiwgMTY4LCA5N10sIC8vIGJhdHRsZSBzdWl0XG4gIFsweDFjLCAxOTksMTEwXSwgLy8gcHN5Y2hvIGFybW9yXG4gIFsweDFkLCAgODIsIDk1XSwgLy8gbWVkaWNhbCBoZXJiIHNlYWxlZCBjYXZlXG4gIFsweDFlLCAgODIsMTAxXSwgLy8gYW50aWRvdGUgc2VhbGVkIGNhdmVcbiAgWzB4MWYsIDM0NiwxNDddLCAvLyBseXNpcyBwbGFudCBmb2cgbGFtcFxuICBbMHg3MCwgMzQ2LDE1MywgMHg0YSwgMHgxNV0sIC8vIGZvZyBsYW1wIG1pbWljIDFcbiAgWzB4NzAsIDM0NiwxNTksIDB4NGEsIDB4MTZdLCAvLyBmb2cgbGFtcCBtaW1pYyAyXG4gIFsweDIwLCAxMjYsIDUyXSwgLy8gZnJ1aXQgb2YgbGltZSBtdCBoeWRyYVxuICBbMHgyMSwgMjI3LCA5N10sIC8vIGZydWl0IG9mIHBvd2VyIHNhYmVyYSBwYWxhY2VcbiAgWzB4MjIsIDI1NiwgNzNdLCAvLyBtYWdpYyByaW5nIGV2aWwgc3Bpcml0IGlzbGFuZFxuICBbMHgyMywgIDU4LDExNV0sIC8vIGZydWl0IG9mIHJlcHVuIHNhYmVyYSAyXG4gIFsweDI0LCAgODIsMTEzXSwgLy8gd2FycCBib290cyBzZWFsZWQgY2F2ZVxuICBbMHgyNSwgMTg5LDE4MF0sIC8vIHN0YXR1ZSBvZiBvbnl4XG4gIFsweDI2LCAgMTgsMTcyXSwgLy8gb3BlbCBzdGF0dWVcbiAgWzB4MjcsIDI2NywxODVdLCAvLyBpbnNlY3QgZmx1dGVcbiAgWzB4MjgsIDI3NSwxNDddLCAvLyBmbHV0ZSBvZiBsaW1lXG4gIFsweDI5LCAxNDcsMjA2XSwgLy8gZ2FzIG1hc2tcbiAgWzB4MmEsIDE3MiwxMDRdLCAvLyBwb3dlciByaW5nXG4gIFsweDJiLCAyMDMsICA1XSwgLy8gd2FycmlvciByaW5nXG4gIFsweDJjLCAyNDksIDY5XSwgLy8gaXJvbiBuZWNrbGFjZVxuICBbMHgyZCwgMTkxLDExMF0sIC8vIGRlb3MgcGVuZGFudFxuICBbMHgyZSwgIDg5LCA5OV0sIC8vIHJhYmJpdCBib290c1xuICBbMHgyZiwgMTY0LDEwNF0sIC8vIGxlYXRoZXIgYm9vdHNcbiAgWzB4MzAsIDMxOSwxMjNdLCAvLyBzaGllbGQgcmluZ1xuICBbMHg3MCwgMzIwLDEzMCwgMHg1NCwgMHgxM10sIC8vIHdhdGVyZmFsbCBjYXZlIG1pbWljXG4gIC8vIDMxIGFsYXJtIGZsdXRlXG4gIFsweDMyLCAxMDUsIDk0XSwgLy8gd2luZG1pbGwga2V5XG4gIFsweDMzLCAgNjQsMTk4XSwgLy8ga2V5IHRvIHByaXNvblxuICBbMHgzNCwgIDgzLCA3MV0sIC8vIGtleSB0byBzdHl4XG4gIFsweDM1LCAzNDUsMTQwXSwgLy8gZm9nIGxhbXBcbiAgWzB4MzYsIDMwMSwxMTldLCAvLyBzaGVsbCBmbHV0ZVxuICBbMHgzNywgMjMzLDExOF0sIC8vIGV5ZSBnbGFzc2VzXG4gIFsweDM4LCAyMzQsIDg4XSwgLy8gYnJva2VuIHN0YXR1ZVxuICBbMHgzOSwgMjk1LCA5Ml0sIC8vIGdsb3dpbmcgbGFtcFxuICAvLyAzYSBzdGF0dWUgb2YgZ29sZFxuICBbMHgzYiwgMjc0LDExN10sIC8vIGxvdmUgcGVuZGFudFxuICBbMHgzYywgMzM4LDIyNl0sIC8vIGtpcmlzYSBwbGFudFxuICBbMHgzZCwgIDIzLCAxN10sIC8vIGl2b3J5IHN0YXR1ZVxuICBbMHgzZSwgMjA2LDI0MV0sIC8vIGJvdyBvZiBtb29uXG4gIFsweDNmLCAxMDEsICA2XSwgLy8gYm93IG9mIHN1blxuICBbMHg0MCwgMjA3LDExMF0sIC8vIGJvdyBvZiB0cnV0aFxuICBbMHg0MSwgIDkyLDExN10sIC8vIHJlZnJlc2hcbiAgWzB4NDIsIDI3OSwxMjZdLCAvLyBwYXJhbHlzaXNcbiAgWzB4NDMsIDIwMiwxMzhdLCAvLyB0ZWxlcGF0aHlcbiAgWzB4NDQsIDEyNCwyMDJdLCAvLyB0ZWxlcG9ydFxuICBbMHg0NSwgMzA0LDEyOF0sIC8vIHJlY292ZXJcbiAgWzB4NDYsIDI0OCwgMzVdLCAvLyBiYXJyaWVyXG4gIFsweDQ3LCAyNzcsICAzXSwgLy8gY2hhbmdlXG4gIFsweDQ4LCAgMTUsIDI1XSwgLy8gZmxpZ2h0XG4gIFsweDUwLCAgODIsMTA3XSwgLy8gbWVkaWNhbCBoZXJiIHNlYWxlZCBjYXZlIGZyb250XG4gIC8vIDUxIHNhY3JlZCBzaGllbGRcbiAgWzB4NTIsIDEzNCwyMTldLCAvLyBtZWRpY2FsIGhlcmIgbXQgc2FicmUgd1xuICBbMHg1MywgIDU5LDIxOV0sIC8vIG1lZGljYWwgaGVyYiBtdCBzYWJyZSBuXG4gIFsweDU0LCAgNTIsIDU1XSwgLy8gbWFnaWMgcmluZyBmb3J0cmVzcyAzIHVwcGVyXG4gIFsweDU1LCAyNDEsIDk3XSwgLy8gbWVkaWNhbCBoZXJiIHNhYmVyYSBwYWxhY2VcbiAgWzB4NTYsIDEyMywgMjNdLCAvLyBtZWRpY2FsIGhlcmIgbXQgaHlkcmFcbiAgWzB4NzAsIDExNSwgIDMsIDB4ODUsIDB4MTddLCAvLyBtdCBoeWRyYSBtaW1pY1xuICBbMHg1NywgIDcwLCAgOV0sIC8vIG1lZGljYWwgaGVyYiBzdHl4XG4gIFsweDcwLCAgODQsICA5LCAweDg5LCAweDEzXSwgLy8gc3R5eCAxIG1pbWljXG4gIFsweDU4LCAgMzIsIDM4XSwgLy8gbWFnaWMgcmluZyBrYXJtaW5lXG4gIFsweDcwLCAgMzIsIDE2LCAweGI1LCAweDBkXSwgLy8ga2FybWluZSBtaW1pYyAxXG4gIFsweDcwLCAgNDAsIDE2LCAweGI1LCAweDBlXSwgLy8ga2FybWluZSBtaW1pYyAyXG4gIFsweDcwLCAgNDAsIDM4LCAweGI1LCAweDBmXSwgLy8ga2FybWluZSBtaW1pYyAzXG4gIC8vIDU5IG1lZGljYWwgaGVyYlxuICBbMHg1YSwgMTYyLCA5N10sIC8vIGZydWl0IG9mIHBvd2VyIG9hc2lzIGNhdmUgKG92ZXIgd2F0ZXIpXG4gIFsweDEwLCAzMjcsMTIzXSwgLy8gZmx1dGUgb2YgbGltZSBjaGVzdCAoTk9URTogY2hhbmdlZCA1Yi0+IDEwKVxuICBbMHg1YywgMjU2LCA3OV0sIC8vIGx5c2lzIHBsYW50IGV2aWwgc3Bpcml0IGlzbGFuZFxuICBbMHg1ZCwgIDM2LDEzOV0sIC8vIGx5c2lzIHBsYW50IHNhYmVyYSBsZXZlbFxuICBbMHg1ZSwgIDE0LDIyOV0sIC8vIGFudGlkb3RlIG10IHNhYnJlIG5cbiAgWzB4NWYsIDM0NSwyMjVdLCAvLyBhbnRpZG90ZSBraXJpc2EgY2F2ZVxuICBbMHg2MCwgIDE4LCA5NF0sIC8vIGFudGlkb3RlIGZvcnRlc3MgM1xuICBbMHg2MSwgMjM0LCA5Nl0sIC8vIGZydWl0IG9mIHBvd2VyIHZhbXBpcmUgMlxuICBbMHg2MiwgIDE4LDExOF0sIC8vIGZydWl0IG9mIHBvd2VyIHNhYmVyYSBsZXZlbFxuICBbMHg2MywgIDM2LCA1NF0sIC8vIG9wZWwgc3RhdHVlIGZvcnRyZXNzIDNcbiAgWzB4NjQsIDE3NCwgOTddLCAvLyBmcnVpdCBvZiBwb3dlciBvYXNpcyBjYXZlXG4gIFsweDY1LCAxMzksIDQwXSwgLy8gbWFnaWMgcmluZyBtdCBoeWRyYVxuICBbMHg2NiwgIDY2LDE2MF0sIC8vIGZydWl0IG9mIHJlcHVuIHNhYmVyYSBsZXZlbFxuICAvLyA2NyBtYWdpYyByaW5nXG4gIC8vIDY4IG1hZ2ljIHJpbmdcbiAgWzB4NjksIDEzMSwyMDFdLCAvLyBtYWdpYyByaW5nIG10IHNhYnJlIHdcbiAgWzB4NmEsICA3NiwyMjZdLCAvLyB3YXJwIGJvb3RzIG10IHNhYnJlIHdcbiAgWzB4NmIsICAxOCwxMDBdLCAvLyBtYWdpYyByaW5nIGZvcnRyZXNzIDMgdXBwZXIgKGJlaGluZClcbiAgWzB4NmMsIDE5MywxMDNdLCAvLyBtYWdpYyByaW5nIHB5cmFtaWQgZnJvbnRcbiAgWzB4NzAsIDE5OSwxMDMsIDB4YTMsIDB4MGRdLCAvLyBweXJhbWlkIGJhY2sgbWltaWNcbiAgWzB4NmQsIDIwNSwxMDNdLCAvLyBvcGVsIHN0YXR1ZSBweXJhbWlkIGJhY2tcbiAgWzB4NzAsIDI1NiwgNjcsIDB4NmIsIDB4MGVdLCAvLyBpcm9uIG5lY2tsYWNlIG1pbWljXG4gIFsweDZlLCAgMjQsIDM4XSwgLy8gd2FycCBib290cyBrYXJtaW5lXG4gIFsweDZmLCAgNDQsIDk3XSwgLy8gbWFnaWMgcmluZyBmb3J0cmVzcyAzIGxvd2VyXG5dO1xuXG5jbGFzcyBHcmFwaCB7XG4gIGNvbnN0cnVjdG9yKHdvcmxkKSB7XG4gICAgLy8gVE9ETyAtIGNvbXB1dGUgdHdvIGRlcGdyYXBoczogb25lIHdpdGggZ2xpdGNoZXMgYW5kIG9uZSB3aXRob3V0XG4gICAgLy8gIC0gdGhlbiB3ZSBjYW4gc2hvdyBncmVlbiB2cyB5ZWxsb3cgZm9yIGdsaXRjaGFibGUgbG9jYXRpb25zXG4gICAgdGhpcy5kZXBncmFwaCA9IGdyYXBoLmludGVncmF0ZSh7dHJhY2tlcjogdHJ1ZX0pO1xuICAgIHRoaXMuc2xvdEVsdHMgPSBuZXcgTWFwKCk7IC8vIG1hcCBmcm9tIHNsb3QgdWlkIHRvIGVsZW1lbnRcbiAgICB0aGlzLml0ZW1FbHRzID0gbmV3IE1hcCgpOyAvLyBtYXAgZnJvbSBpdGVtIHVpZCB0byBlbGVtZW50XG4gICAgdGhpcy5hbHdheXMgPSBuZXcgU2V0KCk7ICAgLy8gb25seSB1c2VkIGZvciBjbGVhcmluZ1xuICAgIHRoaXMuY2hlY2tlZCA9IG5ldyBTZXQoKTsgIC8vIHNldCBvZiBzbG90IHVpZFxuICAgIHRoaXMuZ3JpZCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ2dyaWQnKVswXTtcbiAgICB0aGlzLm1hcCA9IGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ21hcCcpWzBdO1xuICAgIHRoaXMubm9kZUZyb21TbG90ID0gbmV3IE1hcCgpOyAgLy8gbWFwIGZyb20gc2xvdCBpZCB0byBub2RlXG4gICAgdGhpcy5taW1pY1Nsb3RzID0gbmV3IE1hcCgpOyAgICAvLyBsb2NhdGlvbiBhbmQgc3Bhd24gdG8gbm9kZVxuICAgIHRoaXMubm9kZXMgPSBuZXcgTWFwKCk7XG5cbiAgICAvKipcbiAgICAgKiBNYXBzIHVpZCB0byBzdGF0dXM6IDAgPSBoYXMsIDEtMyA9IG9mZi1yb3V0ZSwgNCA9IGJsb2NrZWRcbiAgICAgKiBAY29uc3QgeyFBcnJheTxudW1iZXI+fVxuICAgICAqL1xuICAgIHRoaXMucm91dGUgPSBbXTtcblxuICAgIGZvciAoY29uc3QgbiBvZiBncmFwaC5ub2Rlcykge1xuICAgICAgdGhpcy5ub2Rlcy5zZXQobi51aWQsIG4ubmFtZSk7XG4gICAgICB0aGlzLnJvdXRlW24udWlkXSA9IDQ7XG4gICAgICBpZiAobiBpbnN0YW5jZW9mIFNsb3QpIHtcbiAgICAgICAgLy8gdXNlZCBieSBhZGRCb3hcbiAgICAgICAgaWYgKCFuLmlzTWltaWMoKSkge1xuICAgICAgICAgIHRoaXMubm9kZUZyb21TbG90LnNldChuLnNsb3RJbmRleCwgbik7XG4gICAgICAgIH1cbiAgICAgICAgLy8gbm90IHNob3duLCBqdXN0IGFzc3VtZSBoYXZlIGl0XG4gICAgICAgIGlmIChuLm5hbWUgPT0gJ0FsYXJtIEZsdXRlJyB8fCBuLm5hbWUgPT0gJ01lZGljYWwgSGVyYicpIHtcbiAgICAgICAgICB0aGlzLmFsd2F5cy5hZGQobi5pdGVtLnVpZCk7XG4gICAgICAgICAgdGhpcy5yb3V0ZVtuLml0ZW0udWlkXSA9IDA7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAobiBpbnN0YW5jZW9mIExvY2F0aW9uKSB7XG4gICAgICAgIC8vIGZpbmQgdGhlIG1pbWljcywgdGhleSBuZWVkIHNwZWNpYWwgaGFuZGxpbmdcbiAgICAgICAgZm9yIChjb25zdCBjaGVzdCBvZiBuLmNoZXN0cykge1xuICAgICAgICAgIGlmIChjaGVzdC5pc01pbWljKCkpIHtcbiAgICAgICAgICAgIHRoaXMubWltaWNTbG90cy5zZXQobi5pZCA8PCA4IHwgY2hlc3Quc3Bhd25TbG90LCBjaGVzdCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9IGVsc2UgaWYgKG4gaW5zdGFuY2VvZiBUcmFja2VyTm9kZSkge1xuICAgICAgICBjb25zdCBpbmRleCA9IHRoaXMuZGVwZ3JhcGgudWlkVG9JdGVtW24udWlkXTtcbiAgICAgICAgaWYgKGluZGV4ID09IG51bGwpIGNvbnRpbnVlO1xuICAgICAgICBsZXQgY29sb3IgPSA0O1xuICAgICAgICBpZiAobi50eXBlID09PSBUcmFja2VyTm9kZS5PRkZfUk9VVEUpIGNvbG9yID0gMTtcbiAgICAgICAgaWYgKG4udHlwZSA9PT0gVHJhY2tlck5vZGUuR0xJVENIKSBjb2xvciA9IDI7XG4gICAgICAgIGlmIChuLnR5cGUgPT09IFRyYWNrZXJOb2RlLkhBUkQpIGNvbG9yID0gMztcbiAgICAgICAgdGhpcy5yb3V0ZVtuLnVpZF0gPSBjb2xvcjtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCB0b2dnbGUgPSAoZSwgc2xvdCkgPT4ge1xuICAgICAgc2xvdCA9IHNsb3QgfHwgISFlLmJ1dHRvbjtcbiAgICAgIGxldCB0ID0gZS50YXJnZXQ7XG4gICAgICBjb25zdCBrZXkgPSBzbG90ID8gJ3Nsb3QnIDogJ2l0ZW0nO1xuICAgICAgd2hpbGUgKHQgJiYgIXQuZGF0YXNldFtrZXldKSB7XG4gICAgICAgIHQgPSB0LnBhcmVudEVsZW1lbnQ7XG4gICAgICB9XG4gICAgICBpZiAoIXQpIHJldHVybjtcbiAgICAgIGNvbnN0IHVpZCA9IE51bWJlcih0LmRhdGFzZXRba2V5XSk7XG4gICAgICBpZiAoc2xvdCAmJiBlLnNoaWZ0S2V5KSB7XG4gICAgICAgIHNob3dSZXFzKHVpZCk7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmIChzbG90KSB7XG4gICAgICAgIGlmICh0aGlzLmNoZWNrZWQuaGFzKHVpZCkpIHtcbiAgICAgICAgICB0aGlzLmNoZWNrZWQuZGVsZXRlKHVpZCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhpcy5jaGVja2VkLmFkZCh1aWQpO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICB0aGlzLnJvdXRlW3VpZF0gPSA0IC0gdGhpcy5yb3V0ZVt1aWRdO1xuICAgICAgfVxuICAgICAgaWYgKCFzbG90KSB7XG4gICAgICAgIHQuY2xhc3NMaXN0LnRvZ2dsZSgnZ290JywgIXRoaXMucm91dGVbdWlkXSk7XG4gICAgICB9XG4gICAgICB0aGlzLnVwZGF0ZSgpO1xuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuICAgIH07XG5cbiAgICBjb25zdCByZXFzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3JlcXMnKTtcbiAgICBjb25zdCBjbGVhclJlcXMgPSAoKSA9PiB7XG4gICAgICByZXFzLmRhdGFzZXRbJ3Nob3dpbmcnXSA9ICcnO1xuICAgICAgd2hpbGUgKHJlcXMuY2hpbGRyZW4ubGVuZ3RoKSByZXFzLmNoaWxkcmVuWzBdLnJlbW92ZSgpO1xuICAgIH07XG5cbiAgICB0aGlzLmdyaWQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHRvZ2dsZShlLCBmYWxzZSkpO1xuICAgIHRoaXMuZ3JpZC5hZGRFdmVudExpc3RlbmVyKCdjb250ZXh0bWVudScsIHRvZ2dsZSk7XG4gICAgdGhpcy5tYXAuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBlID0+IHRvZ2dsZShlLCB0cnVlKSk7XG5cbiAgICBjb25zdCBzaG93UmVxcyA9ICh1aWQpID0+IHtcbiAgICAgIGlmIChOdW1iZXIocmVxcy5kYXRhc2V0WydzaG93aW5nJ10pID09IHVpZCkgcmV0dXJuO1xuICAgICAgY2xlYXJSZXFzKCk7XG4gICAgICByZXFzLmRhdGFzZXRbJ3Nob3dpbmcnXSA9IHVpZDtcbiAgICAgIGNvbnN0IHRvcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NwYW4nKTtcbiAgICAgIHRvcC50ZXh0Q29udGVudCA9IGAke3RoaXMubm9kZXMuZ2V0KHVpZCl9IHJlcXVpcmVzYDtcbiAgICAgIHJlcXMuYXBwZW5kQ2hpbGQodG9wKTtcbiAgICAgIGNvbnN0IHVsID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndWwnKTtcbiAgICAgIHJlcXMuYXBwZW5kQ2hpbGQodWwpO1xuICAgICAgY29uc3QgYWx0cyA9IFtdO1xuICAgICAgZm9yIChjb25zdCBhbHQgb2YgdGhpcy5kZXBncmFwaC5yb3V0ZXNbdGhpcy5kZXBncmFwaC51aWRUb0xvY2F0aW9uW3VpZF1dKSB7XG4gICAgICAgIGxldCBsZXZlbCA9IDA7XG4gICAgICAgIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgICAgICAgY29uc3QgcGFydHMgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBiaXQgb2YgQml0cy5iaXRzKGFsdCkpIHtcbiAgICAgICAgICBjb25zdCBkZXAgPSB0aGlzLmRlcGdyYXBoLml0ZW1Ub1VpZFtiaXRdO1xuICAgICAgICAgIGxldmVsID0gTWF0aC5tYXgobGV2ZWwsIHRoaXMucm91dGVbZGVwXSk7XG4gICAgICAgICAgcGFydHMucHVzaCh0aGlzLm5vZGVzLmdldChkZXApKTtcbiAgICAgICAgfVxuICAgICAgICBsaS50ZXh0Q29udGVudCA9IHBhcnRzLmpvaW4oJyBBTkQgJyk7XG4gICAgICAgIGxpLmNsYXNzTGlzdC5hZGQoWydhdmFpbGFibGUnLCAnb2ZmLXJvdXRlJywgJ2dsaXRjaGVkJywgJ2hhcmQnLCAnYmxvY2tlZCddW2xldmVsXSk7XG4gICAgICAgIGFsdHMucHVzaChbbGksIGxldmVsXSk7XG4gICAgICB9XG4gICAgICBhbHRzLnNvcnQoKGEsIGIpID0+IChhWzFdIC0gYlsxXSkgfHwgKGFbMF0udGV4dENvbnRlbnQubGVuZ3RoIC0gYlswXS50ZXh0Q29udGVudC5sZW5ndGgpKTtcbiAgICAgIGZvciAoY29uc3QgYWx0IG9mIGFsdHMpIHVsLmFwcGVuZENoaWxkKGFsdFswXSk7XG4gICAgfTtcbiAgfVxuXG4gIGFkZFNsb3QoaW5kZXgsIHgsIHksIGxvYywgc3Bhd24pIHtcbiAgICBjb25zdCBtaW1pYyA9IGluZGV4ID49IDB4NzA7XG4gICAgY29uc3Qgc2xvdCA9XG4gICAgICAgICFtaW1pYyA/XG4gICAgICAgICAgICB0aGlzLm5vZGVGcm9tU2xvdC5nZXQoaW5kZXgpIDpcbiAgICAgICAgICAgIHRoaXMubWltaWNTbG90cy5nZXQobG9jIDw8IDggfCBzcGF3bik7XG4gICAgaWYgKCFzbG90KSBkZWJ1Z2dlcjtcbiAgICBjb25zdCBkaXYgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBpZiAoc2xvdC5zbG90VHlwZSA9PSAna2V5JyB8fFxuICAgICAgICBzbG90LnNsb3RUeXBlID09ICdtYWdpYycgfHxcbiAgICAgICAgc2xvdC5zbG90VHlwZSA9PSAnYm9udXMnKSB7XG4gICAgICBkaXYuY2xhc3NMaXN0LmFkZCgna2V5Jyk7XG4gICAgICB4LS07IHktLTtcbiAgICB9XG4gICAgeC0tOyB5LS07XG4gICAgZGl2LmRhdGFzZXRbJ3Nsb3QnXSA9IHNsb3QudWlkO1xuICAgIGRpdi5zdHlsZS5sZWZ0ID0geCArICdweCc7XG4gICAgZGl2LnN0eWxlLnRvcCA9IHkgKyAncHgnO1xuICAgIC8vZGl2LnRleHRDb250ZW50ID0gJ1xceGEwJztcbiAgICBjb25zdCBpbm5lciA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuICAgIGRpdi5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgaW5uZXIudGV4dENvbnRlbnQgPSBtaW1pYyA/ICdNaW1pYycgOiBzbG90Lm5hbWUucmVwbGFjZSgnICcsICdcXHhhMCcpO1xuICAgIHRoaXMuc2xvdEVsdHMuc2V0KHNsb3QudWlkLCBkaXYpO1xuICAgIHRoaXMubWFwLmFwcGVuZENoaWxkKGRpdik7XG4gIH1cblxuICBhZGRCb3goY2xzLCBpZCkge1xuICAgIC8vIHBhcnNlIHRoZSBoZXgsIHJlbW92aW5nICQgcHJlZml4XG4gICAgaWQgPSBOdW1iZXIucGFyc2VJbnQoaWQuc3Vic3RyaW5nKDEpLCAxNik7XG4gICAgY29uc3Qgb3V0ZXIgPSBkb2N1bWVudC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGNscylbMF07XG4gICAgY29uc3QgaW5uZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdkaXYnKTtcbiAgICBvdXRlci5hcHBlbmRDaGlsZChpbm5lcik7XG4gICAgY29uc3Qgc2xvdCA9IHRoaXMubm9kZUZyb21TbG90LmdldChpZCk7XG4gICAgb3V0ZXIuZGF0YXNldFsnc2xvdCddID0gc2xvdC51aWQ7XG4gICAgb3V0ZXIuZGF0YXNldFsnaXRlbSddID0gc2xvdC5pdGVtLnVpZDtcbiAgICAvL3RoaXMuc2xvdEVsdHMuc2V0KHNsb3QudWlkLCBvdXRlcik7XG4gICAgdGhpcy5pdGVtRWx0cy5zZXQoc2xvdC5pdGVtLnVpZCwgb3V0ZXIpO1xuICB9XG5cbiAgdXBkYXRlKCkge1xuICAgIG1haW46XG4gICAgZm9yIChjb25zdCBbdWlkLCBlbHRdIG9mIHRoaXMuc2xvdEVsdHMpIHtcbiAgICAgIGVsdC5jbGFzc0xpc3QucmVtb3ZlKCdjaGVja2VkJyk7XG4gICAgICBlbHQuY2xhc3NMaXN0LnJlbW92ZSgnYmxvY2tlZCcpO1xuICAgICAgZWx0LmNsYXNzTGlzdC5yZW1vdmUoJ2F2YWlsYWJsZScpO1xuICAgICAgZWx0LmNsYXNzTGlzdC5yZW1vdmUoJ2dsaXRjaGVkJyk7XG4gICAgICBlbHQuY2xhc3NMaXN0LnJlbW92ZSgnb2ZmLXJvdXRlJyk7XG4gICAgICBlbHQuY2xhc3NMaXN0LnJlbW92ZSgnaGFyZCcpO1xuICAgICAgaWYgKHRoaXMuY2hlY2tlZC5oYXModWlkKSkge1xuICAgICAgICAvLyBubyB3b3JrLCBpdCdzIGFscmVhZHkgY2hlY2tlZFxuICAgICAgICBlbHQuY2xhc3NMaXN0LmFkZCgnY2hlY2tlZCcpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gZmlndXJlIG91dCB3aGV0aGVyIGl0J3MgYXZhaWxhYmxlIG9yIG5vdFxuICAgICAgICBsZXQgbWluTGV2ZWwgPSA0O1xuICAgICAgICBmb3IgKGNvbnN0IGFsdGVybmF0aXZlIG9mIHRoaXMuZGVwZ3JhcGgucm91dGVzW3RoaXMuZGVwZ3JhcGgudWlkVG9Mb2NhdGlvblt1aWRdXSkge1xuICAgICAgICAgIGxldCBsZXZlbCA9IDA7XG4gICAgICAgICAgZm9yIChjb25zdCBkZXAgb2YgQml0cy5iaXRzKGFsdGVybmF0aXZlKSkge1xuICAgICAgICAgICAgbGV2ZWwgPSBNYXRoLm1heChsZXZlbCwgdGhpcy5yb3V0ZVt0aGlzLmRlcGdyYXBoLml0ZW1Ub1VpZFtkZXBdXSk7XG4gICAgICAgICAgICBpZiAoIShsZXZlbCA8IDQpKSBicmVhaztcbiAgICAgICAgICB9XG4gICAgICAgICAgbWluTGV2ZWwgPSBNYXRoLm1pbihtaW5MZXZlbCwgbGV2ZWwpO1xuICAgICAgICAgIGlmICghbWluTGV2ZWwpIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGVsdC5jbGFzc0xpc3QuYWRkKFxuICAgICAgICAgICAgWydhdmFpbGFibGUnLCAnb2ZmLXJvdXRlJywgJ2dsaXRjaGVkJywgJ2hhcmQnLCAnYmxvY2tlZCddW21pbkxldmVsXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG59XG5cbi8vIFRPRE8gLSBhbGwgRyBmbGFncyBnZXQgdGhlIGdsaXRjaCBmb3IgZnJlZVxuLy8gICAgICAtIGFsbCBvdGhlcnMgKG1pbnVzIHdpbGQgd2FycCBpZiBkaXNhYmxlZCkgdHJhY2tlZCBhcyBnbGl0Y2hlc1xuLy8gICAgICAtIGNvbnNpZGVyIGRhcmsgeWVsbG93IGFuZCBkYXJrIGdyZWVuIGFzIHdlbGwgYXMgZGFyayBibHVlID8/XG5cbmxldCBmbGFncyA9ICdSbHB0IFRzJztcbmZvciAoY29uc3QgYXJnIG9mIGxvY2F0aW9uLmhhc2guc3Vic3RyaW5nKDEpLnNwbGl0KCcmJykpIHtcbiAgY29uc3QgW2tleSwgdmFsdWVdID0gYXJnLnNwbGl0KCc9Jyk7XG4gIGlmIChrZXkgPT09ICdmbGFncycpIHtcbiAgICBmbGFncyA9IGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSk7XG4gIH1cbn1cbi8vICAgJ3NwZWVkLWJvb3RzJzogdHJ1ZSxcbi8vICAgJ2dsaXRjaC1naGV0dG8tZmxpZ2h0JzogdHJ1ZSxcbi8vICAgJ2dsaXRjaC10YWxrJzogdHJ1ZSxcbi8vICAgJ3JvdXRlLW5vLWZyZWUtYmFycmllcic6IHRydWUsXG4vLyAgICdyb3V0ZS1zaHlyb24tdGVsZXBvcnQnOiB0cnVlLFxuLy8gICAncm91dGUtZWFybHktZmxpZ2h0JzogdHJ1ZSxcbi8vICAgJ3RyYWNrZXInOiB0cnVlLFxuLy8gfTtcblxuYXN5bmMgZnVuY3Rpb24gbWFpbigpIHtcbiAgY29uc3Qgcm9tID0gYXdhaXQgUm9tLmxvYWQoKTtcbiAgY29uc3QgdyA9IFdvcmxkLmJ1aWxkKHJvbSwgbmV3IEZsYWdTZXQoZmxhZ3MpKTsgLy8gKyAnIER0JykpO1xuICBmb3IgKGxldCBib3ggb2YgQk9YRVMuc3BsaXQoJ1xcbicpKSB7XG4gICAgYm94ID0gYm94LnJlcGxhY2UoLyMuKi8sICcnKS50cmltKCk7XG4gICAgaWYgKCFib3gpIGNvbnRpbnVlO1xuICAgIGdyYXBoLmFkZEJveCguLi5ib3guc3BsaXQoLyArL2cpKTtcbiAgfVxuICBmb3IgKGNvbnN0IHNsb3Qgb2YgU0xPVFMpIHtcbiAgICBncmFwaC5hZGRTbG90KC4uLnNsb3QpO1xuICB9XG4gIGdyYXBoLnVwZGF0ZSgpO1xuXG4gIGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0b2dnbGUtbWFwJykuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCAoKSA9PiB7XG4gICAgZ3JhcGgubWFwLmNsYXNzTGlzdC50b2dnbGUoJ2hpZGRlbicpO1xuICB9KTtcbiAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NsZWFyLWFsbCcpLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgKCkgPT4ge1xuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgZ3JhcGgucm91dGUubGVuZ3RoOyBpKyspIHtcbiAgICAgIGlmIChncmFwaC5yb3V0ZVtpXSA9PSAwKSBncmFwaC5yb3V0ZVtpXSA9IGdyYXBoLmFsd2F5cy5oYXMoaSkgPyAwIDogNDtcbiAgICB9XG4gICAgZ3JhcGguY2hlY2tlZC5jbGVhcigpO1xuICAgIGdyYXBoLnVwZGF0ZSgpO1xuICAgIGZvciAoY29uc3QgZWxlbWVudCBvZiBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKCcuc2xvdC5nb3QnKSkge1xuICAgICAgZWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKCdnb3QnKTtcbiAgICB9XG4gIH0pO1xufTtcblxubWFpbigpO1xuIl19