import { DEBUG_MODE_FLAGS } from './flags/debug-mode.js';
import { EASY_MODE_FLAGS } from './flags/easy-mode.js';
import { GLITCH_FIX_FLAGS } from './flags/glitch-fixes.js';
import { GLITCH_FLAGS } from './flags/glitches.js';
import { HARD_MODE_FLAGS } from './flags/hard-mode.js';
import { MONSTER_FLAGS } from './flags/monsters.js';
import { ROUTING_FLAGS } from './flags/routing.js';
import { SHOP_FLAGS } from './flags/shops.js';
import { TWEAK_FLAGS } from './flags/tweaks.js';
import { WORLD_FLAGS } from './flags/world.js';
import { EXPERIMENTAL_FLAGS } from './flags/experimental.js';
import { UsageError } from './util.js';
export const PRESETS = [
    {
        title: 'Casual',
        descr: `Basic flags for a relatively easy playthrough.`,
        flags: 'Ds Edmrstux Fw Mr Rp Tab',
    },
    {
        title: 'Intermediate',
        descr: `Slightly more challenge than Casual but still approachable.`,
        flags: 'Ds Edmsu Fsw Gt Mr Ps Rpt Tab',
        default: true,
    },
    {
        title: 'Full Shuffle',
        descr: `Slightly harder than intermediate, with full shuffle and no spoiler log.`,
        flags: 'Em Fsw Gt Mert Ps Rprt Tabmp Wmtuw Xegw',
    },
    {
        title: 'Glitchless',
        descr: `Full shuffle but with no glitches.`,
        flags: 'Em Fcpstw Mert Ps Rprt Tab Wmtuw Xcegw',
    },
    {
        title: 'Advanced',
        descr: `A balanced randomization with quite a bit more difficulty.`,
        flags: 'Fsw Gfprt Hbdgtw Mert Ps Roprst Tabmp Wmtuw Xcegw',
    },
    {
        title: 'Ludicrous',
        descr: `Pulls out all the stops, may require superhuman feats.`,
        flags: 'Fs Gcfprtw Hbdgmstwxz Mert Ps Roprst Tabmp Wmtuw Xcegw',
    },
    {
        title: 'Mattrick',
        descr: 'Not for the faint of heart. Good luck...',
        flags: 'Fcprsw Gt Hbdhtwx Mert Ps Ropst Tabmp Wmtuw',
    },
    {
        title: 'The Full Stupid',
        descr: 'Nobody has ever completed this.',
        flags: 'Fcprsw Hbdhmwtxz Mert Ps Ropst Sckmt Tab Wmtuw Xcegw',
    },
    {
        title: 'No Bow Mode',
        descr: 'The tower is open from the start, for whoever is ready for it.',
        flags: 'Fcprstw Ht Mert Ps Rbt Sckmt Tab Xcegw',
    },
    {
        title: 'Tournament: Swiss Round',
        descr: 'Quick-paced full-shuffle flags for Swiss round of 2019 Tournament',
        flags: 'Es Fcprsw Gt Hd Mr Ps Rpt Tab',
    },
    {
        title: 'Tournament: Elimination Round',
        descr: 'More thorough flags for the first elimination rounds of the 2019 Tournament',
        flags: 'Em Fprsw Gft Hbd Mer Ps Rprst Tab Wt',
    },
    {
        title: 'Tournament: Semifinals',
        descr: 'Advanced flags for semifinal round of the 2019 Tournament',
        flags: 'Em Fsw Gft Hbd Mert Ps Roprst Tab Wt',
    },
    {
        title: 'Tournament: Finals',
        descr: 'Expert flags for finals round of the 2019 Tournament',
        flags: 'Fsw Gfprt Hbdw Mert Ps Roprst Tab Wmtw',
    },
];
const PRESETS_BY_KEY = {};
for (const { title, flags } of PRESETS) {
    PRESETS_BY_KEY[`@${title.replace(/ /g, '').toLowerCase()}`] = flags;
}
export const FLAGS = [
    WORLD_FLAGS,
    EASY_MODE_FLAGS,
    MONSTER_FLAGS,
    SHOP_FLAGS,
    HARD_MODE_FLAGS,
    TWEAK_FLAGS,
    ROUTING_FLAGS,
    GLITCH_FLAGS,
    GLITCH_FIX_FLAGS,
    EXPERIMENTAL_FLAGS,
    DEBUG_MODE_FLAGS,
];
export class FlagSet {
    constructor(str = 'RtGftTab') {
        if (str.startsWith('@')) {
            const expanded = PRESETS_BY_KEY[str.toLowerCase()];
            if (!expanded)
                throw new UsageError(`Unknown preset: ${str}`);
            str = expanded;
        }
        this.flags = {};
        str = str.replace(/[^A-Za-z0-9!]/g, '');
        const re = /([A-Z])([a-z0-9!]+)/g;
        let match;
        while ((match = re.exec(str))) {
            const [, key, terms] = match;
            for (const term of terms) {
                this.set(key + term, true);
            }
        }
    }
    get(category) {
        return this.flags[category] || [];
    }
    set(flag, value) {
        const key = flag[0];
        const term = flag.substring(1);
        if (!value) {
            const filtered = (this.flags[key] || []).filter(t => t !== term);
            if (filtered.length) {
                this.flags[key] = filtered;
            }
            else {
                delete this.flags[key];
            }
            return;
        }
        this.removeConflicts(flag);
        const terms = (this.flags[key] || []).filter(t => t !== term);
        terms.push(term);
        terms.sort();
        this.flags[key] = terms;
    }
    check(flag) {
        const terms = this.flags[flag[0]];
        return !!(terms && (terms.indexOf(flag.substring(1)) >= 0));
    }
    preserveUniqueChecks() {
        return this.check('Eu');
    }
    shuffleMimics() {
        return !this.check('Et');
    }
    autoEquipBracelet() {
        return this.check('Ta');
    }
    buffDeosPendant() {
        return this.check('Tb');
    }
    changeGasMaskToHazmatSuit() {
        return this.check('Tb');
    }
    slowDownTornado() {
        return this.check('Tb');
    }
    leatherBootsGiveSpeed() {
        return this.check('Tb');
    }
    rabbitBootsChargeWhileWalking() {
        return this.check('Tb');
    }
    controllerShortcuts() {
        return !this.check('Tc');
    }
    randomizeMusic() {
        return this.check('Tm');
    }
    shuffleSpritePalettes() {
        return this.check('Tp');
    }
    shuffleMonsters() {
        return this.check('Mr');
    }
    shuffleShops() {
        return this.check('Ps');
    }
    bargainHunting() {
        return this.shuffleShops();
    }
    shuffleTowerMonsters() {
        return this.check('Mt');
    }
    shuffleMonsterElements() {
        return this.check('Me');
    }
    shuffleBossElements() {
        return this.shuffleMonsterElements();
    }
    doubleBuffMedicalHerb() {
        return this.check('Em');
    }
    buffMedicalHerb() {
        return !this.check('Hm');
    }
    decreaseEnemyDamage() {
        return this.check('Ed');
    }
    trainer() {
        return this.check('Dt');
    }
    neverDie() {
        return this.check('Di');
    }
    chargeShotsOnly() {
        return this.check('Hc');
    }
    barrierRequiresCalmSea() {
        return true;
    }
    paralysisRequiresPrisonKey() {
        return true;
    }
    sealedCaveRequiresWindmill() {
        return true;
    }
    connectLimeTreeToLeaf() {
        return this.check('Rp');
    }
    connectGoaToLeaf() {
        return this.check('Xe') && this.check('Xg');
    }
    removeEarlyWall() {
        return this.check('Xb');
    }
    zebuStudentGivesItem() {
        return !this.check('Xe') || this.check('Xc');
    }
    addEastCave() {
        return this.check('Xe');
    }
    addExtraChecksToEastCave() {
        return this.check('Xe') && this.check('Xc');
    }
    fogLampNotRequired() {
        return this.check('Xf');
    }
    storyMode() {
        return this.check('Rs');
    }
    noBowMode() {
        return this.check('Rb');
    }
    requireHealedDolphinToRide() {
        return this.check('Rd');
    }
    saharaRabbitsRequireTelepathy() {
        return this.check('Rr');
    }
    teleportOnThunderSword() {
        return this.check('Rt');
    }
    randomizeThunderTeleport() {
        return this.check('Xw');
    }
    orbsOptional() {
        return this.check('Ro');
    }
    randomizeMaps() {
        return this.check('Wm');
    }
    randomizeTrades() {
        return this.check('Wt');
    }
    unidentifiedItems() {
        return this.check('Wu');
    }
    randomizeWalls() {
        return this.check('Ww');
    }
    guaranteeSword() {
        return this.check('Es');
    }
    guaranteeSwordMagic() {
        return !this.check('Hw');
    }
    guaranteeMatchingSword() {
        return !this.check('Hs');
    }
    guaranteeGasMask() {
        return !this.check('Hg');
    }
    guaranteeBarrier() {
        return !this.check('Hb');
    }
    guaranteeRefresh() {
        return this.check('Er');
    }
    disableSwordChargeGlitch() {
        return this.check('Fc');
    }
    disableTeleportSkip() {
        return this.check('Fp');
    }
    disableRabbitSkip() {
        return this.check('Fr');
    }
    disableShopGlitch() {
        return this.check('Fs');
    }
    disableStatueGlitch() {
        return this.check('Ft');
    }
    disableFlightStatueSkip() {
        return false;
    }
    assumeSwordChargeGlitch() {
        return this.check('Gc');
    }
    assumeGhettoFlight() {
        return this.check('Gf');
    }
    assumeTeleportSkip() {
        return this.check('Gp');
    }
    assumeRabbitSkip() {
        return this.check('Gr');
    }
    assumeStatueGlitch() {
        return this.check('Gt');
    }
    assumeTriggerGlitch() {
        return false;
    }
    assumeFlightStatueSkip() {
        return false;
    }
    assumeWildWarp() {
        return this.check('Gw');
    }
    assumeRageSkip() {
        return false;
    }
    nerfWildWarp() {
        return this.check('Fw');
    }
    allowWildWarp() {
        return !this.nerfWildWarp();
    }
    randomizeWildWarp() {
        return this.check('Tw');
    }
    blackoutMode() {
        return this.check('Hz');
    }
    hardcoreMode() {
        return this.check('Hh');
    }
    buffDyna() {
        return this.check('Hd');
    }
    maxScalingInTower() {
        return this.check('Ht');
    }
    expScalingFactor() {
        return this.check('Hx') ? 0.25 : this.check('Ex') ? 2.5 : 1;
    }
    removeConflicts(flag) {
        const re = this.exclusiveFlags(flag);
        if (!re)
            return;
        for (const key in this.flags) {
            if (!this.flags.hasOwnProperty(key))
                continue;
            const terms = this.flags[key].filter(t => !re.test(key + t));
            if (terms.length) {
                this.flags[key] = terms;
            }
            else {
                delete this.flags[key];
            }
        }
    }
    toStringKey(key) {
        return key + [...this.flags[key]].sort().join('');
    }
    exclusiveFlags(flag) {
        const flagForName = this.getFlagForName(flag);
        if (flagForName == null)
            throw new Error(`Unknown flag: ${flag}`);
        return flagForName.conflict;
    }
    getFlagForName(flag) {
        const matchingFlagSection = FLAGS.find(flagSection => {
            return flag.startsWith(flagSection.prefix);
        });
        if (!matchingFlagSection)
            return undefined;
        return matchingFlagSection.flags
            .find(flagToMatch => flagToMatch.flag === flag);
    }
    toString() {
        const keys = Object.keys(this.flags);
        keys.sort();
        return keys.map(k => this.toStringKey(k)).join(' ');
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZmxhZ3NldC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9qcy9mbGFnc2V0LnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBQyxnQkFBZ0IsRUFBQyxNQUFNLHVCQUF1QixDQUFDO0FBQ3ZELE9BQU8sRUFBQyxlQUFlLEVBQUMsTUFBTSxzQkFBc0IsQ0FBQztBQUVyRCxPQUFPLEVBQUMsZ0JBQWdCLEVBQUMsTUFBTSx5QkFBeUIsQ0FBQztBQUN6RCxPQUFPLEVBQUMsWUFBWSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDakQsT0FBTyxFQUFDLGVBQWUsRUFBQyxNQUFNLHNCQUFzQixDQUFDO0FBQ3JELE9BQU8sRUFBQyxhQUFhLEVBQUMsTUFBTSxxQkFBcUIsQ0FBQztBQUNsRCxPQUFPLEVBQUMsYUFBYSxFQUFDLE1BQU0sb0JBQW9CLENBQUM7QUFDakQsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQzVDLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUM5QyxPQUFPLEVBQUMsV0FBVyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDN0MsT0FBTyxFQUFDLGtCQUFrQixFQUFDLE1BQU0seUJBQXlCLENBQUM7QUFDM0QsT0FBTyxFQUFDLFVBQVUsRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUVyQyxNQUFNLENBQUMsTUFBTSxPQUFPLEdBQWE7SUFDL0I7UUFDRSxLQUFLLEVBQUUsUUFBUTtRQUNmLEtBQUssRUFBRSxnREFBZ0Q7UUFDdkQsS0FBSyxFQUFFLDBCQUEwQjtLQUNsQztJQUNEO1FBQ0UsS0FBSyxFQUFFLGNBQWM7UUFDckIsS0FBSyxFQUFFLDZEQUE2RDtRQUNwRSxLQUFLLEVBQUUsK0JBQStCO1FBQ3RDLE9BQU8sRUFBRSxJQUFJO0tBQ2Q7SUFDRDtRQUNFLEtBQUssRUFBRSxjQUFjO1FBQ3JCLEtBQUssRUFDRCwwRUFBMEU7UUFDOUUsS0FBSyxFQUFFLHlD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QUFLLElBQUksQ0FBQyxDQUFDO0lBQ3RELENBQUM7SUFFRCxRQUFRO1FBQ04sTUFBTSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUM7UUFDckMsSUFBSSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ1osT0FBTyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUN0RCxDQUFDO0NBQ0YiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0RFQlVHX01PREVfRkxBR1N9IGZyb20gJy4vZmxhZ3MvZGVidWctbW9kZS5qcyc7XG5pbXBvcnQge0VBU1lfTU9ERV9GTEFHU30gZnJvbSAnLi9mbGFncy9lYXN5LW1vZGUuanMnO1xuaW1wb3J0IHtGbGFnLCBGbGFnU2VjdGlvbiwgUHJlc2V0fSBmcm9tICcuL2ZsYWdzL2ZsYWcuanMnO1xuaW1wb3J0IHtHTElUQ0hfRklYX0ZMQUdTfSBmcm9tICcuL2ZsYWdzL2dsaXRjaC1maXhlcy5qcyc7XG5pbXBvcnQge0dMSVRDSF9GTEFHU30gZnJvbSAnLi9mbGFncy9nbGl0Y2hlcy5qcyc7XG5pbXBvcnQge0hBUkRfTU9ERV9GTEFHU30gZnJvbSAnLi9mbGFncy9oYXJkLW1vZGUuanMnO1xuaW1wb3J0IHtNT05TVEVSX0ZMQUdTfSBmcm9tICcuL2ZsYWdzL21vbnN0ZXJzLmpzJztcbmltcG9ydCB7Uk9VVElOR19GTEFHU30gZnJvbSAnLi9mbGFncy9yb3V0aW5nLmpzJztcbmltcG9ydCB7U0hPUF9GTEFHU30gZnJvbSAnLi9mbGFncy9zaG9wcy5qcyc7XG5pbXBvcnQge1RXRUFLX0ZMQUdTfSBmcm9tICcuL2ZsYWdzL3R3ZWFrcy5qcyc7XG5pbXBvcnQge1dPUkxEX0ZMQUdTfSBmcm9tICcuL2ZsYWdzL3dvcmxkLmpzJztcbmltcG9ydCB7RVhQRVJJTUVOVEFMX0ZMQUdTfSBmcm9tICcuL2ZsYWdzL2V4cGVyaW1lbnRhbC5qcyc7XG5pbXBvcnQge1VzYWdlRXJyb3J9IGZyb20gJy4vdXRpbC5qcyc7XG5cbmV4cG9ydCBjb25zdCBQUkVTRVRTOiBQcmVzZXRbXSA9IFtcbiAge1xuICAgIHRpdGxlOiAnQ2FzdWFsJyxcbiAgICBkZXNjcjogYEJhc2ljIGZsYWdzIGZvciBhIHJlbGF0aXZlbHkgZWFzeSBwbGF5dGhyb3VnaC5gLFxuICAgIGZsYWdzOiAnRHMgRWRtcnN0dXggRncgTXIgUnAgVGFiJyxcbiAgfSxcbiAge1xuICAgIHRpdGxlOiAnSW50ZXJtZWRpYXRlJyxcbiAgICBkZXNjcjogYFNsaWdodGx5IG1vcmUgY2hhbGxlbmdlIHRoYW4gQ2FzdWFsIGJ1dCBzdGlsbCBhcHByb2FjaGFibGUuYCxcbiAgICBmbGFnczogJ0RzIEVkbXN1IEZzdyBHdCBNciBQcyBScHQgVGFiJyxcbiAgICBkZWZhdWx0OiB0cnVlLFxuICB9LFxuICB7XG4gICAgdGl0bGU6ICdGdWxsIFNodWZmbGUnLFxuICAgIGRlc2NyOlxuICAgICAgICBgU2xpZ2h0bHkgaGFyZGVyIHRoYW4gaW50ZXJtZWRpYXRlLCB3aXRoIGZ1bGwgc2h1ZmZsZSBhbmQgbm8gc3BvaWxlciBsb2cuYCxcbiAgICBmbGFnczogJ0VtIEZzdyBHdCBNZXJ0IFBzIFJwcnQgVGFibXAgV210dXcgWGVndycsXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogJ0dsaXRjaGxlc3MnLFxuICAgIGRlc2NyOiBgRnVsbCBzaHVmZmxlIGJ1dCB3aXRoIG5vIGdsaXRjaGVzLmAsXG4gICAgZmxhZ3M6ICdFbSBGY3BzdHcgTWVydCBQcyBScHJ0IFRhYiBXbXR1dyBYY2VndycsXG4gIH0sXG4gIHtcbiAgICB0aXRsZTogJ0FkdmFuY2VkJyxcbiAgICBkZXNjcjogYEEgYmFsYW5jZWQgcmFuZG9taXphdGlvbiB3aXRoIHF1aXRlIGEgYml0IG1vcmUgZGlmZmljdWx0eS5gLFxuICAgIGZsYWdzOiAnRnN3IEdmcHJ0IEhiZGd0dyBNZXJ0IFBzIFJvcHJzdCBUYWJtcCBXbXR1dyBYY2VndycsXG4gIH0sXG4gIHtcbiAgICAvLyBUT0RPOiBhZGQgJ0h0J1xuICAgIHRpdGxlOiAnTHVkaWNyb3VzJyxcbiAgICBkZXNjcjogYFB1bGxzIG91dCBhbGwgdGhlIHN0b3BzLCBtYXkgcmVxdWlyZSBzdXBlcmh1bWFuIGZlYXRzLmAsXG4gICAgZmxhZ3M6ICdGcyBHY2ZwcnR3IEhiZGdtc3R3eHogTWVydCBQcyBSb3Byc3QgVGFibXAgV210dXcgWGNlZ3cnLFxuICB9LFxuICB7XG4gICAgdGl0bGU6ICdNYXR0cmljaycsXG4gICAgZGVzY3I6ICdOb3QgZm9yIHRoZSBmYWludCBvZiBoZWFydC4gR29vZCBsdWNrLi4uJyxcbiAgICBmbGFnczogJ0ZjcHJzdyBHdCBIYmRodHd4IE1lcnQgUHMgUm9wc3QgVGFibXAgV210dXcnLFxuICB9LFxuICB7XG4gICAgdGl0bGU6ICdUaGUgRnVsbCBTdHVwaWQnLFxuICAgIGRlc2NyOiAnTm9ib2R5IGhhcyBldmVyIGNvbXBsZXRlZCB0aGlzLicsXG4gICAgZmxhZ3M6ICdGY3Byc3cgSGJkaG13dHh6IE1lcnQgUHMgUm9wc3QgU2NrbXQgVGFiIFdtdHV3IFhjZWd3JyxcbiAgfSxcbiAge1xuICAgIHRpdGxlOiAnTm8gQm93IE1vZGUnLFxuICAgIGRlc2NyOiAnVGhlIHRvd2VyIGlzIG9wZW4gZnJvbSB0aGUgc3RhcnQsIGZvciB3aG9ldmVyIGlzIHJlYWR5IGZvciBpdC4nLFxuICAgIGZsYWdzOiAnRmNwcnN0dyBIdCBNZXJ0IFBzIFJidCBTY2ttdCBUYWIgWGNlZ3cnLFxuICB9LFxuICAvLyBUT1VSTkFNRU5UIFBSRVNFVFNcbiAge1xuICAgIHRpdGxlOiAnVG91cm5hbWVudDogU3dpc3MgUm91bmQnLFxuICAgIGRlc2NyOiAnUXVpY2stcGFjZWQgZnVsbC1zaHVmZmxlIGZsYWdzIGZvciBTd2lzcyByb3VuZCBvZiAyMDE5IFRvdXJuYW1lbnQnLFxuICAgIGZsYWdzOiAnRXMgRmNwcnN3IEd0IEhkIE1yIFBzIFJwdCBUYWInLFxuICB9LFxuICB7XG4gICAgdGl0bGU6ICdUb3VybmFtZW50OiBFbGltaW5hdGlvbiBSb3VuZCcsXG4gICAgZGVzY3I6ICdNb3JlIHRob3JvdWdoIGZsYWdzIGZvciB0aGUgZmlyc3QgZWxpbWluYXRpb24gcm91bmRzIG9mIHRoZSAyMDE5IFRvdXJuYW1lbnQnLFxuICAgIGZsYWdzOiAnRW0gRnByc3cgR2Z0IEhiZCBNZXIgUHMgUnByc3QgVGFiIFd0JyxcbiAgfSxcbiAge1xuICAgIHRpdGxlOiAnVG91cm5hbWVudDogU2VtaWZpbmFscycsXG4gICAgZGVzY3I6ICdBZHZhbmNlZCBmbGFncyBmb3Igc2VtaWZpbmFsIHJvdW5kIG9mIHRoZSAyMDE5IFRvdXJuYW1lbnQnLFxuICAgIGZsYWdzOiAnRW0gRnN3IEdmdCBIYmQgTWVydCBQcyBSb3Byc3QgVGFiIFd0JyxcbiAgfSxcbiAge1xuICAgIHRpdGxlOiAnVG91cm5hbWVudDogRmluYWxzJyxcbiAgICBkZXNjcjogJ0V4cGVydCBmbGFncyBmb3IgZmluYWxzIHJvdW5kIG9mIHRoZSAyMDE5IFRvdXJuYW1lbnQnLFxuICAgIGZsYWdzOiAnRnN3IEdmcHJ0IEhiZHcgTWVydCBQcyBSb3Byc3QgVGFiIFdtdHcnLFxuICB9LFxuXTtcblxuLy8gSnVzdCB0aGUgZmxhZ3MsIG5vdCB0aGUgd2hvbGUgZG9jdW1lbnRhdGlvbi5cbmNvbnN0IFBSRVNFVFNfQllfS0VZOiB7W2tleTogc3RyaW5nXTogc3RyaW5nfSA9IHt9O1xuZm9yIChjb25zdCB7dGl0bGUsIGZsYWdzfSBvZiBQUkVTRVRTKSB7XG4gIFBSRVNFVFNfQllfS0VZW2BAJHt0aXRsZS5yZXBsYWNlKC8gL2csICcnKS50b0xvd2VyQ2FzZSgpfWBdID0gZmxhZ3M7XG59XG5cbmV4cG9ydCBjb25zdCBGTEFHUzogRmxhZ1NlY3Rpb25bXSA9IFtcbiAgV09STERfRkxBR1MsXG4gIEVBU1lfTU9ERV9GTEFHUyxcbiAgTU9OU1RFUl9GTEFHUyxcbiAgU0hPUF9GTEFHUyxcbiAgSEFSRF9NT0RFX0ZMQUdTLFxuICBUV0VBS19GTEFHUyxcbiAgUk9VVElOR19GTEFHUyxcbiAgR0xJVENIX0ZMQUdTLFxuICBHTElUQ0hfRklYX0ZMQUdTLFxuICBFWFBFUklNRU5UQUxfRkxBR1MsXG4gIERFQlVHX01PREVfRkxBR1MsXG5dO1xuXG5leHBvcnQgY2xhc3MgRmxhZ1NldCB7XG4gIHByaXZhdGUgZmxhZ3M6IHtbc2VjdGlvbjogc3RyaW5nXTogc3RyaW5nW119O1xuXG4gIGNvbnN0cnVjdG9yKHN0ciA9ICdSdEdmdFRhYicpIHtcbiAgICBpZiAoc3RyLnN0YXJ0c1dpdGgoJ0AnKSkge1xuICAgICAgY29uc3QgZXhwYW5kZWQgPSBQUkVTRVRTX0JZX0tFWVtzdHIudG9Mb3dlckNhc2UoKV07XG4gICAgICBpZiAoIWV4cGFuZGVkKSB0aHJvdyBuZXcgVXNhZ2VFcnJvcihgVW5rbm93biBwcmVzZXQ6ICR7c3RyfWApO1xuICAgICAgc3RyID0gZXhwYW5kZWQ7XG4gICAgfVxuICAgIHRoaXMuZmxhZ3MgPSB7fTtcbiAgICAvLyBwYXJzZSB0aGUgc3RyaW5nXG4gICAgc3RyID0gc3RyLnJlcGxhY2UoL1teQS1aYS16MC05IV0vZywgJycpO1xuICAgIGNvbnN0IHJlID0gLyhbQS1aXSkoW2EtejAtOSFdKykvZztcbiAgICBsZXQgbWF0Y2g7XG4gICAgd2hpbGUgKChtYXRjaCA9IHJlLmV4ZWMoc3RyKSkpIHtcbiAgICAgIGNvbnN0IFssIGtleSwgdGVybXNdID0gbWF0Y2g7XG4gICAgICBmb3IgKGNvbnN0IHRlcm0gb2YgdGVybXMpIHtcbiAgICAgICAgdGhpcy5zZXQoa2V5ICsgdGVybSwgdHJ1ZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZ2V0KGNhdGVnb3J5OiBzdHJpbmcpOiBzdHJpbmdbXSB7XG4gICAgcmV0dXJuIHRoaXMuZmxhZ3NbY2F0ZWdvcnldIHx8IFtdO1xuICB9XG5cbiAgc2V0KGZsYWc6IHN0cmluZywgdmFsdWU6IGJvb2xlYW4pIHtcbiAgICAvLyBjaGVjayBmb3IgaW5jb21wYXRpYmxlIGZsYWdzLi4uP1xuICAgIGNvbnN0IGtleSA9IGZsYWdbMF07XG4gICAgY29uc3QgdGVybSA9IGZsYWcuc3Vic3RyaW5nKDEpOyAgLy8gYXNzZXJ0OiB0ZXJtIGlzIG9ubHkgbGV0dGVycy9udW1iZXJzXG4gICAgaWYgKCF2YWx1ZSkge1xuICAgICAgLy8gSnVzdCBkZWxldGUgLSB0aGF0J3MgZWFzeS5cbiAgICAgIGNvbnN0IGZpbHRlcmVkID0gKHRoaXMuZmxhZ3Nba2V5XSB8fCBbXSkuZmlsdGVyKHQgPT4gdCAhPT0gdGVybSk7XG4gICAgICBpZiAoZmlsdGVyZWQubGVuZ3RoKSB7XG4gICAgICAgIHRoaXMuZmxhZ3Nba2V5XSA9IGZpbHRlcmVkO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuZmxhZ3Nba2V5XTtcbiAgICAgIH1cbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgLy8gQWN0dWFsbHkgYWRkIHRoZSBmbGFnLlxuICAgIHRoaXMucmVtb3ZlQ29uZmxpY3RzKGZsYWcpO1xuICAgIGNvbnN0IHRlcm1zID0gKHRoaXMuZmxhZ3Nba2V5XSB8fCBbXSkuZmlsdGVyKHQgPT4gdCAhPT0gdGVybSk7XG4gICAgdGVybXMucHVzaCh0ZXJtKTtcbiAgICB0ZXJtcy5zb3J0KCk7XG4gICAgdGhpcy5mbGFnc1trZXldID0gdGVybXM7XG4gIH1cblxuICBjaGVjayhmbGFnOiBzdHJpbmcpOiBib29sZWFuIHtcbiAgICBjb25zdCB0ZXJtcyA9IHRoaXMuZmxhZ3NbZmxhZ1swXV07XG4gICAgcmV0dXJuICEhKHRlcm1zICYmICh0ZXJtcy5pbmRleE9mKGZsYWcuc3Vic3RyaW5nKDEpKSA+PSAwKSk7XG4gIH1cblxuICBwcmVzZXJ2ZVVuaXF1ZUNoZWNrcygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnRXUnKTtcbiAgfVxuICBzaHVmZmxlTWltaWNzKCkge1xuICAgIHJldHVybiAhdGhpcy5jaGVjaygnRXQnKTtcbiAgfVxuXG4gIGF1dG9FcXVpcEJyYWNlbGV0KCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdUYScpO1xuICB9XG4gIGJ1ZmZEZW9zUGVuZGFudCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnVGInKTtcbiAgfVxuICBjaGFuZ2VHYXNNYXNrVG9IYXptYXRTdWl0KCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdUYicpO1xuICB9XG4gIHNsb3dEb3duVG9ybmFkbygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnVGInKTtcbiAgfVxuICBsZWF0aGVyQm9vdHNHaXZlU3BlZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1RiJyk7XG4gIH1cbiAgcmFiYml0Qm9vdHNDaGFyZ2VXaGlsZVdhbGtpbmcoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1RiJyk7XG4gIH1cbiAgY29udHJvbGxlclNob3J0Y3V0cygpIHtcbiAgICByZXR1cm4gIXRoaXMuY2hlY2soJ1RjJyk7XG4gIH1cbiAgcmFuZG9taXplTXVzaWMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1RtJyk7XG4gIH1cbiAgc2h1ZmZsZVNwcml0ZVBhbGV0dGVzKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdUcCcpO1xuICB9XG5cbiAgc2h1ZmZsZU1vbnN0ZXJzKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdNcicpO1xuICB9XG4gIHNodWZmbGVTaG9wcygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnUHMnKTtcbiAgfVxuICBiYXJnYWluSHVudGluZygpIHtcbiAgICByZXR1cm4gdGhpcy5zaHVmZmxlU2hvcHMoKTtcbiAgfVxuXG4gIHNodWZmbGVUb3dlck1vbnN0ZXJzKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdNdCcpO1xuICB9XG4gIHNodWZmbGVNb25zdGVyRWxlbWVudHMoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ01lJyk7XG4gIH1cbiAgc2h1ZmZsZUJvc3NFbGVtZW50cygpIHtcbiAgICByZXR1cm4gdGhpcy5zaHVmZmxlTW9uc3RlckVsZW1lbnRzKCk7XG4gIH1cblxuICBkb3VibGVCdWZmTWVkaWNhbEhlcmIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0VtJyk7XG4gIH1cbiAgYnVmZk1lZGljYWxIZXJiKCkge1xuICAgIHJldHVybiAhdGhpcy5jaGVjaygnSG0nKTtcbiAgfVxuICBkZWNyZWFzZUVuZW15RGFtYWdlKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdFZCcpO1xuICB9XG4gIHRyYWluZXIoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0R0Jyk7XG4gIH1cbiAgbmV2ZXJEaWUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0RpJyk7XG4gIH1cbiAgY2hhcmdlU2hvdHNPbmx5KCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdIYycpO1xuICB9XG5cbiAgYmFycmllclJlcXVpcmVzQ2FsbVNlYSgpIHtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gdGhpcy5jaGVjaygnUmwnKTtcbiAgfVxuICBwYXJhbHlzaXNSZXF1aXJlc1ByaXNvbktleSgpIHtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gdGhpcy5jaGVjaygnUmwnKTtcbiAgfVxuICBzZWFsZWRDYXZlUmVxdWlyZXNXaW5kbWlsbCgpIHtcbiAgICByZXR1cm4gdHJ1ZTsgLy8gdGhpcy5jaGVjaygnUmwnKTtcbiAgfVxuICBjb25uZWN0TGltZVRyZWVUb0xlYWYoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1JwJyk7XG4gIH1cbiAgY29ubmVjdEdvYVRvTGVhZigpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnWGUnKSAmJiB0aGlzLmNoZWNrKCdYZycpO1xuICB9XG4gIHJlbW92ZUVhcmx5V2FsbCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnWGInKTtcbiAgfVxuICB6ZWJ1U3R1ZGVudEdpdmVzSXRlbSgpIHtcbiAgICByZXR1cm4gIXRoaXMuY2hlY2soJ1hlJykgfHwgdGhpcy5jaGVjaygnWGMnKTtcbiAgfVxuICBhZGRFYXN0Q2F2ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnWGUnKTtcbiAgfVxuICBhZGRFeHRyYUNoZWNrc1RvRWFzdENhdmUoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1hlJykgJiYgdGhpcy5jaGVjaygnWGMnKTtcbiAgfVxuICBmb2dMYW1wTm90UmVxdWlyZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1hmJyk7XG4gIH1cbiAgc3RvcnlNb2RlKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdScycpO1xuICB9XG4gIG5vQm93TW9kZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnUmInKTtcbiAgfVxuICByZXF1aXJlSGVhbGVkRG9scGhpblRvUmlkZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnUmQnKTtcbiAgfVxuICBzYWhhcmFSYWJiaXRzUmVxdWlyZVRlbGVwYXRoeSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnUnInKTtcbiAgfVxuICB0ZWxlcG9ydE9uVGh1bmRlclN3b3JkKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdSdCcpO1xuICB9XG4gIHJhbmRvbWl6ZVRodW5kZXJUZWxlcG9ydCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnWHcnKTtcbiAgfVxuICBvcmJzT3B0aW9uYWwoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ1JvJyk7XG4gIH1cblxuICByYW5kb21pemVNYXBzKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdXbScpO1xuICB9XG4gIHJhbmRvbWl6ZVRyYWRlcygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnV3QnKTtcbiAgfVxuICB1bmlkZW50aWZpZWRJdGVtcygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnV3UnKTtcbiAgfVxuICByYW5kb21pemVXYWxscygpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnV3cnKTtcbiAgfVxuXG4gIGd1YXJhbnRlZVN3b3JkKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdFcycpO1xuICB9XG4gIGd1YXJhbnRlZVN3b3JkTWFnaWMoKSB7XG4gICAgcmV0dXJuICF0aGlzLmNoZWNrKCdIdycpO1xuICB9XG4gIGd1YXJhbnRlZU1hdGNoaW5nU3dvcmQoKSB7XG4gICAgcmV0dXJuICF0aGlzLmNoZWNrKCdIcycpO1xuICB9XG4gIGd1YXJhbnRlZUdhc01hc2soKSB7XG4gICAgcmV0dXJuICF0aGlzLmNoZWNrKCdIZycpO1xuICB9XG4gIGd1YXJhbnRlZUJhcnJpZXIoKSB7XG4gICAgcmV0dXJuICF0aGlzLmNoZWNrKCdIYicpO1xuICB9XG4gIGd1YXJhbnRlZVJlZnJlc2goKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0VyJyk7XG4gIH1cblxuICBkaXNhYmxlU3dvcmRDaGFyZ2VHbGl0Y2goKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0ZjJyk7XG4gIH1cbiAgZGlzYWJsZVRlbGVwb3J0U2tpcCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnRnAnKTtcbiAgfVxuICBkaXNhYmxlUmFiYml0U2tpcCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnRnInKTtcbiAgfVxuICBkaXNhYmxlU2hvcEdsaXRjaCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnRnMnKTtcbiAgfVxuICBkaXNhYmxlU3RhdHVlR2xpdGNoKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdGdCcpO1xuICB9XG4gIGRpc2FibGVGbGlnaHRTdGF0dWVTa2lwKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuXG4gIGFzc3VtZVN3b3JkQ2hhcmdlR2xpdGNoKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdHYycpO1xuICB9XG4gIGFzc3VtZUdoZXR0b0ZsaWdodCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnR2YnKTtcbiAgfVxuICBhc3N1bWVUZWxlcG9ydFNraXAoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0dwJyk7XG4gIH1cbiAgYXNzdW1lUmFiYml0U2tpcCgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnR3InKTtcbiAgfVxuICBhc3N1bWVTdGF0dWVHbGl0Y2goKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0d0Jyk7XG4gIH1cbiAgYXNzdW1lVHJpZ2dlckdsaXRjaCgpIHtcbiAgICByZXR1cm4gZmFsc2U7IC8vIFRPRE8gLSBvbmx5IHdvcmtzIG9uIGxhbmQ/XG4gIH1cbiAgYXNzdW1lRmxpZ2h0U3RhdHVlU2tpcCgpIHtcbiAgICByZXR1cm4gZmFsc2U7IC8vIFRPRE8gLSBhbGxvdyBhIGZsYWcgdG8gZGlzYWJsZVxuICB9XG4gIGFzc3VtZVdpbGRXYXJwKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdHdycpO1xuICB9XG4gIGFzc3VtZVJhZ2VTa2lwKCkge1xuICAgIHJldHVybiBmYWxzZTsgLy8gVE9ETyAtIG5lZWQgdG8gY2hlY2sgZm9yIGEgZmx5ZXIgdG8gdGhlIHNvdXRoP1xuICB9XG5cbiAgbmVyZldpbGRXYXJwKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdGdycpO1xuICB9XG4gIGFsbG93V2lsZFdhcnAoKSB7XG4gICAgcmV0dXJuICF0aGlzLm5lcmZXaWxkV2FycCgpO1xuICB9XG4gIHJhbmRvbWl6ZVdpbGRXYXJwKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdUdycpO1xuICB9XG5cbiAgYmxhY2tvdXRNb2RlKCkge1xuICAgIHJldHVybiB0aGlzLmNoZWNrKCdIeicpO1xuICB9XG4gIGhhcmRjb3JlTW9kZSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnSGgnKTtcbiAgfVxuICBidWZmRHluYSgpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnSGQnKTtcbiAgfVxuICBtYXhTY2FsaW5nSW5Ub3dlcigpIHtcbiAgICByZXR1cm4gdGhpcy5jaGVjaygnSHQnKTtcbiAgfVxuXG4gIGV4cFNjYWxpbmdGYWN0b3IoKSB7XG4gICAgcmV0dXJuIHRoaXMuY2hlY2soJ0h4JykgPyAwLjI1IDogdGhpcy5jaGVjaygnRXgnKSA/IDIuNSA6IDE7XG4gIH1cblxuICAvLyBUaGUgZm9sbG93aW5nIGRpZG4ndCBlbmQgdXAgZ2V0dGluZyB1c2VkLlxuXG4gIC8vIGFsbG93cyhmbGFnKSB7XG4gIC8vICAgY29uc3QgcmUgPSBleGNsdXNpdmVGbGFncyhmbGFnKTtcbiAgLy8gICBpZiAoIXJlKSByZXR1cm4gdHJ1ZTtcbiAgLy8gICBmb3IgKGNvbnN0IGtleSBpbiB0aGlzLmZsYWdzKSB7XG4gIC8vICAgICBpZiAodGhpcy5mbGFnc1trZXldLmZpbmQodCA9PiByZS50ZXN0KGtleSArIHQpKSkgcmV0dXJuIGZhbHNlO1xuICAvLyAgIH1cbiAgLy8gICByZXR1cm4gdHJ1ZTtcbiAgLy8gfVxuXG4gIC8vIG1lcmdlKHRoYXQpIHtcbiAgLy8gICB0aGlzLmZsYWdzID0gdGhhdC5mbGFncztcbiAgLy8gfVxuXG4gIHByaXZhdGUgcmVtb3ZlQ29uZmxpY3RzKGZsYWc6IHN0cmluZykge1xuICAgIC8vIE5PVEU6IHRoaXMgaXMgc29tZXdoYXQgcmVkdW5kYW50IHdpdGggc2V0KGZsYWcsIGZhbHNlKVxuICAgIGNvbnN0IHJlID0gdGhpcy5leGNsdXNpdmVGbGFncyhmbGFnKTtcbiAgICBpZiAoIXJlKSByZXR1cm47XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGhpcy5mbGFncykge1xuICAgICAgaWYgKCF0aGlzLmZsYWdzLmhhc093blByb3BlcnR5KGtleSkpIGNvbnRpbnVlO1xuICAgICAgY29uc3QgdGVybXMgPSB0aGlzLmZsYWdzW2tleV0uZmlsdGVyKHQgPT4gIXJlLnRlc3Qoa2V5ICsgdCkpO1xuICAgICAgaWYgKHRlcm1zLmxlbmd0aCkge1xuICAgICAgICB0aGlzLmZsYWdzW2tleV0gPSB0ZXJtcztcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGRlbGV0ZSB0aGlzLmZsYWdzW2tleV07XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSB0b1N0cmluZ0tleShrZXk6IHN0cmluZykge1xuICAgIHJldHVybiBrZXkgKyBbLi4udGhpcy5mbGFnc1trZXldXS5zb3J0KCkuam9pbignJyk7XG4gIH1cblxuICBwcml2YXRlIGV4Y2x1c2l2ZUZsYWdzKGZsYWc6IHN0cmluZyk6IFJlZ0V4cHx1bmRlZmluZWQge1xuICAgIGNvbnN0IGZsYWdGb3JOYW1lID0gdGhpcy5nZXRGbGFnRm9yTmFtZShmbGFnKTtcbiAgICBpZiAoZmxhZ0Zvck5hbWUgPT0gbnVsbCkgdGhyb3cgbmV3IEVycm9yKGBVbmtub3duIGZsYWc6ICR7ZmxhZ31gKTtcbiAgICByZXR1cm4gZmxhZ0Zvck5hbWUuY29uZmxpY3Q7XG4gIH1cblxuICBwcml2YXRlIGdldEZsYWdGb3JOYW1lKGZsYWc6IHN0cmluZyk6IEZsYWd8dW5kZWZpbmVkIHtcbiAgICBjb25zdCBtYXRjaGluZ0ZsYWdTZWN0aW9uID0gRkxBR1MuZmluZChmbGFnU2VjdGlvbiA9PiB7XG4gICAgICByZXR1cm4gZmxhZy5zdGFydHNXaXRoKGZsYWdTZWN0aW9uLnByZWZpeCk7XG4gICAgfSk7XG4gICAgaWYgKCFtYXRjaGluZ0ZsYWdTZWN0aW9uKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIHJldHVybiBtYXRjaGluZ0ZsYWdTZWN0aW9uLmZsYWdzXG4gICAgICAgIC5maW5kKGZsYWdUb01hdGNoID0+IGZsYWdUb01hdGNoLmZsYWcgPT09IGZsYWcpO1xuICB9XG5cbiAgdG9TdHJpbmcoKSB7XG4gICAgY29uc3Qga2V5cyA9IE9iamVjdC5rZXlzKHRoaXMuZmxhZ3MpO1xuICAgIGtleXMuc29ydCgpO1xuICAgIHJldHVybiBrZXlzLm1hcChrID0+IHRoaXMudG9TdHJpbmdLZXkoaykpLmpvaW4oJyAnKTtcbiAgfVxufVxuIl19