import { Maze } from './maze.js';
import { SWAMP_SCREENS, readScreen, write2d } from './spec.js';
import { Dir, Pos } from './types.js';
import { Monster } from '../rom/monster.js';
import { hex } from '../rom/util.js';
export function shuffleSwamp(rom, random, attempts = 100) {
    extendSwampScreens(rom);
    const swamp = rom.locations.Swamp;
    const w = swamp.width;
    const h = swamp.height;
    const extraTiles = [SCR_U, SCR_D, SCR_UD, SCR_DR, SCR_URD, SCR_LR];
    const available = [0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x7b, 0x7d, 0x7e];
    for (let attempt = 0; attempt < attempts; attempt) {
        const maze = new Maze(random, h, w, SWAMP_SCREENS, extraTiles);
        if (!tryShuffleSwamp(rom, random, swamp, maze, available))
            continue;
        return;
    }
    console.error(`Failed to shuhffle swamp after ${attempts} attempts.`);
}
function tryShuffleSwamp(rom, random, swamp, maze, available) {
    const w = maze.width;
    const h = maze.height;
    const [boss, entrance] = (() => {
        let boss;
        let entrance;
        do {
            boss = random.nextInt(w);
            entrance = random.nextInt(h);
        } while (boss < 2 || entrance < 2);
        return [boss, (entrance << 4)];
    })();
    maze.setBorder(entrance, Dir.LEFT, 1);
    maze.set(boss, 0xf1f0, { force: true });
    maze.set((boss - 1), 0x00f0, { force: true });
    maze.set((boss + 1), 0xf000, { force: true });
    maze.fillAll({ edge: 1 });
    const entranceRoute = entrance << 8 | 0x10;
    function check() {
        const traversal = maze.traverse();
        const main = traversal.get(entranceRoute);
        return main && main.size === traversal.size || false;
    }
    const allPos = [...maze].map(s => s[0]);
    for (let i = Math.floor(0.6 * w * h); i; i--) {
        const pos = random.pick(allPos);
        const dir = random.pick(Dir.ALL);
        const pos2 = Pos.plus(pos, dir);
        if (maze.isFixed(pos) || maze.isFixed(pos2) ||
            !(maze.get(pos) & Dir.edgeMask(dir))) {
            i++;
            continue;
        }
        maze.saveExcursion(() => {
            if (!maze.replaceEdge(pos, dir, 0))
                return false;
            return !!(maze.get(pos) && maze.get(pos2) && check());
        });
    }
    if (!maze.consolidate(available, check, rom))
        return false;
    const [oak, alt] = random.pick([...maze.alternates()]);
    if (alt != 65536)
        throw new Error(`unexpected alt: ${hex(alt)}`);
    maze.replace(oak, (maze.get(oak) | alt));
    swamp.moveScreen(0x30, entrance);
    swamp.moveScreen(0x04, boss);
    maze.write(swamp, new Set());
    const deadEnds = [];
    const bends = [];
    for (const [pos, scr] of maze) {
        if (pos === boss || pos === oak)
            continue;
        if (scr === 0x0001 || scr === 0x0010 || scr === 0x0100 || scr === 0x1000) {
            deadEnds.push(pos);
        }
        if (scr === 0x0011 || scr === 0x0110 || scr === 0x1100 || scr === 0x1001) {
            bends.push(pos);
        }
    }
    const oakScreenTiles = rom.screens[swamp.screens[oak >> 4][oak & 0xf]].tiles;
    let oakTile = 0;
    for (let t = 0; t < 0xf0; t++) {
        if (oakScreenTiles[t] === 3) {
            oakTile = t;
            break;
        }
    }
    swamp.entrances[1].screen = oak;
    swamp.entrances[1].tile = oakTile + 0x11;
    for (let i = 0; i < 2; i++) {
        swamp.exits[5 + i].screen = oak;
        swamp.exits[5 + i].tile = oakTile + i;
    }
    const child = random.pick(deadEnds.length ? deadEnds : bends);
    swamp.spawns[1].screen = child;
    const monsterPlacer = swamp.monsterPlacer(random);
    for (const spawn of swamp.spawns) {
        if (!spawn.isMonster())
            continue;
        const monster = rom.objects[spawn.monsterId];
        if (!(monster instanceof Monster))
            continue;
        const pos = monsterPlacer(monster);
        if (pos == null) {
            console.error(`no valid location for ${hex(monster.id)} in ${hex(swamp.id)}`);
            spawn.used = false;
            continue;
        }
        else {
            spawn.screen = pos >>> 8;
            spawn.tile = pos & 0xff;
        }
    }
    if (rom.spoiler)
        rom.spoiler.addMaze(swamp.id, swamp.name, maze.show());
    return true;
}
const SCR_U = readScreen(`c8 c8 c8 c8 cf f6 c7 ad c4 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b8 b9 c3 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b7 b8 ad ad d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 c2 c3 b7 b8 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 c2 b7 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 ad ad b9 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 ad ad ad ad d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b9 b8 ad ad d2 e2 c8 c8 c8 c8
     c8 c8 c8 c8 e3 f6 c3 c3 b8 b6 d2 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 e3 fd ad ad fc e2 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 ff fb fb fa c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8`);
const SCR_D = readScreen(`c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 cd c9 c9 ca c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 cd eb a0 a0 cb ca c8 c8 c8 c8 c8
     c8 c8 c8 c8 cf a0 f9 f5 f7 f8 cb cc c8 c8 c8 c8
     c8 c8 c8 c8 cf a0 ed 08 09 a0 a0 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf db ee 0c 0b ef a0 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d0 d1 03 03 d8 db cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 c7 ad ad ae d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 ad b9 b7 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 c2 c3 c3 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 c5 c3 c3 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 c2 c3 c3 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b8 b6 b6 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b7 b7 b7 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b7 b7 b8 b6 d2 cc c8 c8 c8 c8`);
const SCR_UD = readScreen(`c8 c8 c8 c8 cf d3 b6 b6 c6 b6 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 c3 c7 b6 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f5 c3 c7 b6 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 b6 c6 c5 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 b6 c6 c3 c7 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f5 c3 c3 c3 c3 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 ad c2 c3 c3 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 c4 c5 c3 c3 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f5 b7 b7 b8 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 c2 b8 b6 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 b6 c2 b7 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d9 b6 b6 b6 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b7 b7 b8 b6 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b9 b7 b7 b7 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 b7 b7 c7 b6 d2 cc c8 c8 c8 c8`);
const SCR_DR = readScreen(`c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 cd c9 c9 c9 c9 c9 c9 c9 c9 c9
     c8 c8 c8 c8 c8 cd a0 a0 a0 e8 04 a0 e8 a0 a0 e4
     c8 c8 c8 c8 cf f8 a0 f0 f1 f5 f5 f7 e9 f4 f7 e5
     c8 c8 c8 c8 cf f6 f7 f8 f2 ea 06 aa e9 f0 f1 e6
     c8 c8 c8 c8 cf a0 dd e0 f3 e0 07 0c ea db f3 e7
     c8 c8 c8 c8 cf db d5 d0 d1 d1 03 03 d0 d1 da da
     c8 c8 c8 c8 cf d5 af c4 c4 ad ad ad ad ad c4 ad
     c8 c8 c8 c8 cf d3 b9 c3 c3 b8 ad ad ad c2 b7 b8
     c8 c8 c8 c8 cf f6 c3 c3 c3 c3 b8 ad ad ad ad ad
     c8 c8 c8 c8 cf f6 c7 ad c2 c3 c7 fc fb fb fb fb
     c8 c8 c8 c8 cf d3 ad ad ad ad d6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b9 b8 ad b9 f6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf f6 c7 ad b9 c7 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 b9 c3 b8 d2 cc c8 c8 c8 c8`);
const SCR_URD = readScreen(`c8 c8 c8 c8 cf d3 c4 c3 c3 c3 f7 f8 ca c8 c8 c8
     c8 c8 c8 c8 cf f5 c3 c3 c3 c3 f7 f7 a0 ca c9 c9
     c8 c8 c8 c8 cf f6 c3 c3 b8 b6 d2 cf cf e8 e4 a0
     c8 c8 c8 c8 cf f5 b7 c3 b7 b8 d2 f0 f1 e9 e5 cf
     c8 c8 c8 c8 cf d3 c2 b8 c2 b8 d8 db cf ea e6 cf
     c8 c8 c8 c8 cf d3 ad ad ad ad ae d4 f3 dd e7 cf
     c8 c8 c8 c8 cf d3 ad ad ad ad ad ae d0 d1 d0 d1
     c8 c8 c8 c8 cf d3 c2 c3 c3 b7 b8 ad ad ad ad ad
     c8 c8 c8 c8 cf d3 ad ad c2 b7 b7 b7 b8 c4 ad ad
     c8 c8 c8 c8 cf d3 ad ad b6 b9 b7 b7 b7 b7 b8 ad
     c8 c8 c8 c8 cf d3 ad c4 c3 b7 b8 fc fb fb fb fb
     c8 c8 c8 c8 cf d3 b6 ad ad ad d6 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 ad ad ad ad d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 c4 c3 b7 b8 d2 cc c8 c8 c8 c8
     c8 c8 c8 c8 cf d3 b6 b9 b7 b7 f6 cc c8 c8 c8 c8`);
const SCR_LR = readScreen(`c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9 c9
     a0 e4 e8 eb e4 a0 a0 a0 eb eb e8 f0 f1 a0 e4 a0
     a0 e5 e9 f9 f5 f6 f6 f7 ec f9 f7 f8 f2 a0 e5 a0
     a0 e6 f0 f1 e6 e0 08 09 ed de ea de f2 a0 e6 a0
     db e7 db f3 e7 e1 0c 0b dd df e0 df f3 db e7 e0
     d0 d1 da da d0 d1 03 03 d0 d1 d0 d1 da da da da
     ad c4 ad ad ad ad ad ad ad ad ad ad ad ad ad ad
     c2 c5 b8 c6 c4 c4 b9 c7 c4 c5 c5 c7 ad ad ad ad
     ad ad ad ad c2 c3 c3 c3 c3 c3 c7 ad ad ad ad ad
     fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8
     c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8 c8`);
export function extendSwampScreens(rom) {
    const ts = rom.metatilesets.swamp;
    ts.getTile(0x03).copyFrom(0xda).setAlternative(0xac);
    ts.getTile(0x04).copyFrom(0xe4).setAlternative(0xaa);
    ts.getTile(0x05).copyFrom(0xe5).setAlternative(0xaa);
    ts.getTile(0x06).copyFrom(0xe6).setAlternative(0xaa);
    ts.getTile(0x07).copyFrom(0xe7).setAlternative(0xaa);
    ts.getTile(0x08).copyFrom(0xf0).setAlternative(0xaa);
    ts.getTile(0x09).copyFrom(0xf1).setAlternative(0xaa);
    ts.getTile(0x0a).copyFrom(0xf2).setAlternative(0xaa);
    ts.getTile(0x0b).copyFrom(0xf3).setAlternative(0xaa);
    ts.getTile(0x0c).copyFrom(0xdc).setAlternative(0xaa);
    ts.getTile(0x0d).copyFrom(0xdd).setAlternative(0xaa);
    rom.swapMetatiles([0xa0], [[0x03, 0xac], ~0xda], [[0x04, 0xaa], ~0xe4], [[0x05, 0xaa], ~0xe5], [[0x06, 0xaa], ~0xe6], [[0x07, 0xaa], ~0xe7], [[0x08, 0xaa], ~0xf0], [[0x09, 0xaa], ~0xf1], [[0x0a, 0xaa], ~0xf2], [[0x0b, 0xaa], ~0xf3], [[0x0c, 0xaa], ~0xdc], [[0x0d, 0xaa], ~0xdd]);
    write2d(rom.screens[0x7f].tiles, 0x00, [
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xa8, 0xcc],
        [0xd2, 0xcc],
        [0xd2, 0xcc],
        [0xd2, 0xcc],
        [0xd2, 0xe2],
        [0xe2, 0xc8],
    ]);
    write2d(rom.screens[0x76].tiles, 0x4c, [
        [0x08, 0x09],
        [0x0c, 0x0b],
        [0x03, 0x03],
    ]);
    write2d(rom.screens[0x7a].tiles, 0x25, [
        [, , 0x04],
        [0x08, 0x09, 0x05],
        [, 0x0a, 0x06],
        [, 0x0b, 0x07],
        [, 0x03, 0x03],
    ]);
    write2d(rom.screens[0x7b].tiles, 0x24, [
        [0x04],
        [],
        [0x06],
        [0x07, 0x0d],
        [0x03, 0x03],
    ]);
    write2d(rom.screens[0x7e].tiles, 0x47, [
        [0x08, 0x09],
        [0x0c, 0x0b],
        [0x03, 0x03],
    ]);
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic3dhbXAuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi9zcmMvanMvbWF6ZS9zd2FtcC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0sV0FBVyxDQUFDO0FBQy9CLE9BQU8sRUFBQyxhQUFhLEVBQUUsVUFBVSxFQUFFLE9BQU8sRUFBQyxNQUFNLFdBQVcsQ0FBQztBQUM3RCxPQUFPLEVBQUMsR0FBRyxFQUFFLEdBQUcsRUFBTSxNQUFNLFlBQVksQ0FBQztBQUl6QyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDMUMsT0FBTyxFQUFDLEdBQUcsRUFBQyxNQUFNLGdCQUFnQixDQUFDO0FBR25DLE1BQU0sVUFBVSxZQUFZLENBQUMsR0FBUSxFQUFFLE1BQWMsRUFBRSxRQUFRLEdBQUcsR0FBRztJQUVuRSxrQkFBa0IsQ0FBQyxHQUFHLENBQUMsQ0FBQztJQUV4QixNQUFNLEtBQUssR0FBRyxHQUFHLENBQUMsU0FBUyxDQUFDLEtBQUssQ0FBQztJQUVsQyxNQUFNLENBQUMsR0FBRyxLQUFLLENBQUMsS0FBSyxDQUFDO0lBQ3RCLE1BQU0sQ0FBQyxHQUFHLEtBQUssQ0FBQyxNQUFNLENBQUM7SUFPdkIsTUFBTSxVQUFVLEdBQUcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsT0FBTyxFQUFFLE1BQU0sQ0FBQyxDQUFDO0lBQ25FLE1BQU0sU0FBUyxHQUFHLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztJQUd6RSxLQUFLLElBQUksT0FBTyxHQUFHLENBQUMsRUFBRSxPQUFPLEdBQUcsUUFBUSxFQUFFLE9BQU8sRUFBRTtRQUNqRCxNQUFNLElBQUksR0FBRyxJQUFJLElBQUksQ0FBQyxNQUFNLEVB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QztJQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFDckQsRUFBRSxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ3JELEVBQUUsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNyRCxFQUFFLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxjQUFjLENBQUMsSUFBSSxDQUFDLENBQUM7SUFPckQsR0FBRyxDQUFDLGFBQWEsQ0FBQyxDQUFDLElBQUksQ0FBQyxFQUNOLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFDckIsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUNyQixDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQ3JCLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFDckIsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUNyQixDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQ3JCLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFDckIsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxFQUNyQixDQUFDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsSUFBSSxDQUFDLEVBQ3JCLENBQUMsQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLEVBQUUsQ0FBQyxJQUFJLENBQUMsRUFDckIsQ0FBQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsRUFBRSxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFLekMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUMsS0FBSyxFQUFFLElBQUksRUFBRTtRQUNyQyxDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7S0FDYixDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFO1FBQ3JDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztLQUNiLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUU7UUFDckMsQ0FBSyxBQUFKLEVBQVUsQUFBTCxFQUFPLElBQUksQ0FBQztRQUNsQixDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO1FBQ2xCLENBQUssQUFBSixFQUFNLElBQUksRUFBRSxJQUFJLENBQUM7UUFDbEIsQ0FBSyxBQUFKLEVBQU0sSUFBSSxFQUFFLElBQUksQ0FBQztRQUNsQixDQUFLLEFBQUosRUFBTSxJQUFJLEVBQUUsSUFBSSxDQUFDO0tBQ25CLENBQUMsQ0FBQztJQUVILE9BQU8sQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLElBQUksQ0FBQyxDQUFDLEtBQUssRUFBRSxJQUFJLEVBQUU7UUFDckMsQ0FBQyxJQUFJLENBQU87UUFDWixFQUFZO1FBQ1osQ0FBQyxJQUFJLENBQU87UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7UUFDWixDQUFDLElBQUksRUFBRSxJQUFJLENBQUM7S0FDYixDQUFDLENBQUM7SUFFSCxPQUFPLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxLQUFLLEVBQUUsSUFBSSxFQUFFO1FBQ3JDLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLElBQUksQ0FBQztLQUNiLENBQUMsQ0FBQztBQUNMLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge01hemV9IGZyb20gJy4vbWF6ZS5qcyc7XG5pbXBvcnQge1NXQU1QX1NDUkVFTlMsIHJlYWRTY3JlZW4sIHdyaXRlMmR9IGZyb20gJy4vc3BlYy5qcyc7XG5pbXBvcnQge0RpciwgUG9zLCBTY3J9IGZyb20gJy4vdHlwZXMuanMnO1xuaW1wb3J0IHtSYW5kb219IGZyb20gJy4uL3JhbmRvbS5qcyc7XG5pbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7TG9jYXRpb259IGZyb20gJy4uL3JvbS9sb2NhdGlvbi5qcyc7XG5pbXBvcnQge01vbnN0ZXJ9IGZyb20gJy4uL3JvbS9tb25zdGVyLmpzJztcbmltcG9ydCB7aGV4fSBmcm9tICcuLi9yb20vdXRpbC5qcyc7XG5cbi8vIFRPRE8gLSBhZGQgYSBzcG9pbGVyIGFyZ3VtZW50IGFuZCBkcmF3IG1hcCBpbnRvIGl0P1xuZXhwb3J0IGZ1bmN0aW9uIHNodWZmbGVTd2FtcChyb206IFJvbSwgcmFuZG9tOiBSYW5kb20sIGF0dGVtcHRzID0gMTAwKTogdm9pZCB7XG4gIC8vIDEuIFN0YXJ0IGJ5IGZpeGluZyB1cCB0aGUgc3dhbXAgdGlsZXMgKG5vdGU6IHdlIGNvdWxkIHBvc3NpYmx5IHdhaXQgb24gdGhpcykuXG4gIGV4dGVuZFN3YW1wU2NyZWVucyhyb20pO1xuXG4gIGNvbnN0IHN3YW1wID0gcm9tLmxvY2F0aW9ucy5Td2FtcDtcblxuICBjb25zdCB3ID0gc3dhbXAud2lkdGg7XG4gIGNvbnN0IGggPSBzd2FtcC5oZWlnaHQ7XG5cbiAgLy8gVE9ETyAtIGlmIHdlIHdhbnRlZCB0byB1c2UgdXAgc29tZSBvZiB0aGUgZXh0cmEgc3BhY2UgKHNlZSBub3Rlcy9jb21wcmVzc2lvbiksXG4gIC8vIGhvdyB3b3VsZCB3ZSBzaWduaWZ5IHRoaXMgLSBpLmUuIHdlIG5lZWQgdG8gaW5jcmVhc2UgdGhlIHVwcGVyIGJvdW5kIG9uIHRoZVxuICAvLyBudW1iZXIgb2YgdW5pcXVlIHNjcmVlbnMgZnJvbSA5IHRvIDkrTi4gIFBvc3NpYmx5IHRoaXMgaXMgYW4gYXJndW1lbnQgdG8gdGhlXG4gIC8vIGNvbnNvbGlkYXRlKCkgZnVuY3Rpb24/ICBNYXliZSBpdCB0YWtlcyBhIGxpc3Qgb2YgdGlsZXMgdG8gY29uc29saWRhdGUgd2l0aFxuICAvLyB0aGUgZXh0cmEgb25lcz9cbiAgY29uc3QgZXh0cmFUaWxlcyA9IFtTQ1JfVSwgU0NSX0QsIFNDUl9VRCwgU0NSX0RSLCBTQ1JfVVJELCBTQ1JfTFJdO1xuICBjb25zdCBhdmFpbGFibGUgPSBbMHg3NSwgMHg3NiwgMHg3NywgMHg3OCwgMHg3OSwgMHg3YSwgMHg3YiwgMHg3ZCwgMHg3ZV07XG5cbiAgLy8gQ29sbGVjdCB0aGUgYXZhaWxhYmxlIHNjcmVlbnMgKDdjIGlzIGJvc3Mgcm9vbSwgN2YgaXMgc29saWQpXG4gIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDwgYXR0ZW1wdHM7IGF0dGVtcHQpIHtcbiAgICBjb25zdCBtYXplID0gbmV3IE1hemUocmFuZG9tLCBoLCB3LCBTV0FNUF9TQ1JFRU5TLCBleHRyYVRpbGVzKTtcbiAgICBpZiAoIXRyeVNodWZmbGVTd2FtcChyb20sIHJhbmRvbSwgc3dhbXAsIG1hemUsIGF2YWlsYWJsZSkpIGNvbnRpbnVlO1xuICAgIFxuICAgIHJldHVybjtcbiAgfVxuICBjb25zb2xlLmVycm9yKGBGYWlsZWQgdG8gc2h1aGZmbGUgc3dhbXAgYWZ0ZXIgJHthdHRlbXB0c30gYXR0ZW1wdHMuYCk7XG59XG5cblxuZnVuY3Rpb24gdHJ5U2h1ZmZsZVN3YW1wKHJvbTogUm9tLCByYW5kb206IFJhbmRvbSwgc3dhbXA6IExvY2F0aW9uLFxuICAgICAgICAgICAgICAgICAgICAgICAgIG1hemU6IE1hemUsIGF2YWlsYWJsZTogbnVtYmVyW10pOiBib29sZWFuIHtcbiAgY29uc3QgdyA9IG1hemUud2lkdGg7XG4gIGNvbnN0IGggPSBtYXplLmhlaWdodDtcblxuICAvLyBUT0RPIC0gQWxsb3cgb3RoZXIgZW50cmFuY2VzPyAgTWF5YmUgcmVhZCBleGlzdGluZyBlbnRyYW5jZXNcbiAgLy8gYW5kIHJlc3BvbmQgdG8gYW4gZWFybGllciBwYXNzIHRoYXQgc2h1ZmZsZWQgaXQ/XG4gIGNvbnN0IFtib3NzLCBlbnRyYW5jZV0gPSAoKCkgPT4ge1xuICAgIGxldCBib3NzO1xuICAgIGxldCBlbnRyYW5jZTtcbiAgICBkbyB7XG4gICAgICBib3NzID0gcmFuZG9tLm5leHRJbnQodyk7XG4gICAgICBlbnRyYW5jZSA9IHJhbmRvbS5uZXh0SW50KGgpO1xuICAgIH0gd2hpbGUgKGJvc3MgPCAyIHx8IGVudHJhbmNlIDwgMik7XG4gICAgcmV0dXJuIFtib3NzIGFzIFBvcywgKGVudHJhbmNlIDw8IDQpIGFzIFBvc107XG4gIH0pKCk7XG4gIG1hemUuc2V0Qm9yZGVyKGVudHJhbmNlLCBEaXIuTEVGVCwgMSk7XG5cbiAgLy8gU2V0IHVwIGJvdW5kYXJ5LCBib3NzLCBhbmQgZW50cmFuY2VcbiAgbWF6ZS5zZXQoYm9zcywgMHhmMWYwIGFzIFNjciwge2ZvcmNlOiB0cnVlfSk7XG4gIG1hemUuc2V0KChib3NzIC0gMSkgYXMgUG9zLCAweDAwZjAgYXMgU2NyLCB7Zm9yY2U6IHRydWV9KTtcbiAgbWF6ZS5zZXQoKGJvc3MgKyAxKSBhcyBQb3MsIDB4ZjAwMCBhcyBTY3IsIHtmb3JjZTogdHJ1ZX0pO1xuICBtYXplLmZpbGxBbGwoe2VkZ2U6IDF9KTtcbiAgLy8gZm9yIChsZXQgeSA9IDA7IHkgPCBoOyB5KyspIHtcbiAgLy8gICBmb3IgKGxldCB4ID0gMDsgeCA8IHc7IHgrKykge1xuICAvLyAgICAgY29uc3QgcG9zID0gKHkgPDwgNCB8IHgpIGFzIFBvcztcbiAgLy8gICAgIGlmIChwb3MgPT09IGJvc3MpIHtcbiAgLy8gICAgIC8vIH0gZWxzZSBpZiAocG9zID09PSBib3NzIC0gMSkge1xuICAvLyAgICAgLy8gICBtYXplLnNldChwb3MsIDB4MDBmMCBhcyBTY3IpO1xuICAvLyAgICAgLy8gfSBlbHNlIGlmIChwb3MgPT09IGJvc3MgKyAxKSB7XG4gIC8vICAgICAvLyAgIG1hemUuc2V0KHBvcywgMHhmMDAwIGFzIFNjcik7XG4gIC8vICAgICB9IGVsc2Uge1xuICAvLyAgICAgICBpZiAoIW1hemUuZmlsbChwb3MsIHtlZGdlOiAxfSkpIHtcbiAgLy8gICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYENvdWxkIG5vdCBpbml0aWFsaXplICR7aGV4KHBvcyl9YCk7XG4gIC8vICAgICAgIH1cbiAgLy8gICAgIH1cbiAgLy8gICB9XG4gIC8vIH1cblxuICAvLyBBdHRlbXB0IHRvIGFkZCB3Kmggd2FsbHNcbiAgY29uc3QgZW50cmFuY2VSb3V0ZSA9IGVudHJhbmNlIDw8IDggfCAweDEwOyAvLyBUT0RPIC0gaGFuZGxlIG9wcG9zaXRlIHNpZGVzP1xuICAvLyBjb25zdCBib3NzUm91dGUgPSAoYm9zcyArIDE2KSA8PCA4IHwgMHgwMTtcbiAgZnVuY3Rpb24gY2hlY2soKTogYm9vbGVhbiB7XG4gICAgY29uc3QgdHJhdmVyc2FsID0gbWF6ZS50cmF2ZXJzZSgpO1xuICAgIGNvbnN0IG1haW4gPSB0cmF2ZXJzYWwuZ2V0KGVudHJhbmNlUm91dGUpO1xuICAgIHJldHVybiBtYWluICYmIG1haW4uc2l6ZSA9PT0gdHJhdmVyc2FsLnNpemUgfHwgZmFsc2U7XG4gICAgLy8gcmV0dXJuIG1haW4gJiYgbWFpbi5oYXMoYm9zc1JvdXRlKSB8fCBmYWxzZTtcbiAgfVxuXG4gIGNvbnN0IGFsbFBvcyA9IFsuLi5tYXplXS5tYXAocyA9PiBzWzBdKTtcbiAgZm9yIChsZXQgaSA9IE1hdGguZmxvb3IoMC42ICogdyAqIGgpOyBpOyBpLS0pIHtcbiAgICBjb25zdCBwb3MgPSByYW5kb20ucGljayhhbGxQb3MpO1xuICAgIGNvbnN0IGRpciA9IHJhbmRvbS5waWNrKERpci5BTEwpO1xuICAgIGNvbnN0IHBvczIgPSBQb3MucGx1cyhwb3MsIGRpcik7XG4gICAgaWYgKG1hemUuaXNGaXhlZChwb3MpIHx8IG1hemUuaXNGaXhlZChwb3MyKSB8fFxuICAgICAgICAhKG1hemUuZ2V0KHBvcykhICYgRGlyLmVkZ2VNYXNrKGRpcikpKSB7XG4gICAgICBpKys7IC8vIHRyeSBhZ2FpblxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIG1hemUuc2F2ZUV4Y3Vyc2lvbigoKSA9PiB7XG4gICAgICBpZiAoIW1hemUucmVwbGFjZUVkZ2UocG9zLCBkaXIsIDApKSByZXR1cm4gZmFsc2U7XG4gICAgICByZXR1cm4gISEobWF6ZS5nZXQocG9zKSAmJiBtYXplLmdldChwb3MyKSAmJiBjaGVjaygpKTtcbiAgICAgIC8vICB8fCAoKCkgPT4geyBjb25zb2xlLmxvZyhgZmFpbGVkXFxuJHttYXplLnNob3coKX1gKTsgcmV0dXJuIGZhbHNlOyB9KSgpO1xuICAgIH0pO1xuICAgIC8vIGNvbnNvbGUubG9nKG1hemUuc2hvdygpKTtcbiAgfVxuXG4gIC8vIE5lZWQgdG8gY29uc29saWRhdGUuXG4gIGlmICghbWF6ZS5jb25zb2xpZGF0ZShhdmFpbGFibGUsIGNoZWNrLCByb20pKSByZXR1cm4gZmFsc2U7XG5cbiAgLy8gRmluZCBhIGZsYWdnYWJsZSBzY3JlZW4gZm9yIHRoZSBPYWsgZW50cmFuY2UuXG4gIGNvbnN0IFtvYWssIGFsdF0gPSByYW5kb20ucGljayhbLi4ubWF6ZS5hbHRlcm5hdGVzKCldKTtcbiAgaWYgKGFsdCAhPSAweDFfMDAwMCkgdGhyb3cgbmV3IEVycm9yKGB1bmV4cGVjdGVkIGFsdDogJHtoZXgoYWx0KX1gKTtcbiAgbWF6ZS5yZXBsYWNlKG9haywgKG1hemUuZ2V0KG9haykhIHwgYWx0KSBhcyBTY3IpO1xuXG4gIC8vIFNldCBldmVyeXRoaW5nXG4gIHN3YW1wLm1vdmVTY3JlZW4oMHgzMCwgZW50cmFuY2UpO1xuICBzd2FtcC5tb3ZlU2NyZWVuKDB4MDQsIGJvc3MpO1xuICBtYXplLndyaXRlKHN3YW1wLCBuZXcgU2V0KCkpO1xuXG4gIC8vIGNvbnNvbGUubG9nKG1hemUuc2hvdygpKTtcblxuICAvLyBBbmFseXplIHNjcmVlbnNcbiAgY29uc3QgZGVhZEVuZHMgPSBbXTtcbiAgY29uc3QgYmVuZHMgPSBbXTtcbiAgZm9yIChjb25zdCBbcG9zLCBzY3JdIG9mIG1hemUpIHtcbiAgICBpZiAocG9zID09PSBib3NzIHx8IHBvcyA9PT0gb2FrKSBjb250aW51ZTtcbiAgICBpZiAoc2NyID09PSAweDAwMDEgfHwgc2NyID09PSAweDAwMTAgfHwgc2NyID09PSAweDAxMDAgfHwgc2NyID09PSAweDEwMDApIHtcbiAgICAgIGRlYWRFbmRzLnB1c2gocG9zKTtcbiAgICB9XG4gICAgaWYgKHNjciA9PT0gMHgwMDExIHx8IHNjciA9PT0gMHgwMTEwIHx8IHNjciA9PT0gMHgxMTAwIHx8IHNjciA9PT0gMHgxMDAxKSB7XG4gICAgICBiZW5kcy5wdXNoKHBvcyk7XG4gICAgfVxuICB9XG5cbiAgLy8gTW92ZSBvYWsgZXhpdCAtIG5lZWQgdG8gZmluZCB0aGUgcmlnaHQgc3BvdC5cbiAgICAvLyBmb3IgKGxldCBpID0gMDsgaSA8IDB4ZjsgaSsrKSB7XG4gICAgLy8gICBjb25zdCBzY3JlZW4gPSBzY3JlZW5zW2ldO1xuICAgIC8vICAgaWYgKHNjcmVlbiA9PSBudWxsKSBjb250aW51ZTtcbiAgICAvLyAgIGNvbnN0IHRpbGVzID0gcm9tLnNjcmVlbnNbc2NyZWVuXS50aWxlcztcbiAgICAvLyAgIGZvciAobGV0IHQgPSAwOyB0IDwgMjQwOyB0KyspIHtcbiAgICAvLyAgICAgaWYgKHRpbGVzW3RdID09PSAzICYmIHRpbGVzW3QgLSAxXSAhPT0gMykgZXhpdFNjcmVlbnMuc2V0KGksIHQpO1xuICAgIC8vICAgICBpZiAodGlsZXNbdF0gPT09IDB4ZjApIHtcbiAgICAvLyAgICAgICBsZXQgYXJyID0gcHVmZlNwb3RzLmdldChpKTtcbiAgICAvLyAgICAgICBpZiAoIWFycikgcHVmZlNwb3RzLnNldChpLCBhcnIgPSBbXSk7XG4gICAgLy8gICAgICAgYXJyLnB1c2godCk7XG4gICAgLy8gICAgIH1cbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgY29uc3Qgb2FrU2NyZWVuVGlsZXMgPSByb20uc2NyZWVuc1tzd2FtcC5zY3JlZW5zW29hayA+PiA0XVtvYWsgJiAweGZdXS50aWxlcztcbiAgbGV0IG9ha1RpbGUgPSAwO1xuICBmb3IgKGxldCB0ID0gMDsgdCA8IDB4ZjA7IHQrKykge1xuICAgIGlmIChvYWtTY3JlZW5UaWxlc1t0XSA9PT0gMykge1xuICAgICAgb2FrVGlsZSA9IHQ7XG4gICAgICBicmVhaztcbiAgICB9XG4gIH1cbiAgc3dhbXAuZW50cmFuY2VzWzFdLnNjcmVlbiA9IG9haztcbiAgc3dhbXAuZW50cmFuY2VzWzFdLnRpbGUgPSBvYWtUaWxlICsgMHgxMTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCAyOyBpKyspIHtcbiAgICBzd2FtcC5leGl0c1s1ICsgaV0uc2NyZWVuID0gb2FrO1xuICAgIHN3YW1wLmV4aXRzWzUgKyBpXS50aWxlID0gb2FrVGlsZSArIGk7XG4gIH1cblxuICAvLyBQbGFjZSBjaGlsZCBpbiBhIGRlYWQgZW5kIChpZiBwb3NzaWJsZSkgb3IgYXQgbGVhc3QgYSBiZW5kXG4gIGNvbnN0IGNoaWxkID0gcmFuZG9tLnBpY2soZGVhZEVuZHMubGVuZ3RoID8gZGVhZEVuZHMgOiBiZW5kcyk7XG4gIHN3YW1wLnNwYXduc1sxXS5zY3JlZW4gPSBjaGlsZDtcblxuICAvLyBNb3ZlIG1vbnN0ZXJzIHRvIHJlYXNvbmFibGUgcGxhY2VzLlxuICBjb25zdCBtb25zdGVyUGxhY2VyID0gc3dhbXAubW9uc3RlclBsYWNlcihyYW5kb20pO1xuICBmb3IgKGNvbnN0IHNwYXduIG9mIHN3YW1wLnNwYXducykge1xuICAgIGlmICghc3Bhd24uaXNNb25zdGVyKCkpIGNvbnRpbnVlO1xuICAgIGNvbnN0IG1vbnN0ZXIgPSByb20ub2JqZWN0c1tzcGF3bi5tb25zdGVySWRdO1xuICAgIGlmICghKG1vbnN0ZXIgaW5zdGFuY2VvZiBNb25zdGVyKSkgY29udGludWU7XG4gICAgY29uc3QgcG9zID0gbW9uc3RlclBsYWNlcihtb25zdGVyKTtcbiAgICBpZiAocG9zID09IG51bGwpIHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoYG5vIHZhbGlkIGxvY2F0aW9uIGZvciAke2hleChtb25zdGVyLmlkKX0gaW4gJHtoZXgoc3dhbXAuaWQpfWApO1xuICAgICAgc3Bhd24udXNlZCA9IGZhbHNlO1xuICAgICAgY29udGludWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIHNwYXduLnNjcmVlbiA9IHBvcyA+Pj4gODtcbiAgICAgIHNwYXduLnRpbGUgPSBwb3MgJiAweGZmO1xuICAgIH1cbiAgfVxuXG4gIGlmIChyb20uc3BvaWxlcikgcm9tLnNwb2lsZXIuYWRkTWF6ZShzd2FtcC5pZCwgc3dhbXAubmFtZSwgbWF6ZS5zaG93KCkpO1xuICByZXR1cm4gdHJ1ZTtcbn1cblxuLy8gb3BlbiB1cHdhcmQsIGRlYWQgZW5kXG5jb25zdCBTQ1JfVSA9IHJlYWRTY3JlZW4oXG4gICAgYGM4IGM4IGM4IGM4IGNmIGY2IGM3IGFkIGM0IGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY2IGI4IGI5IGMzIGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY2IGI3IGI4IGFkIGFkIGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGMyIGMzIGI3IGI4IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI2IGMyIGI3IGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGI5IGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGFkIGFkIGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI5IGI4IGFkIGFkIGQyIGUyIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGUzIGY2IGMzIGMzIGI4IGI2IGQyIGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGUzIGZkIGFkIGFkIGZjIGUyIGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGM4IGZmIGZiIGZiIGZhIGM4IGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4IGM4YCk7XG4vLyBvcGVuIGRvd253YXJkLCBkZWFkIGVuZCAoZG9vcilcbmNvbnN0IFNDUl9EID0gcmVhZFNjcmVlbihcbiAgICBgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggYzggYzggY2QgYzkgYzkgY2EgYzggYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggYzggY2QgZWIgYTAgYTAgY2IgY2EgYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgYTAgZjkgZjUgZjcgZjggY2IgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgYTAgZWQgMDggMDkgYTAgYTAgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZGIgZWUgMGMgMGIgZWYgYTAgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZDAgZDEgMDMgMDMgZDggZGIgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZjYgYzcgYWQgYWQgYWUgZDIgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZDMgYWQgYjkgYjcgYjcgZjYgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZDMgYzIgYzMgYzMgYjcgZjYgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZjYgYzUgYzMgYzMgYjcgZjYgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZDMgYjYgYzIgYzMgYzMgZjYgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZjYgYjggYjYgYjYgYjYgZDIgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZjYgYjcgYjcgYjcgYjcgZjYgY2MgYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggY2YgZjYgYjcgYjcgYjggYjYgZDIgY2MgYzggYzggYzggYzhgKTtcbi8vIHZlcnRpY2FsIHBhc3NhZ2VcbmNvbnN0IFNDUl9VRCA9IHJlYWRTY3JlZW4oXG4gICAgYGM4IGM4IGM4IGM4IGNmIGQzIGI2IGI2IGM2IGI2IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI2IGMzIGM3IGI2IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY1IGMzIGM3IGI2IGI2IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI2IGI2IGM2IGM1IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGI2IGM2IGMzIGM3IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY1IGMzIGMzIGMzIGMzIGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGFkIGMyIGMzIGMzIGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGM0IGM1IGMzIGMzIGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY1IGI3IGI3IGI4IGI2IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGMyIGI4IGI2IGI2IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGI2IGMyIGI3IGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQ5IGI2IGI2IGI2IGI2IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY2IGI3IGI3IGI4IGI2IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI5IGI3IGI3IGI3IGY2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY2IGI3IGI3IGM3IGI2IGQyIGNjIGM4IGM4IGM4IGM4YCk7XG4vLyBkb3duLXJpZ2h0IG9wZW5pbmdzICh0dXJuIHJpZ2h0KSwgd2l0aCBkb29yXG5jb25zdCBTQ1JfRFIgPSByZWFkU2NyZWVuKFxuICAgIGBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOCBjOFxuICAgICBjOCBjOCBjOCBjOCBjOCBjOCBjZCBjOSBjOSBjOSBjOSBjOSBjOSBjOSBjOSBjOVxuICAgICBjOCBjOCBjOCBjOCBjOCBjZCBhMCBhMCBhMCBlOCAwNCBhMCBlOCBhMCBhMCBlNFxuICAgICBjOCBjOCBjOCBjOCBjZiBmOCBhMCBmMCBmMSBmNSBmNSBmNyBlOSBmNCBmNyBlNVxuICAgICBjOCBjOCBjOCBjOCBjZiBmNiBmNyBmOCBmMiBlYSAwNiBhYSBlOSBmMCBmMSBlNlxuICAgICBjOCBjOCBjOCBjOCBjZiBhMCBkZCBlMCBmMyBlMCAwNyAwYyBlYSBkYiBmMyBlN1xuICAgICBjOCBjOCBjOCBjOCBjZiBkYiBkNSBkMCBkMSBkMSAwMyAwMyBkMCBkMSBkYSBkYVxuICAgICBjOCBjOCBjOCBjOCBjZiBkNSBhZiBjNCBjNCBhZCBhZCBhZCBhZCBhZCBjNCBhZFxuICAgICBjOCBjOCBjOCBjOCBjZiBkMyBiOSBjMyBjMyBiOCBhZCBhZCBhZCBjMiBiNyBiOFxuICAgICBjOCBjOCBjOCBjOCBjZiBmNiBjMyBjMyBjMyBjMyBiOCBhZCBhZCBhZCBhZCBhZFxuICAgICBjOCBjOCBjOCBjOCBjZiBmNiBjNyBhZCBjMiBjMyBjNyBmYyBmYiBmYiBmYiBmYlxuICAgICBjOCBjOCBjOCBjOCBjZiBkMyBhZCBhZCBhZCBhZCBkNiBjYyBjOCBjOCBjOCBjOFxuICAgICBjOCBjOCBjOCBjOCBjZiBkMyBiOSBiOCBhZCBiOSBmNiBjYyBjOCBjOCBjOCBjOFxuICAgICBjOCBjOCBjOCBjOCBjZiBmNiBjNyBhZCBiOSBjNyBkMiBjYyBjOCBjOCBjOCBjOFxuICAgICBjOCBjOCBjOCBjOCBjZiBkMyBiNiBiOSBjMyBiOCBkMiBjYyBjOCBjOCBjOCBjOGApO1xuLy8gdXAtZG93bi1yaWdodFxuY29uc3QgU0NSX1VSRCA9IHJlYWRTY3JlZW4oXG4gICAgYGM4IGM4IGM4IGM4IGNmIGQzIGM0IGMzIGMzIGMzIGY3IGY4IGNhIGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY1IGMzIGMzIGMzIGMzIGY3IGY3IGEwIGNhIGM5IGM5XG4gICAgIGM4IGM4IGM4IGM4IGNmIGY2IGMzIGMzIGI4IGI2IGQyIGNmIGNmIGU4IGU0IGEwXG4gICAgIGM4IGM4IGM4IGM4IGNmIGY1IGI3IGMzIGI3IGI4IGQyIGYwIGYxIGU5IGU1IGNmXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGMyIGI4IGMyIGI4IGQ4IGRiIGNmIGVhIGU2IGNmXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGFkIGFkIGFlIGQ0IGYzIGRkIGU3IGNmXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGFkIGFkIGFkIGFlIGQwIGQxIGQwIGQxXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGMyIGMzIGMzIGI3IGI4IGFkIGFkIGFkIGFkIGFkXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGMyIGI3IGI3IGI3IGI4IGM0IGFkIGFkXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGI2IGI5IGI3IGI3IGI3IGI3IGI4IGFkXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGM0IGMzIGI3IGI4IGZjIGZiIGZiIGZiIGZiXG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI2IGFkIGFkIGFkIGQ2IGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGFkIGFkIGFkIGFkIGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGM0IGMzIGI3IGI4IGQyIGNjIGM4IGM4IGM4IGM4XG4gICAgIGM4IGM4IGM4IGM4IGNmIGQzIGI2IGI5IGI3IGI3IGY2IGNjIGM4IGM4IGM4IGM4YCk7XG4vLyBob3Jpem9udGFsIHR1bm5lbFxuY29uc3QgU0NSX0xSID0gcmVhZFNjcmVlbihcbiAgICBgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhcbiAgICAgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzkgYzlcbiAgICAgYTAgZTQgZTggZWIgZTQgYTAgYTAgYTAgZWIgZWIgZTggZjAgZjEgYTAgZTQgYTBcbiAgICAgYTAgZTUgZTkgZjkgZjUgZjYgZjYgZjcgZWMgZjkgZjcgZjggZjIgYTAgZTUgYTBcbiAgICAgYTAgZTYgZjAgZjEgZTYgZTAgMDggMDkgZWQgZGUgZWEgZGUgZjIgYTAgZTYgYTBcbiAgICAgZGIgZTcgZGIgZjMgZTcgZTEgMGMgMGIgZGQgZGYgZTAgZGYgZjMgZGIgZTcgZTBcbiAgICAgZDAgZDEgZGEgZGEgZDAgZDEgMDMgMDMgZDAgZDEgZDAgZDEgZGEgZGEgZGEgZGFcbiAgICAgYWQgYzQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWQgYWRcbiAgICAgYzIgYzUgYjggYzYgYzQgYzQgYjkgYzcgYzQgYzUgYzUgYzcgYWQgYWQgYWQgYWRcbiAgICAgYWQgYWQgYWQgYWQgYzIgYzMgYzMgYzMgYzMgYzMgYzcgYWQgYWQgYWQgYWQgYWRcbiAgICAgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmIgZmJcbiAgICAgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhcbiAgICAgYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzggYzhgKTtcblxuZXhwb3J0IGZ1bmN0aW9uIGV4dGVuZFN3YW1wU2NyZWVucyhyb206IFJvbSkge1xuICAvLyBNb3ZlIHVwIHRvIDEzIHN3YW1wIHRpbGVzIHRvIHRoZSBhbHRlcm5hdGUgcGFsZXR0ZVxuICAvLyBzbyB0aGF0IHdlIGNhbiBzZWxlY3RpdmVseSBvcGVuIHVwIGRpZmZlcmVudCBvcHRpb25zIGZvclxuICAvLyB0aGUgT2FrIGVudHJhbmNlIChvciBwb3NzaWJseSBoaWRlIG90aGVyIGNhdmVzPylcbiAgLy8gIC0gU2NyZWVucyA3NiwgN2EsIDdiIGFuZCB0aGVuIGNsb3NlIHVwIDdlLlxuICAvLyAgLSBUaWxlcyAgIGFjIC0+IGRhOyBhYSAtPiBkYywgZTQsIGU1LCBlNiwgZTcsIGYwLCBmMSwgZjIsIGYzXG5cbiAgLy8gZm9yIChsZXQgaSA9IDA7IGkgPCAweGE7IGkrKykge1xuICAvLyAgIGNvbnN0IHNjcmVlbiA9IFNXQU1QX1NDUkVFTlNbaV07XG4gIC8vICAgaWYgKCFzY3JlZW4pIGNvbnRpbnVlO1xuICAvLyAgIHJvbS5zY3JlZW5zWzB4ODAgfCBpXS50aWxlcyA9IHNjcmVlbi5zcGxpdCgvXFxzKy9nKS5tYXAoeCA9PiBwYXJzZUludCh4LCAxNikpO1xuICAvLyB9XG5cbiAgLy8gTWFrZSBhIGhhbmRmdWwgb2YgcmVtb3ZhYmxlIHRpbGVzIC0gZGVmYXVsdHMgdG8gQ0xPU0VEIVxuICBjb25zdCB0cyA9IHJvbS5tZXRhdGlsZXNldHMuc3dhbXA7XG4gIHRzLmdldFRpbGUoMHgwMykuY29weUZyb20oMHhkYSkuc2V0QWx0ZXJuYXRpdmUoMHhhYyk7XG4gIHRzLmdldFRpbGUoMHgwNCkuY29weUZyb20oMHhlNCkuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwNSkuY29weUZyb20oMHhlNSkuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwNikuY29weUZyb20oMHhlNikuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwNykuY29weUZyb20oMHhlNykuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwOCkuY29weUZyb20oMHhmMCkuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwOSkuY29weUZyb20oMHhmMSkuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwYSkuY29weUZyb20oMHhmMikuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwYikuY29weUZyb20oMHhmMykuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwYykuY29weUZyb20oMHhkYykuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG4gIHRzLmdldFRpbGUoMHgwZCkuY29weUZyb20oMHhkZCkuc2V0QWx0ZXJuYXRpdmUoMHhhYSk7XG5cbiAgLy8gVE9ETyAtIG5vbmUgb2YgdGhlc2Ugc2hvdWxkIGFjdHVhbGx5IHRvdWNoIHRoZSBzY3JlZW5zLi4uP1xuICAvLyAgICAgIC0gd2UgY291bGQgaGF2ZSBhIG1vdmVGcm9tIHByaW1pdGl2ZSB0aGF0IGRvZXM/XG5cbiAgLy8gVE9ETyAtIGhvdyB0byBkbyBtb2RpZmljYXRpb25zIHdpdGggbmV3IG1ldGFzY3JlZW4gc3lzdGVtP1xuICBcbiAgcm9tLnN3YXBNZXRhdGlsZXMoWzB4YTBdLFxuICAgICAgICAgICAgICAgICAgICBbWzB4MDMsIDB4YWNdLCB+MHhkYV0sXG4gICAgICAgICAgICAgICAgICAgIFtbMHgwNCwgMHhhYV0sIH4weGU0XSxcbiAgICAgICAgICAgICAgICAgICAgW1sweDA1LCAweGFhXSwgfjB4ZTVdLFxuICAgICAgICAgICAgICAgICAgICBbWzB4MDYsIDB4YWFdLCB+MHhlNl0sXG4gICAgICAgICAgICAgICAgICAgIFtbMHgwNywgMHhhYV0sIH4weGU3XSxcbiAgICAgICAgICAgICAgICAgICAgW1sweDA4LCAweGFhXSwgfjB4ZjBdLFxuICAgICAgICAgICAgICAgICAgICBbWzB4MDksIDB4YWFdLCB+MHhmMV0sXG4gICAgICAgICAgICAgICAgICAgIFtbMHgwYSwgMHhhYV0sIH4weGYyXSxcbiAgICAgICAgICAgICAgICAgICAgW1sweDBiLCAweGFhXSwgfjB4ZjNdLFxuICAgICAgICAgICAgICAgICAgICBbWzB4MGMsIDB4YWFdLCB+MHhkY10sXG4gICAgICAgICAgICAgICAgICAgIFtbMHgwZCwgMHhhYV0sIH4weGRkXSk7XG5cbiAgLy8gVE9ETyAtIGNhbiB3ZSBtYWtlIHRoZSByZW1vdmFibGVzIGRlZmF1bHQgY2xvc2VkP1xuXG4gIC8vIFBsdWcgcmVtb3ZhYmxlIHRpbGVzIGludG8gc2V2ZXJhbCBvZiB0aGUgc2NyZWVucy5cbiAgd3JpdGUyZChyb20uc2NyZWVuc1sweDdmXS50aWxlcywgMHgwMCwgWyAvLyBzb2xpZCBibG9jayAtIGFkZCBsZWZ0IGNvbHVtblxuICAgIFsweGE4LCAweGNjXSwgLy8gMFxuICAgIFsweGE4LCAweGNjXSxcbiAgICBbMHhhOCwgMHhjY10sXG4gICAgWzB4YTgsIDB4Y2NdLFxuICAgIFsweGE4LCAweGNjXSxcbiAgICBbMHhhOCwgMHhjY10sXG4gICAgWzB4YTgsIDB4Y2NdLFxuICAgIFsweGE4LCAweGNjXSxcbiAgICBbMHhhOCwgMHhjY10sXG4gICAgWzB4ZDIsIDB4Y2NdLCAvLyA5XG4gICAgWzB4ZDIsIDB4Y2NdLFxuICAgIFsweGQyLCAweGNjXSxcbiAgICBbMHhkMiwgMHhlMl0sIC8vIGNcbiAgICBbMHhlMiwgMHhjOF0sIC8vIGRcbiAgXSk7XG5cbiAgd3JpdGUyZChyb20uc2NyZWVuc1sweDc2XS50aWxlcywgMHg0YywgWyAvLyBsZWZ0IGRlYWQgZW5kIC0gYWRkIG9wdGlvbmFsIGRvb3JcbiAgICBbMHgwOCwgMHgwOV0sIC8vIGYwIGYxXG4gICAgWzB4MGMsIDB4MGJdLCAvLyBkYyBmM1xuICAgIFsweDAzLCAweDAzXSwgLy8gZGEgZGFcbiAgXSk7XG5cbiAgd3JpdGUyZChyb20uc2NyZWVuc1sweDdhXS50aWxlcywgMHgyNSwgWyAvLyB0ZWUgLSBhZGQgYW4gb3B0aW9uYWwgZG9vclxuICAgIFsgICAgLCAgICAgLCAweDA0XSwgLy8gICAgICAgZTRcbiAgICBbMHgwOCwgMHgwOSwgMHgwNV0sIC8vIGYwIGYxIGU1XG4gICAgWyAgICAsIDB4MGEsIDB4MDZdLCAvLyAgICBmMiBlNlxuICAgIFsgICAgLCAweDBiLCAweDA3XSwgLy8gICAgZjMgZTdcbiAgICBbICAgICwgMHgwMywgMHgwM10sIC8vICAgIGRhIGRhXG4gIF0pO1xuXG4gIHdyaXRlMmQocm9tLnNjcmVlbnNbMHg3Yl0udGlsZXMsIDB4MjQsIFsgLy8gcmlnaHQgZGVhZCBlbmQgLSBhZGQgb3B0aW9uYWwgZG9vclxuICAgIFsweDA0ICAgICAgXSwgLy8gZTRcbiAgICBbICAgICAgICAgIF0sIC8vXG4gICAgWzB4MDYgICAgICBdLCAvLyBlNlxuICAgIFsweDA3LCAweDBkXSwgLy8gZTcgZGRcbiAgICBbMHgwMywgMHgwM10sIC8vIGRhIGRhXG4gIF0pO1xuXG4gIHdyaXRlMmQocm9tLnNjcmVlbnNbMHg3ZV0udGlsZXMsIDB4NDcsIFsgLy8gZG93bi9sZWZ0IC0gZXhpc3RpbmcgZG9vciBvcHRpb25hbFxuICAgIFsweDA4LCAweDA5XSwgLy8gZjAgZjFcbiAgICBbMHgwYywgMHgwYl0sIC8vIGRjIGYzXG4gICAgWzB4MDMsIDB4MDNdLCAvLyBkYSBkYVxuICBdKTtcbn1cbiJdfQ==