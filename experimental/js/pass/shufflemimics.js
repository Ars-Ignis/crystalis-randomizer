import { iters } from '../util.js';
export function shuffleMimics(rom, flags, random) {
    const chests = [];
    const mimics = [];
    for (const location of rom.locations) {
        for (const spawn of location.spawns) {
            if (spawn.isChest()) {
                const slot = rom.slots[spawn.id];
                if (slot >= 0x70)
                    mimics.push(spawn.id);
                if (flags.preserveUniqueChecks()) {
                    const itemget = rom.itemGets[slot];
                    const item = rom.items[itemget === null || itemget === void 0 ? void 0 : itemget.itemId];
                    if (item === null || item === void 0 ? void 0 : item.unique)
                        continue;
                }
                if (spawn.isInvisible())
                    continue;
                chests.push(spawn.id);
            }
        }
    }
    random.shuffle(chests);
    [...iters.zip(mimics, chests, (i, j) => rom.slots.swap(i, j))];
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2h1ZmZsZW1pbWljcy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9wYXNzL3NodWZmbGVtaW1pY3MudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBR0EsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLFlBQVksQ0FBQztBQUVqQyxNQUFNLFVBQVUsYUFBYSxDQUFDLEdBQVEsRUFBRSxLQUFjLEVBQUUsTUFBYztJQUdwRSxNQUFNLE1BQU0sR0FBYSxFQUFFLENBQUM7SUFDNUIsTUFBTSxNQUFNLEdBQWEsRUFBRSxDQUFDO0lBQzVCLEtBQUssTUFBTSxRQUFRLElBQUksR0FBRyxDQUFDLFNBQVMsRUFBRTtRQUNwQyxLQUFLLE1BQU0sS0FBSyxJQUFJLFFBQVEsQ0FBQyxNQUFNLEVBQUU7WUFDbkMsSUFBSSxLQUFLLENBQUMsT0FBTyxFQUFFLEVBQUU7Z0JBRW5CLE1BQU0sSUFBSSxHQUFHLEdBQUcsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUNqQyxJQUFJLElBQUksSUFBSSxJQUFJO29CQUFFLE1BQU0sQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDO2dCQUN4QyxJQUFJLEtBQUssQ0FBQyxvQkFBb0IsRUFBRSxFQUFFO29CQUNoQyxNQUFNLE9BQU8sR0FBRyxHQUFHLENBQUMsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO29CQUNuQyxNQUFNLElBQUksR0FBRyxHQUFHLENBQUMsS0FBSyxDQUFDLE9BQU8sYUFBUCxPQUFPLHVCQUFQLE9BQU8sQ0FBRSxNQUFNLENBQUMsQ0FBQztvQkFDeEMsSUFBSSxJQUFJLGFBQUosSUFBSSx1QkFBSixJQUFJLENBQUUsTUFBTTt3QkFBRSxTQUFTO2lCQUM1QjtnQkFDRCxJQUFJLEtBQUssQ0FBQyxXQUFXLEVBQUU7b0JBQUUsU0FBUztnQkFFbEMsTUFBTSxDQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUM7YUFDdkI7U0FDRjtLQUNGO0lBRUQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsQ0FBQztJQUd2QixDQUFDLEdBQUcsS0FBSyxDQUFDLEdBQUcsQ0FBQyxNQUFNLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFLENBQUMsR0FBRyxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQztBQUNqRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtGbGFnU2V0fSBmcm9tICcuLi9mbGFnc2V0LmpzJztcbmltcG9ydCB7UmFuZG9tfSBmcm9tICcuLi9yYW5kb20uanMnO1xuaW1wb3J0IHtSb219IGZyb20gJy4uL3JvbS5qcyc7XG5pbXBvcnQge2l0ZXJzfSBmcm9tICcuLi91dGlsLmpzJztcblxuZXhwb3J0IGZ1bmN0aW9uIHNodWZmbGVNaW1pY3Mocm9tOiBSb20sIGZsYWdzOiBGbGFnU2V0LCByYW5kb206IFJhbmRvbSkge1xuICAvLyBOT1RFOiBpZiBmbGFncy5wcmVzZXJ2ZVVuaXF1ZUNoZWNrcygpIHRoZW4gb25seSBkbyBub251bmlxdWUgY2hlc3RzXG4gIC8vIDEuIGdhdGhlciBhbGwgdGhlIGNoZXN0c1xuICBjb25zdCBjaGVzdHM6IG51bWJlcltdID0gW107XG4gIGNvbnN0IG1pbWljczogbnVtYmVyW10gPSBbXTtcbiAgZm9yIChjb25zdCBsb2NhdGlvbiBvZiByb20ubG9jYXRpb25zKSB7XG4gICAgZm9yIChjb25zdCBzcGF3biBvZiBsb2NhdGlvbi5zcGF3bnMpIHtcbiAgICAgIGlmIChzcGF3bi5pc0NoZXN0KCkpIHtcbiAgICAgICAgLy8gSXMgdGhpcyBhbiBlbGlnaWJsZSBjaGVzdD9cbiAgICAgICAgY29uc3Qgc2xvdCA9IHJvbS5zbG90c1tzcGF3bi5pZF07XG4gICAgICAgIGlmIChzbG90ID49IDB4NzApIG1pbWljcy5wdXNoKHNwYXduLmlkKTtcbiAgICAgICAgaWYgKGZsYWdzLnByZXNlcnZlVW5pcXVlQ2hlY2tzKCkpIHtcbiAgICAgICAgICBjb25zdCBpdGVtZ2V0ID0gcm9tLml0ZW1HZXRzW3Nsb3RdO1xuICAgICAgICAgIGNvbnN0IGl0ZW0gPSByb20uaXRlbXNbaXRlbWdldD8uaXRlbUlkXTtcbiAgICAgICAgICBpZiAoaXRlbT8udW5pcXVlKSBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoc3Bhd24uaXNJbnZpc2libGUoKSkgY29udGludWU7XG4gICAgICAgIC8vIEFkZCBlbGlnaWJsZSBjaGVzdHNcbiAgICAgICAgY2hlc3RzLnB1c2goc3Bhd24uaWQpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICAvLyAyLiBzaHVmZmxlIHRoZSBjaGVzdHMuXG4gIHJhbmRvbS5zaHVmZmxlKGNoZXN0cyk7XG4gIC8vIDMuIHppcCB0aGUgY2hlc3RzIGFuZCBtaW1pY3MgdG9nZXRoZXIgYW5kIHN3YXAuXG4gIC8vIE5PVEU6IHNwcmVhZCB0aGUgcmVzdWx0IHNpbmNlIG90aGVyd2lzZSB6aXAgaXMgbGF6eS5cbiAgWy4uLml0ZXJzLnppcChtaW1pY3MsIGNoZXN0cywgKGksIGopID0+IHJvbS5zbG90cy5zd2FwKGksIGopKV07XG59XG4iXX0=