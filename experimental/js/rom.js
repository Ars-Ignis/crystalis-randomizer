import { AdHocSpawn } from './rom/adhocspawn.js';
import { Areas } from './rom/area.js';
import { BossKill } from './rom/bosskill.js';
import { Bosses } from './rom/bosses.js';
import { Flags } from './rom/flags.js';
import { Hitbox } from './rom/hitbox.js';
import { Items } from './rom/item.js';
import { ItemGets } from './rom/itemget.js';
import { Locations } from './rom/location.js';
import { Messages } from './rom/messages.js';
import { Metasprite } from './rom/metasprite.js';
import { Monster } from './rom/monster.js';
import { Npcs } from './rom/npc.js';
import { Objects } from './rom/objects.js';
import { RomOption } from './rom/option.js';
import { Palette } from './rom/palette.js';
import { Pattern } from './rom/pattern.js';
import { Screen } from './rom/screen.js';
import { Shop } from './rom/shop.js';
import { Slots } from './rom/slots.js';
import { Telepathy } from './rom/telepathy.js';
import { TileAnimation } from './rom/tileanimation.js';
import { TileEffects } from './rom/tileeffects.js';
import { Tileset } from './rom/tileset.js';
import { TownWarp } from './rom/townwarp.js';
import { Trigger } from './rom/trigger.js';
import { hex, seq } from './rom/util.js';
import { WildWarp } from './rom/wildwarp.js';
import { Writer } from './rom/writer.js';
import { UnionFind } from './unionfind.js';
export class Rom {
    constructor(rom) {
        const prgSize = rom[4] * 0x4000;
        const prgStart = 0x10 + (rom[6] & 4 ? 512 : 0);
        const prgEnd = prgStart + prgSize;
        this.prg = rom.subarray(prgStart, prgEnd);
        this.chr = rom.subarray(prgEnd);
        this.shopCount = Rom.SHOP_COUNT.get(rom);
        this.scalingLevels = Rom.SCALING_LEVELS.get(rom);
        this.uniqueItemTableAddress = Rom.UNIQUE_ITEM_TABLE.get(rom);
        this.shopDataTablesAddress = Rom.SHOP_DATA_TABLES.get(rom);
        this.telepathyTablesAddress = Rom.TELEPATHY_TABLES.get(rom);
        this.omitItemGetDataSuffix = Rom.OMIT_ITEM_GET_DATA_SUFFIX.get(rom);
        this.omitLocalDialogSuffix = Rom.OMIT_LOCAL_DIALOG_SUFFIX.get(rom);
        this.compressedMapData = Rom.COMPRESSED_MAPDATA.get(rom);
        for (const [address, old, value] of ADJUSTMENTS) {
            if (this.prg[address] === old)
                this.prg[address] = value;
        }
        this.areas = new Areas(this);
        this.screens = seq(0x103, i => new Screen(this, i));
        this.tilesets = seq(12, i => new Tileset(this, i << 2 | 0x80));
        this.tileEffects = seq(11, i => new TileEffects(this, i + 0xb3));
        this.triggers = seq(0x43, i => new Trigger(this, 0x80 | i));
        this.patterns = seq(this.chr.length >> 4, i => new Pattern(this, i));
        this.palettes = seq(0x100, i => new Palette(this, i));
        this.locations = new Locations(this);
        this.tileAnimations = seq(4, i => new TileAnimation(this, i));
        this.hitboxes = seq(24, i => new Hitbox(this, i));
        this.objects = new Objects(this);
        this.adHocSpawns = seq(0x60, i => new AdHocSpawn(this, i));
        this.metasprites = seq(0x100, i => new Metasprite(this, i));
        this.messages = new Messages(this);
        this.telepathy = new Telepathy(this);
        this.itemGets = new ItemGets(this);
        this.items = new Items(this);
        this.shops = seq(44, i => new Shop(this, i));
        this.slots = new Slots(this);
        this.npcs = new Npcs(this);
        this.bossKills = seq(0xe, i => new BossKill(this, i));
        this.wildWarp = new WildWarp(this);
        this.townWarp = new TownWarp(this);
        this.flags = new Flags(this);
        this.bosses = new Bosses(this);
    }
    trigger(id) {
        if (id < 0x80 || id > 0xff)
            throw new Error(`Bad trigger id $${hex(id)}`);
        return this.triggers[id & 0x7f];
    }
    tileset(id) {
        if (id < 0x80 || id > 0xac || id & 3)
            throw new Error(`Bad tileset id $${hex(id)}`);
        return this.tilesets[(id & 0x7f) >>> 2];
    }
    get projectiles() {
        const projectiles = new Set();
        for (const m of this.objects.filter(o => o instanceof Monster)) {
            if (m.child) {
                projectiles.add(this.objects[this.adHocSpawns[m.child].objectId]);
            }
        }
        return [...projectiles].sort((x, y) => (x.id - y.id));
    }
    get monsterGraphics() {
        const gfx = {};
        for (const l of this.locations) {
            if (!l.used || !l.hasSpawns)
                continue;
            for (const o of l.spawns) {
                if (!(o.data[2] & 7)) {
                    const slot = o.data[2] & 0x80 ? 1 : 0;
                    const id = hex(o.data[3] + 0x50);
                    const data = gfx[id] = gfx[id] || {};
                    data[`${slot}:${l.spritePatterns[slot].toString(16)}:${l.spritePalettes[slot].toString(16)}`]
                        = { pal: l.spritePalettes[slot],
                            pat: l.spritePatterns[slot],
                            slot,
                        };
                }
            }
        }
        return gfx;
    }
    get locationMonsters() {
        const m = {};
        for (const l of this.locations) {
            if (!l.used || !l.hasSpawns)
                continue;
            const s = m['$' + hex(l.id)] = {};
            for (const o of l.spawns) {
                if (!(o.data[2] & 7)) {
                    const slot = o.data[2] & 0x80 ? 1 : 0;
                    const id = o.data[3] + 0x50;
                    s[`${slot}:${id.toString(16)}`] =
                        (s[`${slot}:${id.toString(16)}`] || 0) + 1;
                }
            }
        }
        return m;
    }
    async writeData() {
        Rom.SHOP_COUNT.set(this.prg, this.shopCount);
        Rom.SCALING_LEVELS.set(this.prg, this.scalingLevels);
        Rom.UNIQUE_ITEM_TABLE.set(this.prg, this.uniqueItemTableAddress);
        Rom.SHOP_DATA_TABLES.set(this.prg, this.shopDataTablesAddress);
        Rom.OMIT_ITEM_GET_DATA_SUFFIX.set(this.prg, this.omitItemGetDataSuffix);
        Rom.OMIT_LOCAL_DIALOG_SUFFIX.set(this.prg, this.omitLocalDialogSuffix);
        Rom.COMPRESSED_MAPDATA.set(this.prg, this.compressedMapData);
        const writer = new Writer(this.prg, this.chr);
        writer.alloc(0x144f8, 0x17e00);
        writer.alloc(0x193f9, 0x1ac00);
        writer.alloc(0x1ae00, 0x1bd00);
        writer.alloc(0x1c77a, 0x1c95d);
        writer.alloc(0x1cae5, 0x1d8f4);
        writer.alloc(0x1dde6, 0x1e106);
        writer.alloc(0x1e200, 0x1e3c0);
        writer.alloc(0x2111a, 0x21468);
        writer.alloc(0x2a000, 0x2fc00);
        if (this.telepathyTablesAddress) {
            writer.alloc(0x1d8f4, 0x1db00);
        }
        else {
            writer.alloc(0x1da4c, 0x1db00);
        }
        const promises = [];
        const writeAll = (writables) => {
            for (const w of writables) {
                promises.push(w.write(writer));
            }
        };
        writeAll(this.locations);
        writeAll(this.objects);
        writeAll(this.hitboxes);
        writeAll(this.triggers);
        writeAll(this.npcs);
        writeAll(this.tilesets);
        writeAll(this.tileEffects);
        writeAll(this.screens);
        writeAll(this.adHocSpawns);
        this.itemGets.write(writer);
        this.slots.write(writer);
        this.items.write(writer);
        writeAll(this.shops);
        writeAll(this.bossKills);
        writeAll(this.patterns);
        this.wildWarp.write(writer);
        this.townWarp.write(writer);
        promises.push(this.telepathy.write(writer));
        promises.push(this.messages.write(writer));
        promises.push(writer.commit());
        await Promise.all(promises).then(() => undefined);
        writer.report();
    }
    analyzeTiles() {
    }
    disjointTilesets() {
        const tilesetByScreen = [];
        for (const loc of this.locations) {
            if (!loc.used)
                continue;
            const tileset = loc.tileset;
            const ext = loc.extended ? 0x100 : 0;
            for (const row of loc.screens) {
                for (const s of row) {
                    (tilesetByScreen[s + ext] || (tilesetByScreen[s + ext] = new Set())).add(tileset);
                }
            }
        }
        const tiles = seq(256, () => new UnionFind());
        for (let s = 0; s < tilesetByScreen.length; s++) {
            if (!tilesetByScreen[s])
                continue;
            for (const t of this.screens[s].allTilesSet()) {
                tiles[t].union([...tilesetByScreen[s]]);
            }
        }
        for (let t = 0; t < tiles.length; t++) {
            const p = tiles[t].sets()
                .map((s) => [...s].map(hex).join(' '))
                .join(' | ');
            console.log(`Tile ${hex(t)}: ${p}`);
        }
    }
    swapMetatiles(tilesets, ...cycles) {
        const rev = new Map();
        const revArr = seq(0x100);
        const alt = new Map();
        const cpl = (x) => Array.isArray(x) ? x[0] : x < 0 ? ~x : x;
        for (const cycle of cycles) {
            for (let i = 0; i < cycle.length - 1; i++) {
                if (Array.isArray(cycle[i])) {
                    const arr = cycle[i];
                    alt.set(arr[0], arr[1]);
                    cycle[i] = arr[0];
                }
            }
            for (let i = 0; i < cycle.length - 1; i++) {
                const j = cycle[i];
                const k = cycle[i + 1];
                if (j < 0 || k < 0)
                    continue;
                rev.set(k, j);
                revArr[k] = j;
            }
        }
        const screens = new Set();
        const tileEffects = new Set();
        const tilesetsSet = new Set(tilesets);
        for (const l of this.locations) {
            if (!l.used)
                continue;
            if (!tilesetsSet.has(l.tileset))
                continue;
            tileEffects.add(l.tileEffects);
            for (const screen of l.allScreens()) {
                screens.add(screen);
            }
        }
        for (const screen of screens) {
            for (let i = 0, len = screen.tiles.length; i < len; i++) {
                screen.tiles[i] = revArr[screen.tiles[i]];
            }
        }
        for (const tsid of tilesetsSet) {
            const tileset = this.tilesets[(tsid & 0x7f) >>> 2];
            for (const cycle of cycles) {
                for (let i = 0; i < cycle.length - 1; i++) {
                    const a = cpl(cycle[i]);
                    const b = cpl(cycle[i + 1]);
                    for (let j = 0; j < 4; j++) {
                        tileset.tiles[j][a] = tileset.tiles[j][b];
                    }
                    tileset.attrs[a] = tileset.attrs[b];
                    if (b < 0x20 && tileset.alternates[b] !== b) {
                        if (a >= 0x20)
                            throw new Error(`Cannot unflag: ${tsid} ${a} ${b} ${tileset.alternates[b]}`);
                        tileset.alternates[a] = tileset.alternates[b];
                    }
                }
            }
            for (const [a, b] of alt) {
                tileset.alternates[a] = b;
            }
        }
        for (const teid of tileEffects) {
            const tileEffect = this.tileEffects[teid - 0xb3];
            for (const cycle of cycles) {
                for (let i = 0; i < cycle.length - 1; i++) {
                    const a = cpl(cycle[i]);
                    const b = cpl(cycle[i + 1]);
                    tileEffect.effects[a] = tileEffect.effects[b];
                }
            }
            for (const a of alt.keys()) {
                tileEffect.effects[a] |= 0x08;
            }
        }
    }
    moveFlag(oldFlag, newFlag) {
        function replace(arr) {
            for (let i = 0; i < arr.length; i++) {
                if (arr[i] === oldFlag)
                    arr[i] = newFlag;
                if (arr[i] === ~oldFlag)
                    arr[i] = ~newFlag;
            }
        }
        for (const trigger of this.triggers) {
            replace(trigger.conditions);
            replace(trigger.flags);
        }
        for (const npc of this.npcs) {
            for (const conds of npc.spawnConditions.values())
                replace(conds);
            for (const dialogs of [npc.globalDialogs, ...npc.localDialogs.values()]) {
                for (const dialog of dialogs) {
                    if (dialog.condition === oldFlag)
                        dialog.condition = newFlag;
                    if (dialog.condition === ~oldFlag)
                        dialog.condition = ~newFlag;
                }
            }
        }
        if ((oldFlag & ~0xff) === 0x200 && (newFlag & ~0xff) === 0x200) {
            for (const loc of this.locations) {
                for (const flag of loc.flags) {
                    if (flag.flag === oldFlag)
                        flag.flag = newFlag;
                }
            }
        }
    }
    nextFreeTrigger() {
        for (const t of this.triggers) {
            if (!t.used)
                return t;
        }
        throw new Error('Could not find an unused trigger.');
    }
    static async load(patch, receiver) {
        const file = await pickFile(receiver);
        if (patch)
            await patch(file);
        return new Rom(file);
    }
}
Rom.OMIT_ITEM_GET_DATA_SUFFIX = RomOption.bit(0x142c0, 0);
Rom.OMIT_LOCAL_DIALOG_SUFFIX = RomOption.bit(0x142c0, 1);
Rom.COMPRESSED_MAPDATA = RomOption.bit(0x142c0, 2);
Rom.SHOP_COUNT = RomOption.byte(0x142c1);
Rom.SCALING_LEVELS = RomOption.byte(0x142c2);
Rom.UNIQUE_ITEM_TABLE = RomOption.address(0x142d0);
Rom.SHOP_DATA_TABLES = RomOption.address(0x142d3);
Rom.TELEPATHY_TABLES = RomOption.address(0x142d6);
function pickFile(receiver) {
    if (!receiver)
        receiver = picker => document.body.appendChild(picker);
    return new Promise((resolve) => {
        if (window.location.hash !== '#reset') {
            const data = localStorage.getItem('rom');
            if (data) {
                return resolve(Uint8Array.from(new Array(data.length / 2).fill(0).map((_, i) => Number.parseInt(data[2 * i] + data[2 * i + 1], 16))));
            }
        }
        const upload = document.createElement('input');
        document.body.appendChild(upload);
        upload.type = 'file';
        upload.addEventListener('change', () => {
            const file = upload.files[0];
            const reader = new FileReader();
            reader.addEventListener('loadend', () => {
                const arr = new Uint8Array(reader.result);
                const str = Array.from(arr, hex).join('');
                localStorage.setItem('rom', str);
                upload.remove();
                resolve(arr);
            });
            reader.readAsArrayBuffer(file);
        });
    });
}
export const EXPECTED_CRC32 = 0x1bd39032;
const ADJUSTMENTS = [
    [0x13646, 0x02, 0x06],
    [0x1456a, 0x00, 0xff],
    [0x14aeb, 0x09, 0xff],
    [0x14db9, 0x08, 0x80],
    [0x1545d, 0xff, 0x00],
    [0x1581d, 0x00, 0xff],
    [0x1584e, 0xdb, 0xff],
    [0x15baf, 0xf0, 0x80],
    [0x15bb6, 0xdf, 0x80],
    [0x15bb7, 0x96, 0x80],
    [0x15f40, 0x02, 0xff],
    [0x15f61, 0x8d, 0xff],
    [0x15f65, 0x8d, 0xff],
    [0x164ff, 0x0b, 0x0a],
    [0x1782a, 0x10, 0x01],
    [0x17857, 0x10, 0x01],
    [0x19f02, 0x40, 0x80],
    [0x19f03, 0x33, 0x32],
    [0x1a176, 0x2a, 0xff],
    [0x1a1e0, 0x40, 0xc0],
    [0x1a1e1, 0x3d, 0x34],
    [0x1a84c, 0x1c, 0xff],
    [0x1cf05, 0x47, 0x48],
    [0x1d311, 0x20, 0xa0],
    [0x1d312, 0x30, 0x00],
    [0x1cff9, 0x60, 0xe0],
    [0x1e32a, 0x40, 0xc0],
    [0x1e32b, 0x93, 0x00],
    [0x1e330, 0x40, 0xc0],
    [0x1e331, 0x94, 0x00],
    [0x1e336, 0x40, 0xc0],
    [0x1e337, 0x95, 0x00],
    [0x2ca90, 0x02, 0x00],
    [0x2f573, 0x02, 0x00],
    [0x2fae4, 0x5f, 0x00],
];
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicm9tLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL2pzL3JvbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDL0MsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNwQyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sbUJBQW1CLENBQUM7QUFDM0MsT0FBTyxFQUFDLE1BQU0sRUFBQyxNQUFNLGlCQUFpQixDQUFDO0FBQ3ZDLE9BQU8sRUFBQyxLQUFLLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQztBQUNyQyxPQUFPLEVBQUMsTUFBTSxFQUFDLE1BQU0saUJBQWlCLENBQUM7QUFDdkMsT0FBTyxFQUFDLEtBQUssRUFBQyxNQUFNLGVBQWUsQ0FBQztBQUNwQyxPQUFPLEVBQUMsUUFBUSxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDMUMsT0FBTyxFQUFDLFNBQVMsRUFBQyxNQUFNLG1CQUFtQixDQUFDO0FBQzVDLE9BQU8sRUFBQyxRQUFRLEVBQUMsTUFBTSxtQkFBbUIsQ0FBQztBQUMzQyxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0scUJBQXFCLENBQUM7QUFDL0MsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxJQUFJLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFFbEMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxTQUFTLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUMxQyxPQUFPLEVBQUMsT0FBTyxFQUFDLE1BQU0sa0JBQWtCLENBQUM7QUFDekMsT0FBTyxFQUFDLE9BQU8sRUFBQyxNQUFNLGtCQUFrQixDQUFDO0FBQ3pDLE9BQU8sRUFBQyxNQUFNLEVBQUMsTUFBTSxpQkFBaUIsQ0FBQztBQUN2QyxPQUFPLEVBQUMsSUFBSSxFQUFDLE1BQU0s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QyxDQUFDO1FBQ3BELElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksRUFBRSxDQUFDLElBQUksQ0FBQyxHQUFHLElBQUksQ0FBQyxDQUFDLENBQUM7UUFDL0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxXQUFXLENBQUMsSUFBSSxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksT0FBTyxDQUFDLElBQUksRUFBRSxJQUFJLEdBQUcsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM1RCxJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLE1BQU0sSUFBSSxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUNyRSxJQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUN0RCxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxjQUFjLEdBQUcsR0FBRyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksYUFBYSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQzlELElBQUksQ0FBQyxRQUFRLEdBQUcsR0FBRyxDQUFDLEVBQUUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksTUFBTSxDQUFDLElBQUksRUFBRSxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xELElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDakMsSUFBSSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDM0QsSUFBSSxDQUFDLFdBQVcsR0FBRyxHQUFHLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxVQUFVLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDNUQsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUNuQyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQ3JDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxRQUFRLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDbkMsSUFBSSxDQUFDLEtBQUssR0FBRyxJQUFJLEtBQUssQ0FBQyxJQUFJLENBQUMsQ0FBQztRQUM3QixJQUFJLENBQUMsS0FBSyxHQUFHLEdBQUcsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztRQUM3QyxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksS0FBSyxDQUFDLElBQUksQ0FBQyxDQUFDO1FBQzdCLElBQUksQ0FBQyxJQUFJLEdBQUcsSUFBSSxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDM0IsSUFBSSxDQUFDLFNBQVMsR0FBRyxHQUFHLENBQUMsR0FBRyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsSUFBSSxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEQsSUFBSSxDQUFDLFFBQVEsR0FBRyxJQUFJLFFBQVEsQ0FBQyxJQUFJLENBQUMsQ0FB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QUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBR3JCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFFckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3JCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFDckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUNyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBQ3JCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7SUFHckIsQ0FBQyxPQUFPLEVBQUUsSUFBSSxFQUFFLElBQUksQ0FBQztJQUVyQixDQUFDLE9BQU8sRUFBRSxJQUFJLEVBQUUsSUFBSSxDQUFDO0lBRXJCLENBQUMsT0FBTyxFQUFFLElBQUksRUFBRSxJQUFJLENBQUM7Q0FDYixDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHtBZEhvY1NwYXdufSBmcm9tICcuL3JvbS9hZGhvY3NwYXduLmpzJztcbmltcG9ydCB7QXJlYXN9IGZyb20gJy4vcm9tL2FyZWEuanMnO1xuaW1wb3J0IHtCb3NzS2lsbH0gZnJvbSAnLi9yb20vYm9zc2tpbGwuanMnO1xuaW1wb3J0IHtCb3NzZXN9IGZyb20gJy4vcm9tL2Jvc3Nlcy5qcyc7XG5pbXBvcnQge0ZsYWdzfSBmcm9tICcuL3JvbS9mbGFncy5qcyc7XG5pbXBvcnQge0hpdGJveH0gZnJvbSAnLi9yb20vaGl0Ym94LmpzJztcbmltcG9ydCB7SXRlbXN9IGZyb20gJy4vcm9tL2l0ZW0uanMnO1xuaW1wb3J0IHtJdGVtR2V0c30gZnJvbSAnLi9yb20vaXRlbWdldC5qcyc7XG5pbXBvcnQge0xvY2F0aW9uc30gZnJvbSAnLi9yb20vbG9jYXRpb24uanMnO1xuaW1wb3J0IHtNZXNzYWdlc30gZnJvbSAnLi9yb20vbWVzc2FnZXMuanMnO1xuaW1wb3J0IHtNZXRhc3ByaXRlfSBmcm9tICcuL3JvbS9tZXRhc3ByaXRlLmpzJztcbmltcG9ydCB7TW9uc3Rlcn0gZnJvbSAnLi9yb20vbW9uc3Rlci5qcyc7XG5pbXBvcnQge05wY3N9IGZyb20gJy4vcm9tL25wYy5qcyc7XG5pbXBvcnQge09iamVjdERhdGF9IGZyb20gJy4vcm9tL29iamVjdGRhdGEuanMnO1xuaW1wb3J0IHtPYmplY3RzfSBmcm9tICcuL3JvbS9vYmplY3RzLmpzJztcbmltcG9ydCB7Um9tT3B0aW9ufSBmcm9tICcuL3JvbS9vcHRpb24uanMnO1xuaW1wb3J0IHtQYWxldHRlfSBmcm9tICcuL3JvbS9wYWxldHRlLmpzJztcbmltcG9ydCB7UGF0dGVybn0gZnJvbSAnLi9yb20vcGF0dGVybi5qcyc7XG5pbXBvcnQge1NjcmVlbn0gZnJvbSAnLi9yb20vc2NyZWVuLmpzJztcbmltcG9ydCB7U2hvcH0gZnJvbSAnLi9yb20vc2hvcC5qcyc7XG5pbXBvcnQge1Nsb3RzfSBmcm9tICcuL3JvbS9zbG90cy5qcyc7XG5pbXBvcnQge1Nwb2lsZXJ9IGZyb20gJy4vcm9tL3Nwb2lsZXIuanMnO1xuaW1wb3J0IHtUZWxlcGF0aHl9IGZyb20gJy4vcm9tL3RlbGVwYXRoeS5qcyc7XG5pbXBvcnQge1RpbGVBbmltYXRpb259IGZyb20gJy4vcm9tL3RpbGVhbmltYXRpb24uanMnO1xuaW1wb3J0IHtUaWxlRWZmZWN0c30gZnJvbSAnLi9yb20vdGlsZWVmZmVjdHMuanMnO1xuaW1wb3J0IHtUaWxlc2V0fSBmcm9tICcuL3JvbS90aWxlc2V0LmpzJztcbmltcG9ydCB7VG93bldhcnB9IGZyb20gJy4vcm9tL3Rvd253YXJwLmpzJztcbmltcG9ydCB7VHJpZ2dlcn0gZnJvbSAnLi9yb20vdHJpZ2dlci5qcyc7XG5pbXBvcnQge2hleCwgc2VxfSBmcm9tICcuL3JvbS91dGlsLmpzJztcbmltcG9ydCB7V2lsZFdhcnB9IGZyb20gJy4vcm9tL3dpbGR3YXJwLmpzJztcbmltcG9ydCB7V3JpdGVyfSBmcm9tICcuL3JvbS93cml0ZXIuanMnO1xuaW1wb3J0IHtVbmlvbkZpbmR9IGZyb20gJy4vdW5pb25maW5kLmpzJztcblxuLy8gQSBrbm93biBsb2NhdGlvbiBmb3IgZGF0YSBhYm91dCBzdHJ1Y3R1cmFsIGNoYW5nZXMgd2UndmUgbWFkZSB0byB0aGUgcm9tLlxuLy8gVGhlIHRyaWNrIGlzIHRvIGZpbmQgYSBzdWl0YWJsZSByZWdpb24gb2YgUk9NIHRoYXQncyBib3RoIHVudXNlZCAqYW5kKlxuLy8gaXMgbm90IHBhcnRpY3VsYXJseSAqdXNhYmxlKiBmb3Igb3VyIHB1cnBvc2VzLiAgVGhlIGJvdHRvbSAzIHJvd3Mgb2YgdGhlXG4vLyB2YXJpb3VzIHNpbmdsZS1zY3JlZW4gbWFwcyBhcmUgYWxsIGVmZmVjdGl2ZWx5IHVudXNlZCwgc28gdGhhdCBnaXZlcyA0OFxuLy8gYnl0ZXMgcGVyIG1hcC4gIFNob3BzICgxNDAwMC4uMTQyZmYpIGFsc28gaGF2ZSBhIGdpYW50IGFyZWEgdXAgdG9wIHRoYXRcbi8vIGNvdWxkIHBvc3NpYmx5IGJlIHVzYWJsZSwgdGhvdWdoIHdlJ2QgbmVlZCB0byB0ZWFjaCB0aGUgdGlsZS1yZWFkaW5nIGNvZGVcbi8vIHRvIGlnbm9yZSB3aGF0ZXZlcidzIHdyaXR0ZW4gdGhlcmUsIHNpbmNlIGl0ICppcyogdmlzaWJsZSBiZWZvcmUgdGhlIG1lbnVcbi8vIHBvcHMgdXAuICBUaGVzZSBhcmUgYmlnIGVub3VnaCByZWdpb25zIHRoYXQgd2UgY291bGQgZXZlbiBjb25zaWRlciB1c2luZ1xuLy8gdGhlbSB2aWEgcGFnZS1zd2FwcGluZyB0byBnZXQgZXh0cmEgZGF0YSBpbiBhcmJpdHJhcnkgY29udGV4dHMuXG5cbi8vIFNob3BzIGFyZSBwYXJ0aWN1bGFybHkgbmljZSBiZWNhdXNlIHRoZXkncmUgYWxsIDAwIGluIHZhbmlsbGEuXG4vLyBPdGhlciBwb3NzaWJsZSByZWdpb25zOlxuLy8gICAtIDQ4IGJ5dGVzIGF0ICRmZmMwIChtZXphbWUgc2hyaW5lKSA9PiAkZmZlMCBpcyBhbGwgJGZmIGluIHZhbmlsbGEuXG5cbmV4cG9ydCBjbGFzcyBSb20ge1xuXG4gIC8vIFRoZXNlIHZhbHVlcyBjYW4gYmUgcXVlcmllZCB0byBkZXRlcm1pbmUgaG93IHRvIHBhcnNlIGFueSBnaXZlbiByb20uXG4gIC8vIFRoZXkncmUgYWxsIGFsd2F5cyB6ZXJvIGZvciB2YW5pbGxhXG4gIHN0YXRpYyByZWFkb25seSBPTUlUX0lURU1fR0VUX0RBVEFfU1VGRklYICAgID0gUm9tT3B0aW9uLmJpdCgweDE0MmMwLCAwKTtcbiAgc3RhdGljIHJlYWRvbmx5IE9NSVRfTE9DQUxfRElBTE9HX1NVRkZJWCAgICAgPSBSb21PcHRpb24uYml0KDB4MTQyYzAsIDEpO1xuICBzdGF0aWMgcmVhZG9ubHkgQ09NUFJFU1NFRF9NQVBEQVRBICAgICAgICAgICA9IFJvbU9wdGlvbi5iaXQoMHgxNDJjMCwgMik7XG4gIHN0YXRpYyByZWFkb25seSBTSE9QX0NPVU5UICAgICAgICAgICAgICAgICAgID0gUm9tT3B0aW9uLmJ5dGUoMHgxNDJjMSk7XG4gIHN0YXRpYyByZWFkb25seSBTQ0FMSU5HX0xFVkVMUyAgICAgICAgICAgICAgID0gUm9tT3B0aW9uLmJ5dGUoMHgxNDJjMik7XG4gIHN0YXRpYyByZWFkb25seSBVTklRVUVfSVRFTV9UQUJMRSAgICAgICAgICAgID0gUm9tT3B0aW9uLmFkZHJlc3MoMHgxNDJkMCk7XG4gIHN0YXRpYyByZWFkb25seSBTSE9QX0RBVEFfVEFCTEVTICAgICAgICAgICAgID0gUm9tT3B0aW9uLmFkZHJlc3MoMHgxNDJkMyk7XG4gIHN0YXRpYyByZWFkb25seSBURUxFUEFUSFlfVEFCTEVTICAgICAgICAgICAgID0gUm9tT3B0aW9uLmFkZHJlc3MoMHgxNDJkNik7XG5cbiAgcmVhZG9ubHkgcHJnOiBVaW50OEFycmF5O1xuICByZWFkb25seSBjaHI6IFVpbnQ4QXJyYXk7XG5cbiAgcmVhZG9ubHkgYXJlYXM6IEFyZWFzO1xuICByZWFkb25seSBzY3JlZW5zOiBTY3JlZW5bXTtcbiAgcmVhZG9ubHkgdGlsZXNldHM6IFRpbGVzZXRbXTtcbiAgcmVhZG9ubHkgdGlsZUVmZmVjdHM6IFRpbGVFZmZlY3RzW107XG4gIHJlYWRvbmx5IHRyaWdnZXJzOiBUcmlnZ2VyW107XG4gIHJlYWRvbmx5IHBhdHRlcm5zOiBQYXR0ZXJuW107XG4gIHJlYWRvbmx5IHBhbGV0dGVzOiBQYWxldHRlW107XG4gIHJlYWRvbmx5IGxvY2F0aW9uczogTG9jYXRpb25zO1xuICByZWFkb25seSB0aWxlQW5pbWF0aW9uczogVGlsZUFuaW1hdGlvbltdO1xuICByZWFkb25seSBoaXRib3hlczogSGl0Ym94W107XG4gIHJlYWRvbmx5IG9iamVjdHM6IE9iamVjdHM7XG4gIHJlYWRvbmx5IGFkSG9jU3Bhd25zOiBBZEhvY1NwYXduW107XG4gIHJlYWRvbmx5IG1ldGFzcHJpdGVzOiBNZXRhc3ByaXRlW107XG4gIHJlYWRvbmx5IGl0ZW1HZXRzOiBJdGVtR2V0cztcbiAgcmVhZG9ubHkgaXRlbXM6IEl0ZW1zO1xuICByZWFkb25seSBzaG9wczogU2hvcFtdO1xuICByZWFkb25seSBzbG90czogU2xvdHM7XG4gIHJlYWRvbmx5IG5wY3M6IE5wY3M7XG4gIHJlYWRvbmx5IGJvc3NLaWxsczogQm9zc0tpbGxbXTtcbiAgcmVhZG9ubHkgYm9zc2VzOiBCb3NzZXM7XG4gIHJlYWRvbmx5IHdpbGRXYXJwOiBXaWxkV2FycDtcbiAgcmVhZG9ubHkgdG93bldhcnA6IFRvd25XYXJwO1xuICByZWFkb25seSBmbGFnczogRmxhZ3M7XG5cbiAgcmVhZG9ubHkgdGVsZXBhdGh5OiBUZWxlcGF0aHk7XG4gIHJlYWRvbmx5IG1lc3NhZ2VzOiBNZXNzYWdlcztcblxuICBzcG9pbGVyPzogU3BvaWxlcjtcblxuICAvLyBOT1RFOiBUaGUgZm9sbG93aW5nIHByb3BlcnRpZXMgbWF5IGJlIGNoYW5nZWQgYmV0d2VlbiByZWFkaW5nIGFuZCB3cml0aW5nXG4gIC8vIHRoZSByb20uICBJZiB0aGlzIGhhcHBlbnMsIHRoZSB3cml0dGVuIHJvbSB3aWxsIGhhdmUgZGlmZmVyZW50IG9wdGlvbnMuXG4gIC8vIFRoaXMgaXMgYW4gZWZmZWN0aXZlIHdheSB0byBjb252ZXJ0IGJldHdlZW4gdHdvIHN0eWxlcy5cblxuICAvLyBNYXggbnVtYmVyIG9mIHNob3BzLiAgVmFyaW91cyBibG9ja3Mgb2YgbWVtb3J5IHJlcXVpcmUga25vd2luZyB0aGlzIG51bWJlclxuICAvLyB0byBhbGxvY2F0ZS5cbiAgc2hvcENvdW50OiBudW1iZXI7XG4gIC8vIE51bWJlciBvZiBzY2FsaW5nIGxldmVscy4gIERldGVybWluZXMgdGhlIHNpemUgb2YgdGhlIHNjYWxpbmcgdGFibGVzLlxuICBzY2FsaW5nTGV2ZWxzOiBudW1iZXI7XG5cbiAgLy8gQWRkcmVzcyB0byByZWFkL3dyaXRlIHRoZSBiaXRmaWVsZCBpbmRpY2F0aW5nIHVuaXF1ZSBpdGVtcy5cbiAgdW5pcXVlSXRlbVRhYmxlQWRkcmVzczogbnVtYmVyO1xuICAvLyBBZGRyZXNzIG9mIG5vcm1hbGl6ZWQgcHJpY2VzIHRhYmxlLCBpZiBwcmVzZW50LiAgSWYgdGhpcyBpcyBhYnNlbnQgdGhlbiB3ZVxuICAvLyBhc3N1bWUgcHJpY2VzIGFyZSBub3Qgbm9ybWFsaXplZCBhbmQgYXJlIGF0IHRoZSBub3JtYWwgcGF3biBzaG9wIGFkZHJlc3MuXG4gIHNob3BEYXRhVGFibGVzQWRkcmVzczogbnVtYmVyO1xuICAvLyBBZGRyZXNzIG9mIHJlYXJyYW5nZWQgdGVsZXBhdGh5IHRhYmxlcy5cbiAgdGVsZXBhdGh5VGFibGVzQWRkcmVzczogbnVtYmVyO1xuICAvLyBXaGV0aGVyIHRoZSB0cmFpbGluZyAkZmYgc2hvdWxkIGJlIG9taXR0ZWQgZnJvbSB0aGUgSXRlbUdldERhdGEgdGFibGUuXG4gIG9taXRJdGVtR2V0RGF0YVN1ZmZpeDogYm9vbGVhbjtcbiAgLy8gV2hldGhlciB0aGUgdHJhaWxpbmcgYnl0ZSBvZiBlYWNoIExvY2FsRGlhbG9nIGlzIG9taXR0ZWQuICBUaGlzIGFmZmVjdHNcbiAgLy8gYm90aCByZWFkaW5nIGFuZCB3cml0aW5nIHRoZSB0YWJsZS4gIE1heSBiZSBpbmZlcnJlZCB3aGlsZSByZWFkaW5nLlxuICBvbWl0TG9jYWxEaWFsb2dTdWZmaXg6IGJvb2xlYW47XG4gIC8vIFdoZXRoZXIgbWFwZGF0YSBoYXMgYmVlbiBjb21wcmVzc2VkLlxuICBjb21wcmVzc2VkTWFwRGF0YTogYm9vbGVhbjtcblxuICBjb25zdHJ1Y3Rvcihyb206IFVpbnQ4QXJyYXkpIHtcbiAgICBjb25zdCBwcmdTaXplID0gcm9tWzRdICogMHg0MDAwO1xuICAgIC8vIE5PVEU6IGNoclNpemUgPSByb21bNV0gKiAweDIwMDA7XG4gICAgY29uc3QgcHJnU3RhcnQgPSAweDEwICsgKHJvbVs2XSAmIDQgPyA1MTIgOiAwKTtcbiAgICBjb25zdCBwcmdFbmQgPSBwcmdTdGFydCArIHByZ1NpemU7XG4gICAgdGhpcy5wcmcgPSByb20uc3ViYXJyYXkocHJnU3RhcnQsIHByZ0VuZCk7XG4gICAgdGhpcy5jaHIgPSByb20uc3ViYXJyYXkocHJnRW5kKTtcblxuICAgIHRoaXMuc2hvcENvdW50ID0gUm9tLlNIT1BfQ09VTlQuZ2V0KHJvbSk7XG4gICAgdGhpcy5zY2FsaW5nTGV2ZWxzID0gUm9tLlNDQUxJTkdfTEVWRUxTLmdldChyb20pO1xuICAgIHRoaXMudW5pcXVlSXRlbVRhYmxlQWRkcmVzcyA9IFJvbS5VTklRVUVfSVRFTV9UQUJMRS5nZXQocm9tKTtcbiAgICB0aGlzLnNob3BEYXRhVGFibGVzQWRkcmVzcyA9IFJvbS5TSE9QX0RBVEFfVEFCTEVTLmdldChyb20pO1xuICAgIHRoaXMudGVsZXBhdGh5VGFibGVzQWRkcmVzcyA9IFJvbS5URUxFUEFUSFlfVEFCTEVTLmdldChyb20pO1xuICAgIHRoaXMub21pdEl0ZW1HZXREYXRhU3VmZml4ID0gUm9tLk9NSVRfSVRFTV9HRVRfREFUQV9TVUZGSVguZ2V0KHJvbSk7XG4gICAgdGhpcy5vbWl0TG9jYWxEaWFsb2dTdWZmaXggPSBSb20uT01JVF9MT0NBTF9ESUFMT0dfU1VGRklYLmdldChyb20pO1xuICAgIHRoaXMuY29tcHJlc3NlZE1hcERhdGEgPSBSb20uQ09NUFJFU1NFRF9NQVBEQVRBLmdldChyb20pO1xuXG4gICAgLy8gaWYgKGNyYzMyKHJvbSkgPT09IEVYUEVDVEVEX0NSQzMyKSB7XG4gICAgZm9yIChjb25zdCBbYWRkcmVzcywgb2xkLCB2YWx1ZV0gb2YgQURKVVNUTUVOVFMpIHtcbiAgICAgIGlmICh0aGlzLnByZ1thZGRyZXNzXSA9PT0gb2xkKSB0aGlzLnByZ1thZGRyZXNzXSA9IHZhbHVlO1xuICAgIH1cblxuICAgIC8vIExvYWQgdXAgYSBidW5jaCBvZiBkYXRhIHRhYmxlcy4gIFRoaXMgd2lsbCBpbmNsdWRlIGEgbGFyZ2UgbnVtYmVyIG9mIHRoZVxuICAgIC8vIGRhdGEgdGFibGVzIGluIHRoZSBST00uICBUaGUgaWRlYSBpcyB0aGF0IHdlIGNhbiBlZGl0IHRoZSBhcnJheXMgbG9jYWxseVxuICAgIC8vIGFuZCB0aGVuIGhhdmUgYSBcImNvbW1pdFwiIGZ1bmN0aW9uIHRoYXQgcmVidWlsZHMgdGhlIFJPTSB3aXRoIHRoZSBuZXdcbiAgICAvLyBhcnJheXMuICBXZSBtYXkgbmVlZCB0byB3cml0ZSBhIFwicGFnZWQgYWxsb2NhdG9yXCIgdGhhdCBjYW4gYWxsb2NhdGVcbiAgICAvLyBjaHVua3Mgb2YgUk9NIGluIGEgZ2l2ZW4gcGFnZS4gIFByb2JhYmx5IHdhbnQgdG8gdXNlIGEgZ3JlZWR5IGFsZ29yaXRobVxuICAgIC8vIHdoZXJlIHdlIHN0YXJ0IHdpdGggdGhlIGJpZ2dlc3QgY2h1bmsgYW5kIHB1dCBpdCBpbiB0aGUgc21hbGxlc3Qgc3BvdFxuICAgIC8vIHRoYXQgZml0cyBpdC4gIFByZXN1bWFibHkgd2Uga25vdyB0aGUgc2l6ZXMgdXAgZnJvbnQgZXZlbiBiZWZvcmUgd2UgaGF2ZVxuICAgIC8vIGFsbCB0aGUgYWRkcmVzc2VzLCBzbyB3ZSBjb3VsZCBkbyBhbGwgdGhlIGFsbG9jYXRpb24gYXQgb25jZSAtIHByb2JhYmx5XG4gICAgLy8gcmV0dXJuaW5nIGEgdG9rZW4gZm9yIGVhY2ggYWxsb2NhdGlvbiBhbmQgdGhlbiBhbGwgdG9rZW5zIGdldCBmaWxsZWQgaW5cbiAgICAvLyBhdCBvbmNlIChhY3R1YWwgcHJvbWlzZXMgd291bGQgYmUgbW9yZSB1bndlaWxkeSkuXG4gICAgLy8gVHJpY2t5IC0gd2hhdCBhYm91dCBzaGFyZWQgZWxlbWVudHMgb2YgZGF0YSB0YWJsZXMgLSB3ZSBwdWxsIHRoZW1cbiAgICAvLyBzZXBhcmF0ZWx5LCBidXQgd2UnbGwgbmVlZCB0byByZS1jb2FsZXNjZSB0aGVtLiAgQnV0IHRoaXMgcmVxdWlyZXNcbiAgICAvLyBrbm93aW5nIHRoZWlyIGNvbnRlbnRzIEJFRk9SRSBhbGxvY2F0aW5nIHRoZWlyIHNwYWNlLiAgU28gd2UgbmVlZCB0d29cbiAgICAvLyBhbGxvY2F0ZSBtZXRob2RzIC0gb25lIHdoZXJlIHRoZSBjb250ZW50IGlzIGtub3duIGFuZCBvbmUgd2hlcmUgb25seSB0aGVcbiAgICAvLyBsZW5ndGggaXMga25vd24uXG4gICAgdGhpcy5hcmVhcyA9IG5ldyBBcmVhcyh0aGlzKTsgLy8gbm90ZTogbXVzdCBjb21lIGJlZm9yZSBsb2NhdGlvbnNcbiAgICB0aGlzLnNjcmVlbnMgPSBzZXEoMHgxMDMsIGkgPT4gbmV3IFNjcmVlbih0aGlzLCBpKSk7XG4gICAgdGhpcy50aWxlc2V0cyA9IHNlcSgxMiwgaSA9PiBuZXcgVGlsZXNldCh0aGlzLCBpIDw8IDIgfCAweDgwKSk7XG4gICAgdGhpcy50aWxlRWZmZWN0cyA9IHNlcSgxMSwgaSA9PiBuZXcgVGlsZUVmZmVjdHModGhpcywgaSArIDB4YjMpKTtcbiAgICB0aGlzLnRyaWdnZXJzID0gc2VxKDB4NDMsIGkgPT4gbmV3IFRyaWdnZXIodGhpcywgMHg4MCB8IGkpKTtcbiAgICB0aGlzLnBhdHRlcm5zID0gc2VxKHRoaXMuY2hyLmxlbmd0aCA+PiA0LCBpID0+IG5ldyBQYXR0ZXJuKHRoaXMsIGkpKTtcbiAgICB0aGlzLnBhbGV0dGVzID0gc2VxKDB4MTAwLCBpID0+IG5ldyBQYWxldHRlKHRoaXMsIGkpKTtcbiAgICB0aGlzLmxvY2F0aW9ucyA9IG5ldyBMb2NhdGlvbnModGhpcyk7XG4gICAgdGhpcy50aWxlQW5pbWF0aW9ucyA9IHNlcSg0LCBpID0+IG5ldyBUaWxlQW5pbWF0aW9uKHRoaXMsIGkpKTtcbiAgICB0aGlzLmhpdGJveGVzID0gc2VxKDI0LCBpID0+IG5ldyBIaXRib3godGhpcywgaSkpO1xuICAgIHRoaXMub2JqZWN0cyA9IG5ldyBPYmplY3RzKHRoaXMpO1xuICAgIHRoaXMuYWRIb2NTcGF3bnMgPSBzZXEoMHg2MCwgaSA9PiBuZXcgQWRIb2NTcGF3bih0aGlzLCBpKSk7XG4gICAgdGhpcy5tZXRhc3ByaXRlcyA9IHNlcSgweDEwMCwgaSA9PiBuZXcgTWV0YXNwcml0ZSh0aGlzLCBpKSk7XG4gICAgdGhpcy5tZXNzYWdlcyA9IG5ldyBNZXNzYWdlcyh0aGlzKTtcbiAgICB0aGlzLnRlbGVwYXRoeSA9IG5ldyBUZWxlcGF0aHkodGhpcyk7XG4gICAgdGhpcy5pdGVtR2V0cyA9IG5ldyBJdGVtR2V0cyh0aGlzKTtcbiAgICB0aGlzLml0ZW1zID0gbmV3IEl0ZW1zKHRoaXMpO1xuICAgIHRoaXMuc2hvcHMgPSBzZXEoNDQsIGkgPT4gbmV3IFNob3AodGhpcywgaSkpOyAvLyBOT1RFOiBkZXBlbmRzIG9uIGxvY2F0aW9ucyBhbmQgb2JqZWN0c1xuICAgIHRoaXMuc2xvdHMgPSBuZXcgU2xvdHModGhpcyk7XG4gICAgdGhpcy5ucGNzID0gbmV3IE5wY3ModGhpcyk7XG4gICAgdGhpcy5ib3NzS2lsbHMgPSBzZXEoMHhlLCBpID0+IG5ldyBCb3NzS2lsbCh0aGlzLCBpKSk7XG4gICAgdGhpcy53aWxkV2FycCA9IG5ldyBXaWxkV2FycCh0aGlzKTtcbiAgICB0aGlzLnRvd25XYXJwID0gbmV3IFRvd25XYXJwKHRoaXMpO1xuICAgIHRoaXMuZmxhZ3MgPSBuZXcgRmxhZ3ModGhpcyk7XG4gICAgdGhpcy5ib3NzZXMgPSBuZXcgQm9zc2VzKHRoaXMpOyAvLyBOT1RFOiBtdXN0IGJlIGFmdGVyIE5wY3MgYW5kIEZsYWdzXG4gIH1cblxuICB0cmlnZ2VyKGlkOiBudW1iZXIpOiBUcmlnZ2VyIHtcbiAgICBpZiAoaWQgPCAweDgwIHx8IGlkID4gMHhmZikgdGhyb3cgbmV3IEVycm9yKGBCYWQgdHJpZ2dlciBpZCAkJHtoZXgoaWQpfWApO1xuICAgIHJldHVybiB0aGlzLnRyaWdnZXJzW2lkICYgMHg3Zl07XG4gIH1cblxuICB0aWxlc2V0KGlkOiBudW1iZXIpOiBUaWxlc2V0IHtcbiAgICBpZiAoaWQgPCAweDgwIHx8IGlkID4gMHhhYyB8fCBpZCAmIDMpIHRocm93IG5ldyBFcnJvcihgQmFkIHRpbGVzZXQgaWQgJCR7aGV4KGlkKX1gKTtcbiAgICByZXR1cm4gdGhpcy50aWxlc2V0c1soaWQgJiAweDdmKSA+Pj4gMl07XG4gIH1cblxuICAvLyBUT0RPIC0gY3Jvc3MtcmVmZXJlbmNlIG1vbnN0ZXJzL21ldGFzcHJpdGVzL21ldGF0aWxlcy9zY3JlZW5zIHdpdGggcGF0dGVybnMvcGFsZXR0ZXNcbiAgLy8gZ2V0IG1vbnN0ZXJzKCk6IE9iamVjdERhdGFbXSB7XG4gIC8vICAgY29uc3QgbW9uc3RlcnMgPSBuZXcgU2V0PE9iamVjdERhdGE+KCk7XG4gIC8vICAgZm9yIChjb25zdCBsIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gIC8vICAgICBpZiAoIWwudXNlZCB8fCAhbC5oYXNTcGF3bnMpIGNvbnRpbnVlO1xuICAvLyAgICAgZm9yIChjb25zdCBvIG9mIGwuc3Bhd25zKSB7XG4gIC8vICAgICAgIGlmIChvLmlzTW9uc3RlcigpKSBtb25zdGVycy5hZGQodGhpcy5vYmplY3RzW28ubW9uc3RlcklkXSk7XG4gIC8vICAgICB9XG4gIC8vICAgfVxuICAvLyAgIHJldHVybiBbLi4ubW9uc3RlcnNdLnNvcnQoKHgsIHkpID0+ICh4LmlkIC0geS5pZCkpO1xuICAvLyB9XG5cbiAgZ2V0IHByb2plY3RpbGVzKCk6IE9iamVjdERhdGFbXSB7XG4gICAgY29uc3QgcHJvamVjdGlsZXMgPSBuZXcgU2V0PE9iamVjdERhdGE+KCk7XG4gICAgZm9yIChjb25zdCBtIG9mIHRoaXMub2JqZWN0cy5maWx0ZXIobyA9PiBvIGluc3RhbmNlb2YgTW9uc3RlcikpIHtcbiAgICAgIGlmIChtLmNoaWxkKSB7XG4gICAgICAgIHByb2plY3RpbGVzLmFkZCh0aGlzLm9iamVjdHNbdGhpcy5hZEhvY1NwYXduc1ttLmNoaWxkXS5vYmplY3RJZF0pO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gWy4uLnByb2plY3RpbGVzXS5zb3J0KCh4LCB5KSA9PiAoeC5pZCAtIHkuaWQpKTtcbiAgfVxuXG4gIGdldCBtb25zdGVyR3JhcGhpY3MoKSB7XG4gICAgY29uc3QgZ2Z4OiB7W2lkOiBzdHJpbmddOlxuICAgICAgICAgICAgICAgIHtbaW5mbzogc3RyaW5nXTpcbiAgICAgICAgICAgICAgICAge3Nsb3Q6IG51bWJlciwgcGF0OiBudW1iZXIsIHBhbDogbnVtYmVyfX19ID0ge307XG4gICAgZm9yIChjb25zdCBsIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICBpZiAoIWwudXNlZCB8fCAhbC5oYXNTcGF3bnMpIGNvbnRpbnVlO1xuICAgICAgZm9yIChjb25zdCBvIG9mIGwuc3Bhd25zKSB7XG4gICAgICAgIGlmICghKG8uZGF0YVsyXSAmIDcpKSB7XG4gICAgICAgICAgY29uc3Qgc2xvdCA9IG8uZGF0YVsyXSAmIDB4ODAgPyAxIDogMDtcbiAgICAgICAgICBjb25zdCBpZCA9IGhleChvLmRhdGFbM10gKyAweDUwKTtcbiAgICAgICAgICBjb25zdCBkYXRhID0gZ2Z4W2lkXSA9IGdmeFtpZF0gfHwge307XG4gICAgICAgICAgZGF0YVtgJHtzbG90fToke2wuc3ByaXRlUGF0dGVybnNbc2xvdF0udG9TdHJpbmcoMTYpfToke1xuICAgICAgICAgICAgICAgbC5zcHJpdGVQYWxldHRlc1tzbG90XS50b1N0cmluZygxNil9YF1cbiAgICAgICAgICAgID0ge3BhbDogbC5zcHJpdGVQYWxldHRlc1tzbG90XSxcbiAgICAgICAgICAgICAgIHBhdDogbC5zcHJpdGVQYXR0ZXJuc1tzbG90XSxcbiAgICAgICAgICAgICAgIHNsb3QsXG4gICAgICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIGdmeDtcbiAgfVxuXG4gIGdldCBsb2NhdGlvbk1vbnN0ZXJzKCkge1xuICAgIGNvbnN0IG06IHtbaWQ6IHN0cmluZ106IHtbaW5mbzogc3RyaW5nXTogbnVtYmVyfX0gPSB7fTtcbiAgICBmb3IgKGNvbnN0IGwgb2YgdGhpcy5sb2NhdGlvbnMpIHtcbiAgICAgIGlmICghbC51c2VkIHx8ICFsLmhhc1NwYXducykgY29udGludWU7XG4gICAgICAvLyB3aGljaCBtb25zdGVycyBhcmUgaW4gd2hpY2ggc2xvdHM/XG4gICAgICBjb25zdCBzOiB7W2luZm86IHN0cmluZ106IG51bWJlcn0gPSBtWyckJyArIGhleChsLmlkKV0gPSB7fTtcbiAgICAgIGZvciAoY29uc3QgbyBvZiBsLnNwYXducykge1xuICAgICAgICBpZiAoIShvLmRhdGFbMl0gJiA3KSkge1xuICAgICAgICAgIGNvbnN0IHNsb3QgPSBvLmRhdGFbMl0gJiAweDgwID8gMSA6IDA7XG4gICAgICAgICAgY29uc3QgaWQgPSBvLmRhdGFbM10gKyAweDUwO1xuICAgICAgICAgIHNbYCR7c2xvdH06JHtpZC50b1N0cmluZygxNil9YF0gPVxuICAgICAgICAgICAgICAoc1tgJHtzbG90fToke2lkLnRvU3RyaW5nKDE2KX1gXSB8fCAwKSArIDE7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIG07XG4gIH1cblxuICAvLyBUT0RPIC0gZm9yIGVhY2ggc3ByaXRlIHBhdHRlcm4gdGFibGUsIGZpbmQgYWxsIHRoZSBwYWxldHRlcyB0aGF0IGl0IHVzZXMuXG4gIC8vIEZpbmQgYWxsIHRoZSBtb25zdGVycyBvbiBpdC4gIFdlIGNhbiBwcm9iYWJseSBhbGxvdyBhbnkgcGFsZXR0ZSBzbyBsb25nXG4gIC8vIGFzIG9uZSBvZiB0aGUgcGFsZXR0ZXMgaXMgdXNlZCB3aXRoIHRoYXQgcGF0dGVybi5cbiAgLy8gVE9ETyAtIG1heCBudW1iZXIgb2YgaW5zdGFuY2VzIG9mIGEgbW9uc3RlciBvbiBhbnkgbWFwIC0gaS5lLiBhdm9pZCBoYXZpbmdcbiAgLy8gZml2ZSBmbHllcnMgb24gdGhlIHNhbWUgbWFwIVxuXG4gIC8vIDQ2MCAtIDAgbWVhbnMgZWl0aGVyIGZseWVyIG9yIHN0YXRpb25hcnlcbiAgLy8gICAgICAgICAgIC0gc3RhdGlvbmFyeSBoYXMgNGEwIH4gMjA0LDIwNSwyMDZcbiAgLy8gICAgICAgICAgICAgKGtyYWtlbiwgc3dhbXAgcGxhbnQsIHNvcmNlcm9yKVxuICAvLyAgICAgICA2IC0gbWltaWNcbiAgLy8gICAgICAgMWYgLSBzd2ltbWVyXG4gIC8vICAgICAgIDU0IC0gdG9tYXRvIGFuZCBiaXJkXG4gIC8vICAgICAgIDU1IC0gc3dpbW1lclxuICAvLyAgICAgICA1NyAtIG5vcm1hbFxuICAvLyAgICAgICA1ZiAtIGFsc28gbm9ybWFsLCBidXQgbWVkdXNhIGhlYWQgaXMgZmx5ZXI/XG4gIC8vICAgICAgIDc3IC0gc29sZGllcnMsIGljZSB6b21iaWVcblxuLy8gICAvLyBEb24ndCB3b3JyeSBhYm91dCBvdGhlciBkYXRhcyB5ZXRcbi8vICAgd3JpdGVPYmplY3REYXRhKCkge1xuLy8gICAgIC8vIGJ1aWxkIHVwIGEgbWFwIGZyb20gYWN0dWFsIGRhdGEgdG8gaW5kZXhlcyB0aGF0IHBvaW50IHRvIGl0XG4vLyAgICAgbGV0IGFkZHIgPSAweDFhZTAwO1xuLy8gICAgIGNvbnN0IGRhdGFzID0ge307XG4vLyAgICAgZm9yIChjb25zdCBvYmplY3Qgb2YgdGhpcy5vYmplY3RzKSB7XG4vLyAgICAgICBjb25zdCBzZXIgPSBvYmplY3Quc2VyaWFsaXplKCk7XG4vLyAgICAgICBjb25zdCBkYXRhID0gc2VyLmpvaW4oJyAnKTtcbi8vICAgICAgIGlmIChkYXRhIGluIGRhdGFzKSB7XG4vLyAvL2NvbnNvbGUubG9nKGAkJHtvYmplY3QuaWQudG9TdHJpbmcoMTYpLnBhZFN0YXJ0KDIsMCl9OiBSZXVzaW5nIGV4aXN0aW5nIGRhdGEgJCR7ZGF0YXNbZGF0YV0udG9TdHJpbmcoMTYpfWApO1xuLy8gICAgICAgICBvYmplY3Qub2JqZWN0RGF0YUJhc2UgPSBkYXRhc1tkYXRhXTtcbi8vICAgICAgIH0gZWxzZSB7XG4vLyAgICAgICAgIG9iamVjdC5vYmplY3REYXRhQmFzZSA9IGFkZHI7XG4vLyAgICAgICAgIGRhdGFzW2RhdGFdID0gYWRkcjtcbi8vIC8vY29uc29sZS5sb2coYCQke29iamVjdC5pZC50b1N0cmluZygxNikucGFkU3RhcnQoMiwwKX06IERhdGEgaXMgYXQgJCR7XG4vLyAvLyAgICAgICAgICAgICBhZGRyLnRvU3RyaW5nKDE2KX06ICR7QXJyYXkuZnJvbShzZXIsIHg9PickJyt4LnRvU3RyaW5nKDE2KS5wYWRTdGFydCgyLDApKS5qb2luKCcsJyl9YCk7XG4vLyAgICAgICAgIGFkZHIgKz0gc2VyLmxlbmd0aDtcbi8vIC8vIHNlZWQgMzUxNzgxMTAzNlxuLy8gICAgICAgfVxuLy8gICAgICAgb2JqZWN0LndyaXRlKCk7XG4vLyAgICAgfVxuLy8gLy9jb25zb2xlLmxvZyhgV3JvdGUgb2JqZWN0IGRhdGEgZnJvbSAkMWFjMDAgdG8gJCR7YWRkci50b1N0cmluZygxNikucGFkU3RhcnQoNSwgMClcbi8vIC8vICAgICAgICAgICAgIH0sIHNhdmluZyAkezB4MWJlOTEgLSBhZGRyfSBieXRlcy5gKTtcbi8vICAgICByZXR1cm4gYWRkcjtcbi8vICAgfVxuXG4gIGFzeW5jIHdyaXRlRGF0YSgpIHtcbiAgICAvLyBXcml0ZSB0aGUgb3B0aW9ucyBmaXJzdFxuICAgIFJvbS5TSE9QX0NPVU5ULnNldCh0aGlzLnByZywgdGhpcy5zaG9wQ291bnQpO1xuICAgIFJvbS5TQ0FMSU5HX0xFVkVMUy5zZXQodGhpcy5wcmcsIHRoaXMuc2NhbGluZ0xldmVscyk7XG4gICAgUm9tLlVOSVFVRV9JVEVNX1RBQkxFLnNldCh0aGlzLnByZywgdGhpcy51bmlxdWVJdGVtVGFibGVBZGRyZXNzKTtcbiAgICBSb20uU0hPUF9EQVRBX1RBQkxFUy5zZXQodGhpcy5wcmcsIHRoaXMuc2hvcERhdGFUYWJsZXNBZGRyZXNzKTtcbiAgICBSb20uT01JVF9JVEVNX0dFVF9EQVRBX1NVRkZJWC5zZXQodGhpcy5wcmcsIHRoaXMub21pdEl0ZW1HZXREYXRhU3VmZml4KTtcbiAgICBSb20uT01JVF9MT0NBTF9ESUFMT0dfU1VGRklYLnNldCh0aGlzLnByZywgdGhpcy5vbWl0TG9jYWxEaWFsb2dTdWZmaXgpO1xuICAgIFJvbS5DT01QUkVTU0VEX01BUERBVEEuc2V0KHRoaXMucHJnLCB0aGlzLmNvbXByZXNzZWRNYXBEYXRhKTtcblxuICAgIGNvbnN0IHdyaXRlciA9IG5ldyBXcml0ZXIodGhpcy5wcmcsIHRoaXMuY2hyKTtcbiAgICAvLyBNYXBEYXRhXG4gICAgd3JpdGVyLmFsbG9jKDB4MTQ0ZjgsIDB4MTdlMDApO1xuICAgIC8vIE5wY0RhdGFcbiAgICAvLyBOT1RFOiAxOTNmOSBpcyBhc3N1bWluZyAkZmIgaXMgdGhlIGxhc3QgbG9jYXRpb24gSUQuICBJZiB3ZSBhZGQgbW9yZSBsb2NhdGlvbnMgYXRcbiAgICAvLyB0aGUgZW5kIHRoZW4gd2UnbGwgbmVlZCB0byBwdXNoIHRoaXMgYmFjayBhIGZldyBtb3JlIGJ5dGVzLiAgV2UgY291bGQgcG9zc2libHlcbiAgICAvLyBkZXRlY3QgdGhlIGJhZCB3cml0ZSBhbmQgdGhyb3cgYW4gZXJyb3IsIGFuZC9vciBjb21wdXRlIHRoZSBtYXggbG9jYXRpb24gSUQuXG4gICAgd3JpdGVyLmFsbG9jKDB4MTkzZjksIDB4MWFjMDApO1xuICAgIC8vIE9iamVjdERhdGEgKGluZGV4IGF0IDFhYzAwLi4xYWUwMClcbiAgICB3cml0ZXIuYWxsb2MoMHgxYWUwMCwgMHgxYmQwMCk7IC8vIHNhdmUgNTEyIGJ5dGVzIGF0IGVuZCBmb3Igc29tZSBleHRyYSBjb2RlXG4gICAgLy8gTnBjU3Bhd25Db25kaXRpb25zXG4gICAgd3JpdGVyLmFsbG9jKDB4MWM3N2EsIDB4MWM5NWQpO1xuICAgIC8vIE5wY0RpYWxvZ1xuICAgIHdyaXRlci5hbGxvYygweDFjYWU1LCAweDFkOGY0KTtcbiAgICAvLyBJdGVtR2V0RGF0YSAodG8gMWUwNjUpICsgSXRlbVVzZURhdGFcbiAgICB3cml0ZXIuYWxsb2MoMHgxZGRlNiwgMHgxZTEwNik7XG4gICAgLy8gVHJpZ2dlckRhdGFcbiAgICAvLyBOT1RFOiBUaGVyZSdzIHNvbWUgZnJlZSBzcGFjZSBhdCAxZTNjMC4uMWUzZjAsIGJ1dCB3ZSB1c2UgdGhpcyBmb3IgdGhlXG4gICAgLy8gQ2hlY2tCZWxvd0Jvc3MgdHJpZ2dlcnMuXG4gICAgd3JpdGVyLmFsbG9jKDB4MWUyMDAsIDB4MWUzYzApO1xuICAgIC8vIEl0ZW1NZW51TmFtZVxuICAgIHdyaXRlci5hbGxvYygweDIxMTFhLCAweDIxNDY4KTtcbiAgICAvLyBrZWVwIGl0ZW0gJDQ5IFwiICAgICAgICBcIiB3aGljaCBpcyBhY3R1YWxseSB1c2VkIHNvbWV3aGVyZT9cbiAgICAvLyB3cml0ZXIuYWxsb2MoMHgyMTQ3MSwgMHgyMTRmMSk7IC8vIFRPRE8gLSBkbyB3ZSBuZWVkIGFueSBvZiB0aGlzP1xuICAgIC8vIEl0ZW1NZXNzYWdlTmFtZVxuICAgIC8vIHdyaXRlci5hbGxvYygweDI4ZTgxLCAweDI5MjJiKTsgLy8gTk9URTogdW5jb3ZlcmVkIHRocnUgMjk0MDBcbiAgICAvLyB3cml0ZXIuYWxsb2MoMHgyOTIyYiwgMHgyOTQwMCk7IC8vIFRPRE8gLSBuZWVkZWQ/XG4gICAgLy8gTk9URTogb25jZSB3ZSByZWxlYXNlIHRoZSBvdGhlciBtZXNzYWdlIHRhYmxlcywgdGhpcyB3aWxsIGp1c3QgYmUgb25lIGdpYW50IGJsb2NrLlxuXG4gICAgLy8gTWVzc2FnZSB0YWJsZSBwYXJ0c1xuICAgIC8vIHdyaXRlci5hbGxvYygweDI4MDAwLCAweDI4M2ZlKTtcbiAgICAvLyBNZXNzYWdlIHRhYmxlc1xuICAgIC8vIFRPRE8gLSB3ZSBkb24ndCB1c2UgdGhlIHdyaXRlciB0byBhbGxvY2F0ZSB0aGUgYWJicmV2aWF0aW9uIHRhYmxlcywgYnV0IHdlIGNvdWxkXG4gICAgd3JpdGVyLmFsbG9jKDB4MmEwMDAsIDB4MmZjMDApO1xuXG4gICAgaWYgKHRoaXMudGVsZXBhdGh5VGFibGVzQWRkcmVzcykge1xuICAgICAgd3JpdGVyLmFsbG9jKDB4MWQ4ZjQsIDB4MWRiMDApOyAvLyBsb2NhdGlvbiB0YWJsZSBhbGwgdGhlIHdheSB0aHJ1IG1haW5cbiAgICB9IGVsc2Uge1xuICAgICAgd3JpdGVyLmFsbG9jKDB4MWRhNGMsIDB4MWRiMDApOyAvLyBleGlzdGluZyBtYWluIHRhYmxlIGlzIGhlcmUuXG4gICAgfVxuXG4gICAgY29uc3QgcHJvbWlzZXMgPSBbXTtcbiAgICBjb25zdCB3cml0ZUFsbCA9ICh3cml0YWJsZXM6IHt3cml0ZSh3cml0ZXI6IFdyaXRlcik6IHVua25vd259W10pID0+IHtcbiAgICAgIGZvciAoY29uc3QgdyBvZiB3cml0YWJsZXMpIHtcbiAgICAgICAgcHJvbWlzZXMucHVzaCh3LndyaXRlKHdyaXRlcikpO1xuICAgICAgfVxuICAgIH07XG4gICAgd3JpdGVBbGwodGhpcy5sb2NhdGlvbnMpO1xuICAgIHdyaXRlQWxsKHRoaXMub2JqZWN0cyk7XG4gICAgd3JpdGVBbGwodGhpcy5oaXRib3hlcyk7XG4gICAgd3JpdGVBbGwodGhpcy50cmlnZ2Vycyk7XG4gICAgd3JpdGVBbGwodGhpcy5ucGNzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnRpbGVzZXRzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnRpbGVFZmZlY3RzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnNjcmVlbnMpO1xuICAgIHdyaXRlQWxsKHRoaXMuYWRIb2NTcGF3bnMpO1xuICAgIHRoaXMuaXRlbUdldHMud3JpdGUod3JpdGVyKTtcbiAgICB0aGlzLnNsb3RzLndyaXRlKHdyaXRlcik7XG4gICAgdGhpcy5pdGVtcy53cml0ZSh3cml0ZXIpO1xuICAgIHdyaXRlQWxsKHRoaXMuc2hvcHMpO1xuICAgIHdyaXRlQWxsKHRoaXMuYm9zc0tpbGxzKTtcbiAgICB3cml0ZUFsbCh0aGlzLnBhdHRlcm5zKTtcbiAgICB0aGlzLndpbGRXYXJwLndyaXRlKHdyaXRlcik7XG4gICAgdGhpcy50b3duV2FycC53cml0ZSh3cml0ZXIpO1xuICAgIHByb21pc2VzLnB1c2godGhpcy50ZWxlcGF0aHkud3JpdGUod3JpdGVyKSk7XG4gICAgcHJvbWlzZXMucHVzaCh0aGlzLm1lc3NhZ2VzLndyaXRlKHdyaXRlcikpO1xuICAgIHByb21pc2VzLnB1c2god3JpdGVyLmNvbW1pdCgpKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChwcm9taXNlcykudGhlbigoKSA9PiB1bmRlZmluZWQpO1xuICAgIHdyaXRlci5yZXBvcnQoKTtcbiAgfVxuXG4gIGFuYWx5emVUaWxlcygpIHtcbiAgICAvLyBGb3IgYW55IGdpdmVuIHRpbGUgaW5kZXgsIHdoYXQgc2NyZWVucyBkb2VzIGl0IGFwcGVhciBvbi5cbiAgICAvLyBGb3IgdGhvc2Ugc2NyZWVucywgd2hpY2ggdGlsZXNldHMgZG9lcyAqaXQqIGFwcGVhciBvbi5cbiAgICAvLyBUaGF0IHRpbGUgSUQgaXMgbGlua2VkIGFjcm9zcyBhbGwgdGhvc2UgdGlsZXNldHMuXG4gICAgLy8gRm9ybXMgYSBwYXJ0aXRpb25pbmcgZm9yIGVhY2ggdGlsZSBJRCA9PiB1bmlvbi1maW5kLlxuICAgIC8vIEdpdmVuIHRoaXMgcGFydGl0aW9uaW5nLCBpZiBJIHdhbnQgdG8gbW92ZSBhIHRpbGUgb24gYSBnaXZlblxuICAgIC8vIHRpbGVzZXQsIGFsbCBJIG5lZWQgdG8gZG8gaXMgZmluZCBhbm90aGVyIHRpbGUgSUQgd2l0aCB0aGVcbiAgICAvLyBzYW1lIHBhcnRpdGlvbiBhbmQgc3dhcCB0aGVtP1xuXG4gICAgLy8gTW9yZSBnZW5lcmFsbHksIHdlIGNhbiBqdXN0IHBhcnRpdGlvbiB0aGUgdGlsZXNldHMuXG5cbiAgICAvLyBGb3IgZWFjaCBzY3JlZW4sIGZpbmQgYWxsIHRpbGVzZXRzIFQgZm9yIHRoYXQgc2NyZWVuXG4gICAgLy8gVGhlbiBmb3IgZWFjaCB0aWxlIG9uIHRoZSBzY3JlZW4sIHVuaW9uIFQgZm9yIHRoYXQgdGlsZS5cblxuICAgIC8vIEdpdmVuIGEgdGlsZXNldCBhbmQgYSBtZXRhdGlsZSBJRCwgZmluZCBhbGwgdGhlIHNjcmVlbnMgdGhhdCAoMSkgYXJlIHJlbmRlcmVkXG4gICAgLy8gd2l0aCB0aGF0IHRpbGVzZXQsIGFuZCAoYikgdGhhdCBjb250YWluIHRoYXQgbWV0YXRpbGU7IHRoZW4gZmluZCBhbGwgKm90aGVyKlxuICAgIC8vIHRpbGVzZXRzIHRoYXQgdGhvc2Ugc2NyZWVucyBhcmUgZXZlciByZW5kZXJlZCB3aXRoLlxuXG4gICAgLy8gR2l2ZW4gYSBzY3JlZW4sIGZpbmQgYWxsIGF2YWlsYWJsZSBtZXRhdGlsZSBJRHMgdGhhdCBjb3VsZCBiZSBhZGRlZCB0byBpdFxuICAgIC8vIHdpdGhvdXQgY2F1c2luZyBwcm9ibGVtcyB3aXRoIG90aGVyIHNjcmVlbnMgdGhhdCBzaGFyZSBhbnkgdGlsZXNldHMuXG4gICAgLy8gIC0+IHVudXNlZCAob3IgdXNlZCBidXQgc2hhcmVkIGV4Y2x1c2l2ZWx5KSBhY3Jvc3MgYWxsIHRpbGVzZXRzIHRoZSBzY3JlZW4gbWF5IHVzZVxuXG4gICAgLy8gV2hhdCBJIHdhbnQgZm9yIHN3YXBwaW5nIGlzIHRoZSBmb2xsb3dpbmc6XG4gICAgLy8gIDEuIGZpbmQgYWxsIHNjcmVlbnMgSSB3YW50IHRvIHdvcmsgb24gPT4gdGlsZXNldHNcbiAgICAvLyAgMi4gZmluZCB1bnVzZWQgZmxhZ2dhYmJsZSB0aWxlcyBpbiB0aGUgaGFyZGVzdCBvbmUsXG4gICAgLy8gICAgIHdoaWNoIGFyZSBhbHNvIElTT0xBVEVEIGluIHRoZSBvdGhlcnMuXG4gICAgLy8gIDMuIHdhbnQgdGhlc2UgdGlsZXMgdG8gYmUgdW51c2VkIGluIEFMTCByZWxldmFudCB0aWxlc2V0c1xuICAgIC8vICA0LiB0byBtYWtlIHRoaXMgc28sIGZpbmQgKm90aGVyKiB1bnVzZWQgZmxhZ2dhYmxlIHRpbGVzIGluIG90aGVyIHRpbGVzZXRzXG4gICAgLy8gIDUuIHN3YXAgdGhlIHVudXNlZCB3aXRoIHRoZSBpc29sYXRlZCB0aWxlcyBpbiB0aGUgb3RoZXIgdGlsZXNldHNcblxuICAgIC8vIENhdmVzOlxuICAgIC8vICAwYTogICAgICA5MCAvIDljXG4gICAgLy8gIDE1OiA4MCAvIDkwIC8gOWNcbiAgICAvLyAgMTk6ICAgICAgOTAgICAgICAod2lsbCBhZGQgdG8gODA/KVxuICAgIC8vICAzZTogICAgICA5MFxuICAgIC8vXG4gICAgLy8gSWRlYWxseSB3ZSBjb3VsZCByZXVzZSA4MCdzIDEvMi8zLzQgZm9yIHRoaXNcbiAgICAvLyAgMDE6IDkwIHwgOTQgOWNcbiAgICAvLyAgMDI6IDkwIHwgOTQgOWNcbiAgICAvLyAgMDM6ICAgICAgOTQgOWNcbiAgICAvLyAgMDQ6IDkwIHwgOTQgOWNcbiAgICAvL1xuICAgIC8vIE5lZWQgNCBvdGhlciBmbGFnZ2FibGUgdGlsZSBpbmRpY2VzIHdlIGNhbiBzd2FwIHRvP1xuICAgIC8vICAgOTA6ID0+ICgxLDIgbmVlZCBmbGFnZ2FibGU7IDMgdW51c2VkOyA0IGFueSkgPT4gMDcsIDBlLCAxMCwgMTIsIDEzLCAuLi4sIDIwLCAyMSwgMjIsIC4uLlxuICAgIC8vICAgOTQgOWM6ID0+IGRvbid0IG5lZWQgYW55IGZsYWdnYWJsZSA9PiAwNSwgM2MsIDY4LCA4MywgODgsIDg5LCA4YSwgOTAsIC4uLlxuICB9XG5cbiAgZGlzam9pbnRUaWxlc2V0cygpIHtcbiAgICBjb25zdCB0aWxlc2V0QnlTY3JlZW46IEFycmF5PFNldDxudW1iZXI+PiA9IFtdO1xuICAgIGZvciAoY29uc3QgbG9jIG9mIHRoaXMubG9jYXRpb25zKSB7XG4gICAgICBpZiAoIWxvYy51c2VkKSBjb250aW51ZTtcbiAgICAgIGNvbnN0IHRpbGVzZXQgPSBsb2MudGlsZXNldDtcbiAgICAgIGNvbnN0IGV4dCA9IGxvYy5leHRlbmRlZCA/IDB4MTAwIDogMDtcbiAgICAgIGZvciAoY29uc3Qgcm93IG9mIGxvYy5zY3JlZW5zKSB7XG4gICAgICAgIGZvciAoY29uc3QgcyBvZiByb3cpIHtcbiAgICAgICAgICAodGlsZXNldEJ5U2NyZWVuW3MgKyBleHRdIHx8ICh0aWxlc2V0QnlTY3JlZW5bcyArIGV4dF0gPSBuZXcgU2V0KCkpKS5hZGQodGlsZXNldCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgdGlsZXMgPSBzZXEoMjU2LCAoKSA9PiBuZXcgVW5pb25GaW5kPG51bWJlcj4oKSk7XG4gICAgZm9yIChsZXQgcyA9IDA7IHMgPCB0aWxlc2V0QnlTY3JlZW4ubGVuZ3RoOyBzKyspIHtcbiAgICAgIGlmICghdGlsZXNldEJ5U2NyZWVuW3NdKSBjb250aW51ZTtcbiAgICAgIGZvciAoY29uc3QgdCBvZiB0aGlzLnNjcmVlbnNbc10uYWxsVGlsZXNTZXQoKSkge1xuICAgICAgICB0aWxlc1t0XS51bmlvbihbLi4udGlsZXNldEJ5U2NyZWVuW3NdXSk7XG4gICAgICB9XG4gICAgfVxuICAgIC8vIG91dHB1dFxuICAgIGZvciAobGV0IHQgPSAwOyB0IDwgdGlsZXMubGVuZ3RoOyB0KyspIHtcbiAgICAgIGNvbnN0IHAgPSB0aWxlc1t0XS5zZXRzKClcbiAgICAgICAgICAubWFwKChzOiBTZXQ8bnVtYmVyPikgPT4gWy4uLnNdLm1hcChoZXgpLmpvaW4oJyAnKSlcbiAgICAgICAgICAuam9pbignIHwgJyk7XG4gICAgICBjb25zb2xlLmxvZyhgVGlsZSAke2hleCh0KX06ICR7cH1gKTtcbiAgICB9XG4gICAgLy8gICBpZiAoIXRpbGVzZXRCeVNjcmVlbltpXSkge1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhgTm8gdGlsZXNldCBmb3Igc2NyZWVuICR7aS50b1N0cmluZygxNil9YCk7XG4gICAgLy8gICAgIGNvbnRpbnVlO1xuICAgIC8vICAgfVxuICAgIC8vICAgdW5pb24udW5pb24oWy4uLnRpbGVzZXRCeVNjcmVlbltpXV0pO1xuICAgIC8vIH1cbiAgICAvLyByZXR1cm4gdW5pb24uc2V0cygpO1xuICB9XG5cbiAgLy8gQ3ljbGVzIGFyZSBub3QgYWN0dWFsbHkgY3ljbGljIC0gYW4gZXhwbGljaXQgbG9vcCBhdCB0aGUgZW5kIGlzIHJlcXVpcmVkIHRvIHN3YXAuXG4gIC8vIFZhcmlhbmNlOiBbMSwgMiwgbnVsbF0gd2lsbCBjYXVzZSBpbnN0YW5jZXMgb2YgMSB0byBiZWNvbWUgMiBhbmQgd2lsbFxuICAvLyAgICAgICAgICAgY2F1c2UgcHJvcGVydGllcyBvZiAxIHRvIGJlIGNvcGllZCBpbnRvIHNsb3QgMlxuICAvLyBDb21tb24gdXNhZ2UgaXMgdG8gc3dhcCB0aGluZ3Mgb3V0IG9mIHRoZSB3YXkgYW5kIHRoZW4gY29weSBpbnRvIHRoZVxuICAvLyBuZXdseS1mcmVlZCBzbG90LiAgU2F5IHdlIHdhbnRlZCB0byBmcmVlIHVwIHNsb3RzIFsxLCAyLCAzLCA0XSBhbmRcbiAgLy8gaGFkIGF2YWlsYWJsZS9mcmVlIHNsb3RzIFs1LCA2LCA3LCA4XSBhbmQgd2FudCB0byBjb3B5IGZyb20gWzksIGEsIGIsIGNdLlxuICAvLyBUaGVuIGN5Y2xlcyB3aWxsIGJlIFsxLCA1LCA5XSA/Pz8gbm9cbiAgLy8gIC0gcHJvYmFibHkgd2FudCB0byBkbyBzY3JlZW5zIHNlcGFyYXRlbHkgZnJvbSB0aWxlc2V0cy4uLj9cbiAgLy8gTk9URSAtIHdlIGRvbid0IGFjdHVhbGx5IHdhbnQgdG8gY2hhbmdlIHRpbGVzIGZvciB0aGUgbGFzdCBjb3B5Li4uIVxuICAvLyAgIGluIHRoaXMgY2FzZSwgdHNbNV0gPC0gdHNbMV0sIHRzWzFdIDwtIHRzWzldLCBzY3JlZW4ubWFwKDEgLT4gNSlcbiAgLy8gICByZXBsYWNlKFsweDkwXSwgWzUsIDEsIH45XSlcbiAgLy8gICAgID0+IDFzIHJlcGxhY2VkIHdpdGggNXMgaW4gc2NyZWVucyBidXQgOXMgTk9UIHJlcGxhY2VkIHdpdGggMXMuXG4gIC8vIEp1c3QgYnVpbGQgdGhlIHBhcnRpdGlvbiBvbmNlIGxhemlseT8gdGhlbiBjYW4gcmV1c2UuLi5cbiAgLy8gICAtIGVuc3VyZSBib3RoIHNpZGVzIG9mIHJlcGxhY2VtZW50IGhhdmUgY29ycmVjdCBwYXJ0aXRpb25pbmc/RVxuICAvLyAgICAgb3IganVzdCBkbyBpdCBvZmZsaW5lIC0gaXQncyBzaW1wbGVyXG4gIC8vIFRPRE8gLSBTYW5pdHkgY2hlY2s/ICBXYW50IHRvIG1ha2Ugc3VyZSBub2JvZHkgaXMgdXNpbmcgY2xvYmJlcmVkIHRpbGVzP1xuICBzd2FwTWV0YXRpbGVzKHRpbGVzZXRzOiBudW1iZXJbXSwgLi4uY3ljbGVzOiAobnVtYmVyIHwgbnVtYmVyW10pW11bXSkge1xuICAgIC8vIFByb2Nlc3MgdGhlIGN5Y2xlc1xuICAgIGNvbnN0IHJldiA9IG5ldyBNYXA8bnVtYmVyLCBudW1iZXI+KCk7XG4gICAgY29uc3QgcmV2QXJyOiBudW1iZXJbXSA9IHNlcSgweDEwMCk7XG4gICAgY29uc3QgYWx0ID0gbmV3IE1hcDxudW1iZXIsIG51bWJlcj4oKTtcbiAgICBjb25zdCBjcGwgPSAoeDogbnVtYmVyIHwgbnVtYmVyW10pOiBudW1iZXIgPT4gQXJyYXkuaXNBcnJheSh4KSA/IHhbMF0gOiB4IDwgMCA/IH54IDogeDtcbiAgICBmb3IgKGNvbnN0IGN5Y2xlIG9mIGN5Y2xlcykge1xuICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjeWNsZS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkoY3ljbGVbaV0pKSB7XG4gICAgICAgICAgY29uc3QgYXJyID0gY3ljbGVbaV0gYXMgbnVtYmVyW107XG4gICAgICAgICAgYWx0LnNldChhcnJbMF0sIGFyclsxXSk7XG4gICAgICAgICAgY3ljbGVbaV0gPSBhcnJbMF07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3ljbGUubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgIGNvbnN0IGogPSBjeWNsZVtpXSBhcyBudW1iZXI7XG4gICAgICAgIGNvbnN0IGsgPSBjeWNsZVtpICsgMV0gYXMgbnVtYmVyO1xuICAgICAgICBpZiAoaiA8IDAgfHwgayA8IDApIGNvbnRpbnVlO1xuICAgICAgICByZXYuc2V0KGssIGopO1xuICAgICAgICByZXZBcnJba10gPSBqO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBjb25zdCByZXBsYWNlbWVudFNldCA9IG5ldyBTZXQocmVwbGFjZW1lbnRzLmtleXMoKSk7XG4gICAgLy8gRmluZCBpbnN0YW5jZXMgaW4gKDEpIHNjcmVlbnMsICgyKSB0aWxlc2V0cyBhbmQgYWx0ZXJuYXRlcywgKDMpIHRpbGVFZmZlY3RzXG4gICAgY29uc3Qgc2NyZWVucyA9IG5ldyBTZXQ8U2NyZWVuPigpO1xuICAgIGNvbnN0IHRpbGVFZmZlY3RzID0gbmV3IFNldDxudW1iZXI+KCk7XG4gICAgY29uc3QgdGlsZXNldHNTZXQgPSBuZXcgU2V0KHRpbGVzZXRzKTtcbiAgICBmb3IgKGNvbnN0IGwgb2YgdGhpcy5sb2NhdGlvbnMpIHtcbiAgICAgIGlmICghbC51c2VkKSBjb250aW51ZTtcbiAgICAgIGlmICghdGlsZXNldHNTZXQuaGFzKGwudGlsZXNldCkpIGNvbnRpbnVlO1xuICAgICAgdGlsZUVmZmVjdHMuYWRkKGwudGlsZUVmZmVjdHMpO1xuICAgICAgZm9yIChjb25zdCBzY3JlZW4gb2YgbC5hbGxTY3JlZW5zKCkpIHtcbiAgICAgICAgc2NyZWVucy5hZGQoc2NyZWVuKTtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gRG8gcmVwbGFjZW1lbnRzLlxuICAgIC8vIDEuIHNjcmVlbnM6IFs1LCAxLCB+OV0gPT4gY2hhbmdlIDFzIGludG8gNXNcbiAgICBmb3IgKGNvbnN0IHNjcmVlbiBvZiBzY3JlZW5zKSB7XG4gICAgICBmb3IgKGxldCBpID0gMCwgbGVuID0gc2NyZWVuLnRpbGVzLmxlbmd0aDsgaSA8IGxlbjsgaSsrKSB7XG4gICAgICAgIHNjcmVlbi50aWxlc1tpXSA9IHJldkFycltzY3JlZW4udGlsZXNbaV1dO1xuICAgICAgfVxuICAgIH1cbiAgICAvLyAyLiB0aWxlc2V0czogWzUsIDEgfjldID0+IGNvcHkgNSA8PSAxIGFuZCAxIDw9IDlcbiAgICBmb3IgKGNvbnN0IHRzaWQgb2YgdGlsZXNldHNTZXQpIHtcbiAgICAgIGNvbnN0IHRpbGVzZXQgPSB0aGlzLnRpbGVzZXRzWyh0c2lkICYgMHg3ZikgPj4+IDJdO1xuICAgICAgZm9yIChjb25zdCBjeWNsZSBvZiBjeWNsZXMpIHtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBjeWNsZS5sZW5ndGggLSAxOyBpKyspIHtcbiAgICAgICAgICBjb25zdCBhID0gY3BsKGN5Y2xlW2ldKTtcbiAgICAgICAgICBjb25zdCBiID0gY3BsKGN5Y2xlW2kgKyAxXSk7XG4gICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCA0OyBqKyspIHtcbiAgICAgICAgICAgIHRpbGVzZXQudGlsZXNbal1bYV0gPSB0aWxlc2V0LnRpbGVzW2pdW2JdO1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aWxlc2V0LmF0dHJzW2FdID0gdGlsZXNldC5hdHRyc1tiXTtcbiAgICAgICAgICBpZiAoYiA8IDB4MjAgJiYgdGlsZXNldC5hbHRlcm5hdGVzW2JdICE9PSBiKSB7XG4gICAgICAgICAgICBpZiAoYSA+PSAweDIwKSB0aHJvdyBuZXcgRXJyb3IoYENhbm5vdCB1bmZsYWc6ICR7dHNpZH0gJHthfSAke2J9ICR7dGlsZXNldC5hbHRlcm5hdGVzW2JdfWApO1xuICAgICAgICAgICAgdGlsZXNldC5hbHRlcm5hdGVzW2FdID0gdGlsZXNldC5hbHRlcm5hdGVzW2JdO1xuICAgICAgICAgICAgXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IFthLCBiXSBvZiBhbHQpIHtcbiAgICAgICAgdGlsZXNldC5hbHRlcm5hdGVzW2FdID0gYjtcbiAgICAgIH1cbiAgICB9XG4gICAgLy8gMy4gdGlsZUVmZmVjdHNcbiAgICBmb3IgKGNvbnN0IHRlaWQgb2YgdGlsZUVmZmVjdHMpIHtcbiAgICAgIGNvbnN0IHRpbGVFZmZlY3QgPSB0aGlzLnRpbGVFZmZlY3RzW3RlaWQgLSAweGIzXTtcbiAgICAgIGZvciAoY29uc3QgY3ljbGUgb2YgY3ljbGVzKSB7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgY3ljbGUubGVuZ3RoIC0gMTsgaSsrKSB7XG4gICAgICAgICAgY29uc3QgYSA9IGNwbChjeWNsZVtpXSk7XG4gICAgICAgICAgY29uc3QgYiA9IGNwbChjeWNsZVtpICsgMV0pO1xuICAgICAgICAgIHRpbGVFZmZlY3QuZWZmZWN0c1thXSA9IHRpbGVFZmZlY3QuZWZmZWN0c1tiXTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBhIG9mIGFsdC5rZXlzKCkpIHtcbiAgICAgICAgLy8gVGhpcyBiaXQgaXMgcmVxdWlyZWQgdG8gaW5kaWNhdGUgdGhhdCB0aGUgYWx0ZXJuYXRpdmUgdGlsZSdzXG4gICAgICAgIC8vIGVmZmVjdCBzaG91bGQgYmUgY29uc3VsdGVkLiAgU2ltcGx5IGhhdmluZyB0aGUgZmxhZyBhbmQgdGhlXG4gICAgICAgIC8vIHRpbGUgaW5kZXggPCAkMjAgaXMgbm90IHN1ZmZpY2llbnQuXG4gICAgICAgIHRpbGVFZmZlY3QuZWZmZWN0c1thXSB8PSAweDA4O1xuICAgICAgfVxuICAgIH1cbiAgICAvLyBEb25lPyE/XG4gIH1cblxuICBtb3ZlRmxhZyhvbGRGbGFnOiBudW1iZXIsIG5ld0ZsYWc6IG51bWJlcikge1xuICAgIC8vIG5lZWQgdG8gdXBkYXRlIHRyaWdnZXJzLCBzcGF3bnMsIGRpYWxvZ3NcbiAgICBmdW5jdGlvbiByZXBsYWNlKGFycjogbnVtYmVyW10pIHtcbiAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmIChhcnJbaV0gPT09IG9sZEZsYWcpIGFycltpXSA9IG5ld0ZsYWc7XG4gICAgICAgIGlmIChhcnJbaV0gPT09IH5vbGRGbGFnKSBhcnJbaV0gPSB+bmV3RmxhZztcbiAgICAgIH1cbiAgICB9XG4gICAgZm9yIChjb25zdCB0cmlnZ2VyIG9mIHRoaXMudHJpZ2dlcnMpIHtcbiAgICAgIHJlcGxhY2UodHJpZ2dlci5jb25kaXRpb25zKTtcbiAgICAgIHJlcGxhY2UodHJpZ2dlci5mbGFncyk7XG4gICAgfVxuICAgIGZvciAoY29uc3QgbnBjIG9mIHRoaXMubnBjcykge1xuICAgICAgZm9yIChjb25zdCBjb25kcyBvZiBucGMuc3Bhd25Db25kaXRpb25zLnZhbHVlcygpKSByZXBsYWNlKGNvbmRzKTtcbiAgICAgIGZvciAoY29uc3QgZGlhbG9ncyBvZiBbbnBjLmdsb2JhbERpYWxvZ3MsIC4uLm5wYy5sb2NhbERpYWxvZ3MudmFsdWVzKCldKSB7XG4gICAgICAgIGZvciAoY29uc3QgZGlhbG9nIG9mIGRpYWxvZ3MpIHtcbiAgICAgICAgICBpZiAoZGlhbG9nLmNvbmRpdGlvbiA9PT0gb2xkRmxhZykgZGlhbG9nLmNvbmRpdGlvbiA9IG5ld0ZsYWc7XG4gICAgICAgICAgaWYgKGRpYWxvZy5jb25kaXRpb24gPT09IH5vbGRGbGFnKSBkaWFsb2cuY29uZGl0aW9uID0gfm5ld0ZsYWc7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgLy8gYWxzbyBuZWVkIHRvIHVwZGF0ZSBtYXAgZmxhZ3MgaWYgPj0gJDIwMFxuICAgIGlmICgob2xkRmxhZyAmIH4weGZmKSA9PT0gMHgyMDAgJiYgKG5ld0ZsYWcgJiB+MHhmZikgPT09IDB4MjAwKSB7XG4gICAgICBmb3IgKGNvbnN0IGxvYyBvZiB0aGlzLmxvY2F0aW9ucykge1xuICAgICAgICBmb3IgKGNvbnN0IGZsYWcgb2YgbG9jLmZsYWdzKSB7XG4gICAgICAgICAgaWYgKGZsYWcuZmxhZyA9PT0gb2xkRmxhZykgZmxhZy5mbGFnID0gbmV3RmxhZztcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIG5leHRGcmVlVHJpZ2dlcigpOiBUcmlnZ2VyIHtcbiAgICBmb3IgKGNvbnN0IHQgb2YgdGhpcy50cmlnZ2Vycykge1xuICAgICAgaWYgKCF0LnVzZWQpIHJldHVybiB0O1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ0NvdWxkIG5vdCBmaW5kIGFuIHVudXNlZCB0cmlnZ2VyLicpO1xuICB9XG5cbiAgLy8gVXNlIHRoZSBicm93c2VyIEFQSSB0byBsb2FkIHRoZSBST00uICBVc2UgI3Jlc2V0IHRvIGZvcmdldCBhbmQgcmVsb2FkLlxuICBzdGF0aWMgYXN5bmMgbG9hZChwYXRjaD86IChkYXRhOiBVaW50OEFycmF5KSA9PiB2b2lkfFByb21pc2U8dm9pZD4sXG4gICAgICAgICAgICAgICAgICAgIHJlY2VpdmVyPzogKHBpY2tlcjogRWxlbWVudCkgPT4gdm9pZCkge1xuICAgIGNvbnN0IGZpbGUgPSBhd2FpdCBwaWNrRmlsZShyZWNlaXZlcik7XG4gICAgaWYgKHBhdGNoKSBhd2FpdCBwYXRjaChmaWxlKTtcbiAgICByZXR1cm4gbmV3IFJvbShmaWxlKTtcbiAgfSAgXG59XG5cbi8vIGNvbnN0IGludGVyc2VjdHMgPSAobGVmdCwgcmlnaHQpID0+IHtcbi8vICAgaWYgKGxlZnQuc2l6ZSA+IHJpZ2h0LnNpemUpIHJldHVybiBpbnRlcnNlY3RzKHJpZ2h0LCBsZWZ0KTtcbi8vICAgZm9yIChsZXQgaSBvZiBsZWZ0KSB7XG4vLyAgICAgaWYgKHJpZ2h0LmhhcyhpKSkgcmV0dXJuIHRydWU7XG4vLyAgIH1cbi8vICAgcmV0dXJuIGZhbHNlO1xuLy8gfVxuXG4vLyBjb25zdCBUSUxFX0VGRkVDVFNfQllfVElMRVNFVCA9IHtcbi8vICAgMHg4MDogMHhiMyxcbi8vICAgMHg4NDogMHhiNCxcbi8vICAgMHg4ODogMHhiNSxcbi8vICAgMHg4YzogMHhiNixcbi8vICAgMHg5MDogMHhiNyxcbi8vICAgMHg5NDogMHhiOCxcbi8vICAgMHg5ODogMHhiOSxcbi8vICAgMHg5YzogMHhiYSxcbi8vICAgMHhhMDogMHhiYixcbi8vICAgMHhhNDogMHhiYyxcbi8vICAgMHhhODogMHhiNSxcbi8vICAgMHhhYzogMHhiZCxcbi8vIH07XG5cbi8vIE9ubHkgbWFrZXMgc2Vuc2UgaW4gdGhlIGJyb3dzZXIuXG5mdW5jdGlvbiBwaWNrRmlsZShyZWNlaXZlcj86IChwaWNrZXI6IEVsZW1lbnQpID0+IHZvaWQpOiBQcm9taXNlPFVpbnQ4QXJyYXk+IHtcbiAgaWYgKCFyZWNlaXZlcikgcmVjZWl2ZXIgPSBwaWNrZXIgPT4gZG9jdW1lbnQuYm9keS5hcHBlbmRDaGlsZChwaWNrZXIpO1xuICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICBpZiAod2luZG93LmxvY2F0aW9uLmhhc2ggIT09ICcjcmVzZXQnKSB7XG4gICAgICBjb25zdCBkYXRhID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3JvbScpO1xuICAgICAgaWYgKGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHJlc29sdmUoXG4gICAgICAgICAgICBVaW50OEFycmF5LmZyb20oXG4gICAgICAgICAgICAgICAgbmV3IEFycmF5KGRhdGEubGVuZ3RoIC8gMikuZmlsbCgwKS5tYXAoXG4gICAgICAgICAgICAgICAgICAgIChfLCBpKSA9PiBOdW1iZXIucGFyc2VJbnQoXG4gICAgICAgICAgICAgICAgICAgICAgICBkYXRhWzIgKiBpXSArIGRhdGFbMiAqIGkgKyAxXSwgMTYpKSkpO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCB1cGxvYWQgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbnB1dCcpO1xuICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQodXBsb2FkKTtcbiAgICB1cGxvYWQudHlwZSA9ICdmaWxlJztcbiAgICB1cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xuICAgICAgY29uc3QgZmlsZSA9IHVwbG9hZC5maWxlcyFbMF07XG4gICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpO1xuICAgICAgcmVhZGVyLmFkZEV2ZW50TGlzdGVuZXIoJ2xvYWRlbmQnLCAoKSA9PiB7XG4gICAgICAgIGNvbnN0IGFyciA9IG5ldyBVaW50OEFycmF5KHJlYWRlci5yZXN1bHQgYXMgQXJyYXlCdWZmZXIpO1xuICAgICAgICBjb25zdCBzdHIgPSBBcnJheS5mcm9tKGFyciwgaGV4KS5qb2luKCcnKTtcbiAgICAgICAgbG9jYWxTdG9yYWdlLnNldEl0ZW0oJ3JvbScsIHN0cik7XG4gICAgICAgIHVwbG9hZC5yZW1vdmUoKTtcbiAgICAgICAgcmVzb2x2ZShhcnIpO1xuICAgICAgfSk7XG4gICAgICByZWFkZXIucmVhZEFzQXJyYXlCdWZmZXIoZmlsZSk7XG4gICAgfSk7XG4gIH0pO1xufVxuXG5leHBvcnQgY29uc3QgRVhQRUNURURfQ1JDMzIgPSAweDFiZDM5MDMyO1xuXG4vLyBGb3JtYXQ6IFthZGRyZXNzLCBicm9rZW4sIGZpeGVkXVxuY29uc3QgQURKVVNUTUVOVFMgPSBbXG4gIC8vIEZpeCBzb2Z0bG9jayBpbiBjcnlwdCBkdWUgdG8gZmx5YWJsZSB3YWxsIChlZmZlY3RzICRiNiB0aWxlICQ0NilcbiAgWzB4MTM2NDYsIDB4MDIsIDB4MDZdLFxuICAvLyBGaXggYnJva2VuIChmYWxsLXRocm91Z2gpIGV4aXQgb3V0c2lkZSBzdGFydFxuICBbMHgxNDU2YSwgMHgwMCwgMHhmZl0sXG4gIC8vIFJlZHVuZGFudCBleGl0IG5leHQgdG8gc3RvbSdzIGRvb3IgaW4gJDE5XG4gIFsweDE0YWViLCAweDA5LCAweGZmXSxcbiAgLy8gRml4IGdhcmJhZ2UgbWFwIHNxdWFyZSBpbiBib3R0b20tcmlnaHQgb2YgTXQgU2FicmUgV2VzdCBjYXZlXG4gIFsweDE0ZGI5LCAweDA4LCAweDgwXSxcbiAgLy8gRml4IGdhcmJhZ2UgbWFwIHNxdWFyZSBpbiBib3R0b20tbGVmdCBvZiBMaW1lIFRyZWUgVmFsbGV5XG4gIFsweDE1NDVkLCAweGZmLCAweDAwXSxcbiAgLy8gTWFyayBiYWQgZW50cmFuY2UvZXhpdCBpbiBwb3J0b2FcbiAgWzB4MTU4MWQsIDB4MDAsIDB4ZmZdLFxuICBbMHgxNTg0ZSwgMHhkYiwgMHhmZl0sXG4gIC8vIFJlbW92ZSB1bnVzZWQgbWFwIHNjcmVlbnMgZnJvbSBFdmlsIFNwaXJpdCBsb3dlclxuICBbMHgxNWJhZiwgMHhmMCwgMHg4MF0sXG4gIFsweDE1YmI2LCAweGRmLCAweDgwXSxcbiAgWzB4MTViYjcsIDB4OTYsIDB4ODBdLFxuICAvLyBNYXJrIGJhZCBlbnRyYW5jZS9leGl0IGluIGdvYSB2YWxsZXlcbiAgWzB4MTVmNDAsIDB4MDIsIDB4ZmZdLFxuICBbMHgxNWY2MSwgMHg4ZCwgMHhmZl0sXG4gIFsweDE1ZjY1LCAweDhkLCAweGZmXSxcbiAgLy8gRml4IGdhcmJhZ2UgYXQgYm90dG9tIG9mIG9hc2lzIGNhdmUgbWFwIChpdCdzIDh4MTEsIG5vdCA4eDEyID0+IGZpeCBoZWlnaHQpXG4gIFsweDE2NGZmLCAweDBiLCAweDBhXSxcbiAgLy8gRml4IGJhZCBtdXNpYyBpbiB6b21iaWV0b3duIGhvdXNlczogJDEwIHNob3VsZCBiZSAkMDEuXG4gIFsweDE3ODJhLCAweDEwLCAweDAxXSxcbiAgWzB4MTc4NTcsIDB4MTAsIDB4MDFdLFxuICAvLyBGaXggYmFkIHNwYXduIGluIE10IEh5ZHJhIChtYWtlIGl0IGFuIGV4dHJhIHB1ZGRsZSkuXG4gIFsweDE5ZjAyLCAweDQwLCAweDgwXSxcbiAgWzB4MTlmMDMsIDB4MzMsIDB4MzJdLFxuICAvLyBSZW1vdmUgbm9uc2Vuc2UgdHJpZ2dlciA4MyBmcm9tIGdvYSBmb3J0cmVzcyBlbnRyYW5jZVxuICBbMHgxYTE3NiwgMHgyYSwgMHhmZl0sXG4gIC8vIEZpeCBiYWQgc3Bhd24gaW4gU2FiZXJhIDIncyBsZXZlbCAocHJvYmFibHkgbWVhbnQgdG8gYmUgYSBmbGFpbCBndXkpLlxuICBbMHgxYTFlMCwgMHg0MCwgMHhjMF0sIC8vIG1ha2Ugc3VyZSB0byBmaXggcGF0dGVybiBzbG90LCB0b28hXG4gIFsweDFhMWUxLCAweDNkLCAweDM0XSxcbiAgLy8gUmVtb3ZlIG5vbnNlbnNlIHRyaWdnZXIgYWEgZnJvbSBvYWsgZW50cmFuY2VcbiAgWzB4MWE4NGMsIDB4MWMsIDB4ZmZdLFxuICAvLyBQb2ludCBBbWF6b25lcyBvdXRlciBndWFyZCB0byBwb3N0LW92ZXJmbG93IG1lc3NhZ2UgdGhhdCdzIGFjdHVhbGx5IHNob3duLlxuICBbMHgxY2YwNSwgMHg0NywgMHg0OF0sXG4gIC8vIFJlbW92ZSBzdHJheSBmbGlnaHQgZ3JhbnRlciBpbiBab21iaWV0b3duLlxuICBbMHgxZDMxMSwgMHgyMCwgMHhhMF0sXG4gIFsweDFkMzEyLCAweDMwLCAweDAwXSxcbiAgLy8gRml4IHF1ZWVuJ3MgZGlhbG9nIHRvIHRlcm1pbmF0ZSBvbiBsYXN0IGl0ZW0sIHJhdGhlciB0aGFuIG92ZXJmbG93LFxuICAvLyBzbyB0aGF0IHdlIGRvbid0IHBhcnNlIGdhcmJhZ2UuXG4gIFsweDFjZmY5LCAweDYwLCAweGUwXSxcbiAgLy8gUmVtb3ZlIHVudXNlZCBmbGFncyBmcm9tIGRvb3IgdHJpZ2dlcnNcbiAgWzB4MWUzMmEsIDB4NDAsIDB4YzBdLCAvLyBtdCBzYWJyZSBzdW1taXQgKHRyaWdnZXIgYWQpOiBzZXQgMDkzID0+IGNsZWFyIDAwMFxuICBbMHgxZTMyYiwgMHg5MywgMHgwMF0sXG4gIFsweDFlMzMwLCAweDQwLCAweGMwXSwgLy8gc3R4eSAodHJpZ2dlciBhZSk6IHNldCAwOTQgPT4gY2xlYXIgMDAwXG4gIFsweDFlMzMxLCAweDk0LCAweDAwXSxcbiAgWzB4MWUzMzYsIDB4NDAsIDB4YzBdLCAvLyBhbHRhciAodHJpZ2dlciBhZik6IHNldCAwOTUgPT4gY2xlYXIgMDAwXG4gIFsweDFlMzM3LCAweDk1LCAweDAwXSxcblxuICAvLyBGaXggQW1hem9uZXMgb3V0ZXIgZ3VhcmQgbWVzc2FnZSB0byBub3Qgb3ZlcmZsb3cuXG4gIFsweDJjYTkwLCAweDAyLCAweDAwXSxcbiAgLy8gRml4IHNlZW1pbmdseS11bnVzZWQga2Vuc3UgbWVzc2FnZSAxZDoxNyBvdmVyZmxvd2luZyBpbnRvIDFkOjE4XG4gIFsweDJmNTczLCAweDAyLCAweDAwXSxcbiAgLy8gRml4IHVudXNlZCBrYXJtaW5lIHRyZWFzdXJlIGNoZXN0IG1lc3NhZ2UgMjA6MTguXG4gIFsweDJmYWU0LCAweDVmLCAweDAwXSxcbl0gYXMgY29uc3Q7XG4iXX0=