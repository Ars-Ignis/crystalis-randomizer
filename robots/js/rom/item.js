import { Entity, EntityArray } from './entity.js';
import { MessageId } from './messageid.js';
import { hex, readLittleEndian, readString, seq, writeLittleEndian, ITEM_USE_FLAGS, SPAWN_CONDITION_FLAGS } from './util.js';
import { assertNever } from '../util.js';
const ITEM_USE_JUMP_TABLE = 0x1c399;
const ITEM_USE_DATA_TABLE = 0x1dbe2;
const ITEM_DATA_TABLE = 0x20ff0;
const SELECTED_ITEM_TABLE = 0x2103b;
const VANILLA_PAWN_PRICE_TABLE = 0x21ec2;
const MENU_NAME_TABLE = 0x21086;
const MESSAGE_NAME_TABLE = 0x28a5c;
const MENU_NAME_ENCODE = [
    ['Sword', '\x0a\x0b\x0c'],
    [' of ', '\x5c\x5d'],
    ['Bracelet', '\x3c\x3d\x3e\x5b'],
    ['Shield', '\x0d\x0e\x0f'],
    ['Armor', '\x7b\x11\x12'],
    ['Magic', '\x23\x25\x28'],
    ['Power', '\x13\x14\x15'],
    ['Item', '\x16\x17\x5e'],
];
export class Item extends Entity {
    constructor(items, id, opts = {}) {
        super(items.rom, id);
        this.itemUseJump = 0;
        const rom = this.rom;
        items[id] = this;
        this.itemUseData = [];
        this.trades = opts.trades || [];
        this.use = opts.use || false;
        if (this.use) {
            this.itemUseJump = readLittleEndian(rom.prg, this.itemUseJumpPointer) + 0x14000;
            const entries = items.itemUseJumps[this.itemUseJump];
            if (!entries)
                throw new Error(`Bad ItemUseJump: ${this.itemUseJump}`);
            let itemUseOffset = readLittleEndian(rom.prg, this.itemUseDataPointer) + 0x14000;
            for (const entry of entries) {
                const data = ItemUse.from(entry, rom.prg, itemUseOffset);
                this.itemUseData.push(data);
                itemUseOffset += data.length;
            }
        }
        this.itemDataValue = rom.prg[this.itemDataPointer];
        this.selectedItemValue = rom.prg[this.selectedItemPointer];
        if (rom.shopDataTablesAddress != null) {
            const address = rom.shopDataTablesAddress +
                21 * rom.shopCount +
                2 * rom.scalingLevels +
                2 * (id - 0xd);
            this.basePrice = id >= 0xd && id < 0x27 ? readLittleEndian(rom.prg, address) : 0;
        }
        else {
            const address = VANILLA_PAWN_PRICE_TABLE + 2 * id;
            this.basePrice = readLittleEndian(rom.prg, address) * 2;
        }
        const messageNameBase = readLittleEndian(rom.prg, this.messageNamePointer) + 0x20000;
        this.messageName = readString(rom.prg, messageNameBase);
        const menuNameBase = readLittleEndian(rom.prg, this.menuNamePointer) + 0x18000;
        this.menuName = MENU_NAME_ENCODE.reduce((s, [d, e]) => s.replace(e, d), readString(rom.prg, menuNameBase, 0xff));
    }
    get itemUseJumpPointer() {
        return ITEM_USE_JUMP_TABLE + 2 * this.id;
    }
    get itemUseDataPointer() {
        return ITEM_USE_DATA_TABLE + 2 * this.id;
    }
    get itemDataPointer() {
        return ITEM_DATA_TABLE + this.id;
    }
    get selectedItemPointer() {
        return SELECTED_ITEM_TABLE + this.id;
    }
    get messageNamePointer() {
        return MESSAGE_NAME_TABLE + 2 * this.id;
    }
    get menuNamePointer() {
        return MENU_NAME_TABLE + 2 * this.id;
    }
    itemUseMessages() {
        const messages = new Map();
        for (const { message } of this.itemUseData) {
            messages.set(message.mid(), message);
        }
        return [...messages.values()];
    }
    setName(name) {
        this.messageName = this.menuName = name;
    }
    get palette() { return this.itemDataValue & 3; }
    set palette(p) { this.itemDataValue = this.itemDataValue & ~3 | (p & 3); }
    get unique() { return !!(this.itemDataValue & 0x40); }
    set unique(u) { this.itemDataValue = this.itemDataValue & ~0x40 | (u ? 0x40 : 0); }
    get worn() { return !!(this.itemDataValue & 0x20); }
    set worn(w) { this.itemDataValue = this.itemDataValue & ~0x20 | (w ? 0x20 : 0); }
    get solid() { return !!(this.itemDataValue & 0x80); }
    set solid(s) { this.itemDataValue = this.itemDataValue & ~0x80 | (s ? 0x80 : 0); }
    async write(writer) {
        writer.rom[this.itemDataPointer] = this.itemDataValue;
        writer.rom[this.selectedItemPointer] = this.selectedItemValue;
        if (this.rom.shopDataTablesAddress != null) {
            if (this.id >= 0xd && this.id < 0x27) {
                const address = this.rom.shopDataTablesAddress +
                    21 * this.rom.shopCount +
                    2 * this.rom.scalingLevels +
                    2 * (this.id - 0xd);
                writeLittleEndian(writer.rom, address, this.basePrice);
            }
        }
        else {
            const address = VANILLA_PAWN_PRICE_TABLE + 2 * this.id;
            writeLittleEndian(writer.rom, address, this.basePrice >>> 1);
        }
        const menuNameEncoded = MENU_NAME_ENCODE.reduce((s, [d, e]) => s.replace(d, e), this.menuName);
        const menuAddress = await writer.write([...stringToBytes(menuNameEncoded), 0xff], 0x20000, 0x21fff, `ItemMenuName ${hex(this.id)}`);
        writeLittleEndian(writer.rom, this.menuNamePointer, menuAddress - 0x18000);
        if (this.use) {
            writeLittleEndian(writer.rom, this.itemUseJumpPointer, this.itemUseJump - 0x14000);
            const itemUseData = [];
            for (const use of this.itemUseData) {
                itemUseData.push(...use.bytes());
            }
            const itemUseAddress = await writer.write(itemUseData, 0x1c000, 0x1ffff, `ItemUseData ${hex(this.id)}`);
            writeLittleEndian(writer.rom, this.itemUseDataPointer, itemUseAddress - 0x14000);
        }
    }
}
const stringToBytes = (s) => {
    return seq(s.length, i => s.charCodeAt(i));
};
export class ItemUse {
    constructor(kind, want, message, flags) {
        this.kind = kind;
        this.want = want;
        this.message = message;
        this.flags = flags;
    }
    static from(kind, data, offset) {
        let want = 0;
        if (kind === 'expect' || kind === 'screen') {
            want = data[offset + 1] << 8 | data[offset];
            offset += 2;
        }
        else if (kind === 'flag') {
            const flags = SPAWN_CONDITION_FLAGS.read(data, offset);
            if (!flags.length)
                flags.push(~0);
            if (flags.length > 1)
                throw new Error(`Flag list too long: ${flags}`);
            want = flags[0];
            offset += 2;
        }
        else if (kind === 'location') {
            want = data[offset++];
        }
        else if (kind !== 'empty') {
            assertNever(kind);
        }
        const message = MessageId.from(data, offset);
        const flags = ITEM_USE_FLAGS.read(data, offset + 2);
        return new ItemUse(kind, want, message, flags);
    }
    bytes() {
        const bytes = [];
        if (this.kind === 'expect' || this.kind === 'screen') {
            bytes.push(this.want & 0xff, (this.want >>> 8) & 0xff);
        }
        else if (this.kind === 'flag') {
            const flagBytes = SPAWN_CONDITION_FLAGS.bytes([this.want]);
            if (flagBytes.length !== 2)
                throw new Error(`bad data: ${flagBytes}`);
            bytes.push(...flagBytes);
        }
        else if (this.kind === 'location') {
            bytes.push(this.want);
        }
        else if (this.kind !== 'empty') {
            assertNever(this.kind);
        }
        bytes.push(...this.message.data);
        bytes.push(...ITEM_USE_FLAGS.bytes(this.flags));
        return bytes;
    }
    tradeNpc() {
        if (this.kind !== 'expect')
            return null;
        if ((this.want >>> 8) !== 1)
            return null;
        return this.want & 0xff;
    }
    get length() {
        const header = this.kind === 'empty' ? 0 : this.kind === 'location' ? 1 : 2;
        return 2 * (1 + Math.max(1, this.flags.length)) + header;
    }
}
export class Items extends EntityArray {
    constructor(rom) {
        super(0x49);
        this.rom = rom;
        this.itemUseJumps = DEFAULT_ITEM_USE_JUMPS;
        this.SwordOfWind = new Item(this, 0x00);
        this.SwordOfFire = new Item(this, 0x01);
        this.SwordOfWater = new Item(this, 0x02);
        this.SwordOfThunder = new Item(this, 0x03);
        this.Crystalis = new Item(this, 0x04);
        this.BallOfWind = new Item(this, 0x05);
        this.TornadoBracelet = new Item(this, 0x06);
        this.BallOfFire = new Item(this, 0x07);
        this.FlameBracelet = new Item(this, 0x08);
        this.BallOfWater = new Item(this, 0x09);
        this.BlizzardBracelet = new Item(this, 0x0a);
        this.BallOfThunder = new Item(this, 0x0b);
        this.StormBracelet = new Item(this, 0x0c);
        this.CarapaceShield = new Item(this, 0x0d);
        this.BronzeShield = new Item(this, 0x0e);
        this.PlatinumShield = new Item(this, 0x0f);
        this.MirroredShield = new Item(this, 0x10);
        this.CeramicShield = new Item(this, 0x11);
        this.SacredShield = new Item(this, 0x12);
        this.BattleShield = new Item(this, 0x13);
        this.PsychoShield = new Item(this, 0x14);
        this.TannedHide = new Item(this, 0x15);
        this.LeatherArmor = new Item(this, 0x16);
        this.BronzeArmor = new Item(this, 0x17);
        this.PlatinumArmor = new Item(this, 0x18);
        this.SoldierSuit = new Item(this, 0x19);
        this.CeramicSuit = new Item(this, 0x1a);
        this.BattleArmor = new Item(this, 0x1b);
        this.PsychoArmor = new Item(this, 0x1c);
        this.MedicalHerb = new Item(this, 0x1d, { use: true, trades: [0] });
        this.Antidote = new Item(this, 0x1e, { use: true });
        this.LysisPlant = new Item(this, 0x1f, { use: true });
        this.FruitOfLime = new Item(this, 0x20, { use: true });
        this.FruitOfPower = new Item(this, 0x21, { use: true });
        this.MagicRing = new Item(this, 0x22, { use: true });
        this.FruitOfRepun = new Item(this, 0x23, { use: true });
        this.WarpBoots = new Item(this, 0x24, { use: true });
        this.StatueOfOnyx = new Item(this, 0x25, { use: true, trades: [0] });
        this.OpelStatue = new Item(this, 0x26, { use: true });
        this.InsectFlute = new Item(this, 0x27, { use: true });
        this.FluteOfLime = new Item(this, 0x28, { use: true,
            trades: [0, 1, 2, 3] });
        this.GasMask = new Item(this, 0x29);
        this.PowerRing = new Item(this, 0x2a);
        this.WarriorRing = new Item(this, 0x2b);
        this.IronNecklace = new Item(this, 0x2c);
        this.DeosPendant = new Item(this, 0x2d);
        this.RabbitBoots = new Item(this, 0x2e);
        this.LeatherBoots = new Item(this, 0x2f);
        this.ShieldRing = new Item(this, 0x30);
        this.AlarmFlute = new Item(this, 0x31, { use: true, trades: [0, 1] });
        this.WindmillKey = new Item(this, 0x32, { use: true });
        this.KeyToPrison = new Item(this, 0x33, { use: true });
        this.KeyToStyx = new Item(this, 0x34, { use: true });
        this.FogLamp = new Item(this, 0x35, { use: true, trades: [0] });
        this.ShellFlute = new Item(this, 0x36, { use: true });
        this.EyeGlasses = new Item(this, 0x37, { use: true });
        this.BrokenStatue = new Item(this, 0x38, { use: true });
        this.GlowingLamp = new Item(this, 0x39, { use: true });
        this.StatueOfGold = new Item(this, 0x3a, { use: true });
        this.LovePendant = new Item(this, 0x3b, { use: true, trades: [0] });
        this.KirisaPlant = new Item(this, 0x3c, { use: true, trades: [0] });
        this.IvoryStatue = new Item(this, 0x3d, { use: true, trades: [0] });
        this.BowOfMoon = new Item(this, 0x3e, { use: true });
        this.BowOfSun = new Item(this, 0x3f, { use: true });
        this.BowOfTruth = new Item(this, 0x40, { use: true });
        this.Refresh = new Item(this, 0x41);
        this.Paralysis = new Item(this, 0x42);
        this.Telepathy = new Item(this, 0x43);
        this.Teleport = new Item(this, 0x44);
        this.Recover = new Item(this, 0x45);
        this.Barrier = new Item(this, 0x46);
        this.Change = new Item(this, 0x47);
        this.Flight = new Item(this, 0x48);
    }
    async write(writer) {
        const promises = [];
        for (const item of this) {
            promises.push(item.write(writer));
        }
        await Promise.all(promises);
    }
}
const DEFAULT_ITEM_USE_JUMPS = {
    0x1c439: ['expect'],
    0x1c442: ['screen'],
    0x1c450: ['empty'],
    0x1c451: ['screen'],
    0x1c45f: ['location'],
    0x1c491: ['expect'],
    0x1c4a9: ['expect', 'expect'],
    0x1c4b3: ['location'],
    0x1c4d0: ['expect'],
    0x1c4db: [],
    0x1c4e0: ['expect', 'empty'],
    0x1c507: ['empty'],
    0x1c51d: ['empty'],
    0x1c524: ['empty'],
    0x1c52f: ['empty'],
    0x1c53a: ['empty'],
    0x1c54a: ['empty'],
    0x1c564: ['empty'],
    0x1c565: ['expect'],
    0x1c56b: ['flag'],
    0x1c585: ['empty'],
    0x1c59e: ['expect', 'expect', 'expect', 'expect'],
};
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaXRlbS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9qcy9yb20vaXRlbS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUMsTUFBTSxFQUFFLFdBQVcsRUFBQyxNQUFNLGFBQWEsQ0FBQztBQUNoRCxPQUFPLEVBQUMsU0FBUyxFQUFDLE1BQU0sZ0JBQWdCLENBQUM7QUFDekMsT0FBTyxFQUFDLEdBQUcsRUFBRSxnQkFBZ0IsRUFBRSxVQUFVLEVBQUUsR0FBRyxFQUFFLGlCQUFpQixFQUN6RCxjQUFjLEVBQUUscUJBQXFCLEVBQUMsTUFBTSxXQUFXLENBQUM7QUFJaEUsT0FBTyxFQUFDLFdBQVcsRUFBQyxNQUFNLFlBQVksQ0FBQztBQUV2QyxNQUFNLG1CQUFtQixHQUFHLE9BQU8sQ0FBQztBQUNwQyxNQUFNLG1CQUFtQixHQUFHLE9BQU8sQ0FBQztBQUNwQyxNQUFNLGVBQWUsR0FBRyxPQUFPLENBQUM7QUFDaEMsTUFBTSxtQkFBbUIsR0FBRyxPQUFPLENBQUM7QUFDcEMsTUFBTSx3QkFBd0IsR0FBRyxPQUFPLENBQUM7QUFDekMsTUFBTSxlQUFlLEdBQUcsT0FBTyxDQUFDO0FBQ2hDLE1BQU0sa0JBQWtCLEdBQUcsT0FBTyxDQUFDO0FBR25DLE1BQU0sZ0JBQWdCLEdBQUc7SUFDdkIsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDO0lBQ3pCLENBQUMsTUFBTSxFQUFFLFVBQVUsQ0FBQztJQUNwQixDQUFDLFVBQVUsRUFBRSxrQkFBa0IsQ0FBQztJQUNoQyxDQUFDLFFBQVEsRUFBRSxjQUFjLENBQUM7SUFDMUIsQ0FBQyxPQUFPLEVBQUUsY0FBYyxDQUFDO0lBQ3pCLENBQUMsT0FBTyxFQUFFLGNBQWMsQ0FBQztJQUN6QixDQUFDLE9BQU8sRUFBRSxjQUFjLENBQUM7SUFDekIsQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDO0NBQ3pCLENBQUM7QUFRRixNQUFNLE9BQU8sSUFBSyxTQUFRLE1BQU07SUFrQjlC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SUFBSSxDQUFDLENBQUM7UUFDeEMsbUJBQWMsR0FBSyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsbUJBQWMsR0FBSyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsa0JBQWEsR0FBTSxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFDeEMsaUJBQVksR0FBTyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxDQUFDLENBQUM7UUFFeEMsZUFBVSxHQUFTLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxrQkFBYSxHQUFNLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUN4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLENBQUMsQ0FBQztRQUV4QyxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxD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QUFFLElBQUksRUFBQyxDQUFDLENBQUM7UUFDckQsY0FBUyxHQUFVLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxZQUFPLEdBQVksSUFBSSxJQUFJLENBQUMsSUFBSSxFQUFFLElBQUksRUFBRSxFQUFDLEdBQUcsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLENBQUMsQ0FBQyxDQUFDLEVBQUMsQ0FBQyxDQUFDO1FBQ2xFLGVBQVUsR0FBUyxJQUFJLElBQUksQ0FBQyxJQUFJLEVBQUUsSUFBSSxFQUFFLEVBQUMsR0FBRyxFQUFFLElBQUksRUFBQyxDQUFDLENBQUM7UUFDckQsZUFBVSxHQUFTLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxpQkFBWSxHQUFPLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFDLENBQUMsQ0FBQztRQUNyRCxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztRQUNsRSxnQkFBVyxHQUFRLElBQUksSUFBSSxDQUFDLElBQUksRUFBRSxJQUFJLEVBQUUsRUFBQyxHQUFHLEVBQUUsSUFBSSxFQUFFLE1BQU0sRUFBRSxDQUFDLENBQUMsQ0FBQyxFQUFDLENBQUMsQ0FBQztRQUNsRSxn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O0NBQ2xELENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0VudGl0eSwgRW50aXR5QXJyYXl9IGZyb20gJy4vZW50aXR5LmpzJztcbmltcG9ydCB7TWVzc2FnZUlkfSBmcm9tICcuL21lc3NhZ2VpZC5qcyc7XG5pbXBvcnQge2hleCwgcmVhZExpdHRsZUVuZGlhbiwgcmVhZFN0cmluZywgc2VxLCB3cml0ZUxpdHRsZUVuZGlhbixcbiAgICAgICAgSVRFTV9VU0VfRkxBR1MsIFNQQVdOX0NPTkRJVElPTl9GTEFHU30gZnJvbSAnLi91dGlsLmpzJztcbmltcG9ydCB7V3JpdGVyfSBmcm9tICcuL3dyaXRlci5qcyc7XG5pbXBvcnQge0RhdGF9IGZyb20gJy4vdXRpbC5qcyc7XG5pbXBvcnQge1JvbX0gZnJvbSAnLi4vcm9tLmpzJztcbmltcG9ydCB7YXNzZXJ0TmV2ZXJ9IGZyb20gJy4uL3V0aWwuanMnO1xuXG5jb25zdCBJVEVNX1VTRV9KVU1QX1RBQkxFID0gMHgxYzM5OTtcbmNvbnN0IElURU1fVVNFX0RBVEFfVEFCTEUgPSAweDFkYmUyO1xuY29uc3QgSVRFTV9EQVRBX1RBQkxFID0gMHgyMGZmMDtcbmNvbnN0IFNFTEVDVEVEX0lURU1fVEFCTEUgPSAweDIxMDNiO1xuY29uc3QgVkFOSUxMQV9QQVdOX1BSSUNFX1RBQkxFID0gMHgyMWVjMjtcbmNvbnN0IE1FTlVfTkFNRV9UQUJMRSA9IDB4MjEwODY7XG5jb25zdCBNRVNTQUdFX05BTUVfVEFCTEUgPSAweDI4YTVjOyAvLyBOT1RFOiBpbnRlZ3JhdGUgd2l0aCBtZXNzYWdlcyBlbnRpdHk/XG5cbi8vIE1hcCB0byBwYXR0ZXJuIGVudHJpZXMgZm9yIGNvbWJpbmF0aW9ucyBvZiBsZXR0ZXJzLlxuY29uc3QgTUVOVV9OQU1FX0VOQ09ERSA9IFtcbiAgWydTd29yZCcsICdcXHgwYVxceDBiXFx4MGMnXSxcbiAgWycgb2YgJywgJ1xceDVjXFx4NWQnXSxcbiAgWydCcmFjZWxldCcsICdcXHgzY1xceDNkXFx4M2VcXHg1YiddLFxuICBbJ1NoaWVsZCcsICdcXHgwZFxceDBlXFx4MGYnXSxcbiAgWydBcm1vcicsICdcXHg3YlxceDExXFx4MTInXSxcbiAgWydNYWdpYycsICdcXHgyM1xceDI1XFx4MjgnXSxcbiAgWydQb3dlcicsICdcXHgxM1xceDE0XFx4MTUnXSxcbiAgWydJdGVtJywgJ1xceDE2XFx4MTdcXHg1ZSddLFxuXTtcblxuaW50ZXJmYWNlIEl0ZW1PcHRpb25zIHtcbiAgdHJhZGVzPzogbnVtYmVyW107XG4gIHVzZT86IGJvb2xlYW47XG59XG5cbi8vIEFuIGl0ZW07IG5vdGUgdGhhdCBzb21lIHRhYmxlcyBnbyB1cCB0byAkNDkgb3IgZXZlbiAkNGEgLSB0aGVzZSBjYW4gYmJlIGlnbm9yZWRcbmV4cG9ydCBjbGFzcyBJdGVtIGV4dGVuZHMgRW50aXR5IHtcblxuICBpdGVtVXNlSnVtcCA9IDA7XG4gIGl0ZW1Vc2VEYXRhOiBJdGVtVXNlW107XG5cbiAgaXRlbURhdGFWYWx1ZTogbnVtYmVyOyAvLyA6MDMgaXMgcGFsZXR0ZSwgOjgwIGlzIHN3b3JkIGFuZCBtYWdpYyAoc29saWQgYmcpXG4gICAgICAgICAgICAgICAgICAgICAgICAgLy8gOjQwIGlzIHVuaXF1ZSwgOjIwIGlzIHdvcm4gKHN3b3JkL2Ftb3Ivb3JiL3JpbmcvbWFnaWMpXG4gIHNlbGVjdGVkSXRlbVZhbHVlOiBudW1iZXI7XG5cbiAgYmFzZVByaWNlOiBudW1iZXI7XG5cbiAgLy8gUFJPQkxFTSAtIHJlYWQgaW4gb25lIGZvcm1hdCwgd3JpdGUgaW4gYW5vdGhlci4uLj9cbiAgbWVzc2FnZU5hbWU6IHN0cmluZzsgLy8gVE9ETyAtIHRoaXMgc2hvdWxkIGxpdmUgbGluayBpbnRvIE1lc3NhZ2VzIHRhYmxlXG4gIG1lbnVOYW1lOiBzdHJpbmc7XG5cbiAgdHJhZGVzOiBudW1iZXJbXTtcbiAgdXNlOiBib29sZWFuO1xuXG4gIGNvbnN0cnVjdG9yKGl0ZW1zOiBJdGVtcywgaWQ6IG51bWJlciwgb3B0czogSXRlbU9wdGlvbnMgPSB7fSkge1xuICAgIHN1cGVyKGl0ZW1zLnJvbSwgaWQpO1xuICAgIGNvbnN0IHJvbSA9IHRoaXMucm9tO1xuICAgIGl0ZW1zW2lkXSA9IHRoaXM7XG4gICAgdGhpcy5pdGVtVXNlRGF0YSA9IFtdO1xuICAgIHRoaXMudHJhZGVzID0gb3B0cy50cmFkZXMgfHwgW107XG4gICAgdGhpcy51c2UgPSBvcHRzLnVzZSB8fCBmYWxzZTtcblxuICAgIGlmICh0aGlzLnVzZSkge1xuICAgICAgdGhpcy5pdGVtVXNlSnVtcCA9IHJlYWRMaXR0bGVFbmRpYW4ocm9tLnByZywgdGhpcy5pdGVtVXNlSnVtcFBvaW50ZXIpICsgMHgxNDAwMDtcbiAgICAgIGNvbnN0IGVudHJpZXMgPSBpdGVtcy5pdGVtVXNlSnVtcHNbdGhpcy5pdGVtVXNlSnVtcF07XG4gICAgICBpZiAoIWVudHJpZXMpIHRocm93IG5ldyBFcnJvcihgQmFkIEl0ZW1Vc2VKdW1wOiAke3RoaXMuaXRlbVVzZUp1bXB9YCk7XG4gICAgICBsZXQgaXRlbVVzZU9mZnNldCA9IHJlYWRMaXR0bGVFbmRpYW4ocm9tLnByZywgdGhpcy5pdGVtVXNlRGF0YVBvaW50ZXIpICsgMHgxNDAwMDtcbiAgICAgIGZvciAoY29uc3QgZW50cnkgb2YgZW50cmllcykge1xuICAgICAgICBjb25zdCBkYXRhID0gSXRlbVVzZS5mcm9tKGVudHJ5LCByb20ucHJnLCBpdGVtVXNlT2Zmc2V0KTtcbiAgICAgICAgdGhpcy5pdGVtVXNlRGF0YS5wdXNoKGRhdGEpO1xuICAgICAgICBpdGVtVXNlT2Zmc2V0ICs9IGRhdGEubGVuZ3RoO1xuICAgICAgfVxuICAgIH1cblxuICAgIHRoaXMuaXRlbURhdGFWYWx1ZSA9IHJvbS5wcmdbdGhpcy5pdGVtRGF0YVBvaW50ZXJdO1xuICAgIHRoaXMuc2VsZWN0ZWRJdGVtVmFsdWUgPSByb20ucHJnW3RoaXMuc2VsZWN0ZWRJdGVtUG9pbnRlcl07XG5cbiAgICBpZiAocm9tLnNob3BEYXRhVGFibGVzQWRkcmVzcyAhPSBudWxsKSB7XG4gICAgICBjb25zdCBhZGRyZXNzID1cbiAgICAgICAgICByb20uc2hvcERhdGFUYWJsZXNBZGRyZXNzICtcbiAgICAgICAgICAyMSAqIHJvbS5zaG9wQ291bnQgK1xuICAgICAgICAgIDIgKiByb20uc2NhbGluZ0xldmVscyArXG4gICAgICAgICAgMiAqIChpZCAtIDB4ZCk7XG4gICAgICB0aGlzLmJhc2VQcmljZSA9IGlkID49IDB4ZCAmJiBpZCA8IDB4MjcgPyByZWFkTGl0dGxlRW5kaWFuKHJvbS5wcmcsIGFkZHJlc3MpIDogMDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYWRkcmVzcyA9IFZBTklMTEFfUEFXTl9QUklDRV9UQUJMRSArIDIgKiBpZDtcbiAgICAgIHRoaXMuYmFzZVByaWNlID0gcmVhZExpdHRsZUVuZGlhbihyb20ucHJnLCBhZGRyZXNzKSAqIDI7XG4gICAgfVxuXG4gICAgY29uc3QgbWVzc2FnZU5hbWVCYXNlID0gcmVhZExpdHRsZUVuZGlhbihyb20ucHJnLCB0aGlzLm1lc3NhZ2VOYW1lUG9pbnRlcikgKyAweDIwMDAwO1xuICAgIHRoaXMubWVzc2FnZU5hbWUgPSByZWFkU3RyaW5nKHJvbS5wcmcsIG1lc3NhZ2VOYW1lQmFzZSk7XG5cbiAgICBjb25zdCBtZW51TmFtZUJhc2UgPSByZWFkTGl0dGxlRW5kaWFuKHJvbS5wcmcsIHRoaXMubWVudU5hbWVQb2ludGVyKSArIDB4MTgwMDA7XG4gICAgdGhpcy5tZW51TmFtZSA9IE1FTlVfTkFNRV9FTkNPREUucmVkdWNlKChzLCBbZCwgZV0pID0+IHMucmVwbGFjZShlLCBkKSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZFN0cmluZyhyb20ucHJnLCBtZW51TmFtZUJhc2UsIDB4ZmYpKTtcblxuICAgIC8vIGNvbnN0IHRyYWRlSW5Db3VudCA9IFRSQURFX0lOUy5nZXQoaWQpO1xuICAgIC8vIHRoaXMudHJhZGVJbiA9XG4gICAgLy8gICAgIHRyYWRlSW5Db3VudCA/IHR1cGxlKHJvbS5wcmcsIHRoaXMuaXRlbVVzZURhdGFCYXNlLCA2ICogdHJhZGVJbkNvdW50KSA6IHVuZGVmaW5lZDtcblxuICAgIC8vIGNvbnNvbGUubG9nKGBJdGVtICR7dGhpcy5tZW51TmFtZX0gYmFzZSBwcmljZSAke3RoaXMuYmFzZVByaWNlfWApO1xuICAgIC8vIFRPRE8gLSByb20udW5pcXVlSXRlbVRhYmxlQWRkcmVzc1xuICAgIC8vICAtPiBjdXJyZW50IGhhcmQtY29kZWQgaW4gcGF0Y2guaWRlbnRpZnlLZXlJdGVtc0ZvckRpZmZpY3VsdHlCdWZmc1xuICB9XG5cbiAgZ2V0IGl0ZW1Vc2VKdW1wUG9pbnRlcigpOiBudW1iZXIge1xuICAgIHJldHVybiBJVEVNX1VTRV9KVU1QX1RBQkxFICsgMiAqIHRoaXMuaWQ7XG4gIH1cblxuICBnZXQgaXRlbVVzZURhdGFQb2ludGVyKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIElURU1fVVNFX0RBVEFfVEFCTEUgKyAyICogdGhpcy5pZDtcbiAgfVxuXG4gIGdldCBpdGVtRGF0YVBvaW50ZXIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gSVRFTV9EQVRBX1RBQkxFICsgdGhpcy5pZDtcbiAgfVxuXG4gIGdldCBzZWxlY3RlZEl0ZW1Qb2ludGVyKCk6IG51bWJlciB7XG4gICAgcmV0dXJuIFNFTEVDVEVEX0lURU1fVEFCTEUgKyB0aGlzLmlkO1xuICB9XG5cbiAgZ2V0IG1lc3NhZ2VOYW1lUG9pbnRlcigpOiBudW1iZXIge1xuICAgIHJldHVybiBNRVNTQUdFX05BTUVfVEFCTEUgKyAyICogdGhpcy5pZDtcbiAgfVxuXG4gIGdldCBtZW51TmFtZVBvaW50ZXIoKTogbnVtYmVyIHtcbiAgICByZXR1cm4gTUVOVV9OQU1FX1RBQkxFICsgMiAqIHRoaXMuaWQ7XG4gIH1cblxuICBpdGVtVXNlTWVzc2FnZXMoKTogTWVzc2FnZUlkW10ge1xuICAgIGNvbnN0IG1lc3NhZ2VzID0gbmV3IE1hcDxzdHJpbmcsIE1lc3NhZ2VJZD4oKTtcbiAgICBmb3IgKGNvbnN0IHttZXNzYWdlfSBvZiB0aGlzLml0ZW1Vc2VEYXRhKSB7XG4gICAgICBtZXNzYWdlcy5zZXQobWVzc2FnZS5taWQoKSwgbWVzc2FnZSk7XG4gICAgfVxuICAgIHJldHVybiBbLi4ubWVzc2FnZXMudmFsdWVzKCldO1xuICB9XG5cbiAgc2V0TmFtZShuYW1lOiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLm1lc3NhZ2VOYW1lID0gdGhpcy5tZW51TmFtZSA9IG5hbWU7XG4gIH1cblxuICAvLyBQYWxldHRlIGZvciBtZW51IGljb25cbiAgZ2V0IHBhbGV0dGUoKTogbnVtYmVyIHsgcmV0dXJuIHRoaXMuaXRlbURhdGFWYWx1ZSAmIDM7IH1cbiAgc2V0IHBhbGV0dGUocDogbnVtYmVyKSB7IHRoaXMuaXRlbURhdGFWYWx1ZSA9IHRoaXMuaXRlbURhdGFWYWx1ZSAmIH4zIHwgKHAgJiAzKTsgfVxuXG4gIC8vIFVuaXF1ZSBpdGVtOiBjYW5ub3QgYmUgZHJvcHBlZCBvciBzb2xkXG4gIGdldCB1bmlxdWUoKTogYm9vbGVhbiB7IHJldHVybiAhISh0aGlzLml0ZW1EYXRhVmFsdWUgJiAweDQwKTsgfVxuICBzZXQgdW5pcXVlKHU6IGJvb2xlYW4pIHsgdGhpcy5pdGVtRGF0YVZhbHVlID0gdGhpcy5pdGVtRGF0YVZhbHVlICYgfjB4NDAgfCAodSA/IDB4NDAgOiAwKTsgfVxuXG4gIC8vIFdvcm4gaXRlbSAoc3dvcmQvYXJtb3Ivb3JiL3JpbmcvbWFnaWMpIC0gbm90IGNsZWFyIHdoZXJlIHRoaXMgaXMgdXNlZFxuICBnZXQgd29ybigpOiBib29sZWFuIHsgcmV0dXJuICEhKHRoaXMuaXRlbURhdGFWYWx1ZSAmIDB4MjApOyB9XG4gIHNldCB3b3JuKHc6IGJvb2xlYW4pIHsgdGhpcy5pdGVtRGF0YVZhbHVlID0gdGhpcy5pdGVtRGF0YVZhbHVlICYgfjB4MjAgfCAodyA/IDB4MjAgOiAwKTsgfVxuXG4gIC8vIFNvbGlkIGJhY2tncm91bmQgKHN3b3JkL21hZ2ljKVxuICBnZXQgc29saWQoKTogYm9vbGVhbiB7IHJldHVybiAhISh0aGlzLml0ZW1EYXRhVmFsdWUgJiAweDgwKTsgfVxuICBzZXQgc29saWQoczogYm9vbGVhbikgeyB0aGlzLml0ZW1EYXRhVmFsdWUgPSB0aGlzLml0ZW1EYXRhVmFsdWUgJiB+MHg4MCB8IChzID8gMHg4MCA6IDApOyB9XG5cbiAgLy8gZ2V0IGl0ZW1Vc2VEYXRhKCk6IFVpbnQ4QXJyYXkge1xuICAvLyAgIC8vIE5PVEU6IHRoaXMgaXMgaGFja3ksIGl0IHNob3VsZCByZWFsbHkgYmUgbGVzcyB0aGFuIDI0LCBhbmQgdmFyaWFibGUhXG4gIC8vICAgLy8gTW9yZW92ZXIsIHNvbWUgaXRlbXMgaGF2ZSBvdmVybGFwcGluZyBkYXRhLCB3aGljaCBpcyBhd2t3YXJkLlxuICAvLyAgIC8vIFNvIHJlYWxseSB3ZSBuZWVkIHNlcGFyYXRlIEl0ZW1Vc2UgYW5kIEl0ZW1KdW1wIGVudGl0aWVzIGFuZCB0aGVuIGp1c3RcbiAgLy8gICAvLyBwb2ludCB0byB3aGljaCBvbmUgd2Ugd2FudCBoZXJlLlxuICAvLyAgIHJldHVybiB0aGlzLnJvbS5wcmcuc3ViYXJyYXkodGhpcy5pdGVtVXNlRGF0YUJhc2UsIDI0KTtcbiAgLy8gfVxuXG4gIGFzeW5jIHdyaXRlKHdyaXRlcjogV3JpdGVyKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgd3JpdGVyLnJvbVt0aGlzLml0ZW1EYXRhUG9pbnRlcl0gPSB0aGlzLml0ZW1EYXRhVmFsdWU7XG4gICAgd3JpdGVyLnJvbVt0aGlzLnNlbGVjdGVkSXRlbVBvaW50ZXJdID0gdGhpcy5zZWxlY3RlZEl0ZW1WYWx1ZTtcbiAgICBpZiAodGhpcy5yb20uc2hvcERhdGFUYWJsZXNBZGRyZXNzICE9IG51bGwpIHtcbiAgICAgIGlmICh0aGlzLmlkID49IDB4ZCAmJiB0aGlzLmlkIDwgMHgyNykge1xuICAgICAgICBjb25zdCBhZGRyZXNzID1cbiAgICAgICAgICAgIHRoaXMucm9tLnNob3BEYXRhVGFibGVzQWRkcmVzcyArXG4gICAgICAgICAgICAyMSAqIHRoaXMucm9tLnNob3BDb3VudCArXG4gICAgICAgICAgICAyICogdGhpcy5yb20uc2NhbGluZ0xldmVscyArXG4gICAgICAgICAgICAyICogKHRoaXMuaWQgLSAweGQpO1xuICAgICAgICB3cml0ZUxpdHRsZUVuZGlhbih3cml0ZXIucm9tLCBhZGRyZXNzLCB0aGlzLmJhc2VQcmljZSk7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIGNvbnN0IGFkZHJlc3MgPSBWQU5JTExBX1BBV05fUFJJQ0VfVEFCTEUgKyAyICogdGhpcy5pZDtcbiAgICAgIHdyaXRlTGl0dGxlRW5kaWFuKHdyaXRlci5yb20sIGFkZHJlc3MsIHRoaXMuYmFzZVByaWNlID4+PiAxKTtcbiAgICB9XG5cbiAgICBjb25zdCBtZW51TmFtZUVuY29kZWQgPVxuICAgICAgICBNRU5VX05BTUVfRU5DT0RFLnJlZHVjZSgocywgW2QsIGVdKSA9PiBzLnJlcGxhY2UoZCwgZSksIHRoaXMubWVudU5hbWUpO1xuXG4gICAgY29uc3QgbWVudUFkZHJlc3MgPSBhd2FpdCB3cml0ZXIud3JpdGUoXG4gICAgICAgIFsuLi5zdHJpbmdUb0J5dGVzKG1lbnVOYW1lRW5jb2RlZCksIDB4ZmZdLFxuICAgICAgICAweDIwMDAwLCAweDIxZmZmLCBgSXRlbU1lbnVOYW1lICR7aGV4KHRoaXMuaWQpfWApO1xuICAgIHdyaXRlTGl0dGxlRW5kaWFuKHdyaXRlci5yb20sIHRoaXMubWVudU5hbWVQb2ludGVyLCBtZW51QWRkcmVzcyAtIDB4MTgwMDApO1xuXG4gICAgaWYgKHRoaXMudXNlKSB7XG4gICAgICB3cml0ZUxpdHRsZUVuZGlhbih3cml0ZXIucm9tLFxuICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5pdGVtVXNlSnVtcFBvaW50ZXIsIHRoaXMuaXRlbVVzZUp1bXAgLSAweDE0MDAwKTtcblxuICAgICAgY29uc3QgaXRlbVVzZURhdGE6IG51bWJlcltdID0gW107XG4gICAgICBmb3IgKGNvbnN0IHVzZSBvZiB0aGlzLml0ZW1Vc2VEYXRhKSB7XG4gICAgICAgIGl0ZW1Vc2VEYXRhLnB1c2goLi4udXNlLmJ5dGVzKCkpO1xuICAgICAgfVxuICAgICAgY29uc3QgaXRlbVVzZUFkZHJlc3MgPSBhd2FpdCB3cml0ZXIud3JpdGUoXG4gICAgICAgICAgaXRlbVVzZURhdGEsIDB4MWMwMDAsIDB4MWZmZmYsIGBJdGVtVXNlRGF0YSAke2hleCh0aGlzLmlkKX1gKTtcbiAgICAgIHdyaXRlTGl0dGxlRW5kaWFuKHdyaXRlci5yb20sXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLml0ZW1Vc2VEYXRhUG9pbnRlciwgaXRlbVVzZUFkZHJlc3MgLSAweDE0MDAwKTtcbiAgICB9XG5cbiAgICAvLyB3cml0ZXIud3JpdGUoWy4uLnN0cmluZ1RvQnl0ZXModGhpcy5tZXNzYWdlTmFtZSksIDBdLFxuICAgIC8vIDB4MjgwMDAsIDB4MjlmZmYsIGBJdGVtTWVzc2FnZU5hbWUgJHtoZXgodGhpcy5pZCl9YCksXG4gICAgLy8gd3JpdGVMaXR0bGVFbmRpYW4od3JpdGVyLnJvbSwgdGhpcy5tZXNzYWdlTmFtZVBvaW50ZXIsIG1lc3NhZ2VBZGRyZXNzIC0gMHgyMDAwMCk7XG4gIH1cbn1cblxuY29uc3Qgc3RyaW5nVG9CeXRlcyA9IChzOiBzdHJpbmcpOiBudW1iZXJbXSA9PiB7XG4gIHJldHVybiBzZXEocy5sZW5ndGgsIGkgPT4gcy5jaGFyQ29kZUF0KGkpKTtcbn07XG5cbi8vIFRyYWRlLWluIHNsb3RzIGNvdWxkIGJlIGN1c3RvbWl6ZWQgcXVpdGUgYSBiaXQ6XG4vLyAgLSBOUENcbi8vICAtIGl0ZW0gcmVxdWlyZWRcbi8vICAtIGl0ZW0gZ2l2ZW5cbi8vICAtIGZsYWdzIGdpdmVuXG4vLyAgLSBsb2NhdGlvblxuLy8gZXRjLi4uXG4vLyBjb25zdCBUUkFERV9JTlMgPSBuZXcgTWFwKFtcbi8vICAgWzB4MWQsIDFdLCAvLyBtZWRpY2FsIGhlcmJcbi8vICAgWzB4MjUsIDFdLCAvLyBzdGF0dWUgb2Ygb255eFxuLy8gICBbMHgyOCwgNF0sIC8vIGZsdXRlIG9mIGxpbWUgKGZpcnN0IHR3byB1bnVzZWQpXG4vLyAgIFsweDMxLCAyXSwgLy8gYWxhcm0gZmx1dGVcbi8vICAgWzB4MzUsIDFdLCAvLyBmb2cgbGFtcFxuLy8gICBbMHgzYiwgMV0sIC8vIGxvdmUgcGVuZGFudFxuLy8gICBbMHgzYywgMV0sIC8vIGtpcmlzYSBwbGFudFxuLy8gICBbMHgzZCwgMV0sIC8vIGl2b3J5IHN0YXR1ZVxuICAvLyBUT0RPIC0gY29uc2lkZXIgbW92aW5nIHNsZWVwaW5nIHBlb3BsZT9cbiAgLy8gICAgICAtLT4gd291bGQgd2FudCB0byBwdXQgc29tZXRoaW5nIGluIHRoZWlyIHBsYWNlP1xuICAvLyAgICAgICAgICAtIG1heWJlIGV2ZW4gYSBib3NzIGluIGNsb3NlIHF1YXJ0ZXJzIGFyZWE/XG4gIC8vIFRPRE8gLSBtYXliZSBOUEMgc2hvdWxkIGhhdmUgYW4gXCJpdGVtIHdhbnRlZFwiIHByb3BlcnR5P1xuLy8gXSk7XG5cbi8vIEl0ZW1Vc2UgZGF0YSBhcmUgaW4gc3RhbnphcyB3aXRoIDAtMiBieXRlIGhlYWRlcnMuXG4vLyBUaGUgc3RydWN0dXJlIGlzIGRldGVybWluZWQgYnkgdGhlIEl0ZW1Vc2VKdW1wLFxuLy8gd2hpY2ggZXhwZWN0cyB0aGUgdmFyaW91cyBoZWFkZXJzLlxuXG50eXBlIEl0ZW1Vc2VLaW5kID0gJ2V4cGVjdCcgfCAnc2NyZWVuJyB8ICdmbGFnJyB8ICdsb2NhdGlvbicgfCAnZW1wdHknO1xuXG5leHBvcnQgY2xhc3MgSXRlbVVzZSB7XG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBraW5kOiBJdGVtVXNlS2luZCxcbiAgICAgICAgICAgICAgcHVibGljIHdhbnQ6IG51bWJlciwgLy8gbm90ZTogaW50ZXJwcmV0YXRpb24gZGVwZW5kcyBvbiBraW5kLlxuICAgICAgICAgICAgICBwdWJsaWMgbWVzc2FnZTogTWVzc2FnZUlkLFxuICAgICAgICAgICAgICBwdWJsaWMgZmxhZ3M6IG51bWJlcltdKSB7fVxuXG4gIHN0YXRpYyBmcm9tKGtpbmQ6IEl0ZW1Vc2VLaW5kLCBkYXRhOiBEYXRhPG51bWJlcj4sIG9mZnNldDogbnVtYmVyKSB7XG4gICAgbGV0IHdhbnQgPSAwO1xuICAgIGlmIChraW5kID09PSAnZXhwZWN0JyB8fCBraW5kID09PSAnc2NyZWVuJykge1xuICAgICAgd2FudCA9IGRhdGFbb2Zmc2V0ICsgMV0gPDwgOCB8IGRhdGFbb2Zmc2V0XTtcbiAgICAgIG9mZnNldCArPSAyO1xuICAgIH0gZWxzZSBpZiAoa2luZCA9PT0gJ2ZsYWcnKSB7XG4gICAgICBjb25zdCBmbGFncyA9IFNQQVdOX0NPTkRJVElPTl9GTEFHUy5yZWFkKGRhdGEsIG9mZnNldCk7XG4gICAgICBpZiAoIWZsYWdzLmxlbmd0aCkgZmxhZ3MucHVzaCh+MCk7XG4gICAgICBpZiAoZmxhZ3MubGVuZ3RoID4gMSkgdGhyb3cgbmV3IEVycm9yKGBGbGFnIGxpc3QgdG9vIGxvbmc6ICR7ZmxhZ3N9YCk7XG4gICAgICB3YW50ID0gZmxhZ3NbMF07XG4gICAgICBvZmZzZXQgKz0gMjtcbiAgICB9IGVsc2UgaWYgKGtpbmQgPT09ICdsb2NhdGlvbicpIHtcbiAgICAgIHdhbnQgPSBkYXRhW29mZnNldCsrXTtcbiAgICB9IGVsc2UgaWYgKGtpbmQgIT09ICdlbXB0eScpIHtcbiAgICAgIGFzc2VydE5ldmVyKGtpbmQpO1xuICAgIH1cbiAgICBjb25zdCBtZXNzYWdlID0gTWVzc2FnZUlkLmZyb20oZGF0YSwgb2Zmc2V0KTtcbiAgICBjb25zdCBmbGFncyA9IElURU1fVVNFX0ZMQUdTLnJlYWQoZGF0YSwgb2Zmc2V0ICsgMik7XG4gICAgcmV0dXJuIG5ldyBJdGVtVXNlKGtpbmQsIHdhbnQsIG1lc3NhZ2UsIGZsYWdzKTtcbiAgfVxuXG4gIGJ5dGVzKCk6IG51bWJlcltdIHtcbiAgICBjb25zdCBieXRlcyA9IFtdO1xuICAgIGlmICh0aGlzLmtpbmQgPT09ICdleHBlY3QnIHx8IHRoaXMua2luZCA9PT0gJ3NjcmVlbicpIHtcbiAgICAgIGJ5dGVzLnB1c2godGhpcy53YW50ICYgMHhmZiwgKHRoaXMud2FudCA+Pj4gOCkgJiAweGZmKTtcbiAgICB9IGVsc2UgaWYgKHRoaXMua2luZCA9PT0gJ2ZsYWcnKSB7XG4gICAgICBjb25zdCBmbGFnQnl0ZXMgPSBTUEFXTl9DT05ESVRJT05fRkxBR1MuYnl0ZXMoW3RoaXMud2FudF0pO1xuICAgICAgaWYgKGZsYWdCeXRlcy5sZW5ndGggIT09IDIpIHRocm93IG5ldyBFcnJvcihgYmFkIGRhdGE6ICR7ZmxhZ0J5dGVzfWApO1xuICAgICAgYnl0ZXMucHVzaCguLi5mbGFnQnl0ZXMpO1xuICAgIH0gZWxzZSBpZiAodGhpcy5raW5kID09PSAnbG9jYXRpb24nKSB7XG4gICAgICBieXRlcy5wdXNoKHRoaXMud2FudCk7XG4gICAgfSBlbHNlIGlmICh0aGlzLmtpbmQgIT09ICdlbXB0eScpIHtcbiAgICAgIGFzc2VydE5ldmVyKHRoaXMua2luZCk7XG4gICAgfSBcbiAgICBieXRlcy5wdXNoKC4uLnRoaXMubWVzc2FnZS5kYXRhKTtcbiAgICBieXRlcy5wdXNoKC4uLklURU1fVVNFX0ZMQUdTLmJ5dGVzKHRoaXMuZmxhZ3MpKTtcbiAgICByZXR1cm4gYnl0ZXM7XG4gIH1cblxuICAvLyBSZXR1cm4gdGhlIE5QQyBpZCBmb3IgYW4gZXhwZWN0IE5QQyB1c2UsIG90aGVyd2lzZSBudWxsLlxuICB0cmFkZU5wYygpOiBudW1iZXJ8bnVsbCB7XG4gICAgaWYgKHRoaXMua2luZCAhPT0gJ2V4cGVjdCcpIHJldHVybiBudWxsO1xuICAgIGlmICgodGhpcy53YW50ID4+PiA4KSAhPT0gMSkgcmV0dXJuIG51bGw7XG4gICAgcmV0dXJuIHRoaXMud2FudCAmIDB4ZmY7XG4gIH1cblxuICBnZXQgbGVuZ3RoKCk6IG51bWJlciB7XG4gICAgY29uc3QgaGVhZGVyID0gdGhpcy5raW5kID09PSAnZW1wdHknID8gMCA6IHRoaXMua2luZCA9PT0gJ2xvY2F0aW9uJyA/IDEgOiAyO1xuICAgIHJldHVybiAyICogKDEgKyBNYXRoLm1heCgxLCB0aGlzLmZsYWdzLmxlbmd0aCkpICsgaGVhZGVyO1xuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBJdGVtcyBleHRlbmRzIEVudGl0eUFycmF5PEl0ZW0+IHtcbiAgLy8gTk9URTogdGhpcyBtdXN0IGJlIGluaXRpYWxpemVkIGZpcnN0LlxuICByZWFkb25seSBpdGVtVXNlSnVtcHMgPSBERUZBVUxUX0lURU1fVVNFX0pVTVBTO1xuXG4gIC8vIFN3b3Jkc1xuICByZWFkb25seSBTd29yZE9mV2luZCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgwMCk7XG4gIHJlYWRvbmx5IFN3b3JkT2ZGaXJlICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDAxKTtcbiAgcmVhZG9ubHkgU3dvcmRPZldhdGVyICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MDIpO1xuICByZWFkb25seSBTd29yZE9mVGh1bmRlciAgID0gbmV3IEl0ZW0odGhpcywgMHgwMyk7XG4gIHJlYWRvbmx5IENyeXN0YWxpcyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA0KTtcbiAgLy8gUG93ZXJzXG4gIHJlYWRvbmx5IEJhbGxPZldpbmQgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA1KTtcbiAgcmVhZG9ubHkgVG9ybmFkb0JyYWNlbGV0ICA9IG5ldyBJdGVtKHRoaXMsIDB4MDYpO1xuICByZWFkb25seSBCYWxsT2ZGaXJlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgwNyk7XG4gIHJlYWRvbmx5IEZsYW1lQnJhY2VsZXQgICAgPSBuZXcgSXRlbSh0aGlzLCAweDA4KTtcbiAgcmVhZG9ubHkgQmFsbE9mV2F0ZXIgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MDkpO1xuICByZWFkb25seSBCbGl6emFyZEJyYWNlbGV0ID0gbmV3IEl0ZW0odGhpcywgMHgwYSk7XG4gIHJlYWRvbmx5IEJhbGxPZlRodW5kZXIgICAgPSBuZXcgSXRlbSh0aGlzLCAweDBiKTtcbiAgcmVhZG9ubHkgU3Rvcm1CcmFjZWxldCAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MGMpO1xuICAvLyBTaGllbGRzXG4gIHJlYWRvbmx5IENhcmFwYWNlU2hpZWxkICAgPSBuZXcgSXRlbSh0aGlzLCAweDBkKTtcbiAgcmVhZG9ubHkgQnJvbnplU2hpZWxkICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MGUpO1xuICByZWFkb25seSBQbGF0aW51bVNoaWVsZCAgID0gbmV3IEl0ZW0odGhpcywgMHgwZik7XG4gIHJlYWRvbmx5IE1pcnJvcmVkU2hpZWxkICAgPSBuZXcgSXRlbSh0aGlzLCAweDEwKTtcbiAgcmVhZG9ubHkgQ2VyYW1pY1NoaWVsZCAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTEpO1xuICByZWFkb25seSBTYWNyZWRTaGllbGQgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxMik7XG4gIHJlYWRvbmx5IEJhdHRsZVNoaWVsZCAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDEzKTtcbiAgcmVhZG9ubHkgUHN5Y2hvU2hpZWxkICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTQpO1xuICAvLyBBcm1vclxuICByZWFkb25seSBUYW5uZWRIaWRlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxNSk7XG4gIHJlYWRvbmx5IExlYXRoZXJBcm1vciAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDE2KTtcbiAgcmVhZG9ubHkgQnJvbnplQXJtb3IgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MTcpO1xuICByZWFkb25seSBQbGF0aW51bUFybW9yICAgID0gbmV3IEl0ZW0odGhpcywgMHgxOCk7XG4gIHJlYWRvbmx5IFNvbGRpZXJTdWl0ICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDE5KTtcbiAgcmVhZG9ubHkgQ2VyYW1pY1N1aXQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MWEpO1xuICByZWFkb25seSBCYXR0bGVBcm1vciAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgxYik7XG4gIHJlYWRvbmx5IFBzeWNob0FybW9yICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFjKTtcbiAgLy8gQ29uc3VtYWJsZXNcbiAgcmVhZG9ubHkgTWVkaWNhbEhlcmIgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MWQsIHt1c2U6IHRydWUsIHRyYWRlczogWzBdfSk7XG4gIHJlYWRvbmx5IEFudGlkb3RlICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFlLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEx5c2lzUGxhbnQgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDFmLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZMaW1lICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIwLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZQb3dlciAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIxLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IE1hZ2ljUmluZyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIyLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZydWl0T2ZSZXB1biAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDIzLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IFdhcnBCb290cyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDI0LCB7dXNlOiB0cnVlfSk7XG4gIC8vIFF1ZXN0IGl0ZW1zICgxKVxuICByZWFkb25seSBTdGF0dWVPZk9ueXggICAgID0gbmV3IEl0ZW0odGhpcywgMHgyNSwge3VzZTogdHJ1ZSwgdHJhZGVzOiBbMF19KTtcbiAgcmVhZG9ubHkgT3BlbFN0YXR1ZSAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MjYsIHt1c2U6IHRydWV9KTtcbiAgcmVhZG9ubHkgSW5zZWN0Rmx1dGUgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MjcsIHt1c2U6IHRydWV9KTtcbiAgLy8gVE9ETyAtIGNvbnNpZGVyIG9ubHkgdXNpbmcgMiwgMz8gIDAgYW5kIDEgYXJlIHVudXNlZC4uLlxuICByZWFkb25seSBGbHV0ZU9mTGltZSAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyOCwge3VzZTogdHJ1ZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cmFkZXM6IFswLCAxLCAyLCAzXX0pO1xuICAvLyBXb3JuIGl0ZW1zXG4gIHJlYWRvbmx5IEdhc01hc2sgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDI5KTtcbiAgcmVhZG9ubHkgUG93ZXJSaW5nICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MmEpO1xuICByZWFkb25seSBXYXJyaW9yUmluZyAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyYik7XG4gIHJlYWRvbmx5IElyb25OZWNrbGFjZSAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDJjKTtcbiAgcmVhZG9ubHkgRGVvc1BlbmRhbnQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MmQpO1xuICByZWFkb25seSBSYWJiaXRCb290cyAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgyZSk7XG4gIHJlYWRvbmx5IExlYXRoZXJCb290cyAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDJmKTtcbiAgcmVhZG9ubHkgU2hpZWxkUmluZyAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MzApO1xuICAvLyBRdWVzdCBpdGVtcyAoMilcbiAgcmVhZG9ubHkgQWxhcm1GbHV0ZSAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4MzEsIHt1c2U6IHRydWUsIHRyYWRlczogWzAsIDFdfSk7XG4gIHJlYWRvbmx5IFdpbmRtaWxsS2V5ICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDMyLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEtleVRvUHJpc29uICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDMzLCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEtleVRvU3R5eCAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDM0LCB7dXNlOiB0cnVlfSk7XG4gIHJlYWRvbmx5IEZvZ0xhbXAgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDM1LCB7dXNlOiB0cnVlLCB0cmFkZXM6IFswXX0pO1xuICByZWFkb25seSBTaGVsbEZsdXRlICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzNiwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBFeWVHbGFzc2VzICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzNywge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCcm9rZW5TdGF0dWUgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzOCwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBHbG93aW5nTGFtcCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzOSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBTdGF0dWVPZkdvbGQgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzYSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBMb3ZlUGVuZGFudCAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzYiwge3VzZTogdHJ1ZSwgdHJhZGVzOiBbMF19KTtcbiAgcmVhZG9ubHkgS2lyaXNhUGxhbnQgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4M2MsIHt1c2U6IHRydWUsIHRyYWRlczogWzBdfSk7XG4gIHJlYWRvbmx5IEl2b3J5U3RhdHVlICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDNkLCB7dXNlOiB0cnVlLCB0cmFkZXM6IFswXX0pO1xuICByZWFkb25seSBCb3dPZk1vb24gICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzZSwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCb3dPZlN1biAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHgzZiwge3VzZTogdHJ1ZX0pO1xuICByZWFkb25seSBCb3dPZlRydXRoICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0MCwge3VzZTogdHJ1ZX0pO1xuICAvLyBNYWdpY1xuICByZWFkb25seSBSZWZyZXNoICAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0MSk7XG4gIHJlYWRvbmx5IFBhcmFseXNpcyAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQyKTtcbiAgcmVhZG9ubHkgVGVsZXBhdGh5ICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4NDMpO1xuICByZWFkb25seSBUZWxlcG9ydCAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0NCk7XG4gIHJlYWRvbmx5IFJlY292ZXIgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQ1KTtcbiAgcmVhZG9ubHkgQmFycmllciAgICAgICAgICA9IG5ldyBJdGVtKHRoaXMsIDB4NDYpO1xuICByZWFkb25seSBDaGFuZ2UgICAgICAgICAgID0gbmV3IEl0ZW0odGhpcywgMHg0Nyk7XG4gIHJlYWRvbmx5IEZsaWdodCAgICAgICAgICAgPSBuZXcgSXRlbSh0aGlzLCAweDQ4KTtcblxuICBjb25zdHJ1Y3RvcihyZWFkb25seSByb206IFJvbSkge1xuICAgIHN1cGVyKDB4NDkpO1xuICB9XG5cbiAgYXN5bmMgd3JpdGUod3JpdGVyOiBXcml0ZXIpOiBQcm9taXNlPHZvaWQ+IHtcbiAgICBjb25zdCBwcm9taXNlcyA9IFtdO1xuICAgIGZvciAoY29uc3QgaXRlbSBvZiB0aGlzKSB7XG4gICAgICBwcm9taXNlcy5wdXNoKGl0ZW0ud3JpdGUod3JpdGVyKSk7XG4gICAgfVxuICAgIGF3YWl0IFByb21pc2UuYWxsKHByb21pc2VzKTtcbiAgfVxufVxuXG5jb25zdCBERUZBVUxUX0lURU1fVVNFX0pVTVBTOiB7W2FkZHI6IG51bWJlcl06IEl0ZW1Vc2VLaW5kW119ID0ge1xuICAvLyAzYiBsb3ZlIHBlbmRhbnRcbiAgMHgxYzQzOTogWydleHBlY3QnXSxcbiAgLy8gNDAgYm93IG9mIHRydXRoXG4gIDB4MWM0NDI6IFsnc2NyZWVuJ10sXG4gIC8vIDI2IG9wZWwgc3RhdHVlXG4gIDB4MWM0NTA6IFsnZW1wdHknXSxcbiAgLy8gM2UgYm93IG9mIG1vb24sIDNmIGJvdyBvZiBzdW5cbiAgMHgxYzQ1MTogWydzY3JlZW4nXSxcbiAgLy8gMzIgd2luZG1pbGwga2V5LCAzNyBleWUgZ2xhc3Nlc1xuICAweDFjNDVmOiBbJ2xvY2F0aW9uJ10sXG4gIC8vIDMzIHByaXNvbiBrZXksIDM0IHN0eHksIDM1IGZvZyBsYW1wLCAzYyBraXJpc2EgcGxhbnQsIDNkIGl2b3J5IHN0YXR1ZVxuICAweDFjNDkxOiBbJ2V4cGVjdCddLFxuICAvLyAzMSBhbGFybSBmbHV0ZVxuICAweDFjNGE5OiBbJ2V4cGVjdCcsICdleHBlY3QnXSxcbiAgLy8gMjcgaW5zZWN0IGZsdXRlXG4gIDB4MWM0YjM6IFsnbG9jYXRpb24nXSxcbiAgLy8gM2Egc3RhdHVlIG9mIGdvbGRcbiAgMHgxYzRkMDogWydleHBlY3QnXSxcbiAgLy8gaW52YWxpZFxuICAweDFjNGRiOiBbXSxcbiAgLy8gMWQgbWVkaWNhbCBoZXJiXG4gIDB4MWM0ZTA6IFsnZXhwZWN0JywgJ2VtcHR5J10sXG4gIC8vIDIxIGZydWl0IG9mIHBvd2VyXG4gIDB4MWM1MDc6IFsnZW1wdHknXSxcbiAgLy8gMjIgbWFnaWMgcmluZ1xuICAweDFjNTFkOiBbJ2VtcHR5J10sXG4gIC8vIDFlIGFudGlkb3RlXG4gIDB4MWM1MjQ6IFsnZW1wdHknXSxcbiAgLy8gMWYgbHlzaXMgcGxhbnRcbiAgMHgxYzUyZjogWydlbXB0eSddLFxuICAvLyAyMCBmcnVpdCBvZiBsaW1lXG4gIDB4MWM1M2E6IFsnZW1wdHknXSxcbiAgLy8gMjMgZnJ1aXQgb2YgcmVwdW5cbiAgMHgxYzU0YTogWydlbXB0eSddLFxuICAvLyAyNCB3YXJwIGJvb3RzIC0+IHJ0c1xuICAweDFjNTY0OiBbJ2VtcHR5J10sXG4gIC8vIDI1IHN0YXR1ZSBvZiBvbnl4XG4gIDB4MWM1NjU6IFsnZXhwZWN0J10sXG4gIC8vIDM2IHNoZWxsIGZsdXRlXG4gIDB4MWM1NmI6IFsnZmxhZyddLFxuICAvLyAzOSBnbG93aW5nIGxhbXBcbiAgMHgxYzU4NTogWydlbXB0eSddLFxuICAvLyAyOCBmbHV0ZSBvZiBsaW1lXG4gIDB4MWM1OWU6IFsnZXhwZWN0JywgJ2V4cGVjdCcsICdleHBlY3QnLCAnZXhwZWN0J10sXG59O1xuIl19