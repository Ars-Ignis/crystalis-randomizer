export var Event;
(function (Event) {
    Event.STARTED_WINDMILL = Condition(0x00a);
    Event.LEAF_ELDER = Condition(0x00b);
    Event.UNDERGROUND_CHANNEL = Condition(0x018);
    Event.MESIA_RECORDING = Condition(0x01b);
    Event.QUEEN_REVEALED = Condition(0x01e);
    Event.RETURNED_FOG_LAMP = Condition(0x021);
    Event.GENERALS_DEFEATED = Condition(0x024);
    Event.HEALED_DOLPHIN = Condition(0x025);
    Event.ENTERED_SHYRON = Condition(0x026);
    Event.SHYRON_MASSACRE = Condition(0x027);
    Event.LEAF_ABDUCTION = Condition(0x038);
    Event.ZEBU_CAVE = Condition(0x03a);
    Event.ZEBU_SHYRON = Condition(0x03b);
    Event.RESCUED_CHILD = Condition(0x045);
    Event.DWARF_MOTHER = Condition(0x052);
    Event.DWARF_CHILD = Condition(0x053);
    Event.STOM_IN_SWAN = Condition(0x061);
    Event.DRAYGON1 = Condition(0x06c);
    Event.FOUND_KENSU = Condition(0x072);
    Event.SHELL_FLUTE = Condition(0x08b);
    Event.RIDE_DOLPHIN = Condition(0x09b);
    Event.ZEBU_STUDENT = Condition(0x0a5);
    Event.LEAF_RABBIT = Condition(0x0a9);
    Event.CALMED_SEA = Condition(0x283);
    Event.OPENED_JOEL_SHED = Condition(0x287);
    Event.OPENED_CRYPT = Condition(0x28e);
    Event.OPENED_STYX = Condition(0x2b0);
    Event.OPENED_SWAN = Condition(0x2b3);
    Event.OPENED_PRISON = Condition(0x2d8);
    Event.OPENED_SEALED_CAVE = Condition(0x2ee);
    Event.START = Condition(0x2f0);
    Event.WARP_OAK = Condition(0x2f6);
    Event.WARP_JOEL = Condition(0x2fa);
})(Event || (Event = {}));
export var Capability;
(function (Capability) {
    Capability.SWORD = Condition(~0);
    Capability.MONEY = Condition(~1);
    Capability.BREAK_STONE = Condition(~2);
    Capability.BREAK_ICE = Condition(~3);
    Capability.FORM_BRIDGE = Condition(~4);
    Capability.BREAK_IRON = Condition(~5);
    Capability.TRAVEL_SWAMP = Condition(~6);
    Capability.CLIMB_WATERFALL = Condition(~7);
    Capability.BUY_HEALING = Condition(~8);
    Capability.BUY_WARP = Condition(~9);
    Capability.SHOOTING_STATUE = Condition(~10);
    Capability.CLIMB_SLOPE = Condition(~11);
})(Capability || (Capability = {}));
export function Boss(id) {
    return Condition(0x100 | id);
}
(function (Boss) {
    Boss.VAMPIRE1 = Boss(0x0);
    Boss.INSECT = Boss(0x1);
    Boss.KELBESQUE1 = Boss(0x2);
    Boss.RAGE = Boss(0x3);
    Boss.SABERA1 = Boss(0x4);
    Boss.MADO1 = Boss(0x5);
    Boss.KELBESQUE2 = Boss(0x6);
    Boss.SABERA2 = Boss(0x7);
    Boss.MADO2 = Boss(0x8);
    Boss.KARMINE = Boss(0x9);
    Boss.DRAYGON1 = Boss(0xa);
    Boss.DRAYGON2 = Boss(0xb);
    Boss.VAMPIRE2 = Boss(0xc);
})(Boss || (Boss = {}));
export function Item(id) {
    if (id >= 0x70)
        throw new Error(`expected item: ${id.toString(16)}`);
    return Condition(0x200 | id);
}
(function (Item) {
    Item.SWORD_OF_WIND = Item(0x00);
    Item.SWORD_OF_FIRE = Item(0x01);
    Item.SWORD_OF_WATER = Item(0x02);
    Item.SWORD_OF_THUNDER = Item(0x03);
    Item.CRYSTALIS = Item(0x04);
    Item.ORB_OF_WIND = Item(0x05);
    Item.TORNADO_BRACELET = Item(0x06);
    Item.ORB_OF_FIRE = Item(0x07);
    Item.FLAME_BRACELET = Item(0x08);
    Item.ORB_OF_WATER = Item(0x09);
    Item.BLIZZARD_BRACELET = Item(0x0a);
    Item.ORB_OF_THUNDER = Item(0x0b);
    Item.STORM_BRACELET = Item(0x0c);
    Item.MEDICAL_HERB = Item(0x1d);
    Item.WARP_BOOTS = Item(0x24);
    Item.STATUE_OF_ONYX = Item(0x25);
    Item.INSECT_FLUTE = Item(0x27);
    Item.FLUTE_OF_LIME = Item(0x28);
    Item.GAS_MASK = Item(0x29);
    Item.POWER_RING = Item(0x2a);
    Item.WARRIOR_RING = Item(0x2b);
    Item.IRON_NECKLACE = Item(0x2c);
    Item.DEOS_PENDANT = Item(0x2d);
    Item.RABBIT_BOOTS = Item(0x2e);
    Item.LEATHER_BOOTS = Item(0x2f);
    Item.SHIELD_RING = Item(0x30);
    Item.ALARM_FLUTE = Item(0x31);
    Item.WINDMILL_KEY = Item(0x32);
    Item.KEY_TO_PRISON = Item(0x33);
    Item.KEY_TO_STYX = Item(0x34);
    Item.FOG_LAMP = Item(0x35);
    Item.SHELL_FLUTE = Item(0x36);
    Item.EYE_GLASSES = Item(0x37);
    Item.BROKEN_STATUE = Item(0x38);
    Item.GLOWING_LAMP = Item(0x39);
    Item.STATUE_OF_GOLD = and(Item.BROKEN_STATUE, Item.GLOWING_LAMP);
    Item.LOVE_PENDANT = Item(0x3b);
    Item.KIRISA_PLANT = Item(0x3c);
    Item.IVORY_STATUE = Item(0x3d);
    Item.BOW_OF_MOON = Item(0x3e);
    Item.BOW_OF_SUN = Item(0x3f);
    Item.BOW_OF_TRUTH = Item(0x40);
})(Item || (Item = {}));
export var Magic;
(function (Magic) {
    Magic.REFRESH = Item(0x41);
    Magic.PARALYSIS = Item(0x42);
    Magic.TELEPATHY = Item(0x43);
    Magic.TELEPORT = Item(0x44);
    Magic.RECOVER = Item(0x45);
    Magic.BARRIER = Item(0x46);
    Magic.CHANGE = Item(0x47);
    Magic.FLIGHT = Item(0x48);
})(Magic || (Magic = {}));
export var WallType;
(function (WallType) {
    WallType[WallType["WIND"] = 0] = "WIND";
    WallType[WallType["FIRE"] = 1] = "FIRE";
    WallType[WallType["WATER"] = 2] = "WATER";
    WallType[WallType["THUNDER"] = 3] = "THUNDER";
})(WallType || (WallType = {}));
export class MutableRequirement {
    constructor() {
        this.map = new Map();
    }
    [Symbol.iterator]() {
        return this.map.values();
    }
    add(newLabel, newDeps) {
        for (const c of newDeps)
            if (Array.isArray(c))
                throw new Error();
        if (this.map.has(newLabel))
            return false;
        for (const [curLabel, curDeps] of this.map) {
            if (containsAll(newDeps, curDeps))
                return false;
            if (containsAll(curDeps, newDeps))
                this.map.delete(curLabel);
        }
        this.map.set(newLabel, newDeps);
        return true;
    }
    addAll(requirement) {
        for (const conditions of requirement) {
            this.addList(conditions);
        }
    }
    addList(conditions) {
        const sorted = [...new Set(conditions)].sort();
        const deps = new Set(sorted);
        this.add(sorted.join(' '), deps);
    }
    restrict(r) {
        const l = [...this.map.values()];
        this.map.clear();
        for (const ls of l) {
            for (const rs of r) {
                this.addList([...ls, ...rs]);
            }
        }
    }
    freeze() {
        return [...this].map(cs => [...cs]);
    }
}
const containsAll = (left, right) => {
    if (left.size < right.size)
        return false;
    for (const d of right) {
        if (!left.has(d))
            return false;
    }
    return true;
};
export function Condition(x) {
    return [[x]];
}
export function and(...cs) {
    return [[].concat(...cs.map((c) => c[0]))];
}
export function or(...cs) {
    return [].concat(...cs);
}
export function meet(left, right) {
    const out = new MutableRequirement();
    for (const ls of left) {
        for (const rs of right) {
            out.addList([...ls, ...rs]);
        }
    }
    return out.freeze();
}
const meetReq = meet;
(function (Condition) {
    Condition.OPEN = [[]];
})(Condition || (Condition = {}));
export function Slot(x) {
    if (typeof x === 'number')
        return x;
    return x[0][0];
}
(function (Slot) {
    function item(x) {
        return (x | 0x200);
    }
    Slot.item = item;
})(Slot || (Slot = {}));
export var Check;
(function (Check) {
    function chest(id) {
        return { slot: Slot(0x200 | id) };
    }
    Check.chest = chest;
})(Check || (Check = {}));
export var Terrain;
(function (Terrain) {
    Terrain.seamless = memoize((t) => ({ ...t }));
    function meet(left, right) {
        const out = {};
        if (left.enter || right.enter) {
            out.enter = meetReq(left.enter || [[]], right.enter || [[]]);
        }
        if (left.exit || right.exit) {
            out.exit = meetReq(left.exit || [[]], right.exit || [[]]);
        }
        if (left.exitSouth || right.exitSouth) {
            out.exitSouth = meetReq(left.exitSouth || [[]], right.exitSouth || [[]]);
        }
        return out;
    }
    Terrain.meet = meet;
    function join(left, right) {
        const out = {};
        if (left.enter || right.enter) {
            out.enter = (left.enter || [[]]).concat(right.enter || [[]]);
        }
        if (left.exit || right.exit) {
            out.exit = (left.exit || [[]]).concat(right.exit || [[]]);
        }
        if (left.exitSouth || right.exitSouth) {
            out.exitSouth = (left.exitSouth || [[]]).concat(right.exitSouth || [[]]);
        }
        return out;
    }
    Terrain.join = join;
    function flag(id) {
        return { enter: Condition(id) };
    }
    Terrain.flag = flag;
})(Terrain || (Terrain = {}));
export function memoize(f) {
    const map = new WeakMap();
    const undef = {};
    return (x) => {
        let y = map.get(x);
        if (y === undefined) {
            y = f(x);
            map.set(x, y === undefined ? undef : y);
        }
        else if (y === undef) {
            y = undefined;
        }
        return y;
    };
}
export function memoize2(f) {
    const map = new WeakMap();
    const undef = {};
    return (x, y) => {
        let ys = map.get(x);
        if (ys == undefined)
            map.set(x, ys = new WeakMap());
        let z = ys.get(y);
        if (z === undefined) {
            z = f(x, y);
            ys.set(y, z === undefined ? undef : z);
        }
        else if (z === undef) {
            z = undefined;
        }
        return z;
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29uZGl0aW9uLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2pzL2dyYXBoL2NvbmRpdGlvbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxNQUFNLEtBQVcsS0FBSyxDQXFDckI7QUFyQ0QsV0FBaUIsS0FBSztJQUNQLHNCQUFnQixHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNwQyxnQkFBVSxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUM5Qix5QkFBbUIsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDdkMscUJBQWUsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbkMsb0JBQWMsR0FBRyxTQUFTLENBQUMsS0FBSyxDQUFDLENBQUM7SUFDbEMsdUJBQWlCLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ3JDLHVCQUFpQixHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNyQyxvQkFBYyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsQyxvQkFBYyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsQyxxQkFBZSxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNuQyxvQkFBYyxHQUFHLFNBQVMsQ0FBQyxLQUFLLENBQUMsQ0FBQztJQUNsQyxlQUFTLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQzdCLGlCQUFXLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQy9CLG1CQUFhLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2pDLGtCQUFZLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLGlCQUFXLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQy9CLGtCQUFZLEdBQUcsU0FBUyxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hDLGNBQVEsR0FBRyxT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R0FBRyxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUUsRUFBRSxHQUFHLElBQUksT0FBTyxFQUFFLENBQUMsQ0FBQztRQUNwRCxJQUFJLENBQUMsR0FBRyxFQUFFLENBQUMsR0FBRyxDQUFDLENBQUMsQ0FBQyxDQUFDO1FBQ2xCLElBQUksQ0FBQyxLQUFLLFNBQVMsRUFBRTtZQUNuQixDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsQ0FBQztZQUNaLEVBQUUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxFQUFFLENBQUMsS0FBSyxTQUFTLENBQUMsQ0FBQyxDQUFDLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDeEM7YUFBTSxJQUFJLENBQUMsS0FBSyxLQUFLLEVBQUU7WUFDdEIsQ0FBQyxHQUFHLFNBQVMsQ0FBQztTQUNmO1FBQ0QsT0FBTyxDQUFNLENBQUM7SUFDaEIsQ0FBQyxDQUFDO0FBQ0osQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBuYW1lc3BhY2UgRXZlbnQge1xuICBleHBvcnQgY29uc3QgU1RBUlRFRF9XSU5ETUlMTCA9IENvbmRpdGlvbigweDAwYSk7XG4gIGV4cG9ydCBjb25zdCBMRUFGX0VMREVSID0gQ29uZGl0aW9uKDB4MDBiKTtcbiAgZXhwb3J0IGNvbnN0IFVOREVSR1JPVU5EX0NIQU5ORUwgPSBDb25kaXRpb24oMHgwMTgpO1xuICBleHBvcnQgY29uc3QgTUVTSUFfUkVDT1JESU5HID0gQ29uZGl0aW9uKDB4MDFiKTtcbiAgZXhwb3J0IGNvbnN0IFFVRUVOX1JFVkVBTEVEID0gQ29uZGl0aW9uKDB4MDFlKTtcbiAgZXhwb3J0IGNvbnN0IFJFVFVSTkVEX0ZPR19MQU1QID0gQ29uZGl0aW9uKDB4MDIxKTtcbiAgZXhwb3J0IGNvbnN0IEdFTkVSQUxTX0RFRkVBVEVEID0gQ29uZGl0aW9uKDB4MDI0KTtcbiAgZXhwb3J0IGNvbnN0IEhFQUxFRF9ET0xQSElOID0gQ29uZGl0aW9uKDB4MDI1KTtcbiAgZXhwb3J0IGNvbnN0IEVOVEVSRURfU0hZUk9OID0gQ29uZGl0aW9uKDB4MDI2KTtcbiAgZXhwb3J0IGNvbnN0IFNIWVJPTl9NQVNTQUNSRSA9IENvbmRpdGlvbigweDAyNyk7XG4gIGV4cG9ydCBjb25zdCBMRUFGX0FCRFVDVElPTiA9IENvbmRpdGlvbigweDAzOCk7XG4gIGV4cG9ydCBjb25zdCBaRUJVX0NBVkUgPSBDb25kaXRpb24oMHgwM2EpO1xuICBleHBvcnQgY29uc3QgWkVCVV9TSFlST04gPSBDb25kaXRpb24oMHgwM2IpO1xuICBleHBvcnQgY29uc3QgUkVTQ1VFRF9DSElMRCA9IENvbmRpdGlvbigweDA0NSk7XG4gIGV4cG9ydCBjb25zdCBEV0FSRl9NT1RIRVIgPSBDb25kaXRpb24oMHgwNTIpOyAvLyB0YWxrZWQgdG8gdy8gdGVsZXBhdGh5XG4gIGV4cG9ydCBjb25zdCBEV0FSRl9DSElMRCA9IENvbmRpdGlvbigweDA1Myk7IC8vIGZvbGxvd2luZ1xuICBleHBvcnQgY29uc3QgU1RPTV9JTl9TV0FOID0gQ29uZGl0aW9uKDB4MDYxKTtcbiAgZXhwb3J0IGNvbnN0IERSQVlHT04xID0gQ29uZGl0aW9uKDB4MDZjKTtcbiAgZXhwb3J0IGNvbnN0IEZPVU5EX0tFTlNVID0gQ29uZGl0aW9uKDB4MDcyKTtcbiAgZXhwb3J0IGNvbnN0IFNIRUxMX0ZMVVRFID0gQ29uZGl0aW9uKDB4MDhiKTsgLy8gdXNlZCBmb3Igbm9uLXNsb3QgZGlhbG9nIH4gZmlzaGVybWFuXG4gIGV4cG9ydCBjb25zdCBSSURFX0RPTFBISU4gPSBDb25kaXRpb24oMHgwOWIpO1xuICBleHBvcnQgY29uc3QgWkVCVV9TVFVERU5UID0gQ29uZGl0aW9uKDB4MGE1KTtcbiAgZXhwb3J0IGNvbnN0IExFQUZfUkFCQklUID0gQ29uZGl0aW9uKDB4MGE5KTtcbiAgZXhwb3J0IGNvbnN0IENBTE1FRF9TRUEgPSBDb25kaXRpb24oMHgyODMpO1xuICBleHBvcnQgY29uc3QgT1BFTkVEX0pPRUxfU0hFRCA9IENvbmRpdGlvbigweDI4Nyk7XG4gIGV4cG9ydCBjb25zdCBPUEVORURfQ1JZUFQgPSBDb25kaXRpb24oMHgyOGUpO1xuICBleHBvcnQgY29uc3QgT1BFTkVEX1NUWVggPSBDb25kaXRpb24oMHgyYjApO1xuICBleHBvcnQgY29uc3QgT1BFTkVEX1NXQU4gPSBDb25kaXRpb24oMHgyYjMpO1xuICBleHBvcnQgY29uc3QgT1BFTkVEX1BSSVNPTiA9IENvbmRpdGlvbigweDJkOCk7XG4gIGV4cG9ydCBjb25zdCBPUEVORURfU0VBTEVEX0NBVkUgPSBDb25kaXRpb24oMHgyZWUpO1xuICBleHBvcnQgY29uc3QgU1RBUlQgPSBDb25kaXRpb24oMHgyZjApOyAgLy8gYWx3YXlzIHRydWVcbiAgLy8gTk9URTogVGhlc2UgYXJlIG1vdmVkIGZyb20gdmFuaWxsYSBiZWNhdXNlIG9mIHpvbWJpZSB3YXJwIVxuICBleHBvcnQgY29uc3QgV0FSUF9PQUsgPSBDb25kaXRpb24oMHgyZjYpO1xuICBleHBvcnQgY29uc3QgV0FSUF9KT0VMID0gQ29uZGl0aW9uKDB4MmZhKTtcbiAgLy8gZXhwb3J0IGNvbnN0IFdBUlBfU0hZUk9OID0gQ29uZGl0aW9uKDB4MmZkKTtcbiAgLy8gZXhwb3J0IGNvbnN0IFdBUlBfU0FIQVJBID0gQ29uZGl0aW9uKDB4MmZmKTtcbn1cblxuLy8gTk9URTogdGhlc2UgaXRlbXMgYW5kIGNhcGFiaWxpdGllcyBhcmUgb25lcyBjb21wbGVtZW50cywgbm90IG5lZ2F0aXZlc1xuZXhwb3J0IHR5cGUgQ2FwYWJpbGl0eSA9IHJlYWRvbmx5IFtyZWFkb25seSBbQ29uZGl0aW9uXV07XG5leHBvcnQgbmFtZXNwYWNlIENhcGFiaWxpdHkge1xuICBleHBvcnQgY29uc3QgU1dPUkQgPSBDb25kaXRpb24ofjApO1xuICBleHBvcnQgY29uc3QgTU9ORVkgPSBDb25kaXRpb24ofjEpO1xuICBleHBvcnQgY29uc3QgQlJFQUtfU1RPTkUgPSBDb25kaXRpb24ofjIpO1xuICBleHBvcnQgY29uc3QgQlJFQUtfSUNFID0gQ29uZGl0aW9uKH4zKTtcbiAgZXhwb3J0IGNvbnN0IEZPUk1fQlJJREdFID0gQ29uZGl0aW9uKH40KTtcbiAgZXhwb3J0IGNvbnN0IEJSRUFLX0lST04gPSBDb25kaXRpb24ofjUpO1xuICBleHBvcnQgY29uc3QgVFJBVkVMX1NXQU1QID0gQ29uZGl0aW9uKH42KTtcbiAgZXhwb3J0IGNvbnN0IENMSU1CX1dBVEVSRkFMTCA9IENvbmRpdGlvbih+Nyk7XG4gIGV4cG9ydCBjb25zdCBCVVlfSEVBTElORyA9IENvbmRpdGlvbih+OCk7XG4gIGV4cG9ydCBjb25zdCBCVVlfV0FSUCA9IENvbmRpdGlvbih+OSk7XG4gIGV4cG9ydCBjb25zdCBTSE9PVElOR19TVEFUVUUgPSBDb25kaXRpb24ofjEwKTtcbiAgZXhwb3J0IGNvbnN0IENMSU1CX1NMT1BFID0gQ29uZGl0aW9uKH4xMSk7XG59XG5cbi8vIFRoZXNlIGluZGljYXRlIHRoZSBib3NzIGlzIGFjdHVhbGx5IGRlZmVhdGVkLlxuZXhwb3J0IHR5cGUgQm9zcyA9IHJlYWRvbmx5IFtyZWFkb25seSBbQ29uZGl0aW9uXV07XG5leHBvcnQgZnVuY3Rpb24gQm9zcyhpZDogbnVtYmVyKTogQm9zcyB7XG4gIHJldHVybiBDb25kaXRpb24oMHgxMDAgfCBpZCk7XG59XG5leHBvcnQgbmFtZXNwYWNlIEJvc3Mge1xuICBleHBvcnQgY29uc3QgVkFNUElSRTEgPSBCb3NzKDB4MCk7XG4gIGV4cG9ydCBjb25zdCBJTlNFQ1QgPSBCb3NzKDB4MSk7XG4gIGV4cG9ydCBjb25zdCBLRUxCRVNRVUUxID0gQm9zcygweDIpO1xuICBleHBvcnQgY29uc3QgUkFHRSA9IEJvc3MoMHgzKTtcbiAgZXhwb3J0IGNvbnN0IFNBQkVSQTEgPSBCb3NzKDB4NCk7XG4gIGV4cG9ydCBjb25zdCBNQURPMSA9IEJvc3MoMHg1KTtcbiAgZXhwb3J0IGNvbnN0IEtFTEJFU1FVRTIgPSBCb3NzKDB4Nik7XG4gIGV4cG9ydCBjb25zdCBTQUJFUkEyID0gQm9zcygweDcpO1xuICBleHBvcnQgY29uc3QgTUFETzIgPSBCb3NzKDB4OCk7XG4gIGV4cG9ydCBjb25zdCBLQVJNSU5FID0gQm9zcygweDkpO1xuICBleHBvcnQgY29uc3QgRFJBWUdPTjEgPSBCb3NzKDB4YSk7XG4gIGV4cG9ydCBjb25zdCBEUkFZR09OMiA9IEJvc3MoMHhiKTtcbiAgZXhwb3J0IGNvbnN0IFZBTVBJUkUyID0gQm9zcygweGMpO1xufVxuXG5leHBvcnQgdHlwZSBJdGVtID0gcmVhZG9ubHkgW3JlYWRvbmx5IFtDb25kaXRpb25dXTtcbmV4cG9ydCBmdW5jdGlvbiBJdGVtKGlkOiBudW1iZXIpOiBJdGVtIHtcbiAgaWYgKGlkID49IDB4NzApIHRocm93IG5ldyBFcnJvcihgZXhwZWN0ZWQgaXRlbTogJHtpZC50b1N0cmluZygxNil9YCk7XG4gIHJldHVybiBDb25kaXRpb24oMHgyMDAgfCBpZCk7XG59XG5leHBvcnQgbmFtZXNwYWNlIEl0ZW0ge1xuICBleHBvcnQgY29uc3QgU1dPUkRfT0ZfV0lORCA9IEl0ZW0oMHgwMCk7XG4gIGV4cG9ydCBjb25zdCBTV09SRF9PRl9GSVJFID0gSXRlbSgweDAxKTtcbiAgZXhwb3J0IGNvbnN0IFNXT1JEX09GX1dBVEVSID0gSXRlbSgweDAyKTtcbiAgZXhwb3J0IGNvbnN0IFNXT1JEX09GX1RIVU5ERVIgPSBJdGVtKDB4MDMpO1xuICBleHBvcnQgY29uc3QgQ1JZU1RBTElTID0gSXRlbSgweDA0KTtcbiAgZXhwb3J0IGNvbnN0IE9SQl9PRl9XSU5EID0gSXRlbSgweDA1KTtcbiAgZXhwb3J0IGNvbnN0IFRPUk5BRE9fQlJBQ0VMRVQgPSBJdGVtKDB4MDYpO1xuICBleHBvcnQgY29uc3QgT1JCX09GX0ZJUkUgPSBJdGVtKDB4MDcpO1xuICBleHBvcnQgY29uc3QgRkxBTUVfQlJBQ0VMRVQgPSBJdGVtKDB4MDgpO1xuICBleHBvcnQgY29uc3QgT1JCX09GX1dBVEVSID0gSXRlbSgweDA5KTtcbiAgZXhwb3J0IGNvbnN0IEJMSVpaQVJEX0JSQUNFTEVUID0gSXRlbSgweDBhKTtcbiAgZXhwb3J0IGNvbnN0IE9SQl9PRl9USFVOREVSID0gSXRlbSgweDBiKTtcbiAgZXhwb3J0IGNvbnN0IFNUT1JNX0JSQUNFTEVUID0gSXRlbSgweDBjKTtcblxuICBleHBvcnQgY29uc3QgTUVESUNBTF9IRVJCID0gSXRlbSgweDFkKTtcbiAgZXhwb3J0IGNvbnN0IFdBUlBfQk9PVFMgPSBJdGVtKDB4MjQpO1xuXG4gIGV4cG9ydCBjb25zdCBTVEFUVUVfT0ZfT05ZWCA9IEl0ZW0oMHgyNSk7XG4gIGV4cG9ydCBjb25zdCBJTlNFQ1RfRkxVVEUgPSBJdGVtKDB4MjcpO1xuICBleHBvcnQgY29uc3QgRkxVVEVfT0ZfTElNRSA9IEl0ZW0oMHgyOCk7XG4gIGV4cG9ydCBjb25zdCBHQVNfTUFTSyA9IEl0ZW0oMHgyOSk7XG4gIGV4cG9ydCBjb25zdCBQT1dFUl9SSU5HID0gSXRlbSgweDJhKTtcbiAgZXhwb3J0IGNvbnN0IFdBUlJJT1JfUklORyA9IEl0ZW0oMHgyYik7XG4gIGV4cG9ydCBjb25zdCBJUk9OX05FQ0tMQUNFID0gSXRlbSgweDJjKTtcbiAgZXhwb3J0IGNvbnN0IERFT1NfUEVOREFOVCA9IEl0ZW0oMHgyZCk7XG4gIGV4cG9ydCBjb25zdCBSQUJCSVRfQk9PVFMgPSBJdGVtKDB4MmUpO1xuICBleHBvcnQgY29uc3QgTEVBVEhFUl9CT09UUyA9IEl0ZW0oMHgyZik7XG4gIGV4cG9ydCBjb25zdCBTSElFTERfUklORyA9IEl0ZW0oMHgzMCk7XG4gIGV4cG9ydCBjb25zdCBBTEFSTV9GTFVURSA9IEl0ZW0oMHgzMSk7XG4gIGV4cG9ydCBjb25zdCBXSU5ETUlMTF9LRVkgPSBJdGVtKDB4MzIpO1xuICBleHBvcnQgY29uc3QgS0VZX1RPX1BSSVNPTiA9IEl0ZW0oMHgzMyk7XG4gIGV4cG9ydCBjb25zdCBLRVlfVE9fU1RZWCA9IEl0ZW0oMHgzNCk7XG4gIGV4cG9ydCBjb25zdCBGT0dfTEFNUCA9IEl0ZW0oMHgzNSk7XG4gIGV4cG9ydCBjb25zdCBTSEVMTF9GTFVURSA9IEl0ZW0oMHgzNik7XG4gIGV4cG9ydCBjb25zdCBFWUVfR0xBU1NFUyA9IEl0ZW0oMHgzNyk7XG4gIGV4cG9ydCBjb25zdCBCUk9LRU5fU1RBVFVFID0gSXRlbSgweDM4KTtcbiAgZXhwb3J0IGNvbnN0IEdMT1dJTkdfTEFNUCA9IEl0ZW0oMHgzOSk7XG4gIC8vIFRPRE8gLSBjb25zaWRlciBtYWtpbmcgdGhpcyBhbiBhY3R1YWwgaXRlbS5cbiAgZXhwb3J0IGNvbnN0IFNUQVRVRV9PRl9HT0xEID0gYW5kKEl0ZW0uQlJPS0VOX1NUQVRVRSwgSXRlbS5HTE9XSU5HX0xBTVApO1xuICBleHBvcnQgY29uc3QgTE9WRV9QRU5EQU5UID0gSXRlbSgweDNiKTtcbiAgZXhwb3J0IGNvbnN0IEtJUklTQV9QTEFOVCA9IEl0ZW0oMHgzYyk7XG4gIGV4cG9ydCBjb25zdCBJVk9SWV9TVEFUVUUgPSBJdGVtKDB4M2QpO1xuICBleHBvcnQgY29uc3QgQk9XX09GX01PT04gPSBJdGVtKDB4M2UpO1xuICBleHBvcnQgY29uc3QgQk9XX09GX1NVTiA9IEl0ZW0oMHgzZik7XG4gIGV4cG9ydCBjb25zdCBCT1dfT0ZfVFJVVEggPSBJdGVtKDB4NDApO1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIE1hZ2ljIHtcbiAgZXhwb3J0IGNvbnN0IFJFRlJFU0ggPSBJdGVtKDB4NDEpO1xuICBleHBvcnQgY29uc3QgUEFSQUxZU0lTID0gSXRlbSgweDQyKTtcbiAgZXhwb3J0IGNvbnN0IFRFTEVQQVRIWSA9IEl0ZW0oMHg0Myk7XG4gIGV4cG9ydCBjb25zdCBURUxFUE9SVCA9IEl0ZW0oMHg0NCk7XG4gIGV4cG9ydCBjb25zdCBSRUNPVkVSID0gSXRlbSgweDQ1KTtcbiAgZXhwb3J0IGNvbnN0IEJBUlJJRVIgPSBJdGVtKDB4NDYpO1xuICBleHBvcnQgY29uc3QgQ0hBTkdFID0gSXRlbSgweDQ3KTtcbiAgZXhwb3J0IGNvbnN0IEZMSUdIVCA9IEl0ZW0oMHg0OCk7XG59XG5cbi8vIGV4cG9ydCBmdW5jdGlvbiBzdGF0dWUoLi4ucmVxczogUmVxdWlyZW1lbnRbXSk6IFRlcnJhaW4ge1xuLy8gICByZXR1cm4ge2V4aXQ6IG9yKC4uLnJlcXMsIENhcGFiaWxpdHkuU1RBVFVFX0dMSVRDSCl9O1xuLy8gfTtcblxuLy8gTmV3dHlwZXMgZm9yIGRpZmZlcmVudCBudW1iZXIgcHVycG9zZXNcblxuZXhwb3J0IGVudW0gV2FsbFR5cGUge1xuICBXSU5EID0gMCxcbiAgRklSRSA9IDEsXG4gIFdBVEVSID0gMixcbiAgVEhVTkRFUiA9IDMsXG59XG5cbi8vIENsYXNzIGZvciBrZWVwaW5nIHRyYWNrIG9mIGEgZGlzanVuY3RpdmUgbm9ybWFsIGZvcm0gZXhwcmVzc2lvblxuZXhwb3J0IGNsYXNzIE11dGFibGVSZXF1aXJlbWVudCB7XG4gIHByaXZhdGUgcmVhZG9ubHkgbWFwID0gbmV3IE1hcDxzdHJpbmcsIFNldDxDb25kaXRpb24+PigpO1xuXG4gIFtTeW1ib2wuaXRlcmF0b3JdKCk6IEl0ZXJhdG9yPEl0ZXJhYmxlPENvbmRpdGlvbj4+IHtcbiAgICByZXR1cm4gdGhpcy5tYXAudmFsdWVzKCk7XG4gIH1cblxuICBhZGQobmV3TGFiZWw6IHN0cmluZywgbmV3RGVwczogU2V0PENvbmRpdGlvbj4pOiBib29sZWFuIHtcbiAgICBmb3IgKGNvbnN0IGMgb2YgbmV3RGVwcykgaWYgKEFycmF5LmlzQXJyYXkoYykpIHRocm93IG5ldyBFcnJvcigpO1xuXG4gICAgaWYgKHRoaXMubWFwLmhhcyhuZXdMYWJlbCkpIHJldHVybiBmYWxzZTtcbiAgICBmb3IgKGNvbnN0IFtjdXJMYWJlbCwgY3VyRGVwc10gb2YgdGhpcy5tYXApIHtcbiAgICAgIGlmIChjb250YWluc0FsbChuZXdEZXBzLCBjdXJEZXBzKSkgcmV0dXJuIGZhbHNlO1xuICAgICAgaWYgKGNvbnRhaW5zQWxsKGN1ckRlcHMsIG5ld0RlcHMpKSB0aGlzLm1hcC5kZWxldGUoY3VyTGFiZWwpO1xuICAgIH1cbiAgICB0aGlzLm1hcC5zZXQobmV3TGFiZWwsIG5ld0RlcHMpO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG5cbiAgYWRkQWxsKHJlcXVpcmVtZW50OiBSZXF1aXJlbWVudCk6IHZvaWQge1xuICAgIGZvciAoY29uc3QgY29uZGl0aW9ucyBvZiByZXF1aXJlbWVudCkge1xuICAgICAgdGhpcy5hZGRMaXN0KGNvbmRpdGlvbnMpO1xuICAgIH1cbiAgfVxuXG4gIGFkZExpc3QoY29uZGl0aW9uczogcmVhZG9ubHkgQ29uZGl0aW9uW10pOiB2b2lkIHtcbiAgICBjb25zdCBzb3J0ZWQgPSBbLi4ubmV3IFNldChjb25kaXRpb25zKV0uc29ydCgpO1xuICAgIGNvbnN0IGRlcHMgPSBuZXcgU2V0KHNvcnRlZCk7XG4gICAgdGhpcy5hZGQoc29ydGVkLmpvaW4oJyAnKSwgZGVwcyk7XG4gIH1cblxuICAvKiogQXBwZW5kcyB0aGUgZ2l2ZW4gcmVxdWlyZW1lbnQgdG8gYWxsIHJvdXRlcy4gKi9cbiAgcmVzdHJpY3QocjogUmVxdWlyZW1lbnQpOiB2b2lkIHtcbiAgICBjb25zdCBsID0gWy4uLnRoaXMubWFwLnZhbHVlcygpXTtcbiAgICB0aGlzLm1hcC5jbGVhcigpO1xuICAgIGZvciAoY29uc3QgbHMgb2YgbCkge1xuICAgICAgZm9yIChjb25zdCBycyBvZiByKSB7XG4gICAgICAgIHRoaXMuYWRkTGlzdChbLi4ubHMsIC4uLnJzXSk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgZnJlZXplKCk6IFJlcXVpcmVtZW50IHtcbiAgICByZXR1cm4gWy4uLnRoaXNdLm1hcChjcyA9PiBbLi4uY3NdKTtcbiAgfVxufVxuXG5jb25zdCBjb250YWluc0FsbCA9IDxUPihsZWZ0OiBTZXQ8VD4sIHJpZ2h0OiBTZXQ8VD4pOiBib29sZWFuID0+IHtcbiAgaWYgKGxlZnQuc2l6ZSA8IHJpZ2h0LnNpemUpIHJldHVybiBmYWxzZTtcbiAgZm9yIChjb25zdCBkIG9mIHJpZ2h0KSB7XG4gICAgaWYgKCFsZWZ0LmhhcyhkKSkgcmV0dXJuIGZhbHNlO1xuICB9XG4gIHJldHVybiB0cnVlO1xufTtcblxuLy8gRmxhZywgaXRlbSwgb3IgY29uZGl0aW9uLlxuZXhwb3J0IHR5cGUgQ29uZGl0aW9uID0gbnVtYmVyICYge19fY29uZGl0aW9uX186IG5ldmVyfTtcblxuZXhwb3J0IGZ1bmN0aW9uIENvbmRpdGlvbih4OiBudW1iZXIpOiByZWFkb25seSBbcmVhZG9ubHkgW0NvbmRpdGlvbl1dIHtcbiAgcmV0dXJuIFtbeCBhcyBDb25kaXRpb25dXTtcbn1cbmV4cG9ydCBmdW5jdGlvbiBhbmQoLi4uY3M6IChyZWFkb25seSBbcmVhZG9ubHkgQ29uZGl0aW9uW11dKVtdKTogUmVxdWlyZW1lbnQge1xuICAvLyBUT0RPIC0gdGhpcyB3YXMgYSBkZXN0cnVjdHVyaW5nIGZ1bmN0aW9uIChbY10pID0+IGMgYnV0IENsb3N1cmUgaXMgZGVzdHJveWluZ1xuICAvLyBpdCBpbnRvIChjKSA9PiBbY10gPSBjLlxuICAvL3JldHVybiBbKFtdIGFzIENvbmRpdGlvbltdKS5jb25jYXQoLi4uY3MubWFwKChbY10pID0+IGMpKV07XG4gIHJldHVybiBbKFtdIGFzIENvbmRpdGlvbltdKS5jb25jYXQoLi4uY3MubWFwKChjKSA9PiBjWzBdKSldO1xufVxuZXhwb3J0IGZ1bmN0aW9uIG9yKC4uLmNzOiBSZXF1aXJlbWVudFtdKTogUmVxdWlyZW1lbnQge1xuICByZXR1cm4gKFtdIGFzIFJlcXVpcmVtZW50KS5jb25jYXQoLi4uY3MpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIG1lZXQobGVmdDogUmVxdWlyZW1lbnQsIHJpZ2h0OiBSZXF1aXJlbWVudCk6IFJlcXVpcmVtZW50IHtcbiAgY29uc3Qgb3V0ID0gbmV3IE11dGFibGVSZXF1aXJlbWVudCgpO1xuICBmb3IgKGNvbnN0IGxzIG9mIGxlZnQpIHtcbiAgICBmb3IgKGNvbnN0IHJzIG9mIHJpZ2h0KSB7XG4gICAgICBvdXQuYWRkTGlzdChbLi4ubHMsIC4uLnJzXSk7XG4gICAgfVxuICB9XG4gIHJldHVybiBvdXQuZnJlZXplKCk7XG59XG5cbi8vIGFsaWFzIGZvciB1c2UgaW4gVGVycmFpbi5tZWV0XG5jb25zdCBtZWV0UmVxID0gbWVldDtcblxuZXhwb3J0IG5hbWVzcGFjZSBDb25kaXRpb24ge1xuICBleHBvcnQgY29uc3QgT1BFTjogUmVxdWlyZW1lbnQgPSBbW11dO1xufVxuXG4vLyBBbiBpbW11dGFibGUgRE5GIGV4cHJlc3Npb24uICBBbGwgZXhwb3J0ZWQgY29uc3RhbnRzIGFyZSBpbiB0aGlzIGZvcm0uXG5leHBvcnQgdHlwZSBSZXF1aXJlbWVudCA9IHJlYWRvbmx5IChyZWFkb25seSBDb25kaXRpb25bXSlbXTtcblxuLy8gU2xvdCBmb3IgYW4gaXRlbSBvciBmbGFnIHRvIGdldC4gIEFsbW9zdCB0aGUgc2FtZSB0aGluZyBhcyBhIHNpbmdsZVxuLy8gY29uZGl0aW9uLCBidXQgdXNlZCBpbiBkaWZmZXJlbnQgY29udGV4dHMuXG5leHBvcnQgdHlwZSBTbG90ID0gbnVtYmVyICYge19fc2xvdF9fOiBuZXZlcn07XG5cbmV4cG9ydCBmdW5jdGlvbiBTbG90KHg6IG51bWJlciB8IHJlYWRvbmx5IFtyZWFkb25seSBbQ29uZGl0aW9uXV0pOiBTbG90IHtcbiAgaWYgKHR5cGVvZiB4ID09PSAnbnVtYmVyJykgcmV0dXJuIHggYXMgU2xvdDtcbiAgcmV0dXJuIHhbMF1bMF0gYXMgYW55O1xufVxuZXhwb3J0IG5hbWVzcGFjZSBTbG90IHtcbiAgZXhwb3J0IGZ1bmN0aW9uIGl0ZW0oeDogbnVtYmVyKTogU2xvdCB7XG4gICAgcmV0dXJuICh4IHwgMHgyMDApIGFzIFNsb3Q7XG4gIH1cbiAgLy8gZXhwb3J0IGZ1bmN0aW9uIGJvc3MoeDogbnVtYmVyKTogU2xvdCB7XG4gIC8vICAgcmV0dXJuICh+KHggfCAweDEwMCkpIGFzIFNsb3Q7XG4gIC8vIH1cbn1cblxuXG4vLyBNZXRhZGF0YSBhYm91dCBnZXR0aW5nIHNsb3RzLlxuZXhwb3J0IGludGVyZmFjZSBDaGVjayB7XG4gIGNvbmRpdGlvbj86IFJlcXVpcmVtZW50O1xuICBzbG90OiBTbG90O1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIENoZWNrIHtcbiAgZXhwb3J0IGZ1bmN0aW9uIGNoZXN0KGlkOiBudW1iZXIpOiBDaGVjayB7XG4gICAgcmV0dXJuIHtzbG90OiBTbG90KDB4MjAwIHwgaWQpfTtcbiAgfVxufVxuXG5cbmV4cG9ydCBpbnRlcmZhY2UgVGVycmFpbiB7XG4gIC8vIFJlcXVpcmVtZW50IHRvIGVudGVyIHRpbGUsIGRlZmF1bHRzIHRvIE9QRU5cbiAgZW50ZXI/OiBSZXF1aXJlbWVudDtcbiAgLy8gUmVxdWlyZW1lbnQgdG8gZXhpdCBhbnkgZGlyZWN0aW9uIG90aGVyIHRoYW4gc291dGhcbiAgZXhpdD86IFJlcXVpcmVtZW50O1xuICAvLyBSZXF1aXJlbWVudCB0byBleGl0IHNvdXRoXG4gIGV4aXRTb3V0aD86IFJlcXVpcmVtZW50O1xufVxuXG5leHBvcnQgbmFtZXNwYWNlIFRlcnJhaW4ge1xuICAvLyBQb3NpdGl2ZSBudW1iZXJzIHJlcHJlc2VudCBmbGFncywgaXRlbXMsIGV0Yy5cbiAgLy8gLy8gTmVnYXRpdmUgbnVtYmVycyByZXByZXNlbnQgY29tcG9zaXRlIGNvbmRpdGlvbnMuXG4gIC8vIGV4cG9ydCBjb25zdCBDUk9TU19SSVZFUlMgPSAtMTtcbiAgLy8gZXhwb3J0IGNvbnN0IENST1NTX1NFQSA9IC0yO1xuXG4gIC8vIFRPRE8gLSBob3cgdG8gaGFuZGxlIGRvbHBoaW4/IT9cbiAgLy8gICAtLSBpdCdzIHBvc3NpYmxlIHdlIGNvdWxkIGhhcmQtY29kZSB0aGF0IGFueXRoaW5nIGNvbm5lY3RlZFxuICAvLyAgICAgIHRvIGFuZ3J5IHNlYSBpcyBlbnRlcmFibGUgdy8gZG9scGhpbiBhcyB3ZWxsP1xuICAvLyAgIC0tIHJlcXVpcmVzIGxhbmQgYnJpZGdlIGluIHVuZGVyZ3JvdW5kIGNoYW5uZWwuLi5cbiAgLy8gICAgICAtIGNvdWxkIGFsc28ganVzdCB1c2Ugc3VtbW9uIHBvaW50cz9cbiAgLy8gV2hhdCBhYm91dCBmbGFncyBvdmVyIHdhdGVyIC0gbm90IGltcGFzc2FibGU/IHNob3VsZG4ndCBtYXR0ZXI/XG5cbiAgLyoqIE1ha2VzIGEgc2luZ2xlIGV4dHJhIGNvcHkgb2YgYSB0ZXJyYWluIGZvciBzZWFtbGVzcyBleGl0cy4gKi9cbiAgLy8gU2VhbWxlc3MgZXhpdHM6IHNhbWUgZWZmZWN0IGFzIE9QRU4gYnV0IGEgZGlmZmVyZW50IG9iamVjdCBzbyBpdFxuICAvLyBkb2Vzbid0IGdldCB1bmlvbmVkIHRvZ2V0aGVyLiAgVGhpcyB3YXkgd2UgY2FuIGRpc3Rpbmd1aXNoIHRoZVxuICAvLyBleGl0cyBjbGVhcmx5LlxuICBleHBvcnQgY29uc3Qgc2VhbWxlc3MgPSBtZW1vaXplKCh0OiBUZXJyYWluKTogVGVycmFpbiA9PiAoey4uLnR9KSk7XG5cbiAgLy8gZXhwb3J0IGZ1bmN0aW9uIGZsYWcoaWQ6IG51bWJlciwgZmxpZ2h0PzogYm9vbGVhbikge1xuICAvLyAgIHJldHVybiB7ZW50ZXI6IGZsaWdodCA/IFtbaWRdLCBbfjB4MjQ4XV0gOiBbW2lkXV19O1xuICAvLyB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIG1lZXQobGVmdDogVGVycmFpbiwgcmlnaHQ6IFRlcnJhaW4pOiBUZXJyYWluIHtcbiAgICBjb25zdCBvdXQ6IFRlcnJhaW4gPSB7fTtcbiAgICBpZiAobGVmdC5lbnRlciB8fCByaWdodC5lbnRlcikge1xuICAgICAgb3V0LmVudGVyID0gbWVldFJlcShsZWZ0LmVudGVyIHx8IFtbXV0sIHJpZ2h0LmVudGVyIHx8IFtbXV0pO1xuICAgIH1cbiAgICBpZiAobGVmdC5leGl0IHx8IHJpZ2h0LmV4aXQpIHtcbiAgICAgIG91dC5leGl0ID0gbWVldFJlcShsZWZ0LmV4aXQgfHwgW1tdXSwgcmlnaHQuZXhpdCB8fCBbW11dKTtcbiAgICB9XG4gICAgaWYgKGxlZnQuZXhpdFNvdXRoIHx8IHJpZ2h0LmV4aXRTb3V0aCkge1xuICAgICAgb3V0LmV4aXRTb3V0aCA9IG1lZXRSZXEobGVmdC5leGl0U291dGggfHwgW1tdXSwgcmlnaHQuZXhpdFNvdXRoIHx8IFtbXV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGpvaW4obGVmdDogVGVycmFpbiwgcmlnaHQ6IFRlcnJhaW4pOiBUZXJyYWluIHtcbiAgICBjb25zdCBvdXQ6IFRlcnJhaW4gPSB7fTtcbiAgICBpZiAobGVmdC5lbnRlciB8fCByaWdodC5lbnRlcikge1xuICAgICAgb3V0LmVudGVyID0gKGxlZnQuZW50ZXIgfHwgW1tdXSkuY29uY2F0KHJpZ2h0LmVudGVyIHx8IFtbXV0pO1xuICAgIH1cbiAgICBpZiAobGVmdC5leGl0IHx8IHJpZ2h0LmV4aXQpIHtcbiAgICAgIG91dC5leGl0ID0gKGxlZnQuZXhpdCB8fCBbW11dKS5jb25jYXQocmlnaHQuZXhpdCB8fCBbW11dKTtcbiAgICB9XG4gICAgaWYgKGxlZnQuZXhpdFNvdXRoIHx8IHJpZ2h0LmV4aXRTb3V0aCkge1xuICAgICAgb3V0LmV4aXRTb3V0aCA9IChsZWZ0LmV4aXRTb3V0aCB8fCBbW11dKS5jb25jYXQocmlnaHQuZXhpdFNvdXRoIHx8IFtbXV0pO1xuICAgIH1cbiAgICByZXR1cm4gb3V0O1xuICB9XG5cbiAgZXhwb3J0IGZ1bmN0aW9uIGZsYWcoaWQ6IG51bWJlcikge1xuICAgIHJldHVybiB7ZW50ZXI6IENvbmRpdGlvbihpZCl9O1xuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtZW1vaXplPFQgZXh0ZW5kcyBvYmplY3QsIFU+KGY6ICh4OiBUKSA9PiBVKTogKHg6IFQpID0+IFUge1xuICBjb25zdCBtYXAgPSBuZXcgV2Vha01hcDxULCBVPigpO1xuICBjb25zdCB1bmRlZiA9IHt9IGFzIFU7XG4gIHJldHVybiAoeDogVCk6IFUgPT4ge1xuICAgIGxldCB5ID0gbWFwLmdldCh4KTtcbiAgICBpZiAoeSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICB5ID0gZih4KTtcbiAgICAgIG1hcC5zZXQoeCwgeSA9PT0gdW5kZWZpbmVkID8gdW5kZWYgOiB5KTtcbiAgICB9IGVsc2UgaWYgKHkgPT09IHVuZGVmKSB7XG4gICAgICB5ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4geSBhcyBVO1xuICB9O1xufVxuXG5leHBvcnQgZnVuY3Rpb24gbWVtb2l6ZTI8VCBleHRlbmRzIG9iamVjdCwgVSBleHRlbmRzIG9iamVjdCwgVj4oXG4gICAgZjogKHg6IFQsIHk6IFUpID0+IFYpOiAoeDogVCwgeTogVSkgPT4gViB7XG4gIGNvbnN0IG1hcCA9IG5ldyBXZWFrTWFwPFQsIFdlYWtNYXA8VSwgVj4+KCk7XG4gIGNvbnN0IHVuZGVmOiBWID0ge30gYXMgVjtcbiAgcmV0dXJuICh4OiBULCB5OiBVKTogViA9PiB7XG4gICAgbGV0IHlzID0gbWFwLmdldCh4KTtcbiAgICBpZiAoeXMgPT0gdW5kZWZpbmVkKSBtYXAuc2V0KHgsIHlzID0gbmV3IFdlYWtNYXAoKSk7XG4gICAgbGV0IHogPSB5cy5nZXQoeSk7XG4gICAgaWYgKHogPT09IHVuZGVmaW5lZCkge1xuICAgICAgeiA9IGYoeCwgeSk7XG4gICAgICB5cy5zZXQoeSwgeiA9PT0gdW5kZWZpbmVkID8gdW5kZWYgOiB6KTtcbiAgICB9IGVsc2UgaWYgKHogPT09IHVuZGVmKSB7XG4gICAgICB6ID0gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4geiBhcyBWO1xuICB9O1xufVxuIl19